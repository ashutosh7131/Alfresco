/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Directive, Input, Output, EventEmitter } from '@angular/core';
import { TaskCloudService } from './../../../services/task-cloud.service';
import { AppsProcessCloudService } from './../../../../app/services/apps-process-cloud.service';
import { DateCloudFilterType } from '../../../../models/date-cloud-filter.model';
import moment from 'moment';
import { FormBuilder } from '@angular/forms';
import { debounceTime, filter, finalize, switchMap, takeUntil } from 'rxjs/operators';
import { Subject } from 'rxjs';
import { DateAdapter } from '@angular/material/core';
import { TranslationService, UserPreferencesService, UserPreferenceValues } from '@alfresco/adf-core';
import { TaskFilterDialogCloudComponent } from '../task-filter-dialog/task-filter-dialog-cloud.component';
import { MatDialog } from '@angular/material/dialog';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/forms';
import * as ɵngcc2 from '@angular/material/core';
import * as ɵngcc3 from '@alfresco/adf-core';
import * as ɵngcc4 from './../../../../app/services/apps-process-cloud.service';
import * as ɵngcc5 from './../../../services/task-cloud.service';
import * as ɵngcc6 from '@angular/material/dialog';
export class BaseEditTaskFilterCloudComponent {
    constructor(formBuilder, dateAdapter, userPreferencesService, appsProcessCloudService, taskCloudService, dialog, translateService) {
        this.formBuilder = formBuilder;
        this.dateAdapter = dateAdapter;
        this.userPreferencesService = userPreferencesService;
        this.appsProcessCloudService = appsProcessCloudService;
        this.taskCloudService = taskCloudService;
        this.dialog = dialog;
        this.translateService = translateService;
        this.appName = '';
        this.showTitle = true;
        this.showTaskFilterName = true;
        this.filterProperties = [];
        this.role = '';
        this.showFilterActions = true;
        this.actions = BaseEditTaskFilterCloudComponent.DEFAULT_ACTIONS;
        this.sortProperties = [];
        this.action = new EventEmitter();
        this.applicationNames = [];
        this.processDefinitionNames = [];
        this.formHasBeenChanged = false;
        this.taskFilterProperties = [];
        this.taskFilterActions = [];
        this.toggleFilterActions = false;
        this.sortDirections = [
            { value: 'ASC', label: 'ADF_CLOUD_TASK_FILTERS.DIRECTION.ASCENDING' },
            { value: 'DESC', label: 'ADF_CLOUD_TASK_FILTERS.DIRECTION.DESCENDING' }
        ];
        this.allProcessDefinitionNamesOption = {
            value: '',
            label: 'ADF_CLOUD_TASK_FILTERS.STATUS.ALL'
        };
        this.filterChange = new EventEmitter();
        this.onDestroy$ = new Subject();
        this.isLoading = false;
    }
    ngOnInit() {
        this.userPreferencesService
            .select(UserPreferenceValues.Locale)
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(locale => this.dateAdapter.setLocale(locale));
    }
    ngOnChanges(changes) {
        const id = changes['id'];
        if (id && id.currentValue !== id.previousValue) {
            this.retrieveTaskFilterAndBuildForm();
        }
    }
    ngOnDestroy() {
        this.onDestroy$.next(true);
        this.onDestroy$.complete();
    }
    createFilterActions() {
        return [
            {
                actionType: BaseEditTaskFilterCloudComponent.ACTION_SAVE,
                icon: 'adf:save',
                tooltip: 'ADF_CLOUD_EDIT_TASK_FILTER.TOOL_TIP.SAVE'
            },
            {
                actionType: BaseEditTaskFilterCloudComponent.ACTION_SAVE_AS,
                icon: 'adf:save-as',
                tooltip: 'ADF_CLOUD_EDIT_TASK_FILTER.TOOL_TIP.SAVE_AS'
            },
            {
                actionType: BaseEditTaskFilterCloudComponent.ACTION_DELETE,
                icon: 'delete',
                tooltip: 'ADF_CLOUD_EDIT_TASK_FILTER.TOOL_TIP.DELETE'
            }
        ];
    }
    hasFormChanged(action) {
        if (action.actionType === BaseEditTaskFilterCloudComponent.ACTION_SAVE) {
            return !this.formHasBeenChanged;
        }
        if (action.actionType === BaseEditTaskFilterCloudComponent.ACTION_SAVE_AS) {
            return !this.formHasBeenChanged;
        }
        if (action.actionType === BaseEditTaskFilterCloudComponent.ACTION_DELETE) {
            return false;
        }
        return false;
    }
    onExpand() {
        this.toggleFilterActions = true;
    }
    onClose() {
        this.toggleFilterActions = false;
    }
    isDisabledAction(action) {
        return this.isDisabledForDefaultFilters(action) ? true : this.hasFormChanged(action);
    }
    deepCompare(left, right) {
        return JSON.stringify(left).toLowerCase() === JSON.stringify(right).toLowerCase();
    }
    getSanitizeFilterName(filterName) {
        const nameWithHyphen = this.replaceSpaceWithHyphen(filterName.trim());
        return nameWithHyphen.toLowerCase();
    }
    replaceSpaceWithHyphen(name) {
        const regExt = new RegExp(' ', 'g');
        return name.replace(regExt, '-');
    }
    executeFilterActions(action) {
        if (action.actionType === BaseEditTaskFilterCloudComponent.ACTION_SAVE) {
            this.save(action);
        }
        else if (action.actionType === BaseEditTaskFilterCloudComponent.ACTION_SAVE_AS) {
            this.saveAs(action);
        }
        else if (action.actionType === BaseEditTaskFilterCloudComponent.ACTION_DELETE) {
            this.delete(action);
        }
    }
    getRunningApplications() {
        this.appsProcessCloudService
            .getDeployedApplicationsByStatus(BaseEditTaskFilterCloudComponent.APP_RUNNING_STATUS, this.role)
            .subscribe((applications) => {
            if (applications && applications.length > 0) {
                applications.map((application) => {
                    this.applicationNames.push({ label: application.name, value: application.name });
                });
            }
        });
    }
    getProcessDefinitions() {
        this.taskCloudService.getProcessDefinitions(this.appName)
            .subscribe((processDefinitions) => {
            if (processDefinitions && processDefinitions.length > 0) {
                this.processDefinitionNames.push(this.allProcessDefinitionNamesOption);
                processDefinitions.map((processDefinition) => {
                    this.processDefinitionNames.push({ label: processDefinition.name, value: processDefinition.name });
                });
            }
        });
    }
    checkMandatoryActions() {
        if (this.actions === undefined || this.actions.length === 0) {
            this.actions = BaseEditTaskFilterCloudComponent.DEFAULT_ACTIONS;
        }
    }
    isValidAction(actions, action) {
        return actions ? actions.indexOf(action.actionType) >= 0 : true;
    }
    isFormValid() {
        return this.editTaskFilterForm.valid;
    }
    getPropertyController(property) {
        return this.editTaskFilterForm.get(property.key);
    }
    onDateChanged(newDateValue, dateProperty) {
        if (newDateValue) {
            const momentDate = moment(newDateValue, BaseEditTaskFilterCloudComponent.FORMAT_DATE, true);
            const controller = this.getPropertyController(dateProperty);
            if (momentDate.isValid()) {
                controller.setValue(momentDate.toISOString(true));
                controller.setErrors(null);
            }
            else {
                controller.setErrors({ invalid: true });
            }
        }
    }
    onDateRangeFilterChanged(dateRange, property) {
        var _a, _b;
        this.editTaskFilterForm.get((_a = property.attributes) === null || _a === void 0 ? void 0 : _a.from).setValue(dateRange.startDate ? dateRange.startDate : null);
        this.editTaskFilterForm.get((_b = property.attributes) === null || _b === void 0 ? void 0 : _b.to).setValue(dateRange.endDate ? dateRange.endDate : null);
        this.editTaskFilterForm.get(property.attributes.dateType).setValue(DateCloudFilterType.RANGE);
    }
    onChangedUser(users, userProperty) {
        let selectedUsers;
        if (userProperty.selectionMode === 'single') {
            selectedUsers = users[0];
        }
        else {
            selectedUsers = users;
        }
        this.getPropertyController(userProperty).setValue(selectedUsers);
    }
    onAssignedChange(assignedValue) {
        this.editTaskFilterForm.get('candidateGroups').setValue([]);
        this.editTaskFilterForm.get('assignee').setValue(assignedValue === null || assignedValue === void 0 ? void 0 : assignedValue.username);
    }
    onAssignedGroupsChange(groups) {
        this.editTaskFilterForm.get('assignee').setValue(null);
        this.editTaskFilterForm.get('candidateGroups').setValue(groups);
    }
    hasError(property) {
        const controller = this.getPropertyController(property);
        return controller.errors && controller.errors.invalid;
    }
    hasLastModifiedProperty() {
        return this.filterProperties.indexOf(BaseEditTaskFilterCloudComponent.LAST_MODIFIED) >= 0;
    }
    get createSortProperties() {
        this.checkMandatorySortProperties();
        return this.sortProperties.map((property) => {
            return { label: property, value: property };
        });
    }
    createAndFilterActions() {
        this.checkMandatoryActions();
        return this.createFilterActions().filter(action => this.isValidAction(this.actions, action));
    }
    isValidProperty(filterProperties, key) {
        return filterProperties ? filterProperties.indexOf(key) >= 0 : true;
    }
    checkForProperty(property) {
        return this.filterProperties ? this.filterProperties.indexOf(property) >= 0 : false;
    }
    hasSortProperty() {
        return this.filterProperties.indexOf(BaseEditTaskFilterCloudComponent.SORT) >= 0;
    }
    removeOrderProperty(filteredProperties) {
        if (filteredProperties && filteredProperties.length > 0) {
            return filteredProperties.filter(property => property.key !== BaseEditTaskFilterCloudComponent.ORDER);
        }
        return [];
    }
    createAndFilterProperties() {
        this.checkMandatoryFilterProperties();
        if (this.checkForProperty(BaseEditTaskFilterCloudComponent.APPLICATION_NAME)) {
            this.applicationNames = [];
            this.getRunningApplications();
        }
        if (this.checkForProperty(BaseEditTaskFilterCloudComponent.PROCESS_DEFINITION_NAME)) {
            this.processDefinitionNames = [];
            this.getProcessDefinitions();
        }
        const defaultProperties = this.createTaskFilterProperties();
        let filteredProperties = defaultProperties.filter((filterProperty) => this.isValidProperty(this.filterProperties, filterProperty.key));
        if (!this.hasSortProperty()) {
            filteredProperties = this.removeOrderProperty(filteredProperties);
        }
        return filteredProperties;
    }
    onFilterChange() {
        this.editTaskFilterForm.valueChanges
            .pipe(debounceTime(500), filter(() => this.isFormValid()), takeUntil(this.onDestroy$))
            .subscribe((formValues) => {
            this.assignNewFilter(formValues);
        });
    }
    getFormControlsConfig(taskFilterProperties) {
        const properties = taskFilterProperties.map((property) => {
            if (!!property.attributes) {
                return this.getAttributesControlConfig(property);
            }
            else {
                return { [property.key]: property.value };
            }
        });
        return properties.reduce(((result, current) => Object.assign(result, current)), {});
    }
    getAttributesControlConfig(property) {
        return Object.values(property.attributes).reduce((result, key) => {
            result[key] = property.value[key];
            return result;
        }, {});
    }
    buildForm(taskFilterProperties) {
        this.formHasBeenChanged = false;
        this.editTaskFilterForm = this.formBuilder.group(this.getFormControlsConfig(taskFilterProperties));
        this.onFilterChange();
    }
    onDateTypeChange(dateType, property) {
        this.editTaskFilterForm.get(property.attributes.dateType).setValue(dateType);
    }
    retrieveTaskFilterAndBuildForm() {
        this.isLoading = true;
        this.getTaskFilterById(this.appName, this.id)
            .pipe(finalize(() => this.isLoading = false), takeUntil(this.onDestroy$))
            .subscribe(response => {
            this.taskFilter = response;
            this.taskFilterProperties = this.createAndFilterProperties();
            this.taskFilterActions = this.createAndFilterActions();
            this.buildForm(this.taskFilterProperties);
        });
    }
    delete(deleteAction) {
        this.deleteFilter(this.taskFilter)
            .pipe(filter((filters) => {
            deleteAction.filter = this.taskFilter;
            this.action.emit(deleteAction);
            return filters.length === 0;
        }), switchMap(() => this.restoreDefaultTaskFilters()), takeUntil(this.onDestroy$))
            .subscribe(() => { });
    }
    save(saveAction) {
        this.updateFilter(this.changedTaskFilter)
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(() => {
            saveAction.filter = this.changedTaskFilter;
            this.action.emit(saveAction);
            this.formHasBeenChanged = this.deepCompare(this.changedTaskFilter, this.taskFilter);
        });
    }
    saveAs(saveAsAction) {
        var _a;
        const dialogRef = this.dialog.open(TaskFilterDialogCloudComponent, {
            data: {
                name: this.translateService.instant((_a = this.taskFilter) === null || _a === void 0 ? void 0 : _a.name)
            },
            height: 'auto',
            minWidth: '30%'
        });
        dialogRef.afterClosed().subscribe((result) => {
            if (result && result.action === TaskFilterDialogCloudComponent.ACTION_SAVE) {
                const filterId = Math.random().toString(36).substr(2, 9);
                const filterKey = this.getSanitizeFilterName(result.name);
                const newFilter = {
                    name: result.name,
                    icon: result.icon,
                    id: filterId,
                    key: 'custom-' + filterKey
                };
                const resultFilter = Object.assign({}, this.changedTaskFilter, newFilter);
                this.addFilter(resultFilter).subscribe(() => {
                    saveAsAction.filter = resultFilter;
                    this.action.emit(saveAsAction);
                });
            }
        });
    }
    checkMandatoryFilterProperties() {
        if (this.filterProperties === undefined || this.filterProperties.length === 0) {
            this.filterProperties = this.getDefaultFilterProperties();
        }
    }
    checkMandatorySortProperties() {
        if (this.sortProperties === undefined || this.sortProperties.length === 0) {
            this.sortProperties = this.getDefaultSortProperties();
        }
    }
}
BaseEditTaskFilterCloudComponent.ɵfac = function BaseEditTaskFilterCloudComponent_Factory(t) { return new (t || BaseEditTaskFilterCloudComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.FormBuilder), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.DateAdapter), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.UserPreferencesService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.AppsProcessCloudService), ɵngcc0.ɵɵdirectiveInject(ɵngcc5.TaskCloudService), ɵngcc0.ɵɵdirectiveInject(ɵngcc6.MatDialog), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.TranslationService)); };
BaseEditTaskFilterCloudComponent.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: BaseEditTaskFilterCloudComponent, inputs: { appName: "appName", showTitle: "showTitle", showTaskFilterName: "showTaskFilterName", filterProperties: "filterProperties", role: "role", showFilterActions: "showFilterActions", actions: "actions", sortProperties: "sortProperties", id: "id" }, outputs: { action: "action", filterChange: "filterChange" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
BaseEditTaskFilterCloudComponent.ACTION_SAVE = 'save';
BaseEditTaskFilterCloudComponent.ACTION_SAVE_AS = 'saveAs';
BaseEditTaskFilterCloudComponent.ACTION_DELETE = 'delete';
BaseEditTaskFilterCloudComponent.APP_RUNNING_STATUS = 'RUNNING';
BaseEditTaskFilterCloudComponent.APPLICATION_NAME = 'appName';
BaseEditTaskFilterCloudComponent.PROCESS_DEFINITION_NAME = 'processDefinitionName';
BaseEditTaskFilterCloudComponent.LAST_MODIFIED = 'lastModified';
BaseEditTaskFilterCloudComponent.SORT = 'sort';
BaseEditTaskFilterCloudComponent.ORDER = 'order';
BaseEditTaskFilterCloudComponent.DEFAULT_ACTIONS = ['save', 'saveAs', 'delete'];
BaseEditTaskFilterCloudComponent.FORMAT_DATE = 'DD/MM/YYYY';
BaseEditTaskFilterCloudComponent.ACTIONS_DISABLED_BY_DEFAULT = [
    BaseEditTaskFilterCloudComponent.ACTION_SAVE,
    BaseEditTaskFilterCloudComponent.ACTION_DELETE
];
BaseEditTaskFilterCloudComponent.ctorParameters = () => [
    { type: FormBuilder },
    { type: DateAdapter },
    { type: UserPreferencesService },
    { type: AppsProcessCloudService },
    { type: TaskCloudService },
    { type: MatDialog },
    { type: TranslationService }
];
BaseEditTaskFilterCloudComponent.propDecorators = {
    appName: [{ type: Input }],
    id: [{ type: Input }],
    showTitle: [{ type: Input }],
    showTaskFilterName: [{ type: Input }],
    filterProperties: [{ type: Input }],
    role: [{ type: Input }],
    showFilterActions: [{ type: Input }],
    actions: [{ type: Input }],
    sortProperties: [{ type: Input }],
    action: [{ type: Output }],
    filterChange: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(BaseEditTaskFilterCloudComponent, [{
        type: Directive
    }], function () { return [{ type: ɵngcc1.FormBuilder }, { type: ɵngcc2.DateAdapter }, { type: ɵngcc3.UserPreferencesService }, { type: ɵngcc4.AppsProcessCloudService }, { type: ɵngcc5.TaskCloudService }, { type: ɵngcc6.MatDialog }, { type: ɵngcc3.TranslationService }]; }, { appName: [{
            type: Input
        }], showTitle: [{
            type: Input
        }], showTaskFilterName: [{
            type: Input
        }], filterProperties: [{
            type: Input
        }], role: [{
            type: Input
        }], showFilterActions: [{
            type: Input
        }], actions: [{
            type: Input
        }], sortProperties: [{
            type: Input
        }], action: [{
            type: Output
        }], filterChange: [{
            type: Output
        }], id: [{
            type: Input
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS1lZGl0LXRhc2stZmlsdGVyLWNsb3VkLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vaG9tZS90cmF2aXMvYnVpbGQvQWxmcmVzY28vYWxmcmVzY28tbmcyLWNvbXBvbmVudHMvbGliL3Byb2Nlc3Mtc2VydmljZXMtY2xvdWQvc3JjL2xpYi90YXNrL3Rhc2stZmlsdGVycy9jb21wb25lbnRzL2VkaXQtdGFzay1maWx0ZXJzL2Jhc2UtZWRpdC10YXNrLWZpbHRlci1jbG91ZC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUVILE9BQU8sRUFBK0MsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBILE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHdDQUF3QyxDQUFDO0FBQzFFLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHVEQUF1RCxDQUFDO0FBQ2hHLE9BQU8sRUFBRSxtQkFBbUIsRUFBbUIsTUFBTSw0Q0FBNEMsQ0FBQztBQUNsRyxPQUFPLE1BQWtCLE1BQU0sUUFBUSxDQUFDO0FBQ3hDLE9BQU8sRUFBbUIsV0FBVyxFQUFhLE1BQU0sZ0JBQWdCLENBQUM7QUFDekUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN0RixPQUFPLEVBQWMsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNyRCxPQUFPLEVBQXlDLGtCQUFrQixFQUFFLHNCQUFzQixFQUFFLG9CQUFv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QkFBa0I7QUFBRztBQUFHO0FBQW9ELHNCQThCdkgsS0FBSztBQUNSLGlCQUdHLEtBQUs7QUFDUix3QkFHRyxLQUFLO0FBQ1IsaUNBR0csS0FBSztBQUNSLCtCQUdHLEtBQUs7QUFDUixtQkFHRyxLQUFLO0FBQ1IsZ0NBR0csS0FBSztBQUNSLHNCQUdHLEtBQUs7QUFDUiw2QkFHRyxLQUFLO0FBQ1IscUJBR0csTUFBTTtBQUNULDJCQXVCRyxNQUFNO0FBQ1Y7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IE9uQ2hhbmdlcywgU2ltcGxlQ2hhbmdlcywgT25Jbml0LCBPbkRlc3Ryb3ksIERpcmVjdGl2ZSwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGaWx0ZXJPcHRpb25zLCBUYXNrRmlsdGVyQWN0aW9uLCBUYXNrRmlsdGVyUHJvcGVydGllcyB9IGZyb20gJy4uLy4uL21vZGVscy9maWx0ZXItY2xvdWQubW9kZWwnO1xuaW1wb3J0IHsgVGFza0Nsb3VkU2VydmljZSB9IGZyb20gJy4vLi4vLi4vLi4vc2VydmljZXMvdGFzay1jbG91ZC5zZXJ2aWNlJztcbmltcG9ydCB7IEFwcHNQcm9jZXNzQ2xvdWRTZXJ2aWNlIH0gZnJvbSAnLi8uLi8uLi8uLi8uLi9hcHAvc2VydmljZXMvYXBwcy1wcm9jZXNzLWNsb3VkLnNlcnZpY2UnO1xuaW1wb3J0IHsgRGF0ZUNsb3VkRmlsdGVyVHlwZSwgRGF0ZVJhbmdlRmlsdGVyIH0gZnJvbSAnLi4vLi4vLi4vLi4vbW9kZWxzL2RhdGUtY2xvdWQtZmlsdGVyLm1vZGVsJztcbmltcG9ydCBtb21lbnQsIHsgTW9tZW50IH0gZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IEFic3RyYWN0Q29udHJvbCwgRm9ybUJ1aWxkZXIsIEZvcm1Hcm91cCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSwgZmlsdGVyLCBmaW5hbGl6ZSwgc3dpdGNoTWFwLCB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBEYXRlQWRhcHRlciB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2NvcmUnO1xuaW1wb3J0IHsgSWRlbnRpdHlHcm91cE1vZGVsLCBJZGVudGl0eVVzZXJNb2RlbCwgVHJhbnNsYXRpb25TZXJ2aWNlLCBVc2VyUHJlZmVyZW5jZXNTZXJ2aWNlLCBVc2VyUHJlZmVyZW5jZVZhbHVlcyB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBUYXNrRmlsdGVyRGlhbG9nQ2xvdWRDb21wb25lbnQgfSBmcm9tICcuLi90YXNrLWZpbHRlci1kaWFsb2cvdGFzay1maWx0ZXItZGlhbG9nLWNsb3VkLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBNYXREaWFsb2cgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9kaWFsb2cnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERyb3Bkb3duT3B0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG59XG5cbkBEaXJlY3RpdmUoKVxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBkaXJlY3RpdmUtY2xhc3Mtc3VmZml4XG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQ8VD4gaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcywgT25EZXN0cm95IHtcblxuICAgIHB1YmxpYyBzdGF0aWMgQUNUSU9OX1NBVkUgPSAnc2F2ZSc7XG4gICAgcHVibGljIHN0YXRpYyBBQ1RJT05fU0FWRV9BUyA9ICdzYXZlQXMnO1xuICAgIHB1YmxpYyBzdGF0aWMgQUNUSU9OX0RFTEVURSA9ICdkZWxldGUnO1xuICAgIHB1YmxpYyBzdGF0aWMgQVBQX1JVTk5JTkdfU1RBVFVTOiBzdHJpbmcgPSAnUlVOTklORyc7XG4gICAgcHVibGljIHN0YXRpYyBBUFBMSUNBVElPTl9OQU1FOiBzdHJpbmcgPSAnYXBwTmFtZSc7XG4gICAgcHVibGljIHN0YXRpYyBQUk9DRVNTX0RFRklOSVRJT05fTkFNRTogc3RyaW5nID0gJ3Byb2Nlc3NEZWZpbml0aW9uTmFtZSc7XG4gICAgcHVibGljIHN0YXRpYyBMQVNUX01PRElGSUVEOiBzdHJpbmcgPSAnbGFzdE1vZGlmaWVkJztcbiAgICBwdWJsaWMgc3RhdGljIFNPUlQ6IHN0cmluZyA9ICdzb3J0JztcbiAgICBwdWJsaWMgc3RhdGljIE9SREVSOiBzdHJpbmcgPSAnb3JkZXInO1xuICAgIHB1YmxpYyBzdGF0aWMgREVGQVVMVF9BQ1RJT05TID0gWydzYXZlJywgJ3NhdmVBcycsICdkZWxldGUnXTtcbiAgICBwdWJsaWMgc3RhdGljIEZPUk1BVF9EQVRFOiBzdHJpbmcgPSAnREQvTU0vWVlZWSc7XG4gICAgcHVibGljIHN0YXRpYyBBQ1RJT05TX0RJU0FCTEVEX0JZX0RFRkFVTFQgPSBbXG4gICAgICAgIEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9TQVZFLFxuICAgICAgICBCYXNlRWRpdFRhc2tGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fREVMRVRFXG4gICAgXTtcblxuICAgIC8qKiAocmVxdWlyZWQpIE5hbWUgb2YgdGhlIGFwcC4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFwcE5hbWU6IHN0cmluZyA9ICcnO1xuXG4gICAgLyoqIChyZXF1aXJlZCkgSUQgb2YgdGhlIHRhc2sgZmlsdGVyLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgaWQ6IHN0cmluZztcblxuICAgIC8qKiBUb2dnbGVzIHRoZSB0aXRsZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dUaXRsZSA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyBkaXNwbGF5IG9mIHRhc2sgZmlsdGVyIG5hbWUgKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dUYXNrRmlsdGVyTmFtZSA9IHRydWU7XG5cbiAgICAvKiogTGlzdCBvZiB0YXNrIGZpbHRlciBwcm9wZXJ0aWVzIHRvIGRpc3BsYXkuICovXG4gICAgQElucHV0KClcbiAgICBmaWx0ZXJQcm9wZXJ0aWVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLyoqIHVzZXIgcm9sZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIHJvbGU6IHN0cmluZyA9ICcnO1xuXG4gICAgLyoqIFRvZ2dsZXMgdGhlIGZpbHRlciBhY3Rpb25zLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd0ZpbHRlckFjdGlvbnMgPSB0cnVlO1xuXG4gICAgLyoqIExpc3Qgb2YgdGFzayBmaWx0ZXIgYWN0aW9ucy4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFjdGlvbnM6IHN0cmluZ1tdID0gQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuREVGQVVMVF9BQ1RJT05TO1xuXG4gICAgLyoqIExpc3Qgb2Ygc29ydCBwcm9wZXJ0aWVzIHRvIGRpc3BsYXkuICovXG4gICAgQElucHV0KClcbiAgICBzb3J0UHJvcGVydGllczogc3RyaW5nW10gPSBbXTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gYSBmaWx0ZXIgYWN0aW9uIG9jY3VycyAoaS5lIFNhdmUsIFNhdmUgQXMsIERlbGV0ZSkuICovXG4gICAgQE91dHB1dCgpXG4gICAgYWN0aW9uID0gbmV3IEV2ZW50RW1pdHRlcjxUYXNrRmlsdGVyQWN0aW9uPigpO1xuXG4gICAgcHJvdGVjdGVkIGFwcGxpY2F0aW9uTmFtZXM6IERyb3Bkb3duT3B0aW9uW10gPSBbXTtcbiAgICBwcm90ZWN0ZWQgcHJvY2Vzc0RlZmluaXRpb25OYW1lczogRHJvcGRvd25PcHRpb25bXSA9IFtdO1xuICAgIHByb3RlY3RlZCBmb3JtSGFzQmVlbkNoYW5nZWQgPSBmYWxzZTtcblxuICAgIGVkaXRUYXNrRmlsdGVyRm9ybTogRm9ybUdyb3VwO1xuICAgIHRhc2tGaWx0ZXJQcm9wZXJ0aWVzOiBUYXNrRmlsdGVyUHJvcGVydGllc1tdID0gW107XG4gICAgdGFza0ZpbHRlckFjdGlvbnM6IFRhc2tGaWx0ZXJBY3Rpb25bXSA9IFtdO1xuICAgIHRvZ2dsZUZpbHRlckFjdGlvbnM6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBzb3J0RGlyZWN0aW9uczogRHJvcGRvd25PcHRpb25bXSA9IFtcbiAgICAgICAgeyB2YWx1ZTogJ0FTQycsIGxhYmVsOiAnQURGX0NMT1VEX1RBU0tfRklMVEVSUy5ESVJFQ1RJT04uQVNDRU5ESU5HJyB9LFxuICAgICAgICB7IHZhbHVlOiAnREVTQycsIGxhYmVsOiAnQURGX0NMT1VEX1RBU0tfRklMVEVSUy5ESVJFQ1RJT04uREVTQ0VORElORycgfVxuICAgIF07XG4gICAgYWxsUHJvY2Vzc0RlZmluaXRpb25OYW1lc09wdGlvbjogRHJvcGRvd25PcHRpb24gPSB7XG4gICAgICAgIHZhbHVlOiAnJyxcbiAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfVEFTS19GSUxURVJTLlNUQVRVUy5BTEwnXG4gICAgfTtcblxuICAgIHRhc2tGaWx0ZXI6IFQ7XG4gICAgY2hhbmdlZFRhc2tGaWx0ZXI6IFQ7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIGEgdGFzayBmaWx0ZXIgcHJvcGVydHkgY2hhbmdlcy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBmaWx0ZXJDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPFQ+KCk7XG5cbiAgICBwcm90ZWN0ZWQgb25EZXN0cm95JCA9IG5ldyBTdWJqZWN0PGJvb2xlYW4+KCk7XG4gICAgaXNMb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJvdGVjdGVkIGZvcm1CdWlsZGVyOiBGb3JtQnVpbGRlcixcbiAgICAgICAgcHJvdGVjdGVkIGRhdGVBZGFwdGVyOiBEYXRlQWRhcHRlcjxNb21lbnQ+LFxuICAgICAgICBwcm90ZWN0ZWQgdXNlclByZWZlcmVuY2VzU2VydmljZTogVXNlclByZWZlcmVuY2VzU2VydmljZSxcbiAgICAgICAgcHJvdGVjdGVkIGFwcHNQcm9jZXNzQ2xvdWRTZXJ2aWNlOiBBcHBzUHJvY2Vzc0Nsb3VkU2VydmljZSxcbiAgICAgICAgcHJvdGVjdGVkIHRhc2tDbG91ZFNlcnZpY2U6IFRhc2tDbG91ZFNlcnZpY2UsXG4gICAgICAgIHByb3RlY3RlZCBkaWFsb2c6IE1hdERpYWxvZyxcbiAgICAgICAgcHJvdGVjdGVkIHRyYW5zbGF0ZVNlcnZpY2U6IFRyYW5zbGF0aW9uU2VydmljZSkge1xuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnVzZXJQcmVmZXJlbmNlc1NlcnZpY2VcbiAgICAgICAgICAgIC5zZWxlY3QoVXNlclByZWZlcmVuY2VWYWx1ZXMuTG9jYWxlKVxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMub25EZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGxvY2FsZSA9PiB0aGlzLmRhdGVBZGFwdGVyLnNldExvY2FsZShsb2NhbGUpKTtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IGlkID0gY2hhbmdlc1snaWQnXTtcbiAgICAgICAgaWYgKGlkICYmIGlkLmN1cnJlbnRWYWx1ZSAhPT0gaWQucHJldmlvdXNWYWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5yZXRyaWV2ZVRhc2tGaWx0ZXJBbmRCdWlsZEZvcm0oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLm9uRGVzdHJveSQubmV4dCh0cnVlKTtcbiAgICAgICAgdGhpcy5vbkRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gICAgfVxuXG4gICAgY3JlYXRlRmlsdGVyQWN0aW9ucygpOiBUYXNrRmlsdGVyQWN0aW9uW10ge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFjdGlvblR5cGU6IEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9TQVZFLFxuICAgICAgICAgICAgICAgIGljb246ICdhZGY6c2F2ZScsXG4gICAgICAgICAgICAgICAgdG9vbHRpcDogJ0FERl9DTE9VRF9FRElUX1RBU0tfRklMVEVSLlRPT0xfVElQLlNBVkUnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFjdGlvblR5cGU6IEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9TQVZFX0FTLFxuICAgICAgICAgICAgICAgIGljb246ICdhZGY6c2F2ZS1hcycsXG4gICAgICAgICAgICAgICAgdG9vbHRpcDogJ0FERl9DTE9VRF9FRElUX1RBU0tfRklMVEVSLlRPT0xfVElQLlNBVkVfQVMnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFjdGlvblR5cGU6IEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9ERUxFVEUsXG4gICAgICAgICAgICAgICAgaWNvbjogJ2RlbGV0ZScsXG4gICAgICAgICAgICAgICAgdG9vbHRpcDogJ0FERl9DTE9VRF9FRElUX1RBU0tfRklMVEVSLlRPT0xfVElQLkRFTEVURSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBoYXNGb3JtQ2hhbmdlZChhY3Rpb246IFRhc2tGaWx0ZXJBY3Rpb24pOiBib29sZWFuIHtcbiAgICAgICAgaWYgKGFjdGlvbi5hY3Rpb25UeXBlID09PSBCYXNlRWRpdFRhc2tGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fU0FWRSkge1xuICAgICAgICAgICAgcmV0dXJuICF0aGlzLmZvcm1IYXNCZWVuQ2hhbmdlZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWN0aW9uLmFjdGlvblR5cGUgPT09IEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9TQVZFX0FTKSB7XG4gICAgICAgICAgICByZXR1cm4gIXRoaXMuZm9ybUhhc0JlZW5DaGFuZ2VkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb24uYWN0aW9uVHlwZSA9PT0gQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX0RFTEVURSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIG9uRXhwYW5kKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnRvZ2dsZUZpbHRlckFjdGlvbnMgPSB0cnVlO1xuICAgIH1cblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMudG9nZ2xlRmlsdGVyQWN0aW9ucyA9IGZhbHNlO1xuICAgIH1cblxuICAgIGlzRGlzYWJsZWRBY3Rpb24oYWN0aW9uOiBUYXNrRmlsdGVyQWN0aW9uKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzRGlzYWJsZWRGb3JEZWZhdWx0RmlsdGVycyhhY3Rpb24pID8gdHJ1ZSA6IHRoaXMuaGFzRm9ybUNoYW5nZWQoYWN0aW9uKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZGVlcENvbXBhcmUobGVmdDogYW55LCByaWdodDogYW55KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShsZWZ0KS50b0xvd2VyQ2FzZSgpID09PSBKU09OLnN0cmluZ2lmeShyaWdodCkudG9Mb3dlckNhc2UoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gZmlsdGVyIG5hbWVcbiAgICAgKiBAcGFyYW0gZmlsdGVyTmFtZVxuICAgICAqL1xuICAgIGdldFNhbml0aXplRmlsdGVyTmFtZShmaWx0ZXJOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBuYW1lV2l0aEh5cGhlbiA9IHRoaXMucmVwbGFjZVNwYWNlV2l0aEh5cGhlbihmaWx0ZXJOYW1lLnRyaW0oKSk7XG4gICAgICAgIHJldHVybiBuYW1lV2l0aEh5cGhlbi50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVwbGFjZVNwYWNlV2l0aEh5cGhlbihuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCByZWdFeHQgPSBuZXcgUmVnRXhwKCcgJywgJ2cnKTtcbiAgICAgICAgcmV0dXJuIG5hbWUucmVwbGFjZShyZWdFeHQsICctJyk7XG4gICAgfVxuXG4gICAgZXhlY3V0ZUZpbHRlckFjdGlvbnMoYWN0aW9uOiBUYXNrRmlsdGVyQWN0aW9uKTogdm9pZCB7XG4gICAgICAgIGlmIChhY3Rpb24uYWN0aW9uVHlwZSA9PT0gQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX1NBVkUpIHtcbiAgICAgICAgICAgIHRoaXMuc2F2ZShhY3Rpb24pO1xuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbi5hY3Rpb25UeXBlID09PSBCYXNlRWRpdFRhc2tGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fU0FWRV9BUykge1xuICAgICAgICAgICAgdGhpcy5zYXZlQXMoYWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChhY3Rpb24uYWN0aW9uVHlwZSA9PT0gQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX0RFTEVURSkge1xuICAgICAgICAgICAgdGhpcy5kZWxldGUoYWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFJ1bm5pbmdBcHBsaWNhdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuYXBwc1Byb2Nlc3NDbG91ZFNlcnZpY2VcbiAgICAgICAgICAgIC5nZXREZXBsb3llZEFwcGxpY2F0aW9uc0J5U3RhdHVzKEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkFQUF9SVU5OSU5HX1NUQVRVUywgdGhpcy5yb2xlKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoYXBwbGljYXRpb25zKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGFwcGxpY2F0aW9ucyAmJiBhcHBsaWNhdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbnMubWFwKChhcHBsaWNhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbk5hbWVzLnB1c2goeyBsYWJlbDogYXBwbGljYXRpb24ubmFtZSwgdmFsdWU6IGFwcGxpY2F0aW9uLm5hbWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldFByb2Nlc3NEZWZpbml0aW9ucygpIHtcbiAgICAgICAgdGhpcy50YXNrQ2xvdWRTZXJ2aWNlLmdldFByb2Nlc3NEZWZpbml0aW9ucyh0aGlzLmFwcE5hbWUpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChwcm9jZXNzRGVmaW5pdGlvbnMpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc0RlZmluaXRpb25zICYmIHByb2Nlc3NEZWZpbml0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0RlZmluaXRpb25OYW1lcy5wdXNoKHRoaXMuYWxsUHJvY2Vzc0RlZmluaXRpb25OYW1lc09wdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NEZWZpbml0aW9ucy5tYXAoKHByb2Nlc3NEZWZpbml0aW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NEZWZpbml0aW9uTmFtZXMucHVzaCh7IGxhYmVsOiBwcm9jZXNzRGVmaW5pdGlvbi5uYW1lLCB2YWx1ZTogcHJvY2Vzc0RlZmluaXRpb24ubmFtZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2hlY2tNYW5kYXRvcnlBY3Rpb25zKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5hY3Rpb25zID09PSB1bmRlZmluZWQgfHwgdGhpcy5hY3Rpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5hY3Rpb25zID0gQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuREVGQVVMVF9BQ1RJT05TO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc1ZhbGlkQWN0aW9uKGFjdGlvbnM6IHN0cmluZ1tdLCBhY3Rpb246IGFueSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gYWN0aW9ucyA/IGFjdGlvbnMuaW5kZXhPZihhY3Rpb24uYWN0aW9uVHlwZSkgPj0gMCA6IHRydWU7XG4gICAgfVxuXG4gICAgaXNGb3JtVmFsaWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRUYXNrRmlsdGVyRm9ybS52YWxpZDtcbiAgICB9XG5cbiAgICBnZXRQcm9wZXJ0eUNvbnRyb2xsZXIocHJvcGVydHk6IFRhc2tGaWx0ZXJQcm9wZXJ0aWVzKTogQWJzdHJhY3RDb250cm9sIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdFRhc2tGaWx0ZXJGb3JtLmdldChwcm9wZXJ0eS5rZXkpO1xuICAgIH1cblxuICAgIG9uRGF0ZUNoYW5nZWQobmV3RGF0ZVZhbHVlOiBhbnksIGRhdGVQcm9wZXJ0eTogVGFza0ZpbHRlclByb3BlcnRpZXMpIHtcbiAgICAgICAgaWYgKG5ld0RhdGVWYWx1ZSkge1xuICAgICAgICAgICAgY29uc3QgbW9tZW50RGF0ZSA9IG1vbWVudChuZXdEYXRlVmFsdWUsIEJhc2VFZGl0VGFza0ZpbHRlckNsb3VkQ29tcG9uZW50LkZPUk1BVF9EQVRFLCB0cnVlKTtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSB0aGlzLmdldFByb3BlcnR5Q29udHJvbGxlcihkYXRlUHJvcGVydHkpO1xuXG4gICAgICAgICAgICBpZiAobW9tZW50RGF0ZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNldFZhbHVlKG1vbWVudERhdGUudG9JU09TdHJpbmcodHJ1ZSkpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2V0RXJyb3JzKG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNldEVycm9ycyh7IGludmFsaWQ6IHRydWUgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkRhdGVSYW5nZUZpbHRlckNoYW5nZWQoZGF0ZVJhbmdlOiBEYXRlUmFuZ2VGaWx0ZXIsIHByb3BlcnR5OiBUYXNrRmlsdGVyUHJvcGVydGllcykge1xuICAgICAgICB0aGlzLmVkaXRUYXNrRmlsdGVyRm9ybS5nZXQocHJvcGVydHkuYXR0cmlidXRlcz8uZnJvbSkuc2V0VmFsdWUoXG4gICAgICAgICAgICBkYXRlUmFuZ2Uuc3RhcnREYXRlID8gZGF0ZVJhbmdlLnN0YXJ0RGF0ZSA6IG51bGxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5lZGl0VGFza0ZpbHRlckZvcm0uZ2V0KHByb3BlcnR5LmF0dHJpYnV0ZXM/LnRvKS5zZXRWYWx1ZShcbiAgICAgICAgICAgIGRhdGVSYW5nZS5lbmREYXRlID8gZGF0ZVJhbmdlLmVuZERhdGUgOiBudWxsXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuZWRpdFRhc2tGaWx0ZXJGb3JtLmdldChwcm9wZXJ0eS5hdHRyaWJ1dGVzLmRhdGVUeXBlKS5zZXRWYWx1ZShEYXRlQ2xvdWRGaWx0ZXJUeXBlLlJBTkdFKTtcbiAgICB9XG5cbiAgICBvbkNoYW5nZWRVc2VyKHVzZXJzOiBJZGVudGl0eVVzZXJNb2RlbFtdLCB1c2VyUHJvcGVydHk6IFRhc2tGaWx0ZXJQcm9wZXJ0aWVzKSB7XG4gICAgICAgIGxldCBzZWxlY3RlZFVzZXJzO1xuICAgICAgICBpZiAodXNlclByb3BlcnR5LnNlbGVjdGlvbk1vZGUgPT09ICdzaW5nbGUnKSB7XG4gICAgICAgICAgICBzZWxlY3RlZFVzZXJzID0gdXNlcnNbMF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxlY3RlZFVzZXJzID0gdXNlcnM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5nZXRQcm9wZXJ0eUNvbnRyb2xsZXIodXNlclByb3BlcnR5KS5zZXRWYWx1ZShzZWxlY3RlZFVzZXJzKTtcbiAgICB9XG5cbiAgICBvbkFzc2lnbmVkQ2hhbmdlKGFzc2lnbmVkVmFsdWU6IElkZW50aXR5VXNlck1vZGVsKSB7XG4gICAgICAgIHRoaXMuZWRpdFRhc2tGaWx0ZXJGb3JtLmdldCgnY2FuZGlkYXRlR3JvdXBzJykuc2V0VmFsdWUoW10pO1xuICAgICAgICB0aGlzLmVkaXRUYXNrRmlsdGVyRm9ybS5nZXQoJ2Fzc2lnbmVlJykuc2V0VmFsdWUoYXNzaWduZWRWYWx1ZT8udXNlcm5hbWUpO1xuICAgIH1cblxuICAgIG9uQXNzaWduZWRHcm91cHNDaGFuZ2UoZ3JvdXBzOiBJZGVudGl0eUdyb3VwTW9kZWxbXSkge1xuICAgICAgICB0aGlzLmVkaXRUYXNrRmlsdGVyRm9ybS5nZXQoJ2Fzc2lnbmVlJykuc2V0VmFsdWUobnVsbCk7XG4gICAgICAgIHRoaXMuZWRpdFRhc2tGaWx0ZXJGb3JtLmdldCgnY2FuZGlkYXRlR3JvdXBzJykuc2V0VmFsdWUoZ3JvdXBzKTtcbiAgICB9XG5cbiAgICBoYXNFcnJvcihwcm9wZXJ0eTogVGFza0ZpbHRlclByb3BlcnRpZXMpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IHRoaXMuZ2V0UHJvcGVydHlDb250cm9sbGVyKHByb3BlcnR5KTtcbiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIuZXJyb3JzICYmIGNvbnRyb2xsZXIuZXJyb3JzLmludmFsaWQ7XG4gICAgfVxuXG4gICAgaGFzTGFzdE1vZGlmaWVkUHJvcGVydHkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlclByb3BlcnRpZXMuaW5kZXhPZihCYXNlRWRpdFRhc2tGaWx0ZXJDbG91ZENvbXBvbmVudC5MQVNUX01PRElGSUVEKSA+PSAwO1xuICAgIH1cblxuICAgIGdldCBjcmVhdGVTb3J0UHJvcGVydGllcygpOiBGaWx0ZXJPcHRpb25zW10ge1xuICAgICAgICB0aGlzLmNoZWNrTWFuZGF0b3J5U29ydFByb3BlcnRpZXMoKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5zb3J0UHJvcGVydGllcy5tYXAoKHByb3BlcnR5OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7IGxhYmVsOiBwcm9wZXJ0eSwgdmFsdWU6IHByb3BlcnR5IH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNyZWF0ZUFuZEZpbHRlckFjdGlvbnMoKTogVGFza0ZpbHRlckFjdGlvbltdIHtcbiAgICAgICAgdGhpcy5jaGVja01hbmRhdG9yeUFjdGlvbnMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRmlsdGVyQWN0aW9ucygpLmZpbHRlcihhY3Rpb24gPT4gdGhpcy5pc1ZhbGlkQWN0aW9uKHRoaXMuYWN0aW9ucywgYWN0aW9uKSk7XG4gICAgfVxuXG4gICAgaXNWYWxpZFByb3BlcnR5KGZpbHRlclByb3BlcnRpZXM6IHN0cmluZ1tdLCBrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gZmlsdGVyUHJvcGVydGllcyA/IGZpbHRlclByb3BlcnRpZXMuaW5kZXhPZihrZXkpID49IDAgOiB0cnVlO1xuICAgIH1cblxuICAgIGNoZWNrRm9yUHJvcGVydHkocHJvcGVydHk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5maWx0ZXJQcm9wZXJ0aWVzID8gdGhpcy5maWx0ZXJQcm9wZXJ0aWVzLmluZGV4T2YocHJvcGVydHkpID49IDAgOiBmYWxzZTtcbiAgICB9XG5cbiAgICBoYXNTb3J0UHJvcGVydHkoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbHRlclByb3BlcnRpZXMuaW5kZXhPZihCYXNlRWRpdFRhc2tGaWx0ZXJDbG91ZENvbXBvbmVudC5TT1JUKSA+PSAwO1xuICAgIH1cblxuICAgIHJlbW92ZU9yZGVyUHJvcGVydHkoZmlsdGVyZWRQcm9wZXJ0aWVzOiBUYXNrRmlsdGVyUHJvcGVydGllc1tdKTogVGFza0ZpbHRlclByb3BlcnRpZXNbXSB7XG4gICAgICAgIGlmIChmaWx0ZXJlZFByb3BlcnRpZXMgJiYgZmlsdGVyZWRQcm9wZXJ0aWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJlZFByb3BlcnRpZXMuZmlsdGVyKHByb3BlcnR5ID0+IHByb3BlcnR5LmtleSAhPT0gQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuT1JERVIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjcmVhdGVBbmRGaWx0ZXJQcm9wZXJ0aWVzKCkge1xuICAgICAgICB0aGlzLmNoZWNrTWFuZGF0b3J5RmlsdGVyUHJvcGVydGllcygpO1xuXG4gICAgICAgIGlmICh0aGlzLmNoZWNrRm9yUHJvcGVydHkoQmFzZUVkaXRUYXNrRmlsdGVyQ2xvdWRDb21wb25lbnQuQVBQTElDQVRJT05fTkFNRSkpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwbGljYXRpb25OYW1lcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5nZXRSdW5uaW5nQXBwbGljYXRpb25zKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2hlY2tGb3JQcm9wZXJ0eShCYXNlRWRpdFRhc2tGaWx0ZXJDbG91ZENvbXBvbmVudC5QUk9DRVNTX0RFRklOSVRJT05fTkFNRSkpIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0RlZmluaXRpb25OYW1lcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5nZXRQcm9jZXNzRGVmaW5pdGlvbnMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9wZXJ0aWVzID0gdGhpcy5jcmVhdGVUYXNrRmlsdGVyUHJvcGVydGllcygpO1xuICAgICAgICBsZXQgZmlsdGVyZWRQcm9wZXJ0aWVzID0gZGVmYXVsdFByb3BlcnRpZXMuZmlsdGVyKChmaWx0ZXJQcm9wZXJ0eSkgPT4gdGhpcy5pc1ZhbGlkUHJvcGVydHkodGhpcy5maWx0ZXJQcm9wZXJ0aWVzLCBmaWx0ZXJQcm9wZXJ0eS5rZXkpKTtcblxuICAgICAgICBpZiAoIXRoaXMuaGFzU29ydFByb3BlcnR5KCkpIHtcbiAgICAgICAgICAgIGZpbHRlcmVkUHJvcGVydGllcyA9IHRoaXMucmVtb3ZlT3JkZXJQcm9wZXJ0eShmaWx0ZXJlZFByb3BlcnRpZXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZpbHRlcmVkUHJvcGVydGllcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBmb3IgZWRpdCB0YXNrIGZpbHRlciBmb3JtIGNoYW5nZXNcbiAgICAgKi9cbiAgICBvbkZpbHRlckNoYW5nZSgpIHtcbiAgICAgICAgdGhpcy5lZGl0VGFza0ZpbHRlckZvcm0udmFsdWVDaGFuZ2VzXG4gICAgICAgICAgICAucGlwZShcbiAgICAgICAgICAgICAgICBkZWJvdW5jZVRpbWUoNTAwKSxcbiAgICAgICAgICAgICAgICBmaWx0ZXIoKCkgPT4gdGhpcy5pc0Zvcm1WYWxpZCgpKSxcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoZm9ybVZhbHVlcykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXNzaWduTmV3RmlsdGVyKGZvcm1WYWx1ZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0Rm9ybUNvbnRyb2xzQ29uZmlnKHRhc2tGaWx0ZXJQcm9wZXJ0aWVzOiBUYXNrRmlsdGVyUHJvcGVydGllc1tdKTogYW55IHtcbiAgICAgICAgY29uc3QgcHJvcGVydGllcyA9IHRhc2tGaWx0ZXJQcm9wZXJ0aWVzLm1hcCgocHJvcGVydHkpID0+IHtcbiAgICAgICAgICAgIGlmICghIXByb3BlcnR5LmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGVzQ29udHJvbENvbmZpZyhwcm9wZXJ0eSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IFtwcm9wZXJ0eS5rZXldOiBwcm9wZXJ0eS52YWx1ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHByb3BlcnRpZXMucmVkdWNlKCgocmVzdWx0LCBjdXJyZW50KSA9PiBPYmplY3QuYXNzaWduKHJlc3VsdCwgY3VycmVudCkpLCB7fSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRBdHRyaWJ1dGVzQ29udHJvbENvbmZpZyhwcm9wZXJ0eTogVGFza0ZpbHRlclByb3BlcnRpZXMpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMocHJvcGVydHkuYXR0cmlidXRlcykucmVkdWNlKChyZXN1bHQsIGtleSkgPT4ge1xuICAgICAgICAgICAgcmVzdWx0W2tleV0gPSBwcm9wZXJ0eS52YWx1ZVtrZXldO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfSwge30pO1xuICAgIH1cblxuICAgIGJ1aWxkRm9ybSh0YXNrRmlsdGVyUHJvcGVydGllczogVGFza0ZpbHRlclByb3BlcnRpZXNbXSkge1xuICAgICAgICB0aGlzLmZvcm1IYXNCZWVuQ2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmVkaXRUYXNrRmlsdGVyRm9ybSA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAodGhpcy5nZXRGb3JtQ29udHJvbHNDb25maWcodGFza0ZpbHRlclByb3BlcnRpZXMpKTtcbiAgICAgICAgdGhpcy5vbkZpbHRlckNoYW5nZSgpO1xuICAgIH1cblxuICAgIG9uRGF0ZVR5cGVDaGFuZ2UoZGF0ZVR5cGU6IERhdGVDbG91ZEZpbHRlclR5cGUsIHByb3BlcnR5OiBUYXNrRmlsdGVyUHJvcGVydGllcykge1xuICAgICAgICB0aGlzLmVkaXRUYXNrRmlsdGVyRm9ybS5nZXQocHJvcGVydHkuYXR0cmlidXRlcy5kYXRlVHlwZSkuc2V0VmFsdWUoZGF0ZVR5cGUpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCByZXRyaWV2ZVRhc2tGaWx0ZXJBbmRCdWlsZEZvcm0oKSB7XG4gICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICB0aGlzLmdldFRhc2tGaWx0ZXJCeUlkKHRoaXMuYXBwTmFtZSwgdGhpcy5pZClcbiAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgIGZpbmFsaXplKCgpID0+IHRoaXMuaXNMb2FkaW5nID0gZmFsc2UpLFxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRhc2tGaWx0ZXIgPSByZXNwb25zZTtcbiAgICAgICAgICAgICAgICB0aGlzLnRhc2tGaWx0ZXJQcm9wZXJ0aWVzID0gdGhpcy5jcmVhdGVBbmRGaWx0ZXJQcm9wZXJ0aWVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy50YXNrRmlsdGVyQWN0aW9ucyA9IHRoaXMuY3JlYXRlQW5kRmlsdGVyQWN0aW9ucygpO1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRGb3JtKHRoaXMudGFza0ZpbHRlclByb3BlcnRpZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZGVsZXRlKGRlbGV0ZUFjdGlvbjogVGFza0ZpbHRlckFjdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmRlbGV0ZUZpbHRlcih0aGlzLnRhc2tGaWx0ZXIpXG4gICAgICAgICAgICAucGlwZShcbiAgICAgICAgICAgICAgICBmaWx0ZXIoKGZpbHRlcnMpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlQWN0aW9uLmZpbHRlciA9IHRoaXMudGFza0ZpbHRlcjtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3Rpb24uZW1pdChkZWxldGVBY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVycy5sZW5ndGggPT09IDA7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgc3dpdGNoTWFwKCgpID0+IHRoaXMucmVzdG9yZURlZmF1bHRUYXNrRmlsdGVycygpKSxcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKCkgPT4geyB9KTtcbiAgICB9XG5cbiAgICBzYXZlKHNhdmVBY3Rpb246IFRhc2tGaWx0ZXJBY3Rpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy51cGRhdGVGaWx0ZXIodGhpcy5jaGFuZ2VkVGFza0ZpbHRlcilcbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2F2ZUFjdGlvbi5maWx0ZXIgPSB0aGlzLmNoYW5nZWRUYXNrRmlsdGVyO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLmVtaXQoc2F2ZUFjdGlvbik7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtSGFzQmVlbkNoYW5nZWQgPSB0aGlzLmRlZXBDb21wYXJlKHRoaXMuY2hhbmdlZFRhc2tGaWx0ZXIsIHRoaXMudGFza0ZpbHRlcik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzYXZlQXMoc2F2ZUFzQWN0aW9uOiBUYXNrRmlsdGVyQWN0aW9uKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oVGFza0ZpbHRlckRpYWxvZ0Nsb3VkQ29tcG9uZW50LCB7XG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgbmFtZTogdGhpcy50cmFuc2xhdGVTZXJ2aWNlLmluc3RhbnQoKHRoaXMudGFza0ZpbHRlciBhcyBhbnkpPy5uYW1lKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhlaWdodDogJ2F1dG8nLFxuICAgICAgICAgICAgbWluV2lkdGg6ICczMCUnXG4gICAgICAgIH0pO1xuICAgICAgICBkaWFsb2dSZWYuYWZ0ZXJDbG9zZWQoKS5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQuYWN0aW9uID09PSBUYXNrRmlsdGVyRGlhbG9nQ2xvdWRDb21wb25lbnQuQUNUSU9OX1NBVkUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJLZXkgPSB0aGlzLmdldFNhbml0aXplRmlsdGVyTmFtZShyZXN1bHQubmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RmlsdGVyID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogcmVzdWx0Lmljb24sXG4gICAgICAgICAgICAgICAgICAgIGlkOiBmaWx0ZXJJZCxcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnY3VzdG9tLScgKyBmaWx0ZXJLZXlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdEZpbHRlcjogVCA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuY2hhbmdlZFRhc2tGaWx0ZXIsIG5ld0ZpbHRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRGaWx0ZXIocmVzdWx0RmlsdGVyKS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzYXZlQXNBY3Rpb24uZmlsdGVyID0gcmVzdWx0RmlsdGVyO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbi5lbWl0KHNhdmVBc0FjdGlvbik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNoZWNrTWFuZGF0b3J5RmlsdGVyUHJvcGVydGllcygpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuZmlsdGVyUHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUHJvcGVydGllcyA9IHRoaXMuZ2V0RGVmYXVsdEZpbHRlclByb3BlcnRpZXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNoZWNrTWFuZGF0b3J5U29ydFByb3BlcnRpZXMoKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnNvcnRQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgfHwgdGhpcy5zb3J0UHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuc29ydFByb3BlcnRpZXMgPSB0aGlzLmdldERlZmF1bHRTb3J0UHJvcGVydGllcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWJzdHJhY3QgZ2V0RGVmYXVsdEZpbHRlclByb3BlcnRpZXMoKTogc3RyaW5nW107XG4gICAgYWJzdHJhY3QgZ2V0RGVmYXVsdFNvcnRQcm9wZXJ0aWVzKCk6IHN0cmluZ1tdO1xuICAgIGFic3RyYWN0IGlzRGlzYWJsZWRGb3JEZWZhdWx0RmlsdGVycyhhY3Rpb246IFRhc2tGaWx0ZXJBY3Rpb24pOiBib29sZWFuO1xuICAgIGFic3RyYWN0IGNyZWF0ZVRhc2tGaWx0ZXJQcm9wZXJ0aWVzKCk6IFRhc2tGaWx0ZXJQcm9wZXJ0aWVzW107XG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IGdldFRhc2tGaWx0ZXJCeUlkKGFwcE5hbWU6IHN0cmluZywgaWQ6IHN0cmluZyk7XG4gICAgYWJzdHJhY3QgYXNzaWduTmV3RmlsdGVyKGZvcm1WYWx1ZXMpOiB2b2lkO1xuXG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IHJlc3RvcmVEZWZhdWx0VGFza0ZpbHRlcnMoKTogT2JzZXJ2YWJsZTxUW10+O1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBhZGRGaWx0ZXIoZmlsdGVyVG9BZGQ6IFQpOiBPYnNlcnZhYmxlPGFueT47XG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IGRlbGV0ZUZpbHRlcihmaWx0ZXJUb0RlbGV0ZTogVCk6IE9ic2VydmFibGU8VFtdPjtcbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgdXBkYXRlRmlsdGVyKGZpbHRlclRvVXBkYXRlOiBUKTogT2JzZXJ2YWJsZTxhbnk+O1xufVxuIl19