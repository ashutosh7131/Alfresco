/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { FormControl } from '@angular/forms';
import { IdentityUserService } from '@alfresco/adf-core';
import { AssignmentType } from '../../models/filter-cloud.model';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@alfresco/adf-core';
import * as ɵngcc2 from '@angular/flex-layout/flex';
import * as ɵngcc3 from '@angular/material/form-field';
import * as ɵngcc4 from '@angular/material/select';
import * as ɵngcc5 from '@angular/forms';
import * as ɵngcc6 from '@angular/material/core';
import * as ɵngcc7 from '@angular/common';
import * as ɵngcc8 from '../../../../group/components/group-cloud.component';
import * as ɵngcc9 from '@ngx-translate/core';

function TaskAssignmentFilterCloudComponent_adf_cloud_group_13_Template(rf, ctx) { if (rf & 1) {
    const _r2 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "adf-cloud-group", 5);
    ɵngcc0.ɵɵlistener("changedGroups", function TaskAssignmentFilterCloudComponent_adf_cloud_group_13_Template_adf_cloud_group_changedGroups_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r2); const ctx_r1 = ɵngcc0.ɵɵnextContext(); return ctx_r1.onChangedGroups($event); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("mode", "multiple")("appName", ctx_r0.appName)("preSelectGroups", ctx_r0.candidateGroups)("searchGroupsControl", ctx_r0.groupForm)("title", "ADF_CLOUD_TASK_LIST.START_TASK.FORM.LABEL.CANDIDATE_GROUP");
} }
export class TaskAssignmentFilterCloudComponent {
    constructor(identityUserService) {
        this.identityUserService = identityUserService;
        this.assignedChange = new EventEmitter();
        this.assignedGroupChange = new EventEmitter();
        this.candidateGroups = [];
        this.groupForm = new FormControl('');
        this.assignmentTypeList = {
            unassigned: AssignmentType.UNASSIGNED,
            currentUser: AssignmentType.CURRENT_USER,
            candidateGroups: AssignmentType.CANDIDATE_GROUPS
        };
    }
    ngOnInit() {
        if (this.isFilterPropertyDefined()) {
            this.setDefaultAssignedGroups();
            this.setDefaultAssignmentType();
        }
    }
    isCandidateGroupsType() {
        return this.assignmentType === AssignmentType.CANDIDATE_GROUPS;
    }
    onAssignmentTypeChange(type) {
        this.candidateGroups = [];
        if (type === AssignmentType.CURRENT_USER) {
            this.assignedChange.emit(this.identityUserService.getCurrentUserInfo());
        }
        else if (type === AssignmentType.UNASSIGNED) {
            this.assignedChange.emit(null);
        }
    }
    onChangedGroups(groups) {
        this.assignedGroupChange.emit(groups);
    }
    setDefaultAssignmentType() {
        const assignmentAttr = this.taskFilterProperty.attributes['assignee'];
        const assignee = this.taskFilterProperty.value[assignmentAttr];
        if (this.candidateGroups.length > 0) {
            this.assignmentType = AssignmentType.CANDIDATE_GROUPS;
        }
        else if (assignee) {
            this.assignmentType = AssignmentType.CURRENT_USER;
        }
        else {
            this.assignmentType = AssignmentType.UNASSIGNED;
        }
    }
    setDefaultAssignedGroups() {
        const assignmentGroupsAttr = this.taskFilterProperty.attributes['candidateGroups'];
        this.candidateGroups = this.taskFilterProperty.value[assignmentGroupsAttr];
    }
    isFilterPropertyDefined() {
        return !!this.taskFilterProperty.attributes && !!this.taskFilterProperty.value;
    }
}
TaskAssignmentFilterCloudComponent.ɵfac = function TaskAssignmentFilterCloudComponent_Factory(t) { return new (t || TaskAssignmentFilterCloudComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.IdentityUserService)); };
TaskAssignmentFilterCloudComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: TaskAssignmentFilterCloudComponent, selectors: [["adf-cloud-task-assignment-filter"]], inputs: { appName: "appName", taskFilterProperty: "taskFilterProperty" }, outputs: { assignedChange: "assignedChange", assignedGroupChange: "assignedGroupChange" }, decls: 14, vars: 18, consts: [["fxLayout", "row", 1, "adf-cloud-assignment-container"], [3, "floatLabel"], [1, "adf-task-assignment-filter", 3, "placeholder", "ngModel", "ngModelChange"], [3, "value"], ["class", "adf-group-cloud-filter", 3, "mode", "appName", "preSelectGroups", "searchGroupsControl", "title", "changedGroups", 4, "ngIf"], [1, "adf-group-cloud-filter", 3, "mode", "appName", "preSelectGroups", "searchGroupsControl", "title", "changedGroups"]], template: function TaskAssignmentFilterCloudComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵelementStart(1, "mat-form-field", 1);
        ɵngcc0.ɵɵelementStart(2, "mat-select", 2);
        ɵngcc0.ɵɵlistener("ngModelChange", function TaskAssignmentFilterCloudComponent_Template_mat_select_ngModelChange_2_listener($event) { return ctx.assignmentType = $event; })("ngModelChange", function TaskAssignmentFilterCloudComponent_Template_mat_select_ngModelChange_2_listener() { return ctx.onAssignmentTypeChange(ctx.assignmentType); });
        ɵngcc0.ɵɵpipe(3, "translate");
        ɵngcc0.ɵɵelementStart(4, "mat-option", 3);
        ɵngcc0.ɵɵtext(5);
        ɵngcc0.ɵɵpipe(6, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(7, "mat-option", 3);
        ɵngcc0.ɵɵtext(8);
        ɵngcc0.ɵɵpipe(9, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(10, "mat-option", 3);
        ɵngcc0.ɵɵtext(11);
        ɵngcc0.ɵɵpipe(12, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵtemplate(13, TaskAssignmentFilterCloudComponent_adf_cloud_group_13_Template, 1, 5, "adf-cloud-group", 4);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("floatLabel", "auto");
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵpropertyInterpolate("placeholder", ɵngcc0.ɵɵpipeBind1(3, 10, "ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.ASSIGNMENT_TYPE"));
        ɵngcc0.ɵɵproperty("ngModel", ctx.assignmentType);
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("value", ctx.assignmentTypeList.currentUser);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate1("", ɵngcc0.ɵɵpipeBind1(6, 12, "ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.ASSIGNED_TO_ME"), " ");
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("value", ctx.assignmentTypeList.unassigned);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate1("", ɵngcc0.ɵɵpipeBind1(9, 14, "ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.UNASSIGNED"), " ");
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("value", ctx.assignmentTypeList.candidateGroups);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate1("", ɵngcc0.ɵɵpipeBind1(12, 16, "ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.LIST_OF_CANDIDATE_GROUPS"), " ");
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.isCandidateGroupsType());
    } }, directives: [ɵngcc2.DefaultLayoutDirective, ɵngcc3.MatFormField, ɵngcc4.MatSelect, ɵngcc5.NgControlStatus, ɵngcc5.NgModel, ɵngcc6.MatOption, ɵngcc7.NgIf, ɵngcc8.GroupCloudComponent], pipes: [ɵngcc9.TranslatePipe], styles: [".adf-cloud-assignment-container[_ngcontent-%COMP%]{align-items:center}.adf-cloud-assignment-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.adf-task-assignment-filter[_ngcontent-%COMP%]{margin-right:10px}.adf-group-cloud-filter[_ngcontent-%COMP%]{flex:1;margin-left:15px;width:100%}"] });
TaskAssignmentFilterCloudComponent.ctorParameters = () => [
    { type: IdentityUserService }
];
TaskAssignmentFilterCloudComponent.propDecorators = {
    appName: [{ type: Input }],
    taskFilterProperty: [{ type: Input }],
    assignedChange: [{ type: Output }],
    assignedGroupChange: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(TaskAssignmentFilterCloudComponent, [{
        type: Component,
        args: [{
                selector: 'adf-cloud-task-assignment-filter',
                template: "<div class=\"adf-cloud-assignment-container\" fxLayout=\"row\">\n    <mat-form-field [floatLabel]=\"'auto'\">\n        <mat-select class=\"adf-task-assignment-filter\"\n                    placeholder=\"{{ 'ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.ASSIGNMENT_TYPE' | translate }}\"\n                    [(ngModel)]=\"assignmentType\"\n                    (ngModelChange)=\"onAssignmentTypeChange(assignmentType)\">\n            <mat-option [value]=\"assignmentTypeList.currentUser\">{{ 'ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.ASSIGNED_TO_ME' | translate }} </mat-option>\n            <mat-option [value]=\"assignmentTypeList.unassigned\">{{ 'ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.UNASSIGNED' | translate }} </mat-option>\n            <mat-option [value]=\"assignmentTypeList.candidateGroups\">{{ 'ADF_CLOUD_TASK_ASSIGNEMNT_FILTER.LIST_OF_CANDIDATE_GROUPS' | translate }} </mat-option>\n        </mat-select>\n    </mat-form-field>\n\n    <adf-cloud-group class=\"adf-group-cloud-filter\" *ngIf=\"isCandidateGroupsType()\"\n        [mode]=\"'multiple'\"\n        [appName]=\"appName\"\n        [preSelectGroups]=\"candidateGroups\"\n        [searchGroupsControl]=\"groupForm\"\n        (changedGroups)=\"onChangedGroups($event)\"\n        [title]=\"'ADF_CLOUD_TASK_LIST.START_TASK.FORM.LABEL.CANDIDATE_GROUP'\"></adf-cloud-group>\n</div>\n",
                styles: [".adf-cloud-assignment-container{align-items:center}.adf-cloud-assignment-container mat-form-field{width:100%}.adf-task-assignment-filter{margin-right:10px}.adf-group-cloud-filter{flex:1;margin-left:15px;width:100%}"]
            }]
    }], function () { return [{ type: ɵngcc1.IdentityUserService }]; }, { assignedChange: [{
            type: Output
        }], assignedGroupChange: [{
            type: Output
        }], appName: [{
            type: Input
        }], taskFilterProperty: [{
            type: Input
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFzay1hc3NpZ25tZW50LWZpbHRlci5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2hvbWUvdHJhdmlzL2J1aWxkL0FsZnJlc2NvL2FsZnJlc2NvLW5nMi1jb21wb25lbnRzL2xpYi9wcm9jZXNzLXNlcnZpY2VzLWNsb3VkL3NyYy9saWIvdGFzay90YXNrLWZpbHRlcnMvY29tcG9uZW50cy90YXNrLWFzc2lnbm1lbnQtZmlsdGVyL3Rhc2stYXNzaWdubWVudC1maWx0ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFFSCxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQy9FLE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUM3QyxPQUFPLEVBQXlDLG1CQUFtQixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDaEcsT0FBTyxFQUFFLGNBQWMsRUFBd0IsTUFBTSxpQ0FBaUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBT3ZGLE1BQU0sT0FBTyxrQ0FBa0M7QUFBRyxJQW1COUMsWUFBb0IsbUJBQXdDO0FBQUksUUFBNUMsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUFxQjtBQUFDLFFBYm5ELG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQXFCLENBQUM7QUFDckUsUUFDYyx3QkFBbUIsR0FBRyxJQUFJLFlBQVksRUFBd0IsQ0FBQztBQUM3RSxRQUVJLG9CQUFlLEdBQXlCLEVBQUUsQ0FBQztBQUMvQyxRQUFJLGNBQVMsR0FBRyxJQUFJLFdBQVcsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNwQyxRQUFJLHVCQUFrQixHQUFH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LE1BQU07QUFBSyxrQ0FFWCxNQUFNO0FBQUk7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZvcm1Db250cm9sIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgSWRlbnRpdHlHcm91cE1vZGVsLCBJZGVudGl0eVVzZXJNb2RlbCwgSWRlbnRpdHlVc2VyU2VydmljZSB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBBc3NpZ25tZW50VHlwZSwgVGFza0ZpbHRlclByb3BlcnRpZXMgfSBmcm9tICcuLi8uLi9tb2RlbHMvZmlsdGVyLWNsb3VkLm1vZGVsJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdhZGYtY2xvdWQtdGFzay1hc3NpZ25tZW50LWZpbHRlcicsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3Rhc2stYXNzaWdubWVudC1maWx0ZXIuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL3Rhc2stYXNzaWdubWVudC1maWx0ZXIuY29tcG9uZW50LnNjc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBUYXNrQXNzaWdubWVudEZpbHRlckNsb3VkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIEBJbnB1dCgpIGFwcE5hbWU6IHN0cmluZztcblxuICAgIEBJbnB1dCgpIHRhc2tGaWx0ZXJQcm9wZXJ0eTogVGFza0ZpbHRlclByb3BlcnRpZXM7XG5cbiAgICBAT3V0cHV0KCkgYXNzaWduZWRDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPElkZW50aXR5VXNlck1vZGVsPigpO1xuXG4gICAgQE91dHB1dCgpIGFzc2lnbmVkR3JvdXBDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPElkZW50aXR5R3JvdXBNb2RlbFtdPigpO1xuXG4gICAgYXNzaWdubWVudFR5cGU6IEFzc2lnbm1lbnRUeXBlO1xuICAgIGNhbmRpZGF0ZUdyb3VwczogSWRlbnRpdHlHcm91cE1vZGVsW10gPSBbXTtcbiAgICBncm91cEZvcm0gPSBuZXcgRm9ybUNvbnRyb2woJycpO1xuICAgIGFzc2lnbm1lbnRUeXBlTGlzdCA9IHtcbiAgICAgICAgdW5hc3NpZ25lZDogQXNzaWdubWVudFR5cGUuVU5BU1NJR05FRCxcbiAgICAgICAgY3VycmVudFVzZXI6IEFzc2lnbm1lbnRUeXBlLkNVUlJFTlRfVVNFUixcbiAgICAgICAgY2FuZGlkYXRlR3JvdXBzOiBBc3NpZ25tZW50VHlwZS5DQU5ESURBVEVfR1JPVVBTXG4gICAgfTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgaWRlbnRpdHlVc2VyU2VydmljZTogSWRlbnRpdHlVc2VyU2VydmljZSkge31cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICBpZiAodGhpcy5pc0ZpbHRlclByb3BlcnR5RGVmaW5lZCgpKSB7XG4gICAgICAgICAgICB0aGlzLnNldERlZmF1bHRBc3NpZ25lZEdyb3VwcygpO1xuICAgICAgICAgICAgdGhpcy5zZXREZWZhdWx0QXNzaWdubWVudFR5cGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlzQ2FuZGlkYXRlR3JvdXBzVHlwZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzaWdubWVudFR5cGUgPT09IEFzc2lnbm1lbnRUeXBlLkNBTkRJREFURV9HUk9VUFM7XG4gICAgfVxuXG4gICAgb25Bc3NpZ25tZW50VHlwZUNoYW5nZSh0eXBlOiBhbnkpIHtcbiAgICAgICAgdGhpcy5jYW5kaWRhdGVHcm91cHMgPSBbXTtcbiAgICAgICAgaWYgKHR5cGUgPT09IEFzc2lnbm1lbnRUeXBlLkNVUlJFTlRfVVNFUikge1xuICAgICAgICAgICAgdGhpcy5hc3NpZ25lZENoYW5nZS5lbWl0KHRoaXMuaWRlbnRpdHlVc2VyU2VydmljZS5nZXRDdXJyZW50VXNlckluZm8oKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gQXNzaWdubWVudFR5cGUuVU5BU1NJR05FRCkge1xuICAgICAgICAgICAgdGhpcy5hc3NpZ25lZENoYW5nZS5lbWl0KG51bGwpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25DaGFuZ2VkR3JvdXBzKGdyb3VwczogSWRlbnRpdHlHcm91cE1vZGVsW10pIHtcbiAgICAgICAgdGhpcy5hc3NpZ25lZEdyb3VwQ2hhbmdlLmVtaXQoZ3JvdXBzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldERlZmF1bHRBc3NpZ25tZW50VHlwZSgpIHtcbiAgICAgICAgY29uc3QgYXNzaWdubWVudEF0dHIgPSB0aGlzLnRhc2tGaWx0ZXJQcm9wZXJ0eS5hdHRyaWJ1dGVzWydhc3NpZ25lZSddO1xuICAgICAgICBjb25zdCBhc3NpZ25lZSA9IHRoaXMudGFza0ZpbHRlclByb3BlcnR5LnZhbHVlW2Fzc2lnbm1lbnRBdHRyXTtcblxuICAgICAgICBpZiAodGhpcy5jYW5kaWRhdGVHcm91cHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5hc3NpZ25tZW50VHlwZSA9IEFzc2lnbm1lbnRUeXBlLkNBTkRJREFURV9HUk9VUFM7XG4gICAgICAgIH0gZWxzZSBpZiAoYXNzaWduZWUpIHtcbiAgICAgICAgICAgIHRoaXMuYXNzaWdubWVudFR5cGUgPSBBc3NpZ25tZW50VHlwZS5DVVJSRU5UX1VTRVI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFzc2lnbm1lbnRUeXBlID0gQXNzaWdubWVudFR5cGUuVU5BU1NJR05FRDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgc2V0RGVmYXVsdEFzc2lnbmVkR3JvdXBzKCkge1xuICAgICAgICBjb25zdCBhc3NpZ25tZW50R3JvdXBzQXR0ciA9IHRoaXMudGFza0ZpbHRlclByb3BlcnR5LmF0dHJpYnV0ZXNbJ2NhbmRpZGF0ZUdyb3VwcyddO1xuICAgICAgICB0aGlzLmNhbmRpZGF0ZUdyb3VwcyA9IHRoaXMudGFza0ZpbHRlclByb3BlcnR5LnZhbHVlW2Fzc2lnbm1lbnRHcm91cHNBdHRyXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGlzRmlsdGVyUHJvcGVydHlEZWZpbmVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLnRhc2tGaWx0ZXJQcm9wZXJ0eS5hdHRyaWJ1dGVzICYmICEhdGhpcy50YXNrRmlsdGVyUHJvcGVydHkudmFsdWU7XG4gICAgfVxufVxuIl19