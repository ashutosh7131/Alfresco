import { AlfrescoApiService, AppConfigService, LogService } from '@alfresco/adf-core';
import { Injectable } from '@angular/core';
import { throwError } from 'rxjs';
import { map } from 'rxjs/operators';
import { ProcessDefinitionCloud } from '../../../models/process-definition-cloud.model';
import { BaseCloudService } from '../../../services/base-cloud.service';
import * as i0 from "@angular/core";
import * as i1 from "@alfresco/adf-core";
export class StartProcessCloudService extends BaseCloudService {
    constructor(apiService, logService, appConfigService) {
        super(apiService, appConfigService);
        this.logService = logService;
    }
    getProcessDefinitions(appName) {
        if (appName || appName === '') {
            const url = `${this.getBasePath(appName)}/rb/v1/process-definitions`;
            return this.get(url).pipe(map((res) => {
                return res.list.entries.map((processDefs) => new ProcessDefinitionCloud(processDefs.entry));
            }));
        }
        else {
            this.logService.error('AppName is mandatory for querying task');
            return throwError('AppName not configured');
        }
    }
    createProcess(appName, payload) {
        const url = `${this.getBasePath(appName)}/rb/v1/process-instances/create`;
        payload.payloadType = 'CreateProcessInstancePayload';
        return this.post(url, payload).pipe(map((result) => result.entry));
    }
    startCreatedProcess(appName, createdProcessInstanceId, payload) {
        const url = `${this.getBasePath(appName)}/rb/v1/process-instances/${createdProcessInstanceId}/start`;
        return this.post(url, payload).pipe(map((result) => result.entry));
    }
    startProcess(appName, payload) {
        const url = `${this.getBasePath(appName)}/rb/v1/process-instances`;
        payload.payloadType = 'StartProcessPayload';
        return this.post(url, payload);
    }
    updateProcess(appName, processInstanceId, payload) {
        const url = `${this.getBasePath(appName)}/rb/v1/process-instances/${processInstanceId}`;
        payload.payloadType = 'UpdateProcessPayload';
        return this.put(url, payload).pipe(map((processInstance) => processInstance.entry));
    }
    deleteProcess(appName, processInstanceId) {
        const url = `${this.getBasePath(appName)}/rb/v1/process-instances/${processInstanceId}`;
        return this.delete(url);
    }
}
StartProcessCloudService.ɵprov = i0.ɵɵdefineInjectable({ factory: function StartProcessCloudService_Factory() { return new StartProcessCloudService(i0.ɵɵinject(i1.AlfrescoApiService), i0.ɵɵinject(i1.LogService), i0.ɵɵinject(i1.AppConfigService)); }, token: StartProcessCloudService, providedIn: "root" });
StartProcessCloudService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
StartProcessCloudService.ctorParameters = () => [
    { type: AlfrescoApiService },
    { type: LogService },
    { type: AppConfigService }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhcnQtcHJvY2Vzcy1jbG91ZC5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Ii9ob21lL3RyYXZpcy9idWlsZC9BbGZyZXNjby9hbGZyZXNjby1uZzItY29tcG9uZW50cy9saWIvcHJvY2Vzcy1zZXJ2aWNlcy1jbG91ZC9zcmMvIiwic291cmNlcyI6WyJsaWIvcHJvY2Vzcy9zdGFydC1wcm9jZXNzL3NlcnZpY2VzL3N0YXJ0LXByb2Nlc3MtY2xvdWQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpQkEsT0FBTyxFQUFFLGtCQUFrQixFQUFFLGdCQUFnQixFQUFFLFVBQVUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3RGLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFjLFVBQVUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUM5QyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFHckMsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sZ0RBQWdELENBQUM7QUFDeEYsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sc0NBQXNDLENBQUM7OztBQUt4RSxNQUFNLE9BQU8sd0JBQXlCLFNBQVEsZ0JBQWdCO0lBRTFELFlBQVksVUFBOEIsRUFDdEIsVUFBc0IsRUFDOUIsZ0JBQWtDO1FBQzFDLEtBQUssQ0FBQyxVQUFVLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztRQUZwQixlQUFVLEdBQVYsVUFBVSxDQUFZO0lBRzFDLENBQUM7SUFPRCxxQkFBcUIsQ0FBQyxPQUFlO1FBQ2pDLElBQUksT0FBTyxJQUFJLE9BQU8sS0FBSyxFQUFFLEVBQUU7WUFDM0IsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQztZQUVyRSxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUNyQixHQUFHLENBQUMsQ0FBQyxHQUFRLEVBQUUsRUFBRTtnQkFDYixPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsSUFBSSxzQkFBc0IsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztZQUNoRyxDQUFDLENBQUMsQ0FDTCxDQUFDO1NBQ0w7YUFBTTtZQUNILElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLHdDQUF3QyxDQUFDLENBQUM7WUFDaEUsT0FBTyxVQUFVLENBQUMsd0JBQXdCLENBQUMsQ0FBQztTQUMvQztJQUNMLENBQUM7SUFRRCxhQUFhLENBQUMsT0FBZSxFQUFFLE9BQTRCO1FBQ3ZELE1BQU0sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsaUNBQWlDLENBQUM7UUFDMUUsT0FBTyxDQUFDLFdBQVcsR0FBRyw4QkFBOEIsQ0FBQztRQUVyRCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FDL0IsR0FBRyxDQUFDLENBQUMsTUFBVyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQ3JDLENBQUM7SUFDTixDQUFDO0lBT0QsbUJBQW1CLENBQUMsT0FBZSxFQUFFLHdCQUFnQyxFQUFFLE9BQTRCO1FBQy9GLE1BQU0sR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsNEJBQTRCLHdCQUF3QixRQUFRLENBQUM7UUFFckcsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQy9CLEdBQUcsQ0FBQyxDQUFDLE1BQVcsRUFBRSxFQUFFLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUNyQyxDQUFDO0lBQ04sQ0FBQztJQVFELFlBQVksQ0FBQyxPQUFlLEVBQUUsT0FBNEI7UUFDdEQsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQztRQUNuRSxPQUFPLENBQUMsV0FBVyxHQUFHLHFCQUFxQixDQUFDO1FBRTVDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDbkMsQ0FBQztJQVNELGFBQWEsQ0FBQyxPQUFlLEVBQUUsaUJBQXlCLEVBQUUsT0FBNEI7UUFDbEYsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyw0QkFBNEIsaUJBQWlCLEVBQUUsQ0FBQztRQUN4RixPQUFPLENBQUMsV0FBVyxHQUFHLHNCQUFzQixDQUFDO1FBRTdDLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUM5QixHQUFHLENBQUMsQ0FBQyxlQUFvQixFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsS0FBSyxDQUFDLENBQ3ZELENBQUM7SUFDTixDQUFDO0lBT0QsYUFBYSxDQUFDLE9BQWUsRUFBRSxpQkFBeUI7UUFDcEQsTUFBTSxHQUFHLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyw0QkFBNEIsaUJBQWlCLEVBQUUsQ0FBQztRQUV4RixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDNUIsQ0FBQzs7OztZQWpHSixVQUFVLFNBQUM7Z0JBQ1IsVUFBVSxFQUFFLE1BQU07YUFDckI7OztZQVhRLGtCQUFrQjtZQUFvQixVQUFVO1lBQTVCLGdCQUFnQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEFsZnJlc2NvQXBpU2VydmljZSwgQXBwQ29uZmlnU2VydmljZSwgTG9nU2VydmljZSB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCB0aHJvd0Vycm9yIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBQcm9jZXNzSW5zdGFuY2VDbG91ZCB9IGZyb20gJy4uL21vZGVscy9wcm9jZXNzLWluc3RhbmNlLWNsb3VkLm1vZGVsJztcbmltcG9ydCB7IFByb2Nlc3NQYXlsb2FkQ2xvdWQgfSBmcm9tICcuLi9tb2RlbHMvcHJvY2Vzcy1wYXlsb2FkLWNsb3VkLm1vZGVsJztcbmltcG9ydCB7IFByb2Nlc3NEZWZpbml0aW9uQ2xvdWQgfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvcHJvY2Vzcy1kZWZpbml0aW9uLWNsb3VkLm1vZGVsJztcbmltcG9ydCB7IEJhc2VDbG91ZFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9zZXJ2aWNlcy9iYXNlLWNsb3VkLnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIFN0YXJ0UHJvY2Vzc0Nsb3VkU2VydmljZSBleHRlbmRzIEJhc2VDbG91ZFNlcnZpY2Uge1xuXG4gICAgY29uc3RydWN0b3IoYXBpU2VydmljZTogQWxmcmVzY29BcGlTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgbG9nU2VydmljZTogTG9nU2VydmljZSxcbiAgICAgICAgICAgICAgICBhcHBDb25maWdTZXJ2aWNlOiBBcHBDb25maWdTZXJ2aWNlKSB7XG4gICAgICAgIHN1cGVyKGFwaVNlcnZpY2UsIGFwcENvbmZpZ1NlcnZpY2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHByb2Nlc3MgZGVmaW5pdGlvbnMgYXNzb2NpYXRlZCB3aXRoIGFuIGFwcC5cbiAgICAgKiBAcGFyYW0gYXBwTmFtZSBOYW1lIG9mIHRoZSB0YXJnZXQgYXBwXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgcHJvY2VzcyBkZWZpbml0aW9uc1xuICAgICAqL1xuICAgIGdldFByb2Nlc3NEZWZpbml0aW9ucyhhcHBOYW1lOiBzdHJpbmcpOiBPYnNlcnZhYmxlPFByb2Nlc3NEZWZpbml0aW9uQ2xvdWRbXT4ge1xuICAgICAgICBpZiAoYXBwTmFtZSB8fCBhcHBOYW1lID09PSAnJykge1xuICAgICAgICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5nZXRCYXNlUGF0aChhcHBOYW1lKX0vcmIvdjEvcHJvY2Vzcy1kZWZpbml0aW9uc2A7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldCh1cmwpLnBpcGUoXG4gICAgICAgICAgICAgICAgbWFwKChyZXM6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmxpc3QuZW50cmllcy5tYXAoKHByb2Nlc3NEZWZzKSA9PiBuZXcgUHJvY2Vzc0RlZmluaXRpb25DbG91ZChwcm9jZXNzRGVmcy5lbnRyeSkpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5sb2dTZXJ2aWNlLmVycm9yKCdBcHBOYW1lIGlzIG1hbmRhdG9yeSBmb3IgcXVlcnlpbmcgdGFzaycpO1xuICAgICAgICAgICAgcmV0dXJuIHRocm93RXJyb3IoJ0FwcE5hbWUgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIHByb2Nlc3MgYmFzZWQgb24gYSBwcm9jZXNzIGRlZmluaXRpb24sIG5hbWUsIGZvcm0gdmFsdWVzIG9yIHZhcmlhYmxlcy5cbiAgICAgKiBAcGFyYW0gYXBwTmFtZSBuYW1lIG9mIHRoZSBBcHBsaWNhdGlvblxuICAgICAqIEBwYXJhbSBwYXlsb2FkIERldGFpbHMgb2YgdGhlIHByb2Nlc3MgKGRlZmluaXRpb24ga2V5LCBuYW1lLCB2YXJpYWJsZXMsIGV0YylcbiAgICAgKiBAcmV0dXJucyBEZXRhaWxzIG9mIHRoZSBwcm9jZXNzIGluc3RhbmNlIGp1c3QgY3JlYXRlZFxuICAgICAqL1xuICAgIGNyZWF0ZVByb2Nlc3MoYXBwTmFtZTogc3RyaW5nLCBwYXlsb2FkOiBQcm9jZXNzUGF5bG9hZENsb3VkKTogT2JzZXJ2YWJsZTxQcm9jZXNzSW5zdGFuY2VDbG91ZD4ge1xuICAgICAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmdldEJhc2VQYXRoKGFwcE5hbWUpfS9yYi92MS9wcm9jZXNzLWluc3RhbmNlcy9jcmVhdGVgO1xuICAgICAgICBwYXlsb2FkLnBheWxvYWRUeXBlID0gJ0NyZWF0ZVByb2Nlc3NJbnN0YW5jZVBheWxvYWQnO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnBvc3QodXJsLCBwYXlsb2FkKS5waXBlKFxuICAgICAgICAgICAgbWFwKChyZXN1bHQ6IGFueSkgPT4gcmVzdWx0LmVudHJ5KVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyBhbiBhbHJlYWR5IGNyZWF0ZWQgcHJvY2VzcyB1c2luZyB0aGUgcHJvY2VzcyBpbnN0YW5jZSBpZC5cbiAgICAgKiBAcGFyYW0gY3JlYXRlZFByb2Nlc3NJbnN0YW5jZUlkIHByb2Nlc3MgaW5zdGFuY2UgaWQgb2YgdGhlIHByb2Nlc3MgcHJldmlvdXNseSBjcmVhdGVkXG4gICAgICogQHJldHVybnMgRGV0YWlscyBvZiB0aGUgcHJvY2VzcyBpbnN0YW5jZSBqdXN0IHN0YXJ0ZWRcbiAgICAgKi9cbiAgICBzdGFydENyZWF0ZWRQcm9jZXNzKGFwcE5hbWU6IHN0cmluZywgY3JlYXRlZFByb2Nlc3NJbnN0YW5jZUlkOiBzdHJpbmcsIHBheWxvYWQ6IFByb2Nlc3NQYXlsb2FkQ2xvdWQpOiBPYnNlcnZhYmxlPFByb2Nlc3NJbnN0YW5jZUNsb3VkPiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuZ2V0QmFzZVBhdGgoYXBwTmFtZSl9L3JiL3YxL3Byb2Nlc3MtaW5zdGFuY2VzLyR7Y3JlYXRlZFByb2Nlc3NJbnN0YW5jZUlkfS9zdGFydGA7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucG9zdCh1cmwsIHBheWxvYWQpLnBpcGUoXG4gICAgICAgICAgICBtYXAoKHJlc3VsdDogYW55KSA9PiByZXN1bHQuZW50cnkpXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIGEgcHJvY2VzcyBiYXNlZCBvbiBhIHByb2Nlc3MgZGVmaW5pdGlvbiwgbmFtZSwgZm9ybSB2YWx1ZXMgb3IgdmFyaWFibGVzLlxuICAgICAqIEBwYXJhbSBhcHBOYW1lIG5hbWUgb2YgdGhlIEFwcGxpY2F0aW9uXG4gICAgICogQHBhcmFtIHBheWxvYWQgRGV0YWlscyBvZiB0aGUgcHJvY2VzcyAoZGVmaW5pdGlvbiBrZXksIG5hbWUsIHZhcmlhYmxlcywgZXRjKVxuICAgICAqIEByZXR1cm5zIERldGFpbHMgb2YgdGhlIHByb2Nlc3MgaW5zdGFuY2UganVzdCBzdGFydGVkXG4gICAgICovXG4gICAgc3RhcnRQcm9jZXNzKGFwcE5hbWU6IHN0cmluZywgcGF5bG9hZDogUHJvY2Vzc1BheWxvYWRDbG91ZCk6IE9ic2VydmFibGU8UHJvY2Vzc0luc3RhbmNlQ2xvdWQ+IHtcbiAgICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5nZXRCYXNlUGF0aChhcHBOYW1lKX0vcmIvdjEvcHJvY2Vzcy1pbnN0YW5jZXNgO1xuICAgICAgICBwYXlsb2FkLnBheWxvYWRUeXBlID0gJ1N0YXJ0UHJvY2Vzc1BheWxvYWQnO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnBvc3QodXJsLCBwYXlsb2FkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgYW4gZXhpc3RpbmcgcHJvY2VzcyBpbnN0YW5jZVxuICAgICAqIEBwYXJhbSBhcHBOYW1lIG5hbWUgb2YgdGhlIEFwcGxpY2F0aW9uXG4gICAgICogQHBhcmFtIHByb2Nlc3NJbnN0YW5jZUlkIHByb2Nlc3MgaW5zdGFuY2UgdG8gdXBkYXRlXG4gICAgICogQHBhcmFtIHBheWxvYWQgRGV0YWlscyBvZiB0aGUgcHJvY2VzcyAoZGVmaW5pdGlvbiBrZXksIG5hbWUsIHZhcmlhYmxlcywgZXRjKVxuICAgICAqIEByZXR1cm5zIERldGFpbHMgb2YgdGhlIHByb2Nlc3MgaW5zdGFuY2UganVzdCBzdGFydGVkXG4gICAgICovXG4gICAgdXBkYXRlUHJvY2VzcyhhcHBOYW1lOiBzdHJpbmcsIHByb2Nlc3NJbnN0YW5jZUlkOiBzdHJpbmcsIHBheWxvYWQ6IFByb2Nlc3NQYXlsb2FkQ2xvdWQpOiBPYnNlcnZhYmxlPFByb2Nlc3NJbnN0YW5jZUNsb3VkPiB7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuZ2V0QmFzZVBhdGgoYXBwTmFtZSl9L3JiL3YxL3Byb2Nlc3MtaW5zdGFuY2VzLyR7cHJvY2Vzc0luc3RhbmNlSWR9YDtcbiAgICAgICAgcGF5bG9hZC5wYXlsb2FkVHlwZSA9ICdVcGRhdGVQcm9jZXNzUGF5bG9hZCc7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucHV0KHVybCwgcGF5bG9hZCkucGlwZShcbiAgICAgICAgICAgIG1hcCgocHJvY2Vzc0luc3RhbmNlOiBhbnkpID0+IHByb2Nlc3NJbnN0YW5jZS5lbnRyeSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgYW4gZXhpc3RpbmcgcHJvY2VzcyBpbnN0YW5jZVxuICAgICAqIEBwYXJhbSBhcHBOYW1lIG5hbWUgb2YgdGhlIEFwcGxpY2F0aW9uXG4gICAgICogQHBhcmFtIHByb2Nlc3NJbnN0YW5jZUlkIHByb2Nlc3MgaW5zdGFuY2UgdG8gdXBkYXRlXG4gICAgICovXG4gICAgZGVsZXRlUHJvY2VzcyhhcHBOYW1lOiBzdHJpbmcsIHByb2Nlc3NJbnN0YW5jZUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5nZXRCYXNlUGF0aChhcHBOYW1lKX0vcmIvdjEvcHJvY2Vzcy1pbnN0YW5jZXMvJHtwcm9jZXNzSW5zdGFuY2VJZH1gO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmRlbGV0ZSh1cmwpO1xuICAgIH1cbn1cbiJdfQ==