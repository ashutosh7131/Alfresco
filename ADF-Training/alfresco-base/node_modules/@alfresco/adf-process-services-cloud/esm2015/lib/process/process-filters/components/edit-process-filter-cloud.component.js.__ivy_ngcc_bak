/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Component, Input, Output, EventEmitter, ViewEncapsulation } from '@angular/core';
import { FormBuilder } from '@angular/forms';
import { DateAdapter } from '@angular/material/core';
import { MatDialog } from '@angular/material/dialog';
import { debounceTime, filter, takeUntil, finalize, switchMap } from 'rxjs/operators';
import { Subject } from 'rxjs';
import moment from 'moment-es6';
import { AppsProcessCloudService } from '../../../app/services/apps-process-cloud.service';
import { ProcessFilterCloudModel } from '../models/process-filter-cloud.model';
import { TranslationService, UserPreferencesService, UserPreferenceValues } from '@alfresco/adf-core';
import { ProcessFilterCloudService } from '../services/process-filter-cloud.service';
import { ProcessFilterDialogCloudComponent } from './process-filter-dialog-cloud.component';
import { ProcessCloudService } from '../../services/process-cloud.service';
import { DateCloudFilterType } from '../../../models/date-cloud-filter.model';
export class EditProcessFilterCloudComponent {
    constructor(formBuilder, dialog, dateAdapter, userPreferencesService, translateService, processFilterCloudService, appsProcessCloudService, processCloudService) {
        this.formBuilder = formBuilder;
        this.dialog = dialog;
        this.dateAdapter = dateAdapter;
        this.userPreferencesService = userPreferencesService;
        this.translateService = translateService;
        this.processFilterCloudService = processFilterCloudService;
        this.appsProcessCloudService = appsProcessCloudService;
        this.processCloudService = processCloudService;
        this.DATE_FORMAT = 'DD/MM/YYYY';
        this.appName = '';
        this.role = '';
        this.filterProperties = EditProcessFilterCloudComponent.DEFAULT_PROCESS_FILTER_PROPERTIES;
        this.sortProperties = EditProcessFilterCloudComponent.DEFAULT_SORT_PROPERTIES;
        this.actions = EditProcessFilterCloudComponent.DEFAULT_ACTIONS;
        this.showFilterActions = true;
        this.showTitle = true;
        this.showProcessFilterName = true;
        this.filterChange = new EventEmitter();
        this.action = new EventEmitter();
        this.filterHasBeenChanged = false;
        this.status = [
            { value: '', label: 'ADF_CLOUD_PROCESS_FILTERS.STATUS.ALL' },
            { value: 'RUNNING', label: 'ADF_CLOUD_PROCESS_FILTERS.STATUS.RUNNING' },
            { value: 'SUSPENDED', label: 'ADF_CLOUD_PROCESS_FILTERS.STATUS.SUSPENDED' },
            { value: 'CANCELLED', label: 'ADF_CLOUD_PROCESS_FILTERS.STATUS.CANCELLED' },
            { value: 'COMPLETED', label: 'ADF_CLOUD_PROCESS_FILTERS.STATUS.COMPLETED' }
        ];
        this.directions = [
            { value: 'ASC', label: 'ADF_CLOUD_PROCESS_FILTERS.DIRECTION.ASCENDING' },
            { value: 'DESC', label: 'ADF_CLOUD_PROCESS_FILTERS.DIRECTION.DESCENDING' }
        ];
        this.actionDisabledForDefault = [
            EditProcessFilterCloudComponent.ACTION_SAVE,
            EditProcessFilterCloudComponent.ACTION_DELETE
        ];
        this.applicationNames = [];
        this.allProcessDefinitionNamesOption = {
            label: 'ADF_CLOUD_PROCESS_FILTERS.STATUS.ALL',
            value: ''
        };
        this.processDefinitionNames = [];
        this.processFilterProperties = [];
        this.processFilterActions = [];
        this.toggleFilterActions = false;
        this.appVersionOptions = [];
        this.initiatorOptions = [];
        this.onDestroy$ = new Subject();
        this.isLoading = false;
    }
    get processFilter() {
        return this._filter;
    }
    set processFilter(value) {
        const isChanged = this.isFilterChanged(this._filter, value);
        this._filter = value;
        if (value === null || value === void 0 ? void 0 : value.appName) {
            this.appName = value.appName;
        }
        if (value === null || value === void 0 ? void 0 : value.id) {
            this.id = value.id;
        }
        this.processFilterProperties = this.createAndFilterProperties();
        this.processFilterActions = this.createAndFilterActions();
        this.buildForm(this.processFilterProperties);
        if (isChanged) {
            this.filterChange.emit(value);
        }
    }
    ngOnInit() {
        this.userPreferencesService
            .select(UserPreferenceValues.Locale)
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(locale => this.dateAdapter.setLocale(locale));
    }
    ngOnChanges(changes) {
        const id = changes['id'];
        if (id && id.currentValue !== id.previousValue) {
            this.retrieveProcessFilterAndBuildForm();
        }
    }
    ngOnDestroy() {
        this.onDestroy$.next(true);
        this.onDestroy$.complete();
    }
    buildForm(processFilterProperties) {
        this.editProcessFilterForm = this.formBuilder.group(this.getFormControlsConfig(processFilterProperties));
        this.onFilterChange();
    }
    getFormControlsConfig(processFilterProperties) {
        const properties = processFilterProperties.map((property) => {
            if (!!property.attributes) {
                return this.getAttributesControlConfig(property);
            }
            else {
                return { [property.key]: property.value };
            }
        });
        return properties.reduce(((result, current) => Object.assign(result, current)), {});
    }
    getAttributesControlConfig(property) {
        return Object.values(property.attributes).reduce((result, key) => {
            result[key] = property.value[key];
            return result;
        }, {});
    }
    retrieveProcessFilterAndBuildForm() {
        this.isLoading = true;
        this.processFilterCloudService
            .getFilterById(this.appName, this.id)
            .pipe(finalize(() => this.isLoading = false))
            .subscribe(response => {
            this.filterHasBeenChanged = false;
            this.processFilter = new ProcessFilterCloudModel(Object.assign({}, response || {}, this.processFilter || {}));
        });
    }
    onFilterChange() {
        if (this.filterChangeSub) {
            this.filterChangeSub.unsubscribe();
            this.filterChangeSub = null;
        }
        this.filterChangeSub = this.editProcessFilterForm.valueChanges
            .pipe(debounceTime(500), filter(() => this.isFormValid()), takeUntil(this.onDestroy$))
            .subscribe((formValues) => {
            this.setLastModifiedToFilter(formValues);
            const newValue = new ProcessFilterCloudModel(Object.assign({}, this.processFilter, formValues));
            const changed = !this.compareFilters(newValue, this.processFilter);
            this.filterHasBeenChanged = changed;
            if (changed) {
                this._filter = newValue;
                this.filterChange.emit(newValue);
            }
        });
    }
    createAndFilterProperties() {
        this.checkMandatoryFilterProperties();
        if (this.filterProperties.includes('appName')) {
            this.getRunningApplications();
        }
        if (this.filterProperties.includes('processDefinitionName')) {
            this.getProcessDefinitions();
        }
        if (this.filterProperties.includes('appVersionMultiple')) {
            this.getAppVersionOptions();
        }
        if (this.filterProperties.includes('initiator')) {
            this.initiatorOptions = !!this.processFilter.initiator
                ? this.processFilter.initiator.split(',').map(username => Object.assign({}, { username: username }))
                : [];
        }
        const defaultProperties = this.createProcessFilterProperties(this.processFilter);
        let filteredProperties = defaultProperties.filter((filterProperty) => this.isValidProperty(this.filterProperties, filterProperty.key));
        if (!this.filterProperties.includes('sort')) {
            filteredProperties = filteredProperties.filter(property => property.key !== 'order');
        }
        if (this.filterProperties.includes('lastModified')) {
            filteredProperties = [
                ...filteredProperties,
                ...this.createLastModifiedProperty(this.processFilter)
            ];
        }
        return filteredProperties;
    }
    checkMandatoryFilterProperties() {
        if (this.filterProperties === undefined || this.filterProperties.length === 0) {
            this.filterProperties = EditProcessFilterCloudComponent.DEFAULT_PROCESS_FILTER_PROPERTIES;
        }
    }
    isValidProperty(filterProperties, key) {
        return filterProperties ? filterProperties.indexOf(key) >= 0 : true;
    }
    get createSortProperties() {
        this.checkMandatorySortProperties();
        const defaultSortProperties = this.createProcessSortProperties();
        return defaultSortProperties.filter((sortProperty) => this.isValidProperty(this.sortProperties, sortProperty.key));
    }
    getAppVersionOptions() {
        this.appVersionOptions = [];
        this.processCloudService.getApplicationVersions(this.appName).subscribe((appVersions) => {
            appVersions.forEach(appVersion => {
                this.appVersionOptions.push({ label: appVersion.entry.version, value: appVersion.entry.version });
            });
        });
    }
    checkMandatorySortProperties() {
        if (this.sortProperties === undefined || this.sortProperties.length === 0) {
            this.sortProperties = EditProcessFilterCloudComponent.DEFAULT_SORT_PROPERTIES;
        }
    }
    createAndFilterActions() {
        this.checkMandatoryActions();
        const actions = this.createFilterActions();
        return actions.filter((action) => this.isValidAction(this.actions, action));
    }
    checkMandatoryActions() {
        if (this.actions === undefined || this.actions.length === 0) {
            this.actions = EditProcessFilterCloudComponent.DEFAULT_ACTIONS;
        }
    }
    isValidAction(actions, action) {
        return actions ? actions.indexOf(action.actionType) >= 0 : true;
    }
    isFormValid() {
        return this.editProcessFilterForm.valid;
    }
    getPropertyController(property) {
        return this.editProcessFilterForm.get(property.key);
    }
    onDateChanged(newDateValue, dateProperty) {
        if (newDateValue) {
            const controller = this.getPropertyController(dateProperty);
            if (newDateValue.isValid()) {
                controller.setValue(newDateValue);
                controller.setErrors(null);
            }
            else {
                controller.setErrors({ invalid: true });
            }
        }
    }
    onDateTypeChange(dateType, property) {
        this.editProcessFilterForm.get(property.attributes.dateType).setValue(dateType);
    }
    onDateRangeFilterChanged(dateRange, property) {
        var _a, _b;
        this.editProcessFilterForm.get((_a = property.attributes) === null || _a === void 0 ? void 0 : _a.from).setValue(dateRange.startDate ? dateRange.startDate : null);
        this.editProcessFilterForm.get((_b = property.attributes) === null || _b === void 0 ? void 0 : _b.to).setValue(dateRange.endDate ? dateRange.endDate : null);
        this.editProcessFilterForm.get(property.attributes.dateType).setValue(DateCloudFilterType.RANGE);
    }
    onChangedUser(users, processProperty) {
        this.getPropertyController(processProperty).setValue(users.map(user => user.username).join(','));
    }
    hasError(property) {
        const controller = this.getPropertyController(property);
        return controller.errors && controller.errors.invalid;
    }
    compareFilters(editedQuery, currentQuery) {
        return JSON.stringify(editedQuery).toLowerCase() === JSON.stringify(currentQuery).toLowerCase();
    }
    getRunningApplications() {
        this.applicationNames = [];
        this.appsProcessCloudService
            .getDeployedApplicationsByStatus('RUNNING', this.role)
            .subscribe((applications) => {
            if (applications && applications.length > 0) {
                applications.map((application) => {
                    this.applicationNames.push({ label: application.name, value: application.name });
                });
            }
        });
    }
    getProcessDefinitions() {
        this.processDefinitionNames = [];
        this.processCloudService.getProcessDefinitions(this.appName).subscribe((processDefinitions) => {
            if (processDefinitions && processDefinitions.length > 0) {
                this.processDefinitionNames.push(this.allProcessDefinitionNamesOption);
                processDefinitions.map((processDefinition) => {
                    this.processDefinitionNames.push({ label: processDefinition.name, value: processDefinition.name });
                });
            }
        });
    }
    executeFilterActions(action) {
        if (action.actionType === EditProcessFilterCloudComponent.ACTION_SAVE) {
            this.save(action);
        }
        else if (action.actionType === EditProcessFilterCloudComponent.ACTION_SAVE_AS) {
            this.saveAs(action);
        }
        else if (action.actionType === EditProcessFilterCloudComponent.ACTION_DELETE) {
            this.delete(action);
        }
    }
    save(saveAction) {
        this.processFilterCloudService
            .updateFilter(this.processFilter)
            .subscribe(() => {
            saveAction.filter = this.processFilter;
            this.filterHasBeenChanged = false;
            this.action.emit(saveAction);
        });
    }
    delete(deleteAction) {
        this.processFilterCloudService
            .deleteFilter(this.processFilter)
            .pipe(filter((filters) => {
            deleteAction.filter = this.processFilter;
            this.action.emit(deleteAction);
            return filters.length === 0;
        }), switchMap(() => this.restoreDefaultProcessFilters()))
            .subscribe(() => { });
    }
    saveAs(saveAsAction) {
        const dialogRef = this.dialog.open(ProcessFilterDialogCloudComponent, {
            data: {
                name: this.translateService.instant(this.processFilter.name)
            },
            height: 'auto',
            minWidth: '30%'
        });
        dialogRef.afterClosed().subscribe((result) => {
            if (result && result.action === ProcessFilterDialogCloudComponent.ACTION_SAVE) {
                const filterId = Math.random().toString(36).substr(2, 9);
                const filterKey = this.getSanitizeFilterName(result.name);
                const newFilter = {
                    name: result.name,
                    icon: result.icon,
                    id: filterId,
                    key: 'custom-' + filterKey
                };
                const resultFilter = Object.assign({}, this.processFilter, newFilter);
                this.processFilterCloudService
                    .addFilter(resultFilter)
                    .subscribe(() => {
                    saveAsAction.filter = resultFilter;
                    this.filterHasBeenChanged = false;
                    this.action.emit(saveAsAction);
                });
            }
        });
    }
    getSanitizeFilterName(filterName) {
        const nameWithHyphen = this.replaceSpaceWithHyphen(filterName.trim());
        return nameWithHyphen.toLowerCase();
    }
    replaceSpaceWithHyphen(name) {
        const regExt = new RegExp(' ', 'g');
        return name.replace(regExt, '-');
    }
    restoreDefaultProcessFilters() {
        return this.processFilterCloudService.getProcessFilters(this.appName);
    }
    onExpand() {
        this.toggleFilterActions = true;
    }
    onClose() {
        this.toggleFilterActions = false;
    }
    isDisabledAction(action) {
        return (this.processFilterCloudService.isDefaultFilter(this.processFilter.name) &&
            this.actionDisabledForDefault.includes(action.actionType)) ? true : this.hasFilterChanged(action);
    }
    hasFilterChanged(action) {
        return action.actionType === EditProcessFilterCloudComponent.ACTION_SAVE ||
            action.actionType === EditProcessFilterCloudComponent.ACTION_SAVE_AS ?
            !this.filterHasBeenChanged : false;
    }
    setLastModifiedToFilter(formValues) {
        if (formValues.lastModifiedTo && Date.parse(formValues.lastModifiedTo.toString())) {
            const lastModifiedToFilterValue = moment(formValues.lastModifiedTo);
            lastModifiedToFilterValue.set({
                hour: 23,
                minute: 59,
                second: 59
            });
            formValues.lastModifiedTo = lastModifiedToFilterValue.toDate();
        }
    }
    createFilterActions() {
        return [
            {
                actionType: EditProcessFilterCloudComponent.ACTION_SAVE,
                icon: 'adf:save',
                tooltip: 'ADF_CLOUD_EDIT_PROCESS_FILTER.TOOL_TIP.SAVE'
            },
            {
                actionType: EditProcessFilterCloudComponent.ACTION_SAVE_AS,
                icon: 'adf:save-as',
                tooltip: 'ADF_CLOUD_EDIT_PROCESS_FILTER.TOOL_TIP.SAVE_AS'
            },
            {
                actionType: EditProcessFilterCloudComponent.ACTION_DELETE,
                icon: 'delete',
                tooltip: 'ADF_CLOUD_EDIT_PROCESS_FILTER.TOOL_TIP.DELETE'
            }
        ];
    }
    createLastModifiedProperty(filterModel) {
        let lastModifiedFrom;
        let lastModifiedTo;
        if (filterModel.lastModifiedFrom) {
            lastModifiedFrom = moment(filterModel.lastModifiedFrom);
        }
        if (filterModel.lastModifiedTo) {
            lastModifiedTo = moment(filterModel.lastModifiedTo);
        }
        return [
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.LAST_MODIFIED_DATE_FORM',
                type: 'date',
                key: 'lastModifiedFrom',
                value: lastModifiedFrom
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.LAST_MODIFIED_TO',
                type: 'date',
                key: 'lastModifiedTo',
                value: lastModifiedTo
            }
        ];
    }
    createProcessSortProperties() {
        return [
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.ID',
                key: 'id',
                value: 'id'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_NAME',
                key: 'name',
                value: 'name'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.START_DATE',
                key: 'startDate',
                value: 'startDate'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.STATUS',
                key: 'status',
                value: 'status'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.STARTED_BY',
                key: 'initiator',
                value: 'initiator'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.APP_NAME',
                key: 'appName',
                value: 'appName'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.APP_VERSION',
                key: 'appVersion',
                value: 'appVersion'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_INS_ID',
                key: 'processInstanceId',
                value: 'processInstanceId'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_DEF_ID',
                key: 'processDefinitionId',
                value: 'processDefinitionId'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_DEF_NAME',
                key: 'processDefinitionName',
                value: 'processDefinitionName'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_DEF_KEY',
                key: 'processDefinitionKey',
                value: 'processDefinitionKey'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.LAST_MODIFIED',
                key: 'lastModified',
                value: 'lastModified'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.BUSINESS_KEY',
                key: 'businessKey',
                value: 'businessKey'
            }
        ];
    }
    isFilterChanged(oldValue, newValue) {
        const oldJson = JSON.stringify(this.processFilterCloudService.writeQueryParams(oldValue || {}, this.filterProperties));
        const newJson = JSON.stringify(this.processFilterCloudService.writeQueryParams(newValue || {}, this.filterProperties));
        return oldJson !== newJson;
    }
    createProcessFilterProperties(filterModel) {
        const appVersionMultiple = [];
        if (filterModel.appVersion) {
            appVersionMultiple.push(Array.isArray(filterModel.appVersion)
                ? filterModel.appVersion.map(entry => entry.toString())
                : `${filterModel.appVersion}`);
        }
        return [
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.APP_NAME',
                type: 'select',
                key: 'appName',
                value: filterModel.appName || '',
                options: this.applicationNames
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.APP_VERSION',
                type: 'number',
                key: 'appVersion',
                value: filterModel.appVersion
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.APP_VERSION',
                type: 'multi-select',
                key: 'appVersionMultiple',
                value: appVersionMultiple,
                options: this.appVersionOptions
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_INS_ID',
                type: 'text',
                key: 'processInstanceId',
                value: filterModel.processInstanceId || ''
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_NAME',
                type: 'text',
                key: 'processName',
                value: filterModel.processName || ''
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_DEF_NAME',
                type: 'select',
                key: 'processDefinitionName',
                value: filterModel.processDefinitionName || '',
                options: this.processDefinitionNames
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.STATUS',
                type: 'select',
                key: 'status',
                value: filterModel.status || this.status[0].value,
                options: this.status
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_DEF_ID',
                type: 'text',
                key: 'processDefinitionId',
                value: filterModel.processDefinitionId || ''
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.PROCESS_DEF_KEY',
                type: 'text',
                key: 'processDefinitionKey',
                value: filterModel.processDefinitionKey || ''
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.SORT',
                type: 'select',
                key: 'sort',
                value: filterModel.sort || this.createSortProperties[0].value,
                options: this.createSortProperties
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.DIRECTION',
                type: 'select',
                key: 'order',
                value: filterModel.order || this.directions[0].value,
                options: this.directions
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.COMPLETED_DATE',
                type: 'date',
                key: 'completedDate',
                value: filterModel.completedDate || false
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.STARTED_BY',
                type: 'people',
                key: 'initiator',
                value: filterModel.initiator,
                selectionMode: 'multiple'
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.COMPLETED_DATE',
                type: 'date-range',
                key: 'completedDateRange',
                attributes: { dateType: 'completedDateType', from: '_completedFrom', to: '_completedTo' },
                value: {
                    completedDateType: filterModel.completedDateType || null,
                    _completedFrom: filterModel.completedFrom || null,
                    _completedTo: filterModel.completedTo || null
                }
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.STARTED_DATE',
                type: 'date-range',
                key: 'startedDateRange',
                attributes: { dateType: 'startedDateType', from: '_startFrom', to: '_startTo' },
                value: {
                    startedDateType: filterModel.startedDateType || null,
                    _startFrom: filterModel.startFrom || null,
                    _startTo: filterModel.startTo || null
                }
            },
            {
                label: 'ADF_CLOUD_EDIT_PROCESS_FILTER.LABEL.SUSPENDED_DATE',
                type: 'date-range',
                key: 'suspendedDateRange',
                attributes: { dateType: 'suspendedDateType', from: '_suspendedFrom', to: '_suspendedTo' },
                value: {
                    suspendedDateType: filterModel.suspendedDateType || null,
                    _suspendedFrom: filterModel.suspendedFrom || null,
                    _suspendedTo: filterModel.suspendedTo || null
                }
            }
        ];
    }
}
EditProcessFilterCloudComponent.ACTION_SAVE = 'save';
EditProcessFilterCloudComponent.ACTION_SAVE_AS = 'saveAs';
EditProcessFilterCloudComponent.ACTION_DELETE = 'delete';
EditProcessFilterCloudComponent.DEFAULT_PROCESS_FILTER_PROPERTIES = ['status', 'sort', 'order', 'lastModified'];
EditProcessFilterCloudComponent.DEFAULT_SORT_PROPERTIES = ['id', 'name', 'status', 'startDate'];
EditProcessFilterCloudComponent.DEFAULT_ACTIONS = ['save', 'saveAs', 'delete'];
EditProcessFilterCloudComponent.decorators = [
    { type: Component, args: [{
                selector: 'adf-cloud-edit-process-filter',
                template: "<mat-accordion [hideToggle]=\"isLoading\">\n    <mat-expansion-panel (afterExpand)=\"onExpand()\" (closed)=\"onClose()\">\n        <mat-expansion-panel-header *ngIf=\"processFilter\" id=\"adf-edit-process-filter-expansion-header\">\n            <ng-container *ngIf=\"!isLoading; else loadingTemplate\">\n                <mat-panel-title *ngIf=\"showProcessFilterName\" fxLayoutAlign=\"space-between center\" id=\"adf-edit-process-filter-title-id\">{{processFilter.name | translate}}</mat-panel-title>\n                <mat-panel-description fxLayoutAlign=\"space-between center\" id=\"adf-edit-process-filter-sub-title-id\">\n                    <span *ngIf=\"showTitle\"> {{ 'ADF_CLOUD_EDIT_PROCESS_FILTER.TITLE' | translate}}</span>\n                    <div *ngIf=\"showFilterActions\" class=\"adf-cloud-edit-process-filter-actions\">\n                        <ng-container *ngIf=\"toggleFilterActions\">\n                            <button *ngFor=\"let filterAction of processFilterActions\" mat-icon-button matTooltip=\"{{ filterAction.tooltip | translate}}\" [attr.data-automation-id]=\"'adf-filter-action-' + filterAction.actionType\" [disabled]=\"isDisabledAction(filterAction)\" (click)=\"executeFilterActions(filterAction)\">\n                                <adf-icon [value]=\"filterAction.icon\"></adf-icon>\n                            </button>\n                        </ng-container>\n                    </div>\n                </mat-panel-description>\n            </ng-container>\n            <ng-template #loadingTemplate>\n                <div class=\"adf-cloud-edit-process-filter-loading-margin\">\n                    <mat-spinner [diameter]=\"30\"></mat-spinner>\n                </div>\n            </ng-template>\n        </mat-expansion-panel-header>\n        <ng-container *ngIf=\"!isLoading\">\n            <form [formGroup]=\"editProcessFilterForm\" *ngIf=\"editProcessFilterForm\">\n                <div fxLayout=\"row wrap\" fxLayout.xs=\"column\" fxLayoutGap=\"10px\" fxLayoutAlign=\"start center\">\n                    <ng-container *ngFor=\"let processFilterProperty of processFilterProperties\">\n                        <mat-form-field [floatLabel]=\"'auto'\" fxFlex=\"23%\" *ngIf=\"processFilterProperty.type === 'select'\" [attr.data-automation-id]=\"processFilterProperty.key\">\n                            <mat-select\n                                placeholder=\"{{processFilterProperty.label | translate}}\"\n                                [formControlName]=\"processFilterProperty.key\"\n                                [attr.data-automation-id]=\"'adf-cloud-edit-process-property-' + processFilterProperty.key\">\n                                <mat-option\n                                    *ngFor=\"let propertyOption of processFilterProperty.options\"\n                                    [value]=\"propertyOption.value\"\n                                    [attr.data-automation-id]=\"'adf-cloud-edit-process-property-options-' + processFilterProperty.key\"\n                                >{{ propertyOption.label | translate }}</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                        <mat-form-field [floatLabel]=\"'auto'\" fxFlex=\"23%\" *ngIf=\"processFilterProperty.type === 'multi-select'\" [attr.data-automation-id]=\"processFilterProperty.key\">\n                            <mat-select\n                                placeholder=\"{{processFilterProperty.label | translate}}\"\n                                [formControlName]=\"processFilterProperty.key\"\n                                [attr.data-automation-id]=\"'adf-cloud-edit-process-property-' + processFilterProperty.key\"\n                                [multiple]=\"true\">\n                                <mat-option *ngFor=\"let propertyOption of processFilterProperty.options\" [value]=\"propertyOption.value\" [attr.data-automation-id]=\"'adf-cloud-edit-process-property-options-' + processFilterProperty.key\">\n                                    {{ propertyOption.label | translate }}\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                        <mat-form-field [floatLabel]=\"'auto'\" fxFlex=\"23%\" *ngIf=\"processFilterProperty.type === 'text'\" [attr.data-automation-id]=\"processFilterProperty.key\">\n                            <input matInput\n                                [formControlName]=\"processFilterProperty.key\"\n                                type=\"text\"\n                                placeholder=\"{{processFilterProperty.label | translate}}\"\n                                [attr.data-automation-id]=\"'adf-cloud-edit-process-property-' + processFilterProperty.key\"/>\n                        </mat-form-field>\n                        <mat-form-field [floatLabel]=\"'auto'\" fxFlex=\"23%\" *ngIf=\"processFilterProperty.type === 'number'\" [attr.data-automation-id]=\"processFilterProperty.key\">\n                            <input matInput\n                                [formControlName]=\"processFilterProperty.key\"\n                                type=\"number\" min=\"0\"\n                                placeholder=\"{{processFilterProperty.label | translate}}\"\n                                [attr.data-automation-id]=\"'adf-cloud-edit-process-property-' + processFilterProperty.key\"/>\n                        </mat-form-field>\n                        <mat-form-field [floatLabel]=\"'auto'\" fxFlex=\"23%\" *ngIf=\"processFilterProperty.type === 'date'\" [attr.data-automation-id]=\"processFilterProperty.key\">\n                            <mat-label>{{processFilterProperty.label | translate}}</mat-label>\n                            <input\n                                matInput\n                                [formControlName]=\"processFilterProperty.key\"\n                                (keyup)=\"onDateChanged($any($event).srcElement.value, processFilterProperty)\"\n                                (dateChange)=\"onDateChanged($event.value, processFilterProperty)\"\n                                [matDatepicker]=\"dateController\"\n                                placeholder=\"{{processFilterProperty.label | translate}}\"\n                                [attr.data-automation-id]=\"'adf-cloud-edit-process-property-' + processFilterProperty.key\">\n                        <mat-datepicker-toggle matSuffix [for]=\"dateController\" [attr.data-automation-id]=\"'adf-cloud-edit-process-property-date-toggle-' + processFilterProperty.key\"></mat-datepicker-toggle>\n                        <mat-datepicker #dateController [attr.data-automation-id]=\"'adf-cloud-edit-process-property-date-picker-' + processFilterProperty.key\"></mat-datepicker>\n                        <div class=\"adf-edit-process-filter-date-error-container\">\n                            <div *ngIf=\"hasError(processFilterProperty)\">\n                                <div class=\"adf-error-text\">{{'ADF_CLOUD_EDIT_PROCESS_FILTER.ERROR.DATE' | translate}}</div>\n                                <mat-icon class=\"adf-error-icon\">warning</mat-icon>\n                            </div>\n                        </div>\n                        </mat-form-field>\n\n                        <adf-cloud-date-range-filter *ngIf=\"processFilterProperty.type === 'date-range'\"\n                            [processFilterProperty]=\"processFilterProperty\"\n                            [options]=\"processFilterProperty.dateFilterOptions\"\n                            (dateTypeChange)=\"onDateTypeChange($event, processFilterProperty)\"\n                            (dateChanged)=\"onDateRangeFilterChanged($event, processFilterProperty)\"></adf-cloud-date-range-filter>\n\n                        <div fxFlex=\"23%\" *ngIf=\"processFilterProperty.type === 'people'\">\n                            <adf-cloud-people\n                                [preSelectUsers]=\"initiatorOptions\"\n                                [title]=\"processFilterProperty.label\"\n                                [validate]=\"true\"\n                                [appName]=\"appName\"\n                                [mode]=\"processFilterProperty.selectionMode\"\n                                (changedUsers)=\"onChangedUser($event, processFilterProperty)\"></adf-cloud-people>\n                        </div>\n                    </ng-container>\n                </div>\n            </form>\n        </ng-container>\n    </mat-expansion-panel>\n</mat-accordion>\n",
                encapsulation: ViewEncapsulation.None,
                styles: [".adf-edit-process-filter-date-error-container{height:20px;margin-top:12px;position:absolute;width:100%}.adf-edit-process-filter-date-error-container>div{display:flex;flex-flow:row;justify-content:flex-start}.adf-edit-process-filter-date-error-container .adf-error-text{color:var(--theme-warn-color);font-size:11px;height:16px;line-height:1.33;padding-right:8px;width:auto}.adf-edit-process-filter-date-error-container .adf-error-icon{color:var(--theme-warn-color);font-size:16px}.adf-cloud-edit-process-filter-loading-margin{margin-left:calc(50% - 50px);margin-right:calc(50% - 50px)}"]
            },] }
];
EditProcessFilterCloudComponent.ctorParameters = () => [
    { type: FormBuilder },
    { type: MatDialog },
    { type: DateAdapter },
    { type: UserPreferencesService },
    { type: TranslationService },
    { type: ProcessFilterCloudService },
    { type: AppsProcessCloudService },
    { type: ProcessCloudService }
];
EditProcessFilterCloudComponent.propDecorators = {
    appName: [{ type: Input }],
    role: [{ type: Input }],
    id: [{ type: Input }],
    filterProperties: [{ type: Input }],
    sortProperties: [{ type: Input }],
    actions: [{ type: Input }],
    showFilterActions: [{ type: Input }],
    showTitle: [{ type: Input }],
    showProcessFilterName: [{ type: Input }],
    filterChange: [{ type: Output }],
    action: [{ type: Output }],
    processFilter: [{ type: Input }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZWRpdC1wcm9jZXNzLWZpbHRlci1jbG91ZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiL2hvbWUvdHJhdmlzL2J1aWxkL0FsZnJlc2NvL2FsZnJlc2NvLW5nMi1jb21wb25lbnRzL2xpYi9wcm9jZXNzLXNlcnZpY2VzLWNsb3VkL3NyYy8iLCJzb3VyY2VzIjpbImxpYi9wcm9jZXNzL3Byb2Nlc3MtZmlsdGVycy9jb21wb25lbnRzL2VkaXQtcHJvY2Vzcy1maWx0ZXItY2xvdWQuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRztBQUVILE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQStDLGlCQUFpQixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZJLE9BQU8sRUFBYSxXQUFXLEVBQW1CLE1BQU0sZ0JBQWdCLENBQUM7QUFDekUsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3JELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3RGLE9BQU8sRUFBRSxPQUFPLEVBQTRCLE1BQU0sTUFBTSxDQUFDO0FBQ3pELE9BQU8sTUFBTSxNQUFNLFlBQVksQ0FBQztBQUVoQyxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxrREFBa0QsQ0FBQztBQUMzRixPQUFPLEVBQUUsdUJBQXVCLEVBQWlHLE1BQU0sc0NBQXNDLENBQUM7QUFDOUssT0FBTyxFQUFxQixrQkFBa0IsRUFBRSxzQkFBc0IsRUFBRSxvQkFBb0IsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3pILE9BQU8sRUFBRSx5QkFBeUIsRUFBRSxNQUFNLDBDQUEwQyxDQUFDO0FBQ3JGLE9BQU8sRUFBRSxpQ0FBaUMsRUFB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U0FDSixDQUFDO0lBQ04sQ0FBQzs7QUF0dkJhLDJDQUFXLEdBQUcsTUFBTSxDQUFDO0FBQ3JCLDhDQUFjLEdBQUcsUUFBUSxDQUFDO0FBQzFCLDZDQUFhLEdBQUcsUUFBUSxDQUFDO0FBQ3pCLGlFQUFpQyxHQUFHLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsY0FBYyxDQUFDLENBQUM7QUFDaEYsdURBQXVCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQztBQUNoRSwrQ0FBZSxHQUFHLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxRQUFRLENBQUMsQ0FBQzs7WUFiaEUsU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSwrQkFBK0I7Z0JBQ3pDLGc2UUFBeUQ7Z0JBRXpELGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJOzthQUN4Qzs7O1lBekJtQixXQUFXO1lBRXRCLFNBQVM7WUFEVCxXQUFXO1lBUTRCLHNCQUFzQjtZQUExQyxrQkFBa0I7WUFDckMseUJBQXlCO1lBSHpCLHVCQUF1QjtZQUt2QixtQkFBbUI7OztzQkF5QnZCLEtBQUs7bUJBSUwsS0FBSztpQkFJTCxLQUFLOytCQUlMLEtBQUs7NkJBSUwsS0FBSztzQkFJTCxLQUFLO2dDQUlMLEtBQUs7d0JBSUwsS0FBSztvQ0FJTCxLQUFLOzJCQUlMLE1BQU07cUJBSU4sTUFBTTs0QkFVTixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIE9uSW5pdCwgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzLCBPbkRlc3Ryb3ksIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGb3JtR3JvdXAsIEZvcm1CdWlsZGVyLCBBYnN0cmFjdENvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBEYXRlQWRhcHRlciB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2NvcmUnO1xuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZGlhbG9nJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSwgZmlsdGVyLCB0YWtlVW50aWwsIGZpbmFsaXplLCBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBTdWJqZWN0LCBPYnNlcnZhYmxlLCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50LWVzNic7XG5pbXBvcnQgeyBNb21lbnQgfSBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHsgQXBwc1Byb2Nlc3NDbG91ZFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9hcHAvc2VydmljZXMvYXBwcy1wcm9jZXNzLWNsb3VkLnNlcnZpY2UnO1xuaW1wb3J0IHsgUHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWwsIFByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzLCBQcm9jZXNzRmlsdGVyQWN0aW9uLCBQcm9jZXNzRmlsdGVyT3B0aW9ucywgUHJvY2Vzc1NvcnRGaWx0ZXJQcm9wZXJ0eSB9IGZyb20gJy4uL21vZGVscy9wcm9jZXNzLWZpbHRlci1jbG91ZC5tb2RlbCc7XG5pbXBvcnQgeyBJZGVudGl0eVVzZXJNb2RlbCwgVHJhbnNsYXRpb25TZXJ2aWNlLCBVc2VyUHJlZmVyZW5jZXNTZXJ2aWNlLCBVc2VyUHJlZmVyZW5jZVZhbHVlcyB9IGZyb20gJ0BhbGZyZXNjby9hZGYtY29yZSc7XG5pbXBvcnQgeyBQcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvcHJvY2Vzcy1maWx0ZXItY2xvdWQuc2VydmljZSc7XG5pbXBvcnQgeyBQcm9jZXNzRmlsdGVyRGlhbG9nQ2xvdWRDb21wb25lbnQgfSBmcm9tICcuL3Byb2Nlc3MtZmlsdGVyLWRpYWxvZy1jbG91ZC5jb21wb25lbnQnO1xuaW1wb3J0IHsgUHJvY2Vzc0Nsb3VkU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3Byb2Nlc3MtY2xvdWQuc2VydmljZSc7XG5pbXBvcnQgeyBEYXRlQ2xvdWRGaWx0ZXJUeXBlLCBEYXRlUmFuZ2VGaWx0ZXIgfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvZGF0ZS1jbG91ZC1maWx0ZXIubW9kZWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERyb3Bkb3duT3B0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xuICAgIGxhYmVsOiBzdHJpbmc7XG59XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLWNsb3VkLWVkaXQtcHJvY2Vzcy1maWx0ZXInLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9lZGl0LXByb2Nlc3MtZmlsdGVyLWNsb3VkLmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnLi9lZGl0LXByb2Nlc3MtZmlsdGVyLWNsb3VkLmNvbXBvbmVudC5zY3NzJ10sXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxufSlcbmV4cG9ydCBjbGFzcyBFZGl0UHJvY2Vzc0ZpbHRlckNsb3VkQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSB7XG5cbiAgICBwdWJsaWMgc3RhdGljIEFDVElPTl9TQVZFID0gJ3NhdmUnO1xuICAgIHB1YmxpYyBzdGF0aWMgQUNUSU9OX1NBVkVfQVMgPSAnc2F2ZUFzJztcbiAgICBwdWJsaWMgc3RhdGljIEFDVElPTl9ERUxFVEUgPSAnZGVsZXRlJztcbiAgICBwdWJsaWMgc3RhdGljIERFRkFVTFRfUFJPQ0VTU19GSUxURVJfUFJPUEVSVElFUyA9IFsnc3RhdHVzJywgJ3NvcnQnLCAnb3JkZXInLCAnbGFzdE1vZGlmaWVkJ107XG4gICAgcHVibGljIHN0YXRpYyBERUZBVUxUX1NPUlRfUFJPUEVSVElFUyA9IFsnaWQnLCAnbmFtZScsICdzdGF0dXMnLCAnc3RhcnREYXRlJ107XG4gICAgcHVibGljIHN0YXRpYyBERUZBVUxUX0FDVElPTlMgPSBbJ3NhdmUnLCAnc2F2ZUFzJywgJ2RlbGV0ZSddO1xuICAgIHB1YmxpYyBEQVRFX0ZPUk1BVDogc3RyaW5nID0gJ0REL01NL1lZWVknO1xuXG4gICAgLyoqIFRoZSBuYW1lIG9mIHRoZSBhcHBsaWNhdGlvbi4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFwcE5hbWU6IHN0cmluZyA9ICcnO1xuXG4gICAgLyoqIHJvbGVzIHRvIGZpbHRlciB0aGUgYXBwcyAqL1xuICAgIEBJbnB1dCgpXG4gICAgcm9sZTogc3RyaW5nID0gJyc7XG5cbiAgICAvKiogSWQgb2YgdGhlIHByb2Nlc3MgaW5zdGFuY2UgZmlsdGVyLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgaWQ6IHN0cmluZztcblxuICAgIC8qKiBMaXN0IG9mIHByb2Nlc3MgZmlsdGVyIHByb3BlcnRpZXMgdG8gZGlzcGxheSAqL1xuICAgIEBJbnB1dCgpXG4gICAgZmlsdGVyUHJvcGVydGllcyA9IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuREVGQVVMVF9QUk9DRVNTX0ZJTFRFUl9QUk9QRVJUSUVTO1xuXG4gICAgLyoqIExpc3Qgb2Ygc29ydCBwcm9wZXJ0aWVzIHRvIGRpc3BsYXkuICovXG4gICAgQElucHV0KClcbiAgICBzb3J0UHJvcGVydGllcyA9IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuREVGQVVMVF9TT1JUX1BST1BFUlRJRVM7XG5cbiAgICAvKiogTGlzdCBvZiBzb3J0IGFjdGlvbnMuICovXG4gICAgQElucHV0KClcbiAgICBhY3Rpb25zID0gRWRpdFByb2Nlc3NGaWx0ZXJDbG91ZENvbXBvbmVudC5ERUZBVUxUX0FDVElPTlM7XG5cbiAgICAvKiogVG9nZ2xlcyBlZGl0aW5nIG9mIHByb2Nlc3MgZmlsdGVyIGFjdGlvbnMuICovXG4gICAgQElucHV0KClcbiAgICBzaG93RmlsdGVyQWN0aW9ucyA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyBlZGl0aW5nIG9mIHRoZSBwcm9jZXNzIGZpbHRlciB0aXRsZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dUaXRsZSA9IHRydWU7XG5cbiAgICAgLyoqIFRvZ2dsZXMgdGhlIGFwcGVhcmFuY2Ugb2YgdGhlIHByb2Nlc3MgZmlsdGVyIG5hbWUgLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd1Byb2Nlc3NGaWx0ZXJOYW1lID0gdHJ1ZTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gYSBwcm9jZXNzIGluc3RhbmNlIGZpbHRlciBwcm9wZXJ0eSBjaGFuZ2VzLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGZpbHRlckNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8UHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWw+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIGEgZmlsdGVyIGFjdGlvbiBvY2N1cnMgaS5lIFNhdmUsIFNhdmVBcywgRGVsZXRlLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGFjdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8UHJvY2Vzc0ZpbHRlckFjdGlvbj4oKTtcblxuICAgIHByaXZhdGUgX2ZpbHRlcjogUHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWw7XG4gICAgcHJvdGVjdGVkIGZpbHRlckhhc0JlZW5DaGFuZ2VkID0gZmFsc2U7XG5cbiAgICBnZXQgcHJvY2Vzc0ZpbHRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbHRlcjtcbiAgICB9XG5cbiAgICBASW5wdXQoKVxuICAgIHNldCBwcm9jZXNzRmlsdGVyKHZhbHVlOiBQcm9jZXNzRmlsdGVyQ2xvdWRNb2RlbCkge1xuICAgICAgICBjb25zdCBpc0NoYW5nZWQgPSB0aGlzLmlzRmlsdGVyQ2hhbmdlZCh0aGlzLl9maWx0ZXIsIHZhbHVlKTtcblxuICAgICAgICB0aGlzLl9maWx0ZXIgPSB2YWx1ZTtcblxuICAgICAgICBpZiAodmFsdWU/LmFwcE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwTmFtZSA9IHZhbHVlLmFwcE5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodmFsdWU/LmlkKSB7XG4gICAgICAgICAgICB0aGlzLmlkID0gdmFsdWUuaWQ7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzID0gdGhpcy5jcmVhdGVBbmRGaWx0ZXJQcm9wZXJ0aWVzKCk7XG4gICAgICAgIHRoaXMucHJvY2Vzc0ZpbHRlckFjdGlvbnMgPSB0aGlzLmNyZWF0ZUFuZEZpbHRlckFjdGlvbnMoKTtcblxuICAgICAgICB0aGlzLmJ1aWxkRm9ybSh0aGlzLnByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzKTtcblxuICAgICAgICBpZiAoaXNDaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckNoYW5nZS5lbWl0KHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHN0YXR1czogQXJyYXk8RHJvcGRvd25PcHRpb24+ID0gW1xuICAgICAgICB7IHZhbHVlOiAnJywgbGFiZWw6ICdBREZfQ0xPVURfUFJPQ0VTU19GSUxURVJTLlNUQVRVUy5BTEwnIH0sXG4gICAgICAgIHsgdmFsdWU6ICdSVU5OSU5HJywgbGFiZWw6ICdBREZfQ0xPVURfUFJPQ0VTU19GSUxURVJTLlNUQVRVUy5SVU5OSU5HJyB9LFxuICAgICAgICB7IHZhbHVlOiAnU1VTUEVOREVEJywgbGFiZWw6ICdBREZfQ0xPVURfUFJPQ0VTU19GSUxURVJTLlNUQVRVUy5TVVNQRU5ERUQnIH0sXG4gICAgICAgIHsgdmFsdWU6ICdDQU5DRUxMRUQnLCBsYWJlbDogJ0FERl9DTE9VRF9QUk9DRVNTX0ZJTFRFUlMuU1RBVFVTLkNBTkNFTExFRCcgfSxcbiAgICAgICAgeyB2YWx1ZTogJ0NPTVBMRVRFRCcsIGxhYmVsOiAnQURGX0NMT1VEX1BST0NFU1NfRklMVEVSUy5TVEFUVVMuQ09NUExFVEVEJyB9XG4gICAgXTtcbiAgICBkaXJlY3Rpb25zOiBBcnJheTxEcm9wZG93bk9wdGlvbj4gPSBbXG4gICAgICAgIHsgdmFsdWU6ICdBU0MnLCBsYWJlbDogJ0FERl9DTE9VRF9QUk9DRVNTX0ZJTFRFUlMuRElSRUNUSU9OLkFTQ0VORElORycgfSxcbiAgICAgICAgeyB2YWx1ZTogJ0RFU0MnLCBsYWJlbDogJ0FERl9DTE9VRF9QUk9DRVNTX0ZJTFRFUlMuRElSRUNUSU9OLkRFU0NFTkRJTkcnIH1cbiAgICBdO1xuICAgIGFjdGlvbkRpc2FibGVkRm9yRGVmYXVsdCA9IFtcbiAgICAgICAgRWRpdFByb2Nlc3NGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fU0FWRSxcbiAgICAgICAgRWRpdFByb2Nlc3NGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fREVMRVRFXG4gICAgXTtcbiAgICBhcHBsaWNhdGlvbk5hbWVzOiBhbnlbXSA9IFtdO1xuICAgIGFsbFByb2Nlc3NEZWZpbml0aW9uTmFtZXNPcHRpb246IERyb3Bkb3duT3B0aW9uID0ge1xuICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9QUk9DRVNTX0ZJTFRFUlMuU1RBVFVTLkFMTCcsXG4gICAgICAgIHZhbHVlOiAnJ1xuICAgIH07XG4gICAgcHJvY2Vzc0RlZmluaXRpb25OYW1lczogYW55W10gPSBbXTtcbiAgICBlZGl0UHJvY2Vzc0ZpbHRlckZvcm06IEZvcm1Hcm91cDtcbiAgICBwcm9jZXNzRmlsdGVyUHJvcGVydGllczogUHJvY2Vzc0ZpbHRlclByb3BlcnRpZXNbXSA9IFtdO1xuICAgIHByb2Nlc3NGaWx0ZXJBY3Rpb25zOiBQcm9jZXNzRmlsdGVyQWN0aW9uW10gPSBbXTtcbiAgICB0b2dnbGVGaWx0ZXJBY3Rpb25zOiBib29sZWFuID0gZmFsc2U7XG4gICAgYXBwVmVyc2lvbk9wdGlvbnM6IFByb2Nlc3NGaWx0ZXJPcHRpb25zW10gPSBbXTtcbiAgICBpbml0aWF0b3JPcHRpb25zOiBJZGVudGl0eVVzZXJNb2RlbFtdID0gW107XG5cbiAgICBwcml2YXRlIG9uRGVzdHJveSQgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuICAgIGlzTG9hZGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZmlsdGVyQ2hhbmdlU3ViOiBTdWJzY3JpcHRpb247XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBmb3JtQnVpbGRlcjogRm9ybUJ1aWxkZXIsXG4gICAgICAgIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZyxcbiAgICAgICAgcHJpdmF0ZSBkYXRlQWRhcHRlcjogRGF0ZUFkYXB0ZXI8TW9tZW50PixcbiAgICAgICAgcHJpdmF0ZSB1c2VyUHJlZmVyZW5jZXNTZXJ2aWNlOiBVc2VyUHJlZmVyZW5jZXNTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHRyYW5zbGF0ZVNlcnZpY2U6IFRyYW5zbGF0aW9uU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBwcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlOiBQcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIGFwcHNQcm9jZXNzQ2xvdWRTZXJ2aWNlOiBBcHBzUHJvY2Vzc0Nsb3VkU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBwcm9jZXNzQ2xvdWRTZXJ2aWNlOiBQcm9jZXNzQ2xvdWRTZXJ2aWNlKSB7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMudXNlclByZWZlcmVuY2VzU2VydmljZVxuICAgICAgICAgICAgLnNlbGVjdChVc2VyUHJlZmVyZW5jZVZhbHVlcy5Mb2NhbGUpXG4gICAgICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUobG9jYWxlID0+IHRoaXMuZGF0ZUFkYXB0ZXIuc2V0TG9jYWxlKGxvY2FsZSkpO1xuICAgIH1cblxuICAgIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICAgICAgY29uc3QgaWQgPSBjaGFuZ2VzWydpZCddO1xuICAgICAgICBpZiAoaWQgJiYgaWQuY3VycmVudFZhbHVlICE9PSBpZC5wcmV2aW91c1ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnJldHJpZXZlUHJvY2Vzc0ZpbHRlckFuZEJ1aWxkRm9ybSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMub25EZXN0cm95JC5uZXh0KHRydWUpO1xuICAgICAgICB0aGlzLm9uRGVzdHJveSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBidWlsZEZvcm0ocHJvY2Vzc0ZpbHRlclByb3BlcnRpZXM6IFByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzW10pIHtcbiAgICAgICAgdGhpcy5lZGl0UHJvY2Vzc0ZpbHRlckZvcm0gPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHRoaXMuZ2V0Rm9ybUNvbnRyb2xzQ29uZmlnKHByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzKSk7XG4gICAgICAgIHRoaXMub25GaWx0ZXJDaGFuZ2UoKTtcbiAgICB9XG5cbiAgICBnZXRGb3JtQ29udHJvbHNDb25maWcocHJvY2Vzc0ZpbHRlclByb3BlcnRpZXM6IFByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzW10pOiBhbnkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0aWVzID0gcHJvY2Vzc0ZpbHRlclByb3BlcnRpZXMubWFwKChwcm9wZXJ0eSkgPT4ge1xuICAgICAgICAgICAgaWYgKCEhcHJvcGVydHkuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZXNDb250cm9sQ29uZmlnKHByb3BlcnR5KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgW3Byb3BlcnR5LmtleV06IHByb3BlcnR5LnZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcHJvcGVydGllcy5yZWR1Y2UoKChyZXN1bHQsIGN1cnJlbnQpID0+IE9iamVjdC5hc3NpZ24ocmVzdWx0LCBjdXJyZW50KSksIHt9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldEF0dHJpYnV0ZXNDb250cm9sQ29uZmlnKHByb3BlcnR5OiBQcm9jZXNzRmlsdGVyUHJvcGVydGllcykge1xuICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhwcm9wZXJ0eS5hdHRyaWJ1dGVzKS5yZWR1Y2UoKHJlc3VsdCwga2V5KSA9PiB7XG4gICAgICAgICAgICByZXN1bHRba2V5XSA9IHByb3BlcnR5LnZhbHVlW2tleV07XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9LCB7fSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmV0Y2hlcyBwcm9jZXNzIGluc3RhbmNlIGZpbHRlciBieSBhcHBsaWNhdGlvbiBuYW1lIGFuZCBmaWx0ZXIgaWQgYW5kIGNyZWF0ZXMgZmlsdGVyIHByb3BlcnRpZXMsIGJ1aWxkIGZvcm1cbiAgICAgKi9cbiAgICByZXRyaWV2ZVByb2Nlc3NGaWx0ZXJBbmRCdWlsZEZvcm0oKSB7XG4gICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5wcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlXG4gICAgICAgICAgICAuZ2V0RmlsdGVyQnlJZCh0aGlzLmFwcE5hbWUsIHRoaXMuaWQpXG4gICAgICAgICAgICAucGlwZShmaW5hbGl6ZSgoKSA9PiB0aGlzLmlzTG9hZGluZyA9IGZhbHNlKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVySGFzQmVlbkNoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NGaWx0ZXIgPSBuZXcgUHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWwoXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oe30sIHJlc3BvbnNlIHx8IHt9LCB0aGlzLnByb2Nlc3NGaWx0ZXIgfHwge30pXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrIHByb2Nlc3MgaW5zdGFuY2UgZmlsdGVyIGNoYW5nZXNcbiAgICAgKi9cbiAgICBvbkZpbHRlckNoYW5nZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyQ2hhbmdlU3ViKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlckNoYW5nZVN1Yi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2VTdWIgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2VTdWIgPSB0aGlzLmVkaXRQcm9jZXNzRmlsdGVyRm9ybS52YWx1ZUNoYW5nZXNcbiAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgIGRlYm91bmNlVGltZSg1MDApLFxuICAgICAgICAgICAgICAgIGZpbHRlcigoKSA9PiB0aGlzLmlzRm9ybVZhbGlkKCkpLFxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChmb3JtVmFsdWVzOiBQcm9jZXNzRmlsdGVyQ2xvdWRNb2RlbCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0TGFzdE1vZGlmaWVkVG9GaWx0ZXIoZm9ybVZhbHVlcyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBuZXdWYWx1ZSA9IG5ldyBQcm9jZXNzRmlsdGVyQ2xvdWRNb2RlbChPYmplY3QuYXNzaWduKHt9LCB0aGlzLnByb2Nlc3NGaWx0ZXIsIGZvcm1WYWx1ZXMpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VkID0gIXRoaXMuY29tcGFyZUZpbHRlcnMobmV3VmFsdWUsIHRoaXMucHJvY2Vzc0ZpbHRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJIYXNCZWVuQ2hhbmdlZCA9IGNoYW5nZWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoY2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maWx0ZXIgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJDaGFuZ2UuZW1pdChuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY3JlYXRlQW5kRmlsdGVyUHJvcGVydGllcygpOiBQcm9jZXNzRmlsdGVyUHJvcGVydGllc1tdIHtcbiAgICAgICAgdGhpcy5jaGVja01hbmRhdG9yeUZpbHRlclByb3BlcnRpZXMoKTtcblxuICAgICAgICBpZiAodGhpcy5maWx0ZXJQcm9wZXJ0aWVzLmluY2x1ZGVzKCdhcHBOYW1lJykpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0UnVubmluZ0FwcGxpY2F0aW9ucygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyUHJvcGVydGllcy5pbmNsdWRlcygncHJvY2Vzc0RlZmluaXRpb25OYW1lJykpIHtcbiAgICAgICAgICAgIHRoaXMuZ2V0UHJvY2Vzc0RlZmluaXRpb25zKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5maWx0ZXJQcm9wZXJ0aWVzLmluY2x1ZGVzKCdhcHBWZXJzaW9uTXVsdGlwbGUnKSkge1xuICAgICAgICAgICAgdGhpcy5nZXRBcHBWZXJzaW9uT3B0aW9ucygpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyUHJvcGVydGllcy5pbmNsdWRlcygnaW5pdGlhdG9yJykpIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhdG9yT3B0aW9ucyA9ICEhdGhpcy5wcm9jZXNzRmlsdGVyLmluaXRpYXRvclxuICAgICAgICAgICAgICAgID8gdGhpcy5wcm9jZXNzRmlsdGVyLmluaXRpYXRvci5zcGxpdCgnLCcpLm1hcCggdXNlcm5hbWUgPT4gT2JqZWN0LmFzc2lnbih7fSwgeyB1c2VybmFtZTogdXNlcm5hbWUgfSkpXG4gICAgICAgICAgICAgICAgOiBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9wZXJ0aWVzID0gdGhpcy5jcmVhdGVQcm9jZXNzRmlsdGVyUHJvcGVydGllcyh0aGlzLnByb2Nlc3NGaWx0ZXIpO1xuICAgICAgICBsZXQgZmlsdGVyZWRQcm9wZXJ0aWVzID0gZGVmYXVsdFByb3BlcnRpZXMuZmlsdGVyKChmaWx0ZXJQcm9wZXJ0eSkgPT4gdGhpcy5pc1ZhbGlkUHJvcGVydHkodGhpcy5maWx0ZXJQcm9wZXJ0aWVzLCBmaWx0ZXJQcm9wZXJ0eS5rZXkpKTtcblxuICAgICAgICBpZiAoIXRoaXMuZmlsdGVyUHJvcGVydGllcy5pbmNsdWRlcygnc29ydCcpKSB7XG4gICAgICAgICAgICBmaWx0ZXJlZFByb3BlcnRpZXMgPSBmaWx0ZXJlZFByb3BlcnRpZXMuZmlsdGVyKHByb3BlcnR5ID0+IHByb3BlcnR5LmtleSAhPT0gJ29yZGVyJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5maWx0ZXJQcm9wZXJ0aWVzLmluY2x1ZGVzKCdsYXN0TW9kaWZpZWQnKSkge1xuICAgICAgICAgICAgZmlsdGVyZWRQcm9wZXJ0aWVzID0gW1xuICAgICAgICAgICAgICAgIC4uLmZpbHRlcmVkUHJvcGVydGllcyxcbiAgICAgICAgICAgICAgICAuLi50aGlzLmNyZWF0ZUxhc3RNb2RpZmllZFByb3BlcnR5KHRoaXMucHJvY2Vzc0ZpbHRlcilcbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmlsdGVyZWRQcm9wZXJ0aWVzO1xuICAgIH1cblxuICAgIGNoZWNrTWFuZGF0b3J5RmlsdGVyUHJvcGVydGllcygpIHtcbiAgICAgICAgaWYgKHRoaXMuZmlsdGVyUHJvcGVydGllcyA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuZmlsdGVyUHJvcGVydGllcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyUHJvcGVydGllcyA9IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuREVGQVVMVF9QUk9DRVNTX0ZJTFRFUl9QUk9QRVJUSUVTO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc1ZhbGlkUHJvcGVydHkoZmlsdGVyUHJvcGVydGllczogc3RyaW5nW10sIGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBmaWx0ZXJQcm9wZXJ0aWVzID8gZmlsdGVyUHJvcGVydGllcy5pbmRleE9mKGtleSkgPj0gMCA6IHRydWU7XG4gICAgfVxuXG4gICAgZ2V0IGNyZWF0ZVNvcnRQcm9wZXJ0aWVzKCk6IFByb2Nlc3NGaWx0ZXJPcHRpb25zW10ge1xuICAgICAgICB0aGlzLmNoZWNrTWFuZGF0b3J5U29ydFByb3BlcnRpZXMoKTtcbiAgICAgICAgY29uc3QgZGVmYXVsdFNvcnRQcm9wZXJ0aWVzID0gdGhpcy5jcmVhdGVQcm9jZXNzU29ydFByb3BlcnRpZXMoKTtcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRTb3J0UHJvcGVydGllcy5maWx0ZXIoKHNvcnRQcm9wZXJ0eSkgPT4gdGhpcy5pc1ZhbGlkUHJvcGVydHkodGhpcy5zb3J0UHJvcGVydGllcywgc29ydFByb3BlcnR5LmtleSkpO1xuICAgIH1cblxuICAgIGdldEFwcFZlcnNpb25PcHRpb25zKCkge1xuICAgICAgICB0aGlzLmFwcFZlcnNpb25PcHRpb25zID0gW107XG5cbiAgICAgICAgdGhpcy5wcm9jZXNzQ2xvdWRTZXJ2aWNlLmdldEFwcGxpY2F0aW9uVmVyc2lvbnModGhpcy5hcHBOYW1lKS5zdWJzY3JpYmUoKGFwcFZlcnNpb25zKSA9PiB7XG4gICAgICAgICAgICBhcHBWZXJzaW9ucy5mb3JFYWNoKGFwcFZlcnNpb24gPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwVmVyc2lvbk9wdGlvbnMucHVzaCh7IGxhYmVsOiBhcHBWZXJzaW9uLmVudHJ5LnZlcnNpb24sIHZhbHVlOiBhcHBWZXJzaW9uLmVudHJ5LnZlcnNpb24gfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY2hlY2tNYW5kYXRvcnlTb3J0UHJvcGVydGllcygpIHtcbiAgICAgICAgaWYgKHRoaXMuc29ydFByb3BlcnRpZXMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLnNvcnRQcm9wZXJ0aWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhpcy5zb3J0UHJvcGVydGllcyA9IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuREVGQVVMVF9TT1JUX1BST1BFUlRJRVM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjcmVhdGVBbmRGaWx0ZXJBY3Rpb25zKCkge1xuICAgICAgICB0aGlzLmNoZWNrTWFuZGF0b3J5QWN0aW9ucygpO1xuICAgICAgICBjb25zdCBhY3Rpb25zID0gdGhpcy5jcmVhdGVGaWx0ZXJBY3Rpb25zKCk7XG4gICAgICAgIHJldHVybiBhY3Rpb25zLmZpbHRlcigoYWN0aW9uKSA9PiB0aGlzLmlzVmFsaWRBY3Rpb24odGhpcy5hY3Rpb25zLCBhY3Rpb24pKTtcbiAgICB9XG5cbiAgICBjaGVja01hbmRhdG9yeUFjdGlvbnMoKSB7XG4gICAgICAgIGlmICh0aGlzLmFjdGlvbnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLmFjdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmFjdGlvbnMgPSBFZGl0UHJvY2Vzc0ZpbHRlckNsb3VkQ29tcG9uZW50LkRFRkFVTFRfQUNUSU9OUztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaXNWYWxpZEFjdGlvbihhY3Rpb25zOiBzdHJpbmdbXSwgYWN0aW9uOiBQcm9jZXNzRmlsdGVyQWN0aW9uKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBhY3Rpb25zID8gYWN0aW9ucy5pbmRleE9mKGFjdGlvbi5hY3Rpb25UeXBlKSA+PSAwIDogdHJ1ZTtcbiAgICB9XG5cbiAgICBpc0Zvcm1WYWxpZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdFByb2Nlc3NGaWx0ZXJGb3JtLnZhbGlkO1xuICAgIH1cblxuICAgIGdldFByb3BlcnR5Q29udHJvbGxlcihwcm9wZXJ0eTogUHJvY2Vzc0ZpbHRlclByb3BlcnRpZXMpOiBBYnN0cmFjdENvbnRyb2wge1xuICAgICAgICByZXR1cm4gdGhpcy5lZGl0UHJvY2Vzc0ZpbHRlckZvcm0uZ2V0KHByb3BlcnR5LmtleSk7XG4gICAgfVxuXG4gICAgb25EYXRlQ2hhbmdlZChuZXdEYXRlVmFsdWU6IE1vbWVudCwgZGF0ZVByb3BlcnR5OiBQcm9jZXNzRmlsdGVyUHJvcGVydGllcykge1xuICAgICAgICBpZiAobmV3RGF0ZVZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gdGhpcy5nZXRQcm9wZXJ0eUNvbnRyb2xsZXIoZGF0ZVByb3BlcnR5KTtcblxuICAgICAgICAgICAgaWYgKG5ld0RhdGVWYWx1ZS5pc1ZhbGlkKCkpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNldFZhbHVlKG5ld0RhdGVWYWx1ZSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5zZXRFcnJvcnMobnVsbCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2V0RXJyb3JzKHsgaW52YWxpZDogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uRGF0ZVR5cGVDaGFuZ2UoZGF0ZVR5cGU6IERhdGVDbG91ZEZpbHRlclR5cGUsIHByb3BlcnR5OiBQcm9jZXNzRmlsdGVyUHJvcGVydGllcykge1xuICAgICAgICB0aGlzLmVkaXRQcm9jZXNzRmlsdGVyRm9ybS5nZXQocHJvcGVydHkuYXR0cmlidXRlcy5kYXRlVHlwZSkuc2V0VmFsdWUoZGF0ZVR5cGUpO1xuICAgIH1cblxuICAgIG9uRGF0ZVJhbmdlRmlsdGVyQ2hhbmdlZChkYXRlUmFuZ2U6IERhdGVSYW5nZUZpbHRlciwgcHJvcGVydHk6IFByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzKSB7XG4gICAgICAgIHRoaXMuZWRpdFByb2Nlc3NGaWx0ZXJGb3JtLmdldChwcm9wZXJ0eS5hdHRyaWJ1dGVzPy5mcm9tKS5zZXRWYWx1ZShcbiAgICAgICAgICAgIGRhdGVSYW5nZS5zdGFydERhdGUgPyBkYXRlUmFuZ2Uuc3RhcnREYXRlIDogbnVsbFxuICAgICAgICApO1xuICAgICAgICB0aGlzLmVkaXRQcm9jZXNzRmlsdGVyRm9ybS5nZXQocHJvcGVydHkuYXR0cmlidXRlcz8udG8pLnNldFZhbHVlKFxuICAgICAgICAgICAgZGF0ZVJhbmdlLmVuZERhdGUgPyBkYXRlUmFuZ2UuZW5kRGF0ZSA6IG51bGxcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5lZGl0UHJvY2Vzc0ZpbHRlckZvcm0uZ2V0KHByb3BlcnR5LmF0dHJpYnV0ZXMuZGF0ZVR5cGUpLnNldFZhbHVlKERhdGVDbG91ZEZpbHRlclR5cGUuUkFOR0UpO1xuICAgIH1cblxuICAgIG9uQ2hhbmdlZFVzZXIodXNlcnM6IElkZW50aXR5VXNlck1vZGVsW10sIHByb2Nlc3NQcm9wZXJ0eTogUHJvY2Vzc0ZpbHRlclByb3BlcnRpZXMpIHtcbiAgICAgICAgdGhpcy5nZXRQcm9wZXJ0eUNvbnRyb2xsZXIocHJvY2Vzc1Byb3BlcnR5KS5zZXRWYWx1ZSh1c2Vycy5tYXAoIHVzZXIgPT4gdXNlci51c2VybmFtZSkuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBoYXNFcnJvcihwcm9wZXJ0eTogUHJvY2Vzc0ZpbHRlclByb3BlcnRpZXMpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IHRoaXMuZ2V0UHJvcGVydHlDb250cm9sbGVyKHByb3BlcnR5KTtcbiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXIuZXJyb3JzICYmIGNvbnRyb2xsZXIuZXJyb3JzLmludmFsaWQ7XG4gICAgfVxuXG4gICAgY29tcGFyZUZpbHRlcnMoZWRpdGVkUXVlcnk6IFByb2Nlc3NGaWx0ZXJDbG91ZE1vZGVsLCBjdXJyZW50UXVlcnk6IFByb2Nlc3NGaWx0ZXJDbG91ZE1vZGVsKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShlZGl0ZWRRdWVyeSkudG9Mb3dlckNhc2UoKSA9PT0gSlNPTi5zdHJpbmdpZnkoY3VycmVudFF1ZXJ5KS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIGdldFJ1bm5pbmdBcHBsaWNhdGlvbnMoKSB7XG4gICAgICAgIHRoaXMuYXBwbGljYXRpb25OYW1lcyA9IFtdO1xuXG4gICAgICAgIHRoaXMuYXBwc1Byb2Nlc3NDbG91ZFNlcnZpY2VcbiAgICAgICAgICAgIC5nZXREZXBsb3llZEFwcGxpY2F0aW9uc0J5U3RhdHVzKCdSVU5OSU5HJywgdGhpcy5yb2xlKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoYXBwbGljYXRpb25zKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGFwcGxpY2F0aW9ucyAmJiBhcHBsaWNhdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbnMubWFwKChhcHBsaWNhdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBsaWNhdGlvbk5hbWVzLnB1c2goeyBsYWJlbDogYXBwbGljYXRpb24ubmFtZSwgdmFsdWU6IGFwcGxpY2F0aW9uLm5hbWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldFByb2Nlc3NEZWZpbml0aW9ucygpIHtcbiAgICAgICAgdGhpcy5wcm9jZXNzRGVmaW5pdGlvbk5hbWVzID0gW107XG5cbiAgICAgICAgdGhpcy5wcm9jZXNzQ2xvdWRTZXJ2aWNlLmdldFByb2Nlc3NEZWZpbml0aW9ucyh0aGlzLmFwcE5hbWUpLnN1YnNjcmliZSgocHJvY2Vzc0RlZmluaXRpb25zKSA9PiB7XG4gICAgICAgICAgICBpZiAocHJvY2Vzc0RlZmluaXRpb25zICYmIHByb2Nlc3NEZWZpbml0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzRGVmaW5pdGlvbk5hbWVzLnB1c2godGhpcy5hbGxQcm9jZXNzRGVmaW5pdGlvbk5hbWVzT3B0aW9uKTtcbiAgICAgICAgICAgICAgICBwcm9jZXNzRGVmaW5pdGlvbnMubWFwKChwcm9jZXNzRGVmaW5pdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NEZWZpbml0aW9uTmFtZXMucHVzaCh7IGxhYmVsOiBwcm9jZXNzRGVmaW5pdGlvbi5uYW1lLCB2YWx1ZTogcHJvY2Vzc0RlZmluaXRpb24ubmFtZSB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZXhlY3V0ZUZpbHRlckFjdGlvbnMoYWN0aW9uOiBQcm9jZXNzRmlsdGVyQWN0aW9uKTogdm9pZCB7XG4gICAgICAgIGlmIChhY3Rpb24uYWN0aW9uVHlwZSA9PT0gRWRpdFByb2Nlc3NGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fU0FWRSkge1xuICAgICAgICAgICAgdGhpcy5zYXZlKGFjdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLmFjdGlvblR5cGUgPT09IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX1NBVkVfQVMpIHtcbiAgICAgICAgICAgIHRoaXMuc2F2ZUFzKGFjdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoYWN0aW9uLmFjdGlvblR5cGUgPT09IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX0RFTEVURSkge1xuICAgICAgICAgICAgdGhpcy5kZWxldGUoYWN0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNhdmUoc2F2ZUFjdGlvbjogUHJvY2Vzc0ZpbHRlckFjdGlvbikge1xuICAgICAgICB0aGlzLnByb2Nlc3NGaWx0ZXJDbG91ZFNlcnZpY2VcbiAgICAgICAgICAgIC51cGRhdGVGaWx0ZXIodGhpcy5wcm9jZXNzRmlsdGVyKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2F2ZUFjdGlvbi5maWx0ZXIgPSB0aGlzLnByb2Nlc3NGaWx0ZXI7XG4gICAgICAgICAgICAgICAgdGhpcy5maWx0ZXJIYXNCZWVuQ2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uLmVtaXQoc2F2ZUFjdGlvbik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgYSBwcm9jZXNzIGluc3RhbmNlIGZpbHRlclxuICAgICAqL1xuICAgIGRlbGV0ZShkZWxldGVBY3Rpb246IFByb2Nlc3NGaWx0ZXJBY3Rpb24pIHtcbiAgICAgICAgdGhpcy5wcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlXG4gICAgICAgICAgICAuZGVsZXRlRmlsdGVyKHRoaXMucHJvY2Vzc0ZpbHRlcilcbiAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgIGZpbHRlcigoZmlsdGVycykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVBY3Rpb24uZmlsdGVyID0gdGhpcy5wcm9jZXNzRmlsdGVyO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbi5lbWl0KGRlbGV0ZUFjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWx0ZXJzLmxlbmd0aCA9PT0gMDtcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBzd2l0Y2hNYXAoKCkgPT4gdGhpcy5yZXN0b3JlRGVmYXVsdFByb2Nlc3NGaWx0ZXJzKCkpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgoKSA9PiB7fSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSBBcyBhIHByb2Nlc3MgaW5zdGFuY2UgZmlsdGVyXG4gICAgICovXG4gICAgc2F2ZUFzKHNhdmVBc0FjdGlvbjogUHJvY2Vzc0ZpbHRlckFjdGlvbikge1xuICAgICAgICBjb25zdCBkaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKFByb2Nlc3NGaWx0ZXJEaWFsb2dDbG91ZENvbXBvbmVudCwge1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMudHJhbnNsYXRlU2VydmljZS5pbnN0YW50KHRoaXMucHJvY2Vzc0ZpbHRlci5uYW1lKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhlaWdodDogJ2F1dG8nLFxuICAgICAgICAgICAgbWluV2lkdGg6ICczMCUnXG4gICAgICAgIH0pO1xuICAgICAgICBkaWFsb2dSZWYuYWZ0ZXJDbG9zZWQoKS5zdWJzY3JpYmUoKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQuYWN0aW9uID09PSBQcm9jZXNzRmlsdGVyRGlhbG9nQ2xvdWRDb21wb25lbnQuQUNUSU9OX1NBVkUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJJZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWx0ZXJLZXkgPSB0aGlzLmdldFNhbml0aXplRmlsdGVyTmFtZShyZXN1bHQubmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RmlsdGVyID0ge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiByZXN1bHQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogcmVzdWx0Lmljb24sXG4gICAgICAgICAgICAgICAgICAgIGlkOiBmaWx0ZXJJZCxcbiAgICAgICAgICAgICAgICAgICAga2V5OiAnY3VzdG9tLScgKyBmaWx0ZXJLZXlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdEZpbHRlcjogUHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWwgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnByb2Nlc3NGaWx0ZXIsIG5ld0ZpbHRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlXG4gICAgICAgICAgICAgICAgICAgIC5hZGRGaWx0ZXIocmVzdWx0RmlsdGVyKVxuICAgICAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhdmVBc0FjdGlvbi5maWx0ZXIgPSByZXN1bHRGaWx0ZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbHRlckhhc0JlZW5DaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbi5lbWl0KHNhdmVBc0FjdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gZmlsdGVyIG5hbWVcbiAgICAgKiBAcGFyYW0gZmlsdGVyTmFtZVxuICAgICAqL1xuICAgIGdldFNhbml0aXplRmlsdGVyTmFtZShmaWx0ZXJOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBuYW1lV2l0aEh5cGhlbiA9IHRoaXMucmVwbGFjZVNwYWNlV2l0aEh5cGhlbihmaWx0ZXJOYW1lLnRyaW0oKSk7XG4gICAgICAgIHJldHVybiBuYW1lV2l0aEh5cGhlbi50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBuYW1lIHdpdGggaHlwaGVuXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICByZXBsYWNlU3BhY2VXaXRoSHlwaGVuKG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHJlZ0V4dCA9IG5ldyBSZWdFeHAoJyAnLCAnZycpO1xuICAgICAgICByZXR1cm4gbmFtZS5yZXBsYWNlKHJlZ0V4dCwgJy0nKTtcbiAgICB9XG5cbiAgICByZXN0b3JlRGVmYXVsdFByb2Nlc3NGaWx0ZXJzKCk6IE9ic2VydmFibGU8UHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWxbXT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlLmdldFByb2Nlc3NGaWx0ZXJzKHRoaXMuYXBwTmFtZSk7XG4gICAgfVxuXG4gICAgb25FeHBhbmQoKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlRmlsdGVyQWN0aW9ucyA9IHRydWU7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgdGhpcy50b2dnbGVGaWx0ZXJBY3Rpb25zID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaXNEaXNhYmxlZEFjdGlvbihhY3Rpb246IFByb2Nlc3NGaWx0ZXJBY3Rpb24pOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc0ZpbHRlckNsb3VkU2VydmljZS5pc0RlZmF1bHRGaWx0ZXIodGhpcy5wcm9jZXNzRmlsdGVyLm5hbWUpICYmXG4gICAgICAgICAgICB0aGlzLmFjdGlvbkRpc2FibGVkRm9yRGVmYXVsdC5pbmNsdWRlcyhhY3Rpb24uYWN0aW9uVHlwZSlcbiAgICAgICAgKSA/IHRydWUgOiB0aGlzLmhhc0ZpbHRlckNoYW5nZWQoYWN0aW9uKTtcbiAgICB9XG5cbiAgICBoYXNGaWx0ZXJDaGFuZ2VkKGFjdGlvbjogUHJvY2Vzc0ZpbHRlckFjdGlvbik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gYWN0aW9uLmFjdGlvblR5cGUgPT09IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX1NBVkUgfHxcbiAgICAgICAgICAgIGFjdGlvbi5hY3Rpb25UeXBlID09PSBFZGl0UHJvY2Vzc0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9TQVZFX0FTID9cbiAgICAgICAgICAgICF0aGlzLmZpbHRlckhhc0JlZW5DaGFuZ2VkIDogZmFsc2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRMYXN0TW9kaWZpZWRUb0ZpbHRlcihmb3JtVmFsdWVzOiBQcm9jZXNzRmlsdGVyQ2xvdWRNb2RlbCkge1xuICAgICAgICBpZiAoZm9ybVZhbHVlcy5sYXN0TW9kaWZpZWRUbyAmJiBEYXRlLnBhcnNlKGZvcm1WYWx1ZXMubGFzdE1vZGlmaWVkVG8udG9TdHJpbmcoKSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RNb2RpZmllZFRvRmlsdGVyVmFsdWUgPSBtb21lbnQoZm9ybVZhbHVlcy5sYXN0TW9kaWZpZWRUbyk7XG4gICAgICAgICAgICBsYXN0TW9kaWZpZWRUb0ZpbHRlclZhbHVlLnNldCh7XG4gICAgICAgICAgICAgICAgaG91cjogMjMsXG4gICAgICAgICAgICAgICAgbWludXRlOiA1OSxcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IDU5XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvcm1WYWx1ZXMubGFzdE1vZGlmaWVkVG8gPSBsYXN0TW9kaWZpZWRUb0ZpbHRlclZhbHVlLnRvRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVGaWx0ZXJBY3Rpb25zKCk6IFByb2Nlc3NGaWx0ZXJBY3Rpb25bXSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYWN0aW9uVHlwZTogRWRpdFByb2Nlc3NGaWx0ZXJDbG91ZENvbXBvbmVudC5BQ1RJT05fU0FWRSxcbiAgICAgICAgICAgICAgICBpY29uOiAnYWRmOnNhdmUnLFxuICAgICAgICAgICAgICAgIHRvb2x0aXA6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5UT09MX1RJUC5TQVZFJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhY3Rpb25UeXBlOiBFZGl0UHJvY2Vzc0ZpbHRlckNsb3VkQ29tcG9uZW50LkFDVElPTl9TQVZFX0FTLFxuICAgICAgICAgICAgICAgIGljb246ICdhZGY6c2F2ZS1hcycsXG4gICAgICAgICAgICAgICAgdG9vbHRpcDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLlRPT0xfVElQLlNBVkVfQVMnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGFjdGlvblR5cGU6IEVkaXRQcm9jZXNzRmlsdGVyQ2xvdWRDb21wb25lbnQuQUNUSU9OX0RFTEVURSxcbiAgICAgICAgICAgICAgICBpY29uOiAnZGVsZXRlJyxcbiAgICAgICAgICAgICAgICB0b29sdGlwOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuVE9PTF9USVAuREVMRVRFJ1xuICAgICAgICAgICAgfVxuICAgICAgICBdO1xuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlTGFzdE1vZGlmaWVkUHJvcGVydHkoZmlsdGVyTW9kZWw6IFByb2Nlc3NGaWx0ZXJDbG91ZE1vZGVsKTogUHJvY2Vzc0ZpbHRlclByb3BlcnRpZXNbXSB7XG4gICAgICAgIGxldCBsYXN0TW9kaWZpZWRGcm9tO1xuICAgICAgICBsZXQgbGFzdE1vZGlmaWVkVG87XG5cbiAgICAgICAgaWYgKGZpbHRlck1vZGVsLmxhc3RNb2RpZmllZEZyb20pIHtcbiAgICAgICAgICAgIGxhc3RNb2RpZmllZEZyb20gPSBtb21lbnQoZmlsdGVyTW9kZWwubGFzdE1vZGlmaWVkRnJvbSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZmlsdGVyTW9kZWwubGFzdE1vZGlmaWVkVG8pIHtcbiAgICAgICAgICAgIGxhc3RNb2RpZmllZFRvID0gbW9tZW50KGZpbHRlck1vZGVsLmxhc3RNb2RpZmllZFRvKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5MQVNUX01PRElGSUVEX0RBVEVfRk9STScsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2RhdGUnLFxuICAgICAgICAgICAgICAgIGtleTogJ2xhc3RNb2RpZmllZEZyb20nLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBsYXN0TW9kaWZpZWRGcm9tXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuTEFTVF9NT0RJRklFRF9UTycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2RhdGUnLFxuICAgICAgICAgICAgICAgIGtleTogJ2xhc3RNb2RpZmllZFRvJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogbGFzdE1vZGlmaWVkVG9cbiAgICAgICAgICAgIH1cbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVByb2Nlc3NTb3J0UHJvcGVydGllcygpOiBQcm9jZXNzU29ydEZpbHRlclByb3BlcnR5W10ge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuSUQnLFxuICAgICAgICAgICAgICAgIGtleTogJ2lkJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogJ2lkJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlBST0NFU1NfTkFNRScsXG4gICAgICAgICAgICAgICAga2V5OiAnbmFtZScsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICduYW1lJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlNUQVJUX0RBVEUnLFxuICAgICAgICAgICAgICAgIGtleTogJ3N0YXJ0RGF0ZScsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdzdGFydERhdGUnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuU1RBVFVTJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdzdGF0dXMnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAnc3RhdHVzJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlNUQVJURURfQlknLFxuICAgICAgICAgICAgICAgIGtleTogJ2luaXRpYXRvcicsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdpbml0aWF0b3InXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuQVBQX05BTUUnLFxuICAgICAgICAgICAgICAgIGtleTogJ2FwcE5hbWUnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAnYXBwTmFtZSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5BUFBfVkVSU0lPTicsXG4gICAgICAgICAgICAgICAga2V5OiAnYXBwVmVyc2lvbicsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdhcHBWZXJzaW9uJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlBST0NFU1NfSU5TX0lEJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdwcm9jZXNzSW5zdGFuY2VJZCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdwcm9jZXNzSW5zdGFuY2VJZCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5QUk9DRVNTX0RFRl9JRCcsXG4gICAgICAgICAgICAgICAga2V5OiAncHJvY2Vzc0RlZmluaXRpb25JZCcsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdwcm9jZXNzRGVmaW5pdGlvbklkJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlBST0NFU1NfREVGX05BTUUnLFxuICAgICAgICAgICAgICAgIGtleTogJ3Byb2Nlc3NEZWZpbml0aW9uTmFtZScsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdwcm9jZXNzRGVmaW5pdGlvbk5hbWUnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuUFJPQ0VTU19ERUZfS0VZJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdwcm9jZXNzRGVmaW5pdGlvbktleScsXG4gICAgICAgICAgICAgICAgdmFsdWU6ICdwcm9jZXNzRGVmaW5pdGlvbktleSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5MQVNUX01PRElGSUVEJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdsYXN0TW9kaWZpZWQnLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAnbGFzdE1vZGlmaWVkJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLkJVU0lORVNTX0tFWScsXG4gICAgICAgICAgICAgICAga2V5OiAnYnVzaW5lc3NLZXknLFxuICAgICAgICAgICAgICAgIHZhbHVlOiAnYnVzaW5lc3NLZXknXG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0ZpbHRlckNoYW5nZWQob2xkVmFsdWU6IFByb2Nlc3NGaWx0ZXJDbG91ZE1vZGVsLCBuZXdWYWx1ZTogUHJvY2Vzc0ZpbHRlckNsb3VkTW9kZWwpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3Qgb2xkSnNvbiA9IEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlLndyaXRlUXVlcnlQYXJhbXMob2xkVmFsdWUgfHwge30sIHRoaXMuZmlsdGVyUHJvcGVydGllcylcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgbmV3SnNvbiA9IEpTT04uc3RyaW5naWZ5KFxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzRmlsdGVyQ2xvdWRTZXJ2aWNlLndyaXRlUXVlcnlQYXJhbXMobmV3VmFsdWUgfHwge30sIHRoaXMuZmlsdGVyUHJvcGVydGllcylcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gb2xkSnNvbiAhPT0gbmV3SnNvbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzKGZpbHRlck1vZGVsOiBQcm9jZXNzRmlsdGVyQ2xvdWRNb2RlbCk6IFByb2Nlc3NGaWx0ZXJQcm9wZXJ0aWVzW10ge1xuICAgICAgICBjb25zdCBhcHBWZXJzaW9uTXVsdGlwbGUgPSBbXTtcblxuICAgICAgICBpZiAoZmlsdGVyTW9kZWwuYXBwVmVyc2lvbikge1xuICAgICAgICAgICAgYXBwVmVyc2lvbk11bHRpcGxlLnB1c2goXG4gICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheShmaWx0ZXJNb2RlbC5hcHBWZXJzaW9uKVxuICAgICAgICAgICAgICAgICAgICA/IGZpbHRlck1vZGVsLmFwcFZlcnNpb24ubWFwKGVudHJ5ID0+IGVudHJ5LnRvU3RyaW5nKCkpXG4gICAgICAgICAgICAgICAgICAgIDogYCR7ZmlsdGVyTW9kZWwuYXBwVmVyc2lvbn1gXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLkFQUF9OQU1FJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICAgICAgICAgICAgICBrZXk6ICdhcHBOYW1lJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwuYXBwTmFtZSB8fCAnJyxcbiAgICAgICAgICAgICAgICBvcHRpb25zOiB0aGlzLmFwcGxpY2F0aW9uTmFtZXNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5BUFBfVkVSU0lPTicsXG4gICAgICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICAgICAga2V5OiAnYXBwVmVyc2lvbicsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGZpbHRlck1vZGVsLmFwcFZlcnNpb25cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5BUFBfVkVSU0lPTicsXG4gICAgICAgICAgICAgICAgdHlwZTogJ211bHRpLXNlbGVjdCcsXG4gICAgICAgICAgICAgICAga2V5OiAnYXBwVmVyc2lvbk11bHRpcGxlJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogYXBwVmVyc2lvbk11bHRpcGxlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuYXBwVmVyc2lvbk9wdGlvbnNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5QUk9DRVNTX0lOU19JRCcsXG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgIGtleTogJ3Byb2Nlc3NJbnN0YW5jZUlkJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwucHJvY2Vzc0luc3RhbmNlSWQgfHwgJydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5QUk9DRVNTX05BTUUnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICBrZXk6ICdwcm9jZXNzTmFtZScsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGZpbHRlck1vZGVsLnByb2Nlc3NOYW1lIHx8ICcnXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuUFJPQ0VTU19ERUZfTkFNRScsXG4gICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAga2V5OiAncHJvY2Vzc0RlZmluaXRpb25OYW1lJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwucHJvY2Vzc0RlZmluaXRpb25OYW1lIHx8ICcnLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMucHJvY2Vzc0RlZmluaXRpb25OYW1lc1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlNUQVRVUycsXG4gICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdCcsXG4gICAgICAgICAgICAgICAga2V5OiAnc3RhdHVzJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwuc3RhdHVzIHx8IHRoaXMuc3RhdHVzWzBdLnZhbHVlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuc3RhdHVzXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuUFJPQ0VTU19ERUZfSUQnLFxuICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcbiAgICAgICAgICAgICAgICBrZXk6ICdwcm9jZXNzRGVmaW5pdGlvbklkJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwucHJvY2Vzc0RlZmluaXRpb25JZCB8fCAnJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlBST0NFU1NfREVGX0tFWScsXG4gICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgICAgICAgICAgIGtleTogJ3Byb2Nlc3NEZWZpbml0aW9uS2V5JyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwucHJvY2Vzc0RlZmluaXRpb25LZXkgfHwgJydcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5TT1JUJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICAgICAgICAgICAgICBrZXk6ICdzb3J0JyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwuc29ydCB8fCB0aGlzLmNyZWF0ZVNvcnRQcm9wZXJ0aWVzWzBdLnZhbHVlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuY3JlYXRlU29ydFByb3BlcnRpZXNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5ESVJFQ1RJT04nLFxuICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLFxuICAgICAgICAgICAgICAgIGtleTogJ29yZGVyJyxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsdGVyTW9kZWwub3JkZXIgfHwgdGhpcy5kaXJlY3Rpb25zWzBdLnZhbHVlLFxuICAgICAgICAgICAgICAgIG9wdGlvbnM6IHRoaXMuZGlyZWN0aW9uc1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLkNPTVBMRVRFRF9EQVRFJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZScsXG4gICAgICAgICAgICAgICAga2V5OiAnY29tcGxldGVkRGF0ZScsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGZpbHRlck1vZGVsLmNvbXBsZXRlZERhdGUgfHwgZmFsc2VcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdBREZfQ0xPVURfRURJVF9QUk9DRVNTX0ZJTFRFUi5MQUJFTC5TVEFSVEVEX0JZJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAncGVvcGxlJyxcbiAgICAgICAgICAgICAgICBrZXk6ICdpbml0aWF0b3InLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBmaWx0ZXJNb2RlbC5pbml0aWF0b3IsXG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uTW9kZTogJ211bHRpcGxlJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLkNPTVBMRVRFRF9EQVRFJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZS1yYW5nZScsXG4gICAgICAgICAgICAgICAga2V5OiAnY29tcGxldGVkRGF0ZVJhbmdlJyxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7IGRhdGVUeXBlOiAnY29tcGxldGVkRGF0ZVR5cGUnLCBmcm9tOiAnX2NvbXBsZXRlZEZyb20nLCB0bzogJ19jb21wbGV0ZWRUbyd9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZERhdGVUeXBlOiBmaWx0ZXJNb2RlbC5jb21wbGV0ZWREYXRlVHlwZSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBfY29tcGxldGVkRnJvbTogZmlsdGVyTW9kZWwuY29tcGxldGVkRnJvbSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBfY29tcGxldGVkVG86IGZpbHRlck1vZGVsLmNvbXBsZXRlZFRvIHx8IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQURGX0NMT1VEX0VESVRfUFJPQ0VTU19GSUxURVIuTEFCRUwuU1RBUlRFRF9EQVRFJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZS1yYW5nZScsXG4gICAgICAgICAgICAgICAga2V5OiAnc3RhcnRlZERhdGVSYW5nZScsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogeyBkYXRlVHlwZTogJ3N0YXJ0ZWREYXRlVHlwZScsIGZyb206ICdfc3RhcnRGcm9tJywgdG86ICdfc3RhcnRUbyd9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0ZWREYXRlVHlwZTogZmlsdGVyTW9kZWwuc3RhcnRlZERhdGVUeXBlIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIF9zdGFydEZyb206IGZpbHRlck1vZGVsLnN0YXJ0RnJvbSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBfc3RhcnRUbzogZmlsdGVyTW9kZWwuc3RhcnRUbyB8fCBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0FERl9DTE9VRF9FRElUX1BST0NFU1NfRklMVEVSLkxBQkVMLlNVU1BFTkRFRF9EQVRFJyxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGF0ZS1yYW5nZScsXG4gICAgICAgICAgICAgICAga2V5OiAnc3VzcGVuZGVkRGF0ZVJhbmdlJyxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB7IGRhdGVUeXBlOiAnc3VzcGVuZGVkRGF0ZVR5cGUnLCBmcm9tOiAnX3N1c3BlbmRlZEZyb20nLCB0bzogJ19zdXNwZW5kZWRUbyd9LFxuICAgICAgICAgICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgIHN1c3BlbmRlZERhdGVUeXBlOiBmaWx0ZXJNb2RlbC5zdXNwZW5kZWREYXRlVHlwZSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBfc3VzcGVuZGVkRnJvbTogZmlsdGVyTW9kZWwuc3VzcGVuZGVkRnJvbSB8fCBudWxsLFxuICAgICAgICAgICAgICAgICAgICBfc3VzcGVuZGVkVG86IGZpbHRlck1vZGVsLnN1c3BlbmRlZFRvIHx8IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfVxufVxuIl19