import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { throwError as observableThrowError, of } from 'rxjs';
import { catchError, map } from 'rxjs/operators';
import { AppConfigService } from '../app-config/app-config.service';
import { LogService } from './log.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "../app-config/app-config.service";
import * as i3 from "./log.service";
export class IdentityRoleService {
    constructor(http, appConfig, logService) {
        this.http = http;
        this.appConfig = appConfig;
        this.logService = logService;
        this.contextRoot = '';
        this.identityHost = '';
        this.contextRoot = this.appConfig.get('apiHost', '');
        this.identityHost = this.appConfig.get('identityHost');
    }
    getRoles(skipCount = 0, size = 5) {
        return this.http.get(`${this.identityHost}/roles`).pipe(map(res => {
            return this.preparePaginationWithRoles(res, skipCount, size);
        }), catchError(error => this.handleError(error)));
    }
    preparePaginationWithRoles(roles, skipCount = 0, size = 5) {
        return {
            entries: roles.slice(skipCount, skipCount + size),
            pagination: {
                skipCount: skipCount,
                maxItems: size,
                count: roles.length,
                hasMoreItems: false,
                totalItems: roles.length
            }
        };
    }
    addRole(newRole) {
        if (newRole) {
            const request = newRole;
            return this.http
                .post(`${this.identityHost}/roles`, request)
                .pipe(catchError(error => this.handleError(error)));
        }
        return of();
    }
    deleteRole(deletedRole) {
        return this.http
            .delete(`${this.identityHost}/roles-by-id/${deletedRole.id}`)
            .pipe(catchError(error => this.handleError(error)));
    }
    updateRole(updatedRole, roleId) {
        if (updatedRole && roleId) {
            const request = updatedRole;
            return this.http
                .put(`${this.identityHost}/roles-by-id/${roleId}`, request)
                .pipe(catchError(error => this.handleError(error)));
        }
        return of();
    }
    handleError(error) {
        this.logService.error(error);
        return observableThrowError(error || 'Server error');
    }
}
IdentityRoleService.ɵprov = i0.ɵɵdefineInjectable({ factory: function IdentityRoleService_Factory() { return new IdentityRoleService(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.AppConfigService), i0.ɵɵinject(i3.LogService)); }, token: IdentityRoleService, providedIn: "root" });
IdentityRoleService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
IdentityRoleService.ctorParameters = () => [
    { type: HttpClient },
    { type: AppConfigService },
    { type: LogService }
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaWRlbnRpdHktcm9sZS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Ii9ob21lL3RyYXZpcy9idWlsZC9BbGZyZXNjby9hbGZyZXNjby1uZzItY29tcG9uZW50cy9saWIvY29yZS8iLCJzb3VyY2VzIjpbInNlcnZpY2VzL2lkZW50aXR5LXJvbGUuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpQkEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDbEQsT0FBTyxFQUFFLFVBQVUsSUFBSSxvQkFBb0IsRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDMUUsT0FBTyxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUdqRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUNwRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDOzs7OztBQVUzQyxNQUFNLE9BQU8sbUJBQW1CO0lBSTVCLFlBQ2MsSUFBZ0IsRUFDaEIsU0FBMkIsRUFDM0IsVUFBc0I7UUFGdEIsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixjQUFTLEdBQVQsU0FBUyxDQUFrQjtRQUMzQixlQUFVLEdBQVYsVUFBVSxDQUFZO1FBTnBDLGdCQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLGlCQUFZLEdBQUcsRUFBRSxDQUFDO1FBT2QsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDckQsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUMzRCxDQUFDO0lBTUQsUUFBUSxDQUNKLFlBQW9CLENBQUMsRUFDckIsT0FBZSxDQUFDO1FBRWhCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQU0sR0FBRyxJQUFJLENBQUMsWUFBWSxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQ3hELEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNOLE9BQU8sSUFBSSxDQUFDLDBCQUEwQixDQUFDLEdBQUcsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDakUsQ0FBQyxDQUFDLEVBQ0YsVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUMvQyxDQUFDO0lBQ04sQ0FBQztJQUVPLDBCQUEwQixDQUM5QixLQUEwQixFQUMxQixZQUFvQixDQUFDLEVBQ3JCLE9BQWUsQ0FBQztRQUVoQixPQUFPO1lBQ0gsT0FBTyxFQUFFLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLFNBQVMsR0FBRyxJQUFJLENBQUM7WUFDakQsVUFBVSxFQUFFO2dCQUNSLFNBQVMsRUFBRSxTQUFTO2dCQUNwQixRQUFRLEVBQUUsSUFBSTtnQkFDZCxLQUFLLEVBQUUsS0FBSyxDQUFDLE1BQU07Z0JBQ25CLFlBQVksRUFBRSxLQUFLO2dCQUNuQixVQUFVLEVBQUUsS0FBSyxDQUFDLE1BQU07YUFDM0I7U0FDSixDQUFDO0lBQ04sQ0FBQztJQU9ELE9BQU8sQ0FBQyxPQUEwQjtRQUM5QixJQUFJLE9BQU8sRUFBRTtZQUNULE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQztZQUN4QixPQUFPLElBQUksQ0FBQyxJQUFJO2lCQUNYLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLFFBQVEsRUFBRSxPQUFPLENBQUM7aUJBQzNDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUMzRDtRQUNELE9BQU8sRUFBRSxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQU9ELFVBQVUsQ0FBQyxXQUE4QjtRQUNyQyxPQUFPLElBQUksQ0FBQyxJQUFJO2FBQ1gsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLFlBQVksZ0JBQWdCLFdBQVcsQ0FBQyxFQUFFLEVBQUUsQ0FBQzthQUM1RCxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQVFELFVBQVUsQ0FDTixXQUE4QixFQUM5QixNQUFjO1FBRWQsSUFBSSxXQUFXLElBQUksTUFBTSxFQUFFO1lBQ3ZCLE1BQU0sT0FBTyxHQUFHLFdBQVcsQ0FBQztZQUM1QixPQUFPLElBQUksQ0FBQyxJQUFJO2lCQUNYLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxZQUFZLGdCQUFnQixNQUFNLEVBQUUsRUFBRSxPQUFPLENBQUM7aUJBQzFELElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUMzRDtRQUNELE9BQU8sRUFBRSxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQUVPLFdBQVcsQ0FBQyxLQUFVO1FBQzFCLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdCLE9BQU8sb0JBQW9CLENBQUMsS0FBSyxJQUFJLGNBQWMsQ0FBQyxDQUFDO0lBQ3pELENBQUM7Ozs7WUFqR0osVUFBVSxTQUFDO2dCQUNSLFVBQVUsRUFBRSxNQUFNO2FBQ3JCOzs7WUFmUSxVQUFVO1lBS1YsZ0JBQWdCO1lBQ2hCLFVBQVUiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBBbGZyZXNjbyBTb2Z0d2FyZSwgTHRkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgdGhyb3dFcnJvciBhcyBvYnNlcnZhYmxlVGhyb3dFcnJvciwgT2JzZXJ2YWJsZSwgb2YgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGNhdGNoRXJyb3IsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IFBhZ2luYXRpb24gfSBmcm9tICdAYWxmcmVzY28vanMtYXBpJztcbmltcG9ydCB7IElkZW50aXR5Um9sZU1vZGVsIH0gZnJvbSAnLi4vbW9kZWxzL2lkZW50aXR5LXJvbGUubW9kZWwnO1xuaW1wb3J0IHsgQXBwQ29uZmlnU2VydmljZSB9IGZyb20gJy4uL2FwcC1jb25maWcvYXBwLWNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7IExvZ1NlcnZpY2UgfSBmcm9tICcuL2xvZy5zZXJ2aWNlJztcblxuZXhwb3J0IGludGVyZmFjZSBJZGVudGl0eVJvbGVSZXNwb25zZU1vZGVsIHtcbiAgICBlbnRyaWVzOiBJZGVudGl0eVJvbGVNb2RlbFtdO1xuICAgIHBhZ2luYXRpb246IFBhZ2luYXRpb247XG4gIH1cblxuQEluamVjdGFibGUoe1xuICAgIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBJZGVudGl0eVJvbGVTZXJ2aWNlIHtcbiAgICBjb250ZXh0Um9vdCA9ICcnO1xuICAgIGlkZW50aXR5SG9zdCA9ICcnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByb3RlY3RlZCBodHRwOiBIdHRwQ2xpZW50LFxuICAgICAgICBwcm90ZWN0ZWQgYXBwQ29uZmlnOiBBcHBDb25maWdTZXJ2aWNlLFxuICAgICAgICBwcm90ZWN0ZWQgbG9nU2VydmljZTogTG9nU2VydmljZVxuICAgICkge1xuICAgICAgICB0aGlzLmNvbnRleHRSb290ID0gdGhpcy5hcHBDb25maWcuZ2V0KCdhcGlIb3N0JywgJycpO1xuICAgICAgICB0aGlzLmlkZW50aXR5SG9zdCA9IHRoaXMuYXBwQ29uZmlnLmdldCgnaWRlbnRpdHlIb3N0Jyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0IGFsbCByb2xlc1xuICAgICAqIEByZXR1cm5zIExpc3Qgb2Ygcm9sZXNcbiAgICAgKi9cbiAgICBnZXRSb2xlcyhcbiAgICAgICAgc2tpcENvdW50OiBudW1iZXIgPSAwLFxuICAgICAgICBzaXplOiBudW1iZXIgPSA1XG4gICAgKTogT2JzZXJ2YWJsZTxJZGVudGl0eVJvbGVSZXNwb25zZU1vZGVsPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0PGFueT4oYCR7dGhpcy5pZGVudGl0eUhvc3R9L3JvbGVzYCkucGlwZShcbiAgICAgICAgICAgIG1hcChyZXMgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnByZXBhcmVQYWdpbmF0aW9uV2l0aFJvbGVzKHJlcywgc2tpcENvdW50LCBzaXplKTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2F0Y2hFcnJvcihlcnJvciA9PiB0aGlzLmhhbmRsZUVycm9yKGVycm9yKSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHByZXBhcmVQYWdpbmF0aW9uV2l0aFJvbGVzKFxuICAgICAgICByb2xlczogSWRlbnRpdHlSb2xlTW9kZWxbXSxcbiAgICAgICAgc2tpcENvdW50OiBudW1iZXIgPSAwLFxuICAgICAgICBzaXplOiBudW1iZXIgPSA1XG4gICAgKTogSWRlbnRpdHlSb2xlUmVzcG9uc2VNb2RlbCB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBlbnRyaWVzOiByb2xlcy5zbGljZShza2lwQ291bnQsIHNraXBDb3VudCArIHNpemUpLFxuICAgICAgICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICAgICAgICAgIHNraXBDb3VudDogc2tpcENvdW50LFxuICAgICAgICAgICAgICAgIG1heEl0ZW1zOiBzaXplLFxuICAgICAgICAgICAgICAgIGNvdW50OiByb2xlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgaGFzTW9yZUl0ZW1zOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0b3RhbEl0ZW1zOiByb2xlcy5sZW5ndGhcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgbmV3IHJvbGVcbiAgICAgKiBAcGFyYW0gbmV3Um9sZSBSb2xlIG1vZGVsXG4gICAgICogQHJldHVybnMgU2VydmVyIHJlc3VsdCBwYXlsb2FkXG4gICAgICovXG4gICAgYWRkUm9sZShuZXdSb2xlOiBJZGVudGl0eVJvbGVNb2RlbCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIGlmIChuZXdSb2xlKSB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3Um9sZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmh0dHBcbiAgICAgICAgICAgICAgICAucG9zdChgJHt0aGlzLmlkZW50aXR5SG9zdH0vcm9sZXNgLCByZXF1ZXN0KVxuICAgICAgICAgICAgICAgIC5waXBlKGNhdGNoRXJyb3IoZXJyb3IgPT4gdGhpcy5oYW5kbGVFcnJvcihlcnJvcikpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb2YoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZWxldGUgZXhpc3Rpbmcgcm9sZVxuICAgICAqIEBwYXJhbSBkZWxldGVkUm9sZSBSb2xlIG1vZGVsXG4gICAgICogQHJldHVybnMgU2VydmVyIHJlc3VsdCBwYXlsb2FkXG4gICAgICovXG4gICAgZGVsZXRlUm9sZShkZWxldGVkUm9sZTogSWRlbnRpdHlSb2xlTW9kZWwpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwXG4gICAgICAgICAgICAuZGVsZXRlKGAke3RoaXMuaWRlbnRpdHlIb3N0fS9yb2xlcy1ieS1pZC8ke2RlbGV0ZWRSb2xlLmlkfWApXG4gICAgICAgICAgICAucGlwZShjYXRjaEVycm9yKGVycm9yID0+IHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIGV4aXN0aW5nIHJvbGVcbiAgICAgKiBAcGFyYW0gdXBkYXRlZFJvbGUgUm9sZSBtb2RlbFxuICAgICAqIEBwYXJhbSByb2xlSWQgUm9sZSBpZFxuICAgICAqIEByZXR1cm5zIFNlcnZlciByZXN1bHQgcGF5bG9hZFxuICAgICAqL1xuICAgIHVwZGF0ZVJvbGUoXG4gICAgICAgIHVwZGF0ZWRSb2xlOiBJZGVudGl0eVJvbGVNb2RlbCxcbiAgICAgICAgcm9sZUlkOiBzdHJpbmdcbiAgICApOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICBpZiAodXBkYXRlZFJvbGUgJiYgcm9sZUlkKSB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gdXBkYXRlZFJvbGU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5odHRwXG4gICAgICAgICAgICAgICAgLnB1dChgJHt0aGlzLmlkZW50aXR5SG9zdH0vcm9sZXMtYnktaWQvJHtyb2xlSWR9YCwgcmVxdWVzdClcbiAgICAgICAgICAgICAgICAucGlwZShjYXRjaEVycm9yKGVycm9yID0+IHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9mKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVFcnJvcihlcnJvcjogYW55KSB7XG4gICAgICAgIHRoaXMubG9nU2VydmljZS5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybiBvYnNlcnZhYmxlVGhyb3dFcnJvcihlcnJvciB8fCAnU2VydmVyIGVycm9yJyk7XG4gICAgfVxufVxuIl19