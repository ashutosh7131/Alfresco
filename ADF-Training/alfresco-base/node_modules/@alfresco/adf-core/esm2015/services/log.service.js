import { Injectable } from '@angular/core';
import { AppConfigService, AppConfigValues } from '../app-config/app-config.service';
import { logLevels, LogLevelsEnum } from '../models/log-levels.model';
import { Subject } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "../app-config/app-config.service";
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../app-config/app-config.service';
export class LogService {
    constructor(appConfig) {
        this.appConfig = appConfig;
        this.onMessage = new Subject();
    }
    get currentLogLevel() {
        const configLevel = this.appConfig.get(AppConfigValues.LOG_LEVEL);
        if (configLevel) {
            return this.getLogLevel(configLevel);
        }
        return LogLevelsEnum.TRACE;
    }
    error(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.ERROR) {
            this.messageBus(message, 'ERROR');
            console.error(message, ...optionalParams);
        }
    }
    debug(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.DEBUG) {
            this.messageBus(message, 'DEBUG');
            console.debug(message, ...optionalParams);
        }
    }
    info(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.INFO) {
            this.messageBus(message, 'INFO');
            console.info(message, ...optionalParams);
        }
    }
    log(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.TRACE) {
            this.messageBus(message, 'LOG');
            console.log(message, ...optionalParams);
        }
    }
    trace(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.TRACE) {
            this.messageBus(message, 'TRACE');
            console.trace(message, ...optionalParams);
        }
    }
    warn(message, ...optionalParams) {
        if (this.currentLogLevel >= LogLevelsEnum.WARN) {
            this.messageBus(message, 'WARN');
            console.warn(message, ...optionalParams);
        }
    }
    assert(test, message, ...optionalParams) {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            this.messageBus(message, 'ASSERT');
            console.assert(test, message, ...optionalParams);
        }
    }
    group(groupTitle, ...optionalParams) {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            console.group(groupTitle, ...optionalParams);
        }
    }
    groupEnd() {
        if (this.currentLogLevel !== LogLevelsEnum.SILENT) {
            console.groupEnd();
        }
    }
    getLogLevel(level) {
        const referencedLevel = logLevels.find((currentLevel) => {
            return currentLevel.name.toLocaleLowerCase() === level.toLocaleLowerCase();
        });
        return referencedLevel ? referencedLevel.level : 5;
    }
    messageBus(text, logLevel) {
        this.onMessage.next({ text: text, type: logLevel });
    }
}
LogService.ɵfac = function LogService_Factory(t) { return new (t || LogService)(ɵngcc0.ɵɵinject(ɵngcc1.AppConfigService)); };
LogService.ɵprov = i0.ɵɵdefineInjectable({ factory: function LogService_Factory() { return new LogService(i0.ɵɵinject(i1.AppConfigService)); }, token: LogService, providedIn: "root" });
LogService.ctorParameters = () => [
    { type: AppConfigService }
];
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LogService, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: ɵngcc1.AppConfigService }]; }, null); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLnNlcnZpY2UuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2hvbWUvdHJhdmlzL2J1aWxkL0FsZnJlc2NvL2FsZnJlc2NvLW5nMi1jb21wb25lbnRzL2xpYi9jb3JlL3NlcnZpY2VzL2xvZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW1CQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxlQUFlLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUNyRixPQUFPLEVBQUUsU0FBUyxFQUFFLGFBQWEsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3RFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0I7QUFFc0I7OztBQUV0QixNQUFNLE9BQU8sVUFBVTtBQUN2QixJQWFJLFlBQW9CLFNBQTJCO0FBQ25ELFFBRHdCLGNBQVMsR0FBVCxTQUFTLENBQWtCO0FBQUMsUUFDNUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLE9BQU8sRUFBRSxDQUFDO0FBQ3ZDLElBQUksQ0FBQztBQUNMLElBZkksSUFBSSxlQUFlO0FBQ3ZCLFFBQVEsTUFBTSxXQUFXLEdBQVcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQVMsZUFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzFGLFFBQ1EsSUFBSSxXQUFXLEVBQUU7QUFDekIsWUFBWSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDakQsU0FBUztBQUNULFFBQ1EsT0FBTyxhQUFhLENBQUMsS0FBSyxDQUFDO0FBQ25DLElBQUksQ0FBQztBQUNMLElBWUksS0FBSyxDQUFDLE9BQWEsRUFBRSxHQUFHLGNBQXFCO0FBQ2pELFFBQVEsSUFBSSxJQUFJLENBQUMsZUFBZSxJQUFJLGFBQWEsQ0FBQyxLQUFLLEVBQUU7QUFDekQsWUFDWSxJQUFJLENBQUMsVUFB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Q0FBQyxlQUFlLEtBQUssYUFBYSxDQUFDLE1BQU0sRUFBRTtBQUMzRCxZQUFZLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztBQUMvQixTQUFTO0FBQ1QsSUFBSSxDQUFDO0FBQ0wsSUFNSSxXQUFXLENBQUMsS0FBYTtBQUFJLFFBQ3pCLE1BQU0sZUFBZSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxZQUFpQixFQUFFLEVBQUU7QUFDckUsWUFBWSxPQUFPLFlBQVksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsS0FBSyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztBQUN2RixRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQ1gsUUFDUSxPQUFPLGVBQWUsQ0FBQyxDQUFDLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzNELElBQUksQ0FBQztBQUNMLElBTUksVUFBVSxDQUFDLElBQVksRUFBRSxRQUFnQjtBQUM3QyxRQUFRLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQztBQUM1RCxJQUFJLENBQUM7QUFDTDs2SEFBQztBQUNELHlMQS9KSztBQUFDO0VBSEwsVUFBVSxTQUFDLHJCQUtHLFlBVE4sZ0JBQWdCO0FBQUc7S0FLeEIsVUFBVSxFQUFFLE1BQU0sY0FDckI7Ozs7O2lGQU42QjtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyogdHNsaW50OmRpc2FibGU6bm8tY29uc29sZSAgKi9cblxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQXBwQ29uZmlnU2VydmljZSwgQXBwQ29uZmlnVmFsdWVzIH0gZnJvbSAnLi4vYXBwLWNvbmZpZy9hcHAtY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHsgbG9nTGV2ZWxzLCBMb2dMZXZlbHNFbnVtIH0gZnJvbSAnLi4vbW9kZWxzL2xvZy1sZXZlbHMubW9kZWwnO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuXG5ASW5qZWN0YWJsZSh7XG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIExvZ1NlcnZpY2Uge1xuXG4gICAgZ2V0IGN1cnJlbnRMb2dMZXZlbCgpIHtcbiAgICAgICAgY29uc3QgY29uZmlnTGV2ZWw6IHN0cmluZyA9IHRoaXMuYXBwQ29uZmlnLmdldDxzdHJpbmc+KEFwcENvbmZpZ1ZhbHVlcy5MT0dfTEVWRUwpO1xuXG4gICAgICAgIGlmIChjb25maWdMZXZlbCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TG9nTGV2ZWwoY29uZmlnTGV2ZWwpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIExvZ0xldmVsc0VudW0uVFJBQ0U7XG4gICAgfVxuXG4gICAgb25NZXNzYWdlOiBTdWJqZWN0PGFueT47XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcENvbmZpZzogQXBwQ29uZmlnU2VydmljZSkge1xuICAgICAgICB0aGlzLm9uTWVzc2FnZSA9IG5ldyBTdWJqZWN0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9ncyBhIG1lc3NhZ2UgYXQgdGhlIFwiRVJST1JcIiBsZXZlbC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICAgICAqIEBwYXJhbSBvcHRpb25hbFBhcmFtcyBJbnRlcnBvbGF0aW9uIHZhbHVlcyBmb3IgdGhlIG1lc3NhZ2UgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uRVJST1IpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdFUlJPUicpO1xuXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIC4uLm9wdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ3MgYSBtZXNzYWdlIGF0IHRoZSBcIkRFQlVHXCIgbGV2ZWwuXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSB0byBsb2dcbiAgICAgKiBAcGFyYW0gb3B0aW9uYWxQYXJhbXMgSW50ZXJwb2xhdGlvbiB2YWx1ZXMgZm9yIHRoZSBtZXNzYWdlIGluIFwicHJpbnRmXCIgZm9ybWF0XG4gICAgICovXG4gICAgZGVidWcobWVzc2FnZT86IGFueSwgLi4ub3B0aW9uYWxQYXJhbXM6IGFueVtdKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMb2dMZXZlbCA+PSBMb2dMZXZlbHNFbnVtLkRFQlVHKSB7XG5cbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyhtZXNzYWdlLCAnREVCVUcnKTtcblxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhtZXNzYWdlLCAuLi5vcHRpb25hbFBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2dzIGEgbWVzc2FnZSBhdCB0aGUgXCJJTkZPXCIgbGV2ZWwuXG4gICAgICogQHBhcmFtIG1lc3NhZ2UgTWVzc2FnZSB0byBsb2dcbiAgICAgKiBAcGFyYW0gb3B0aW9uYWxQYXJhbXMgSW50ZXJwb2xhdGlvbiB2YWx1ZXMgZm9yIHRoZSBtZXNzYWdlIGluIFwicHJpbnRmXCIgZm9ybWF0XG4gICAgICovXG4gICAgaW5mbyhtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uSU5GTykge1xuXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VCdXMobWVzc2FnZSwgJ0lORk8nKTtcblxuICAgICAgICAgICAgY29uc29sZS5pbmZvKG1lc3NhZ2UsIC4uLm9wdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ3MgYSBtZXNzYWdlIGF0IGFueSBsZXZlbCBmcm9tIFwiVFJBQ0VcIiB1cHdhcmRzLlxuICAgICAqIEBwYXJhbSBtZXNzYWdlIE1lc3NhZ2UgdG8gbG9nXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUGFyYW1zIEludGVycG9sYXRpb24gdmFsdWVzIGZvciB0aGUgbWVzc2FnZSBpbiBcInByaW50ZlwiIGZvcm1hdFxuICAgICAqL1xuICAgIGxvZyhtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uVFJBQ0UpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdMT0cnKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSwgLi4ub3B0aW9uYWxQYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9ncyBhIG1lc3NhZ2UgYXQgdGhlIFwiVFJBQ0VcIiBsZXZlbC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICAgICAqIEBwYXJhbSBvcHRpb25hbFBhcmFtcyBJbnRlcnBvbGF0aW9uIHZhbHVlcyBmb3IgdGhlIG1lc3NhZ2UgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICB0cmFjZShtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsID49IExvZ0xldmVsc0VudW0uVFJBQ0UpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdUUkFDRScpO1xuXG4gICAgICAgICAgICBjb25zb2xlLnRyYWNlKG1lc3NhZ2UsIC4uLm9wdGlvbmFsUGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvZ3MgYSBtZXNzYWdlIGF0IHRoZSBcIldBUk5cIiBsZXZlbC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBNZXNzYWdlIHRvIGxvZ1xuICAgICAqIEBwYXJhbSBvcHRpb25hbFBhcmFtcyBJbnRlcnBvbGF0aW9uIHZhbHVlcyBmb3IgdGhlIG1lc3NhZ2UgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U/OiBhbnksIC4uLm9wdGlvbmFsUGFyYW1zOiBhbnlbXSkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50TG9nTGV2ZWwgPj0gTG9nTGV2ZWxzRW51bS5XQVJOKSB7XG5cbiAgICAgICAgICAgIHRoaXMubWVzc2FnZUJ1cyhtZXNzYWdlLCAnV0FSTicpO1xuXG4gICAgICAgICAgICBjb25zb2xlLndhcm4obWVzc2FnZSwgLi4ub3B0aW9uYWxQYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9ncyBhIG1lc3NhZ2UgaWYgYSBib29sZWFuIHRlc3QgZmFpbHMuXG4gICAgICogQHBhcmFtIHRlc3QgVGVzdCB2YWx1ZSAodHlwaWNhbGx5IGEgYm9vbGVhbiBleHByZXNzaW9uKVxuICAgICAqIEBwYXJhbSBtZXNzYWdlIE1lc3NhZ2UgdG8gc2hvdyBpZiB0ZXN0IGlzIGZhbHNlXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUGFyYW1zIEludGVycG9sYXRpb24gdmFsdWVzIGZvciB0aGUgbWVzc2FnZSBpbiBcInByaW50ZlwiIGZvcm1hdFxuICAgICAqL1xuICAgIGFzc2VydCh0ZXN0PzogYm9vbGVhbiwgbWVzc2FnZT86IHN0cmluZywgLi4ub3B0aW9uYWxQYXJhbXM6IGFueVtdKSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRMb2dMZXZlbCAhPT0gTG9nTGV2ZWxzRW51bS5TSUxFTlQpIHtcblxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlQnVzKG1lc3NhZ2UsICdBU1NFUlQnKTtcblxuICAgICAgICAgICAgY29uc29sZS5hc3NlcnQodGVzdCwgbWVzc2FnZSwgLi4ub3B0aW9uYWxQYXJhbXMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RhcnRzIGFuIGluZGVudGVkIGdyb3VwIG9mIGxvZyBtZXNzYWdlcy5cbiAgICAgKiBAcGFyYW0gZ3JvdXBUaXRsZSBUaXRsZSBzaG93biBhdCB0aGUgc3RhcnQgb2YgdGhlIGdyb3VwXG4gICAgICogQHBhcmFtIG9wdGlvbmFsUGFyYW1zIEludGVycG9sYXRpb24gdmFsdWVzIGZvciB0aGUgdGl0bGUgaW4gXCJwcmludGZcIiBmb3JtYXRcbiAgICAgKi9cbiAgICBncm91cChncm91cFRpdGxlPzogc3RyaW5nLCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudExvZ0xldmVsICE9PSBMb2dMZXZlbHNFbnVtLlNJTEVOVCkge1xuICAgICAgICAgICAgY29uc29sZS5ncm91cChncm91cFRpdGxlLCAuLi5vcHRpb25hbFBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFbmRzIGEgaW5kZW50ZWQgZ3JvdXAgb2YgbG9nIG1lc3NhZ2VzLlxuICAgICAqL1xuICAgIGdyb3VwRW5kKCkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50TG9nTGV2ZWwgIT09IExvZ0xldmVsc0VudW0uU0lMRU5UKSB7XG4gICAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIGxvZyBsZXZlbCBuYW1lIHN0cmluZyBpbnRvIGl0cyBudW1lcmljIGVxdWl2YWxlbnQuXG4gICAgICogQHBhcmFtIGxldmVsIExldmVsIG5hbWVcbiAgICAgKiBAcmV0dXJucyBOdW1lcmljIGxvZyBsZXZlbFxuICAgICAqL1xuICAgIGdldExvZ0xldmVsKGxldmVsOiBzdHJpbmcpOiBMb2dMZXZlbHNFbnVtIHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlZExldmVsID0gbG9nTGV2ZWxzLmZpbmQoKGN1cnJlbnRMZXZlbDogYW55KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudExldmVsLm5hbWUudG9Mb2NhbGVMb3dlckNhc2UoKSA9PT0gbGV2ZWwudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlZmVyZW5jZWRMZXZlbCA/IHJlZmVyZW5jZWRMZXZlbC5sZXZlbCA6IDU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcnMgbm90aWZpY2F0aW9uIGNhbGxiYWNrIGZvciBsb2cgbWVzc2FnZXMuXG4gICAgICogQHBhcmFtIHRleHQgTWVzc2FnZSB0ZXh0XG4gICAgICogQHBhcmFtIGxvZ0xldmVsIExvZyBsZXZlbCBmb3IgdGhlIG1lc3NhZ2VcbiAgICAgKi9cbiAgICBtZXNzYWdlQnVzKHRleHQ6IHN0cmluZywgbG9nTGV2ZWw6IHN0cmluZykge1xuICAgICAgICB0aGlzLm9uTWVzc2FnZS5uZXh0KHsgdGV4dDogdGV4dCwgdHlwZTogbG9nTGV2ZWwgfSk7XG4gICAgfVxufVxuIl19