{"version":3,"sources":["../../../content-services/src/lib/material.module.ts","../../../../node_modules/tslib/tslib.es6.js","../../../content-services/src/lib/document-list/models/document-folder.model.ts","../../../content-services/src/lib/document-list/services/custom-resources.service.ts","../../../content-services/src/lib/document-list/models/node-action.enum.ts","../../../content-services/src/lib/document-list/services/document-list.service.ts","../../../content-services/src/lib/content-node-selector/content-node-selector.component.ts","../../../content-services/src/lib/dialogs/node-lock.dialog.ts","../../../content-services/src/lib/content-node-selector/content-node-dialog.service.ts","../../../content-services/src/lib/directives/node-lock.directive.ts","../../../content-services/src/lib/directives/node-counter.directive.ts","../../../content-services/src/lib/directives/content-directive.module.ts","../../../content-services/src/lib/social/services/rating.service.ts","../../../content-services/src/lib/social/rating.component.ts","../../../content-services/src/lib/social/like.component.ts","../../../content-services/src/lib/social/social.module.ts","../../../content-services/src/lib/tag/services/tag.service.ts","../../../content-services/src/lib/tag/tag-actions.component.ts","../../../content-services/src/lib/tag/tag-list.component.ts","../../../content-services/src/lib/tag/tag-node-list.component.ts","../../../content-services/src/lib/tag/tag.module.ts","../../../content-services/src/lib/webscript/webscript.component.ts","../../../content-services/src/lib/webscript/webscript.module.ts","../../../content-services/src/lib/document-list/data/share-data-row.model.ts","../../../content-services/src/lib/document-list/models/content-action.model.ts","../../../content-services/src/lib/document-list/data/share-datatable-adapter.ts","../../../content-services/src/lib/document-list/models/preset.model.ts","../../../content-services/src/lib/document-list/components/node.event.ts","../../../content-services/src/lib/document-list/components/document-list.component.ts","../../../content-services/src/lib/document-list/models/permissions.model.ts","../../../content-services/src/lib/document-list/services/node-actions.service.ts","../../../content-services/src/lib/document-list/services/document-actions.service.ts","../../../content-services/src/lib/document-list/services/folder-actions.service.ts","../../../content-services/src/lib/document-list/components/content-action/content-action-list.component.ts","../../../content-services/src/lib/document-list/components/content-action/content-action.component.ts","../../../content-services/src/lib/document-list/components/library-name-column/library-name-column.component.ts","../../../content-services/src/lib/document-list/components/library-role-column/library-role-column.component.ts","../../../content-services/src/lib/document-list/components/library-status-column/library-status-column.component.ts","../../../content-services/src/lib/document-list/components/name-column/name-column.component.ts","../../../content-services/src/lib/search/search-query-service.token.ts","../../../content-services/src/lib/search/services/base-query-builder.service.ts","../../../content-services/src/lib/search/services/search-header-query-builder.service.ts","../../../content-services/src/lib/document-list/components/filter-header/filter-header.component.ts","../../../content-services/src/lib/document-list/components/trashcan-name-column/trashcan-name-column.component.ts","../../../content-services/src/lib/document-list/models/document-library.model.ts","../../../content-services/src/lib/document-list/models/permissions-style.model.ts","../../../content-services/src/lib/upload/components/file-uploading-dialog.component.ts","../../../content-services/src/lib/upload/components/file-uploading-list-row.component.ts","../../../content-services/src/lib/upload/components/file-uploading-list.component.ts","../../../content-services/src/lib/upload/components/upload-files.event.ts","../../../content-services/src/lib/upload/components/base-upload/upload-base.ts","../../../content-services/src/lib/upload/components/upload-button.component.ts","../../../content-services/src/lib/upload/components/upload-version-button.component.ts","../../../content-services/src/lib/upload/components/upload-drag-area.component.ts","../../../content-services/src/lib/upload/pipes/file-upload-error.pipe.ts","../../../content-services/src/lib/upload/directives/file-draggable.directive.ts","../../../content-services/src/lib/upload/directives/toggle-icon.directive.ts","../../../content-services/src/lib/upload/upload.module.ts","../../../content-services/src/lib/search/components/empty-search-result.component.ts","../../../content-services/src/lib/search/components/search-control.component.ts","../../../content-services/src/lib/search/components/search.component.ts","../../../content-services/src/lib/search/components/search-text/search-text.component.ts","../../../content-services/src/lib/search/models/search-filter-list.model.ts","../../../content-services/src/lib/search/components/search-radio/search-radio.component.ts","../../../content-services/src/lib/search/components/search-slider/search-slider.component.ts","../../../content-services/src/lib/search/forms/live-error-state-matcher.ts","../../../content-services/src/lib/search/components/search-number-range/search-number-range.component.ts","../../../content-services/src/lib/search/components/search-check-list/search-check-list.component.ts","../../../content-services/src/lib/search/components/search-date-range/search-date-range.component.ts","../../../content-services/src/lib/search/components/search-datetime-range/search-datetime-range.component.ts","../../../content-services/src/lib/search/services/search-filter.service.ts","../../../content-services/src/lib/search/components/search-widget-container/search-widget-container.component.ts","../../../content-services/src/lib/search/services/search-query-builder.service.ts","../../../content-services/src/lib/search/services/search-facet-filters.service.ts","../../../content-services/src/lib/search/components/search-filter/search-filter.component.ts","../../../content-services/src/lib/search/components/search-chip-list/search-chip-list.component.ts","../../../content-services/src/lib/content-node-selector/content-node-selector-panel.service.ts","../../../content-services/src/lib/search/components/search-panel/search-panel.component.ts","../../../content-services/src/lib/search/components/search-sorting-picker/search-sorting-picker.component.ts","../../../content-services/src/lib/search/components/search-filter-container/search-filter-container.component.ts","../../../content-services/src/lib/search/components/search-form/search-form.component.ts","../../../content-services/src/lib/search/components/search-filter-chips/search-filter-chips.component.ts","../../../content-services/src/lib/search/components/search-filter-chips/search-filter-menu-card/search-filter-menu-card.component.ts","../../../content-services/src/lib/search/components/search-facet-field/search-facet-field.component.ts","../../../content-services/src/lib/search/components/search-filter-chips/search-widget-chip/search-widget-chip.component.ts","../../../content-services/src/lib/search/components/search-filter-chips/search-facet-chip/search-facet-chip.component.ts","../../../content-services/src/lib/search/components/reset-search.directive.ts","../../../content-services/src/lib/search/search.module.ts","../../../content-services/src/lib/site-dropdown/sites-dropdown.component.ts","../../../content-services/src/lib/document-list/document-list.module.ts","../../../content-services/src/lib/site-dropdown/sites-dropdown.module.ts","../../../content-services/src/lib/breadcrumb/breadcrumb.component.ts","../../../content-services/src/lib/breadcrumb/dropdown-breadcrumb.component.ts","../../../content-services/src/lib/breadcrumb/breadcrumb.module.ts","../../../content-services/src/lib/dialogs/confirm.dialog.ts","../../../content-services/src/lib/version-manager/content-version.service.ts","../../../content-services/src/lib/version-manager/version-list.component.ts","../../../content-services/src/lib/version-manager/version-manager.component.ts","../../../content-services/src/lib/version-manager/version-upload.component.ts","../../../content-services/src/lib/version-manager/version-comparison.component.ts","../../../content-services/src/lib/version-manager/version-manager.module.ts","../../../content-services/src/lib/content-node-selector/name-location-cell/name-location-cell.component.ts","../../../content-services/src/lib/content-node-selector/content-node-selector-panel.component.ts","../../../content-services/src/lib/content-node-selector/content-node-selector.module.ts","../../../content-services/src/lib/dialogs/folder-name.validators.ts","../../../content-services/src/lib/dialogs/folder.dialog.ts","../../../content-services/src/lib/dialogs/library/library.dialog.ts","../../../content-services/src/lib/dialogs/dialog.module.ts","../../../content-services/src/lib/folder-directive/folder-create.directive.ts","../../../content-services/src/lib/folder-directive/folder-edit.directive.ts","../../../content-services/src/lib/folder-directive/folder-directive.module.ts","../../../content-services/src/lib/content-metadata/services/basic-properties.service.ts","../../../content-services/src/lib/content-metadata/services/property-groups-translator.service.ts","../../../content-services/src/lib/content-metadata/services/config/property-group-reader.ts","../../../content-services/src/lib/content-metadata/services/config/aspect-oriented-config.service.ts","../../../content-services/src/lib/content-metadata/services/config/indifferent-config.service.ts","../../../content-services/src/lib/content-metadata/services/config/layout-oriented-config.service.ts","../../../content-services/src/lib/content-metadata/services/config/content-metadata-config.factory.ts","../../../content-services/src/lib/content-metadata/services/property-descriptors.service.ts","../../../content-services/src/lib/content-type/content-type.service.ts","../../../content-services/src/lib/content-type/content-type-dialog.component.ts","../../../content-services/src/lib/content-metadata/services/content-type-property.service.ts","../../../content-services/src/lib/content-metadata/services/content-metadata.service.ts","../../../content-services/src/lib/content-metadata/components/content-metadata/content-metadata.component.ts","../../../content-services/src/lib/aspect-list/aspect-list-dialog.component.ts","../../../content-services/src/lib/aspect-list/aspect-list.service.ts","../../../content-services/src/lib/aspect-list/node-aspect.service.ts","../../../content-services/src/lib/content-metadata/components/content-metadata-card/content-metadata-card.component.ts","../../../content-services/src/lib/content-metadata/content-metadata.module.ts","../../../content-services/src/lib/permission-manager/models/permission.model.ts","../../../content-services/src/lib/permission-manager/services/node-permission.service.ts","../../../content-services/src/lib/permission-manager/models/member.model.ts","../../../content-services/src/lib/permission-manager/components/add-permission/add-permission-dialog.component.ts","../../../content-services/src/lib/permission-manager/services/node-permission-dialog.service.ts","../../../content-services/src/lib/permission-manager/components/permission-list/permission-list.service.ts","../../../content-services/src/lib/permission-manager/components/permission-list/permission-list.component.ts","../../../content-services/src/lib/permission-manager/components/inherited-button.directive.ts","../../../content-services/src/lib/permission-manager/components/add-permission/search-config-permission.service.ts","../../../content-services/src/lib/permission-manager/components/add-permission/add-permission-panel.component.ts","../../../content-services/src/lib/permission-manager/components/add-permission/add-permission.component.ts","../../../content-services/src/lib/permission-manager/components/user-icon-column/user-icon-column.component.ts","../../../content-services/src/lib/permission-manager/components/user-name-column/user-name-column.component.ts","../../../content-services/src/lib/permission-manager/components/user-role-column/user-role-column.component.ts","../../../content-services/src/lib/permission-manager/components/node-path-column/node-path-column.component.ts","../../../content-services/src/lib/permission-manager/components/permission-container/permission-container.component.ts","../../../content-services/src/lib/permission-manager/components/pop-over.directive.ts","../../../content-services/src/lib/permission-manager/permission-manager.module.ts","../../../content-services/src/lib/content-node-share/content-node-share.dialog.ts","../../../content-services/src/lib/content-node-share/content-node-share.directive.ts","../../../content-services/src/lib/content-node-share/content-node-share.module.ts","../../../content-services/src/lib/tree-view/models/tree-view.model.ts","../../../content-services/src/lib/tree-view/services/tree-view.service.ts","../../../content-services/src/lib/tree-view/data/tree-view-datasource.ts","../../../content-services/src/lib/tree-view/components/tree-view.component.ts","../../../content-services/src/lib/tree-view/tree-view.module.ts","../../../content-services/src/lib/group/services/group.service.ts","../../../content-services/src/lib/aspect-list/aspect-list.component.ts","../../../content-services/src/lib/aspect-list/aspect-list.module.ts","../../../content-services/src/lib/content-type/content-type.module.ts","../../../content-services/src/lib/content.module.ts"],"names":["NgModule","args","imports","MatButtonModule","MatChipsModule","MatDialogModule","MatIconModule","MatCardModule","MatInputModule","MatListModule","MatProgressSpinnerModule","MatProgressBarModule","MatRippleModule","MatMenuModule","MatOptionModule","MatExpansionModule","MatSelectModule","MatCheckboxModule","MatDatepickerModule","MatSlideToggleModule","MatRadioModule","MatSliderModule","MatTreeModule","MatBadgeModule","exports","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","this","constructor","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","n","v","op","pop","length","push","__values","o","s","m","i","__read","r","ar","error","__spread","arguments","concat","DocumentLoaderNode","currentNode","children","CustomResourcesService","apiService","logService","CREATE_PERMISSION","defineProperty","_peopleApi","_a","PeopleApi","getInstance","_sitesApi","SitesApi","_trashcanApi","TrashcanApi","_searchApi","SearchApi","_sharedLinksApi","SharedlinksApi","_favoritesApi","FavoritesApi","_nodesApi","NodesApi","getRecentFiles","personId","pagination","filters","_this","defaultFilter","Observable","observer","peopleApi","getPerson","person","username","entry","id","filterQueries","query","join","SearchRequest","language","include","sort","type","field","ascending","paging","maxItems","skipCount","searchApi","search","searchResult","complete","err","pipe","catchError","handleError","loadFavorites","includeFields","where","includeFieldsRequest","getIncludesFields","defaultPredicate","options","favoritesApi","listFavorites","page","list","entries","map","_b","target","file","folder","properties","assign","cm:title","title","cm:description","description","loadMemberSites","sitesApi","listSiteMembershipsForPerson","SiteMemberPaging","site","allowableOperations","name","loadSites","listSites","loadTrashcan","from","trashcanApi","listDeletedNodes","loadSharedLinks","sharedLinksApi","listSharedLinks","isCustomSource","folderId","isCustomSources","indexOf","isSupportedSource","isSupportedSources","loadFolderByNodeId","nodeId","getCorrespondingNodeIds","node","getIdFromEntry","nodesApi","getNode","of","guid","targetGuid","hasCorrespondingNodeIds","filter","element","index","array","throwError","Injectable","providedIn","AlfrescoApiService","LogService","NodeAction","DocumentListService","contentService","customResourcesService","deleteNode","nodes","copyNode","targetParentId","moveNode","getFolder","opts","rootNodeId","ROOT_ID","rootFolderId","params","includeSource","relativePath","orderBy","listNodeChildren","getFolderNode","isCustomSourceService","retrieveDocumentNode","forkJoin","results","ContentService","ContentNodeSelectorComponent","translation","notificationService","uploadService","dialog","data","showingSearch","hasAllowableOperations","isLoading","selectedTabIndex","uploadStarted","emptyFolderImageUrl","action","actionName","CHOOSE","buttonActionName","currentDirectoryId","currentFolderId","ngOnInit","keydownEvents","subscribe","event","keyCode","preventDefault","stopImmediatePropagation","close","backdropClick","fileUploadStarting","onSelect","nodeList","chosenNode","onSiteChange","siteTitle","updateTitle","onNavigationChange","pathElement","onClick","select","getTitleTranslation","instant","getSelectedCount","isCounterVisible","ATTACH","isMultipleSelection","selectionMode","onError","showError","isChooseButtonDisabled","isUploading","hasNodeSelected","onShowingSearch","onCurrentFolder","currentFolder","AllowableOperationsEnum","CREATE","breadcrumbFolderNode","isNotAllowedToUpload","onFolderLoaded","onTabSelectionChange","tabIndex","isFileServerTabSelected","isLocalUploadTabSelected","isUploadEnabled","canPerformLocalUpload","showLocalUploadButton","getWarningMessage","hasNoPermissionToUpload","hasUploadError","Component","selector","template","encapsulation","ViewEncapsulation","None","TranslationService","NotificationService","UploadService","MatDialogRef","Inject","MAT_DIALOG_DATA","NodeLockDialogComponent","formBuilder","alfrescoApi","nodeName","form","group","isLocked","allowOwner","isTimeLock","time","moment","duration","diff","asSeconds","NodeBodyLock","timeToExpire","lockTimeInSeconds","lifetime","toggleLock","lockNode","nodeBodyLock","unlockNode","submit","catch","FormBuilder","Optional","ContentNodeDialogService","documentListService","siteService","thumbnailService","EventEmitter","openFileBrowseDialogByFolderId","folderNodeId","switchMap","nodeEntry","openUploadFileDialog","openLockNodeDialog","contentEntry","observable","Subject","LOCK","open","emit","width","openFileBrowseDialogBySite","getSites","response","openFileBrowseDialogByDefaultLocation","openFolderBrowseDialogBySite","openFolderBrowseDialogByFolderId","openUploadFolderDialog","openCopyMoveDialog","permission","excludeSiteContent","select_1","parentId","imageResolver","bind","isSelectionValid","isCopyMoveSelectionValid","nonDocumentSiteContent","openContentNodeDialog","afterClosed","errors","Error","JSON","stringify","statusCode","toUpperCase","hasAllowableOperationsOnNodeFolder","showFilesInResult","isFile","panelClass","disableClose","row","isNodeFolder","getMimeTypeIcon","isFolder","hasEntityCreatePermission","isSite","nodeType","MatDialog","SitesService","ThumbnailService","Output","NodeLockDirective","renderer","contentNodeDialogService","stopPropagation","ngAfterViewInit","setProperty","nativeElement","Directive","ElementRef","Renderer2","Input","HostListener","NodeCounterDirective","resolver","viewContainerRef","componentFactory","resolveComponentFactory","NodeCounterComponent","componentRef","createComponent","instance","counter","ngOnChanges","ComponentFactoryResolver","ViewContainerRef","CommonModule","MaterialModule","TranslateModule","declarations","RatingService","_ratingsApi","RatingsApi","getRating","ratingType","ratingsApi","postRating","vote","ratingBody","RatingBody","myRating","createRating","deleteRating","RatingComponent","ratingService","average","ratingsCounter","changeVote","stars","onDestroy$","takeUntil","ratingEntry","refreshRating","ngOnDestroy","calculateStars","roundedAverage","Math","round","fill","updateVote","ratingValue","unRateItem","rateItem","Number","parseFloat","aggregate","numberOfRatings","LikeComponent","likesCounter","isLike","clean","ratedAt","likeClick","TagService","refresh","_tagsApi","TagsApi","getTagsByNodeId","tagsApi","listTagsForNode","getAllTheTags","listTags","addTag","tagName","tagBody","TagBody","tag","observableAdd","createTagForNode","tagEntry","removeTag","observableRemove","deleteTagFromNode","TagActionsComponent","tagService","translateService","successAdd","disableAddTag","refreshTag","tagPaging","tagsEntries","searchTag","newTagName","errorMsg","searchTagName","find","currentTag","cleanErrorMsg","host","class","TagListComponent","size","isSizeMinimum","defaultPagination","hasMoreItems","tags","loadMoreTags","count","loadLessTags","slice","TagNodeListComponent","showDelete","FormsModule","ReactiveFormsModule","CoreModule","WebscriptComponent","showData","contextRoot","servicePath","contentType","success","undefined","_webscriptApi","WebscriptApi","webscriptApi","executeWebScript","scriptPath","scriptArgs","webScriptData","showDataAsDataTable","log","schema","ObjectDataTableAdapter","generateSchema","isDataTableContent","ShareDataRow","obj","permissionsStyle","allowDropFiles","cache","isSelected","cssClass","ERR_OBJECT_NOT_FOUND","isDropTarget","checkNodeTypeAndPermissions","getPermissionClass","getId","isFolderAndHasPermissionToUpload","isFileAndHasParentFolderPermissionToUpload","nodeEntity","permissionsClasses","forEach","currentPermissionsStyle","applyPermissionStyleToFolder","applyPermissionStyleToFile","css","cacheValue","key","getValue","ObjectUtils","imageErrorResolver","content","mimeType","hasValue","ContentActionTarget","ShareDataTableAdapter","sorting","sortingMode","ERR_ROW_NOT_FOUND","ERR_COL_NOT_FOUND","thumbnails","rows","columns","_sortingMode","newValue","toLowerCase","getRows","setRows","getColumns","setColumns","col","dataRow","resolved","getFolderIcon","getDocumentThumbnailUrl","getDefaultMimeTypeIcon","getSorting","setSorting","sortRows","direction","DataSorting","setFilter","setImageResolver","isSmartFolder","isRuleFolder","isALinkFolder","nodeAspects","getNodeAspectNames","aspectNames","includes","numeric","a","left","Date","valueOf","toString","right","localeCompare","loadPage","nodePaging","merge","shareDataRows","nodeEntries","item","sortable","c","listPrunedDuplicate","elementToFilter","currentRow","getSelectedRows","getRowByNodeId","presetsDefaultModel","-trashcan-","srTitle","format","-sites-","-mysites-","-favorites-","-recent-","-sharedlinks-","default","disableWithNoPermission","disabled","visible","icon","handler","execute","DocumentActionModel","json","_super","ContentActionModel","FolderActionModel","NodeEntityEvent","BaseEvent","NodeEntryEvent","DocumentListComponent","ngZone","elementRef","appConfig","userPreferencesService","alfrescoApiService","lockService","DEFAULT_PAGINATION","Pagination","totalItems","DEFAULT_SORTING","display","DisplayMode","List","locationFormat","navigate","showHeader","ShowHeaderMode","Data","navigationMode","DOUBLE_CLICK_NAVIGATION","multiselect","contentActions","contentActionsPosition","contextMenuActions","additionalSorting","loading","_rowFilter","stickyHeader","headerFilters","preselectNodes","nodeClick","nodeDblClick","folderChange","preview","ready","nodeSelected","filterSelection","actions","contextActionHandler","noPermission","selection","$folderNode","allowFiltering","preselectedRows","_pagination","BehaviorSubject","sortingSubject","layoutPresets","rowMenuCache","UserPreferenceValues","PaginationSize","pagSize","rowFilter","reload","getContextActions","getNodeActions","currentAction","model","subject","columnList","getDefaultSorting","defaultSorting","isArray","_c","getLayoutPreset","ObjectDataColumn","isMobile","test","navigator","userAgent","isEmpty","loadLayoutPresets","val","contextActionCallback","enforceSingleClickNavigationForMobile","ngAfterContentInit","changes","setTableSchema","hasCustomLayout","setupDefaultColumns","resetSelection","buildOrderByArray","firstChange","currentValue","_d","previousValue","loadFolder","preserveExistingSelection","onPreselectNodes","onDataReady","run","reloadWithoutResettingSelection","syncPagination","executeContentAction","target_1","refreshAction","actionsByTarget","isActionDisabled","isActionVisible","onShowContextMenu","navigateTo","resetNewFolderPagination","canNavigateFolder","getNodeFolderDestinationId","isLinkFolder","updateCustomSourceData","handlerSub","setLoadingState","clearTimeout","loadingTimeout","setTimeout","documentNode","folderNode","onPageLoaded","dataTable","onSortingChanged","detail","sortingKey","currentKey","currentDirection","preset","onPreviewFile","onNodeClick","domEvent","CustomEvent","sender","bubbles","dispatchEvent","defaultPrevented","SINGLE_CLICK_NAVIGATION","executeActionClick","onNodeDblClick","onNodeSelect","onNodeUnselect","onShowRowContextMenu","onShowRowActionsMenu","onExecuteRowAction","externalSettings","get","updatePagination","requestPaginationModel","onFilterSelectionChange","activeFilters","message","parse","getPreselectedNodesBasedOnSelectionMode","hasPreselectedNodes","isSingleSelectionMode","getPreselectedRowsBasedOnSelectionMode","hasPreselectedRows","getSelectionBasedOnSelectionMode","preselectRowsOfPreselectedNodes","selectedNodes","preselectedRows_1","preselectedRows_1_1","selectRow","isMultipleSelectionMode","_e","rowOfSelection","preselectedNode","rowOfPreselectedNode","unselectRowFromNodeId","rowToUnselect","NgZone","AppConfigService","UserPreferencesService","LockService","ContentChild","DataColumnListComponent","CustomLoadingContentTemplateDirective","CustomNoPermissionTemplateDirective","CustomEmptyContentTemplateDirective","ViewChild","static","NodeActionsService","contentDialogService","dialogRef","downloadService","downloadNode","NodeDownloadDirective","copyContent","doFileOperation","COPY","copyFolder","moveContent","MOVE","moveFolder","selections","DownloadService","DocumentActionsService","nodeActionsService","permissionEvent","handlers","setupActionHandlers","getHandler","lKey","setHandler","canExecuteAction","_target","actionObservable","prepareHandlers","fileOperationMessage","handlerObservable","PermissionModel","FolderActionsService","ContentActionListComponent","documentList","registerAction","unregisterAction","idx","splice","ContentActionComponent","documentActions","folderActions","All","subscriptions","folderActionModel","generateAction","Folder","documentActionModel","Document","subscription","unsubscribe","unregister","register","getSystemHandler","providers","LibraryNameColumnComponent","displayTooltip$","displayText$","updateValue","nodeUpdated","context","makeLibraryTitle","makeLibraryTooltip","library","isDuplicate","some","changeDetection","ChangeDetectionStrategy","OnPush","LibraryRoleColumnComponent","api","role","Site","RoleEnum","SiteManager","SiteCollaborator","SiteContributor","SiteConsumer","LibraryStatusColumnComponent","visibility","VisibilityEnum","PUBLIC","PRIVATE","MODERATED","NameColumnComponent","displayText","SEARCH_QUERY_SERVICE_TOKEN","InjectionToken","BaseQueryBuilderService","configUpdated","updated","executed","searchForms","ReplaySubject","categories","queryFragments","sortingOptions","_userQuery","userFacetBuckets","config","ranges","resetToDefaults","trim","currentConfig","getDefaultConfiguration","resetSearchOptions","getSearchFormDetails","setUpSearchConfiguration","configurations","loadConfiguration","selectedConfiguration","configuration","updateSelectedConfiguration","update","scope","selected","currentConfiguration","category","enabled","defaults","addUserFacetBucket","bucket","buckets","facetBucket","getUserFacetBuckets","removeUserFacetBucket","addFilterQuery","filterQuery","removeFilterQuery","getFacetQuery","hasFacetQueries","facetQueries","queries","getFacetField","facetFields","fields","getSupportedLabel","setScope","getScope","queryBody","buildQuery","resultSetPaging","error_1","promise","getFinalQuery","facetIntervals","highlight","getPrimarySorting","getSortingOptions","getQueryGroup","intervals","def","RequestSortDefinitionInner","hasFacetIntervals","interval","sets","set","start","end","startInclusive","endInclusive","hasFacetHighlight","facet","customQuery","userQuery","keys","subQuery","facets","mincount","limit","offset","prefix","configLabel","SearchHeaderQueryBuilderService","nodeApiService","customSources","isFilterServiceActive","setupCurrentPagination","setActiveFilter","columnActivated","filterValue","selectedFilter","activeFilter","resetActiveFilters","getActiveFilters","isNoFilterActive","removeActiveFilter","columnRemoved","filterIndex","dataSorting","columnSorting","fieldValue","getSortingFieldFromColumnName","optionAscending","toLocaleLowerCase","currentSort","columnName","sortOption","option","getCategoryForColumn","columnKey","foundCategory","setCurrentRootFolderId","isCustomSourceNode","currentNodeId","getNodeIdForCustomSource","customSourceId","NodesApiService","FilterHeaderComponent","searchFilterQueryBuilder","newNodePaging","initDataPagination","initDataSorting","resetFilterHeader","configureSearchParent","newPagination","initSearchHeader","provide","useClass","decorators","TrashcanNameColumnComponent","isLibrary","displayTooltip","FileUploadingDialogComponent","changeDetector","position","alwaysVisible","filesUploadingList","isDialogActive","totalCompleted","totalErrors","isDialogMinimized","isConfirmation","dialogActive","delay","querySelector","focus","listSubscription","queueChanged","fileList","counterSubscription","fileUploadComplete","fileUploadDeleted","totalComplete","detectChanges","errorSubscription","fileUploadError","totalError","fileUploadSubscription","fileUpload","fileDeleted","objId","uploadedFile","status","FileUploadStatus","Cancelled","textOrientation","toggleConfirmation","cancelAllUploads","uploadList","cancelAllFiles","toggleMinimized","clearQueue","canShowDialog","canShowCancelAll","hasUploadInProgress","canCloseDialog","isUploadCompleted","isUploadCancelled","ChangeDetectorRef","HostBinding","FileUploadingListRowComponent","cancel","remove","onCancel","onRemove","showCancelledStatus","Aborted","Deleted","isUploadVersion","newVersion","FileUploadingListComponent","files","cancelFile","Pending","cancelUpload","removeFile","notifyError","cancelNodeVersionInstances","deletedFiles","isUploadingFile","Complete","Boolean","Starting","Progress","every","permanent","_i","messageError","fileName","total","TemplateRef","UploadFilesEvent","successEmitter","errorEmitter","isDefaultPrevented","pauseUpload","resumeUpload","addToQueue","uploadFilesInTheQueue","UploadBase","translationService","acceptedFilesType","versioning","majorVersion","beginUpload","updateFileVersion","uploadFiles","filteredFiles","createFileModel","webkitRelativePath","replace","uploadQueue","uploadFilesInfo","fileInfo","relativeFolder","isFileAcceptable","isFileSizeAcceptable","split","ext","extension","path","FileModel","comment","isFileSizeAllowed","isMaxFileSizeDefined","isFileSizeCorrect","maxFilesSize","acceptableSize","UploadButtonComponent","uploadFolders","multipleFiles","tooltip","permissionValue","checkPermission","isButtonDisabled","onFilesAdded","$event","FileUtils","toFileArray","currentTarget","onClickUploadButton","onDirectoryAdded","res","nodeHasPermission","viewProviders","EXTENDIBLE_COMPONENT","useExisting","forwardRef","UploadVersionButtonComponent","fileModel","UPDATE","UploadDragAreaComponent","onFilesDropped","onFolderEntityDropped","isDirectory","flatten","filesInfo","showUndoNotificationBar","latestFilesAdded","messageTranslate","actionTranslate","openSnackMessageAction","onAction","isDroppable","onUploadFiles","isTargetNodeFolder","destinationFolderName_1","FileUploadErrorPipe","transform","errorCode","Pipe","pure","FileDraggableDirective","el","filesDropped","folderEntityDropped","cssClassName","runOutsideAngular","addEventListener","onDragEnter","onDragOver","onDragLeave","onDropFiles","removeEventListener","items","dataTransfer","webkitGetAsEntry","getAsFile","classList","dropEffect","add","ToggleIconDirective","isFocus","toggle","onMouseEnter","onMouseLeave","onFocus","onBlur","exportAs","A11yModule","SearchControlComponent","authService","inputType","liveSearchEnabled","autocomplete","expandable","liveSearchMaxResults","searchChange","optionClicked","focusSubject","noSearchResultTemplate","searchTerm","isNoSearchTemplatePresent","emptySearchTemplate","isLoggedIn","isEcmLoggedIn","inputChange","getMimeType","elementClicked","FocusEvent","getNextElementSibling","isListElement","onSelectFirstResult","listResultElement","first","_getHostElement","onRowArrowDown","nextElement","onRowArrowUp","previousElement","getPreviousElementSibling","onReset","searchAutocomplete","resetResults","relatedTarget","className","nextElementSibling","previousElementSibling","AuthenticationService","ViewChildren","MatListItem","EmptySearchResultComponent","SearchComponent","searchService","_elementRef","displayWith","maxResults","skipResults","resultLoaded","showPanel","_isOpen","keyPressedStream","_classList","debounceTime","searchedWord","loadSearchResults","dataLoaded","onSearchDataLoaded","onSearchDataError","setVisibility","cleanResults","isOpen","hidePanel","preserveWhitespaces","SearchService","SearchTextComponent","isActive","enableChangeUpdate","displayValue$","settings","pattern","match","RegExp","exec","allowUpdateOnChange","startValue","setValue","clear","updateQuery","reset","onChangedHandler","getSearchPrefix","getSearchSuffix","submitValues","hasValidValue","getCurrentValue","searchPrefix","searchSuffix","SearchFilterList","pageSize","filteredItems","_filterText","currentPageSize","_filter","applyFilter","showMoreItems","canShowMoreItems","showLessItems","canShowLessItems","filterText","addItem","deleteItem","removeIndex","pointer","visibleItems","SearchRadioComponent","initialValue","getSelectedValue","updateDisplayValue","opt","selectOptions","changeHandler","SearchSliderComponent","thumbLabel","min","max","unit","LiveErrorStateMatcher","isErrorState","control","isSubmitted","submitted","invalid","dirty","touched","pristine","SearchNumberRangeComponent","matcher","validators","Validators","compose","required","FormControl","to","FormGroup","formValidator","formGroup","parseInt","mismatch","isValid","Map","formatString","str","expr","valid","SearchCheckListComponent","operator","clearOptions","checked","displayValue","checkedValues","getCheckedValues","MOMENT_DATE_FORMATS","SearchDateRangeComponent","dateAdapter","getFromValidationMessage","hasError","hasParseError","getToValidationMessage","datePickerFormat","dateFormat","overrideDisplayFormat","Locale","locale","setLocale","maxDate","today","endOf","splitValue","fromValue","toValue","setFromMaxDate","startOf","parsedDate","markAsDirty","markAsTouched","formControl","inputValue","formatDate","setErrors","invalidOnChange","getError","text","forcePlaceholder","srcElement","click","fromMaxDate","isBefore","DateAdapter","MomentDateAdapter","deps","MAT_DATE_LOCALE","MAT_DATE_FORMATS","useValue","ɵ0","MAT_MOMENT_DATETIME_FORMATS","SearchDatetimeRangeComponent","datetimePickerFormat","datetimeFormat","maxDatetime","setFromMaxDatetime","utc","fromMaxDatetime","MAT_DATETIME_FORMATS","ɵ0$1","DatetimeAdapter","widgets","radio","slider","number-range","check-list","date-range","datetime-range","SearchWidgetContainerComponent","searchFilterService","queryBuilder","componentFactoryResolver","componentType","factory","setupWidget","ref","destroy","applyInnerWidget","hasValueSelected","getDisplayValue","resetInnerWidget","SearchFilterService","read","SearchQueryBuilderService","SearchFacetFiltersService","responseFacets","selectedBuckets","DEFAULT_PAGE_SIZE","facetQueriesPageSize","onDataLoaded","parseFacets","parseFacetFields","parseFacetIntervals","parseFacetQueries","parseFacetItems","configFacetFields","itemType","responseField","findFacet","responseBuckets","getResponseBuckets","getFilterByMinCount","alreadyExistingField","findResponseFacet","alreadyExistingBuckets","updateExistingBuckets","bucketList","getBucketFilterFunction","configFacetIntervals","facetQuerySetting","configGroups","reduce","acc","mincountFilter","getResponseQueryBuckets","configField","respBucket","getCountValue","getCorrespondingFilterQuery","configGroup","metrics","getBucketCountDisplay","mincountInput","configFacetItem","bucketLabel","configSet","buildIntervalQuery","fieldName","fieldLabel","bucketsToDelete","responseBucket","selBuckets","oldBucket","filterWithContains","startsWith","unselectFacetBucket","updateSelectedBuckets","this_1","resetAllSelectedBuckets","resetQueryFragments","SearchFilterComponent","facetFiltersService","showContextFacets","facetQueriesLabel","facetExpanded","expanded","displayResetButton","resetButton","shouldExpand","clearAll","ContentNodeSelectorPanelService","propertyTypes","modelPropertyTypeToSearchFilterTypeMap","convertCustomModelPropertiesToSearchCategories","searchConfig","customModels","propertyModel","convertModelPropertyIntoSearchFilter","modelProperty","filterSearch","isTypeSupported","dataType","prefixedName","component","placeholder","SearchPanelComponent","contentNodeSelectorPanelService","queryBuilderService","hasCustomModels","SearchSortingPickerComponent","primary","onValueChanged","getSortingOrder","applySorting","findOptionByKey","SearchFilterContainerComponent","focusTrapFactory","filterChange","onKeyPressed","menuTrigger","widgetContainer","onApply","closeMenu","resetSearchFilter","onClearButtonClick","getTooltipTranslation","columnTitle","onMenuOpen","filterContainer","focusTrap","focusInitialElement","onClosed","ConfigurableFocusTrapFactory","SearchFormComponent","formChange","onSelectionChange","getSelected","forms","SearchFilterMenuCardComponent","onClose","SearchFacetFieldComponent","searchFacetFiltersService","onToggleBucket","selectFacetBucket","canUpdateOnChange","canResetSelectedBuckets","resetSelectedBuckets","_f","SearchWidgetChipComponent","menuContainer","widgetContainerComponent","SearchFacetChipComponent","facetFieldComponent","ResetSearchDirective","filterService","SearchChipListComponent","SearchFilterChipsComponent","Relations","FlexLayoutModule","UploadModule","EditJsonDialogModule","SearchModule","DropdownSitesComponent","sitesService","hideMyFiles","siteList","change","MY_FILES_VALUE","loadSiteList","loadAllOnScroll","isInfiniteScrollingEnabled","selectedSite","extendedOptions","InfiniteSelectScrollDirective","MAX_ITEMS","relations","sitePaging","Members","filteredResultsByMember","siteEntry","SiteEntry","unshift","siteListHasMoreItems","showLoading","sites","loggedUserName","getEcmCurrentLoggedUserName","isCurrentUserMember","members","member","BreadcrumbComponent","root","rootId","route","readOnly","recalculateNodes","parseRoute","lastNodes","previousNodes","reverse","dropdown","hasPreviousNodes","elements","rootPos","getElementPosition","findIndex","breadcrumbItemIsAnchor","lastItem","onRoutePathClick","onRouteClick","DropdownBreadcrumbComponent","ConfirmDialogComponent","sanitizer","yesLabel","thirdOptionLabel","noLabel","htmlContent","sanitizedHtmlContent","sanitize","SecurityContext","HTML","DomSanitizer","ContentVersionService","_contentApi","ContentApi","getVersionContentUrl","versionId","attachment","nodeDownloadUrl","contentApi","getContentUrl","VersionListComponent","contentVersionService","versions","showComments","allowDownload","allowViewVersions","showActions","restored","deleted","viewVersion","_versionsApi","VersionsApi","loadVersionHistory","canUpdate","canDelete","restore","versionsApi","revertVersion","onVersionRestored","onViewVersion","listVersionHistory","versionPaging","downloadVersion","versionDownloadUrl","downloadContent","deleteVersion","minWidth","onVersionDeleted","url","link","document","createElement","style","href","appendChild","removeChild","VersionManagerComponent","showVersionComparison","uploadSuccess","uploadError","uploadCancel","uploadState","newFileVersion","toggleNewVersion","versionListComponent","onUploadSuccess","onUploadError","onUploadCancel","animations","trigger","state","height","opacity","transition","animate","VersionUploadComponent","semanticVersion","uploadVersion","minorVersion","showUploadButton","showCancelButton","versionChanged","commentChanged","version","getNextMinorVersion","getNextMajorVersion","canUpload","isMajorVersion","onVersionChange","onCommentChange","onSuccess","getParsedVersion","major","minor","substr","VersionComparisonComponent","NameLocationCellComponent","fullPath","defaultValidation","ContentNodeSelectorPanelComponent","nodesApiService","appConfigService","showSiteList","showSearchField","showCounter","restrictRootToCurrentFolderId","dropdownHideMyFiles","dropdownSiteList","_excludeSiteContent","navigationChange","siteChange","folderLoaded","showingSearchResults","loadingSearchResults","inDialog","_chosenNode","selectionWithoutValidation","folderIdToShow","breadcrumbFolderTitle","startSiteGuid","hasValidQuery","Never","infiniteScroll","debounceSearch","searchInput","preselectedNodes","currentUploadBatch","searchPanelExpanded","createRowFilter","showFilesQuery","valueChanges","searchValue","prepareDialogForNewSearch","resetFolderToShow","clearSearch","showSearchResults","breadcrumbRootId","siteId","getStartSite","breadcrumbTransform","onFileUploadEvent","onFileUploadDeletedEvent","resetPagination","setSearchScopeToNodes","toggleSearchPanel","fileUploadEvent","getPreselectNodesBasedOnSelectionMode","deletedFileEvent","startNodeEntry","getSiteNameFromNodePath","getSite","startSiteEntry","isExcludedSiteContent","siteChanged","chosenSite","setTitleIfCustomSite","infinitePaginationComponent","addCorrespondingNodeIdsQuery","resetChosenNode","extraParentFiltering","nodeIds","extraId","parentFiltering","locations","onFolderChange","updatePaginationAfterRowFilter","attemptNodeSelection","showBreadcrumbs","getNextPageOfSearch","onCurrentSelection","nodesEntries","validNodesEntity","hasPreselectNodes","HighlightDirective","InfinitePaginationComponent","SitesDropdownModule","BreadcrumbModule","DocumentListModule","ContentDirectiveModule","I18N_ERRORS_PATH","forbidSpecialCharacters","forbidEndingDot","forbidOnlySpaces","FolderDialogComponent","editTitle","createTitle","parentNodeId","createFolder","edit","updateNode","editing","errorMessage","LibraryDialogComponent","libraryTitleExists","visibilityOptions","disableCreateButton","_queriesApi","QueriesApi","maxLength","minLength","createSiteIdValidator","visibilityOption","controls","mergeMap","checkLibraryNameExists","canGenerateId","patchValue","finalize","visibilityChangeHandler","siteBody","createSite","input","libraryTitle","findLibraryByTitle","queriesApi","findSites","timer","MatMomentDatetimeModule","MatDatetimepickerModule","FolderCreateDirective","openDialog","DIALOG_WIDTH","dialogConfig","dialogInstance","componentInstance","folderCreate","FolderEditDirective","folderEdit","BasicPropertiesService","fileSizePipe","getProperties","sizeInBytes","mimeTypeName","author","CardViewTextItemModel","editable","createdByUser","displayName","CardViewDateItemModel","createdAt","pipes","modifiedByUser","modifiedAt","multiline","FileSizePipe","D_TEXT","D_MLTEXT","D_DATE","D_DATETIME","D_INT","D_LONG","D_FLOAT","D_DOUBLE","D_BOOLEAN","PropertyGroupTranslatorService","multiValuePipe","decimalNumberPipe","valueSeparator","translateToCardViewGroups","propertyGroups","propertyValues","definition","propertyGroup","translatedPropertyGroup","translateArray","translateProperty","property","allowEditing","checkECMTypeValidity","propertyDefinition","defaultValue","isProtected","constraints","isMultiValued","translate","getPropertyConstraints","propertyValue","protected","multiValued","cardViewItemProperty","isListOfValues","parameters","allowedValues","options$","CardViewSelectItemModel","CardViewIntItemModel","multivalued","CardViewFloatItemModel","CardViewDatetimeItemModel","CardViewBoolItemModel","constraint","propertyName","ecmPropertyType","RECOGNISED_ECM_TYPES","MultiValuePipe","DecimalNumberPipe","emptyGroup","getGroup","groupName","getProperty","propertyDefinitions","object","groupDefinition","AspectOrientedConfigService","isGroupAllowed","isIncludeAllEnabled","reorganiseByConfig","aspects","groupAccumulator","aspectName","newGroup","getOrganisedPropertyGroup","organisedPropertyGroup","appendAllPreset","isAspectReadOnly","setReadOnlyProperty","isPropertyReadOnly","readOnlyAspects","readOnlyProperties","propertyGroupName","filterExcludedPreset","exclude","includeAll","aspectProperties","props","IndifferentConfigService","LayoutOrientedConfigService","getMatchingGroups","itemsGroup","layoutBlock","flattenItems","explodedItem","isProperty","setPropertyTitle","setEditableProperty","excludedConfig","includeAllProperty","itemConfig","accumulator","flattenedProperties","aspect","ContentMetadataConfigFactory","presetName","presetConfig","presets","DEFAULT_PRESET_NAME","INDIFFERENT_PRESET","createConfig","isLayoutOrientedPreset","isAspectOrientedPreset","freeze","isObject","x","PropertyDescriptorsService","_classesApi","ClassesApi","load","groupNames","groupFetchStreams","defer","classesApi","getClass","convertToObject","propertyGroupsArray","ContentTypeService","_typesApi","TypesApi","getContentTypeByPrefix","prefixedType","typesApi","getType","getContentTypeChildren","listTypes","ContentTypeDialogComponent","contentTypeService","typeProperties","propertyColumns","confirmMessage","contentTypeEntry","currentContentType","namespacePrefix","ContentTypePropertiesService","versionCompatibilityService","propertyGroupTranslatorService","getContentTypeCardItem","isVersionSupported","contentTypesOptions$","getContentTypesAsSelectOption","contentTypeCard","buildContentTypeSelectCardModel","filteredProperties","getContentTypeSpecificProperties","buildCardItemsFromPropertyList","buildContentTypeTextCardModel","currentProperties","buildCardItemFromProperty","displayNoneOption","currentType","childrenTypes$","zip","distinctUntilChanged","contentTypesEntries","appendCurrentType","resultTypes","openContentTypeDialogConfirm","closeAll","VersionCompatibilityService","ContentMetadataService","basicPropertiesService","contentMetadataConfigFactory","propertyDescriptorsService","contentTypePropertyService","getBasicProperties","getContentTypeProperty","openConfirmDialog","changedProperties","getGroupedProperties","groupedProperties","contentMetadataConfig_1","groups","iif","filterEmptyPreset","setTitleToNameIfNotSet","ContentMetadataComponent","contentMetadataService","cardViewUpdateService","displayEmpty","multi","displayDefaultProperties","displayAspect","copyToClipboardAction","useChipsForMultiValueProperty","hasMetadataChanged","multiValueSeparator","DEFAULT_SEPARATOR","itemUpdated$","updatedNode","targetProperty","updateChanges","changed","updatedAspect$","loadProperties","handleUpdateError","basicProperties$","groupedProperties$","properties$","contentTypeProperty$","baseProperty","updatedNodeChanges","saveChanges","hasContentTypeChanged","updateElement","updateNodeAspect","revertChanges","cancelChanges","showGroup","canExpandTheCard","canExpandProperties","keyDown","CardViewUpdateService","AspectListDialogComponent","currentAspectSelection","overTableMessage","aspectList","AspectListService","_aspectsApi","AspectsApi","getAspects","visibleAspectList","getVisibleAspects","standardAspects$","getStandardAspects","customAspects$","getCustomAspects","whiteList","aspectsApi","listAspects","filterAspectByConfig","aspectEntries","aspectVisibleConfig","aspectGroup","openAspectListDialog","NodeAspectService","aspectListService","updateNodeAspects","ContentMetadataCardComponent","nodeAspectService","_displayDefaultProperties","editAspectSupported","onDisplayDefaultPropertiesChange","toggleEdit","toggleExpanded","openAspectDialog","isEditAspectSupported","isInherited","authorityId","accessStatus","NodePermissionService","searchApiService","nodeService","_groupsApi","GroupsApi","getNodeRoles","retrieveSiteQueryBody","buildRetrieveSiteQueryBody","searchByQueryBody","siteNodeList","siteName","getGroupMembersBySiteName","permissions","settable","getNodePermissions","locallySet","permissionElement","PermissionDisplayModel","inherited","permissionInherited","updatePermissionRole","updatedPermissionRole","permissionBody","updateNodePermissions","permissionList","updateLocallySetPermissions","duplicatedPermissions","getDuplicatedPermissions","duplicatePermissionMessage","nodeLocallySet","permissionListAdded","duplicatePermissions","duplicate","localPermission","isEqualPermission","oldPermission","newPermission","removePermission","permissionToRemove","getGroupMemberByGroupName","groupMemberPaging","displayResult","formattedRoleName","groupsApi","listGroupMemberships","nodePath","getLocalPermissions","getInheritedPermission","removePermissions","updatePermissions","getNodeWithRoles","roles","_roles","transformNodeToUserPerson","firstName","lastName","email","EcmUserModel","Group","MemberModel","readonly","parseFromSearchResult","toPermissionElement","AddPermissionDialogComponent","isSearchActive","selectedMembers","existingMembers","currentSelection","onAddClicked","confirm","onSearchAddClicked","newMembers","existingMember","disableSearch","enableSearch","onBulkUpdate","onMemberDelete","onMemberUpdate","NodePermissionDialogService","nodePermissionService","openAddPermissionDialog","UPDATEPERMISSIONS","currentPanelClass","chosenWidth","restoreFocus","updateNodePermissionByDialog","PermissionListService","nodePermissionDialogService","errored","loading$","error$","nodeWithRoles$","data$","nodeLocalPermissions","localPermissions","updateReadOnlyPermission","inheritedPermissions","SITE_MANAGER_ROLE","fetchPermission","toggleInherited","updateLocalPermission$","nodeBody_1","isInheritanceEnabled","getManagerAuthority","showInfo","reloadNode","source","showWarning","isGroup","user","deletePermissions","updateRole","buildUpdatedPermission","bulkRoleUpdate","deletePermission","cloneNode","canUpdateThePermission","sitePath","hasLocalManagerPermission","PermissionListComponent","selectedPermissions","deleteSelection","updatePermission","updateAllPermission","InheritPermissionDirective","onInheritPermissionClicked","nodeBody","(click)","SEARCH_QUERY_TOKEN","SearchPermissionConfigurationService","queryProvider","generateQueryBody","getQuery","AddPermissionPanelComponent","selectedItems","EVERYONE","NodeEntry","cm:authorityName","selectionOptions","matSelectionList","selectedOptions","deselectAll","uniqueSelection","uniquesElements","currentElement","uniqueElement","SearchConfigurationService","MatSelectionList","AddPermissionComponent","currentNodeRoles","isAddEnabled","applySelection","transformNodeToPermissionElement","UserIconColumnComponent","UserNameColumnComponent","subTitleText$","permissionGroup","updatePerson","updateGroup","UserRoleColumnComponent","roleChanged","onRoleChanged","newRole","NodePathColumnComponent","PermissionContainerComponent","isReadOnly","showLocation","updateAll","delete","bulkSelectionRole","permissionRow","PopOverDirective","overlay","vcr","_open","destroy$","createOverlay","attachOverlay","detachOverlay","scrollStrategy","scrollStrategies","reposition","positionStrategy","flexibleConnectedTo","withPositions","ConnectionPositionPair","originX","originY","overlayX","overlayY","withPush","overlayRef","hasBackdrop","backdropClass","hasAttached","periodSelectorPortal","TemplatePortal","popOver","attach","detach","Overlay","PipeModule","ShareDialogComponent","sharedLinksApiService","renditionService","minDate","isFileShared","isDisabled","sharedUrl","maxDebounceTime","baseShareUrl","sharedId","updateForm","createSharedLinks","onTimeChanged","date","updateEntryExpiryDate","onSlideShareChange","openConfirmationDialog","onToggleExpirationDate","slideToggle","enable","disable","onDatetimepickerClosed","dateTimePickerInput","blur","slideToggleExpirationDate","closeOnNavigation","beforeClosed","deleteSharedLink","sharedLink","qshare:sharedId","generateRenditionForNode","expiryDate","local","qshare:expiryDate","SharedLinksApiService","RenditionsService","NodeSharedDirective","zone","isShared","shareNode","getNodeInfo","openShareLinkDialog","onStable","ContentNodeShareModule","forRoot","ngModule","forChild","level","TreeViewService","nodeApi","getTreeNodes","getNodeChildren","nodePage","TreeBaseNode","TreeViewDataSource","treeControl","treeViewService","dataChange","childrenSubscription","changeSubscription","treeNodes","dataNodes","connect","collectionViewer","expansionModel","added","expandTreeNodes","removed","reduceTreeNodes","viewChange","disconnect","expandNode","toggleNode","actualNode","FlatTreeControl","TreeViewComponent","nodeClicked","getLevel","isExpandable","hasChild","nodeData","dataSource","loadTreeNode","onNodeClicked","treeNode","GroupService","listAllGroupMembershipsForPerson","listGroupMembershipsForPerson","groupsPaginated","skip","AspectListComponent","valueChanged","aspects$","nodeAspectStatus","hasEqualAspect","node$","customAspect$","customAspects","flatMap","customAspect","tap","concatMap","onCheckBoxClick","onChange","updateEqualityOfAspectList","getTitle","MatTableModule","MatTooltipModule","ContentModule","TRANSLATION_PROVIDER","SocialModule","TagModule","WebScriptModule","DialogModule","ContentNodeSelectorModule","ContentMetadataModule","FolderDirectiveModule","PermissionManagerModule","VersionManagerModule","TreeViewModule","ContentTypeModule","AspectListModule"],"mappings":"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","sourcesContent":["/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NgModule } from '@angular/core';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatOptionModule, MatRippleModule } from '@angular/material/core';\nimport { MatDatepickerModule } from '@angular/material/datepicker';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatListModule } from '@angular/material/list';\nimport { MatMenuModule } from '@angular/material/menu';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatSlideToggleModule } from '@angular/material/slide-toggle';\nimport { MatSliderModule } from '@angular/material/slider';\nimport { MatTreeModule } from '@angular/material/tree';\nimport { MatBadgeModule } from '@angular/material/badge';\n\n@NgModule({\n    imports: [\n        MatButtonModule,\n        MatChipsModule,\n        MatDialogModule,\n        MatIconModule,\n        MatCardModule,\n        MatInputModule,\n        MatListModule,\n        MatProgressSpinnerModule,\n        MatProgressBarModule,\n        MatRippleModule,\n        MatMenuModule,\n        MatOptionModule,\n        MatExpansionModule,\n        MatSelectModule,\n        MatCheckboxModule,\n        MatDatepickerModule,\n        MatSlideToggleModule,\n        MatRadioModule,\n        MatSliderModule,\n        MatTreeModule,\n        MatBadgeModule\n    ],\n    exports: [\n        MatButtonModule,\n        MatChipsModule,\n        MatDialogModule,\n        MatIconModule,\n        MatCardModule,\n        MatInputModule,\n        MatListModule,\n        MatProgressSpinnerModule,\n        MatProgressBarModule,\n        MatRippleModule,\n        MatMenuModule,\n        MatOptionModule,\n        MatExpansionModule,\n        MatSelectModule,\n        MatCheckboxModule,\n        MatDatepickerModule,\n        MatSlideToggleModule,\n        MatRadioModule,\n        MatSliderModule,\n        MatTreeModule,\n        MatBadgeModule\n    ]\n})\nexport class MaterialModule {\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodeEntry, NodePaging } from '@alfresco/js-api';\n\nexport class DocumentLoaderNode {\n    currentNode: NodeEntry;\n    children: NodePaging;\n\n    constructor(currentNode: NodeEntry, children: NodePaging) {\n        this.currentNode = currentNode;\n        this.children = children;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AlfrescoApiService, LogService, PaginationModel } from '@alfresco/adf-core';\nimport {\n    NodePaging,\n    DeletedNodesPaging,\n    SearchRequest,\n    SharedLinkPaging,\n    FavoritePaging,\n    SiteMemberPaging,\n    SiteRolePaging,\n    PeopleApi,\n    SitesApi,\n    SearchApi,\n    FavoritesApi,\n    SharedlinksApi,\n    TrashcanApi,\n    NodesApi\n} from '@alfresco/js-api';\nimport { Injectable } from '@angular/core';\nimport { Observable, from, of, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\n\n@Injectable({ providedIn: 'root' })\nexport class CustomResourcesService {\n\n    private CREATE_PERMISSION = 'create';\n\n    _peopleApi: PeopleApi;\n    get peopleApi(): PeopleApi {\n        this._peopleApi = this._peopleApi ?? new PeopleApi(this.apiService.getInstance());\n        return this._peopleApi;\n    }\n\n    _sitesApi: SitesApi;\n    get sitesApi(): SitesApi {\n        this._sitesApi = this._sitesApi ?? new SitesApi(this.apiService.getInstance());\n        return this._sitesApi;\n    }\n\n    _trashcanApi: TrashcanApi;\n    get trashcanApi(): TrashcanApi {\n        this._trashcanApi = this._trashcanApi ?? new TrashcanApi(this.apiService.getInstance());\n        return this._trashcanApi;\n    }\n\n    _searchApi: SearchApi;\n    get searchApi(): SearchApi {\n        this._searchApi = this._searchApi ?? new SearchApi(this.apiService.getInstance());\n        return this._searchApi;\n    }\n\n    _sharedLinksApi: SharedlinksApi;\n    get sharedLinksApi(): SharedlinksApi {\n        this._sharedLinksApi = this._sharedLinksApi ?? new SharedlinksApi(this.apiService.getInstance());\n        return this._sharedLinksApi;\n    }\n\n    _favoritesApi: FavoritesApi;\n    get favoritesApi(): FavoritesApi {\n        this._favoritesApi = this._favoritesApi ?? new FavoritesApi(this.apiService.getInstance());\n        return this._favoritesApi;\n    }\n\n    _nodesApi: NodesApi;\n    get nodesApi(): NodesApi {\n        this._nodesApi = this._nodesApi ?? new NodesApi(this.apiService.getInstance());\n        return this._nodesApi;\n    }\n\n    constructor(private apiService: AlfrescoApiService, private logService: LogService) {\n    }\n\n    /**\n     * Gets files recently accessed by a user.\n     * @param personId ID of the user\n     * @param pagination Specifies how to paginate the results\n     * @param filters Specifies additional filters to apply (joined with **AND**)\n     * @returns List of nodes for the recently used files\n     */\n    getRecentFiles(personId: string, pagination: PaginationModel, filters?: string[]): Observable<NodePaging> {\n        const defaultFilter = [\n            'TYPE:\"content\"',\n            '-PNAME:\"0/wiki\"',\n            '-TYPE:\"app:filelink\"',\n            '-TYPE:\"cm:thumbnail\"',\n            '-TYPE:\"cm:failedThumbnail\"',\n            '-TYPE:\"cm:rating\"',\n            '-TYPE:\"dl:dataList\"',\n            '-TYPE:\"dl:todoList\"',\n            '-TYPE:\"dl:issue\"',\n            '-TYPE:\"dl:contact\"',\n            '-TYPE:\"dl:eventAgenda\"',\n            '-TYPE:\"dl:event\"',\n            '-TYPE:\"dl:task\"',\n            '-TYPE:\"dl:simpletask\"',\n            '-TYPE:\"dl:meetingAgenda\"',\n            '-TYPE:\"dl:location\"',\n            '-TYPE:\"fm:topic\"',\n            '-TYPE:\"fm:post\"',\n            '-TYPE:\"ia:calendarEvent\"',\n            '-TYPE:\"lnk:link\"'\n        ];\n\n        return new Observable((observer) => {\n            this.peopleApi.getPerson(personId)\n                .then((person) => {\n                        const username = person.entry.id;\n                        const filterQueries = [\n                            { query: `cm:modified:[NOW/DAY-30DAYS TO NOW/DAY+1DAY]` },\n                            { query: `cm:modifier:${username} OR cm:creator:${username}` },\n                            { query: defaultFilter.join(' AND ') }\n                        ];\n\n                        if (filters && filters.length > 0) {\n                            filterQueries.push({\n                                query: filters.join()\n                            });\n                        }\n\n                        const query = new SearchRequest({\n                            query: {\n                                query: '*',\n                                language: 'afts'\n                            },\n                            filterQueries,\n                            include: ['path', 'properties', 'allowableOperations'],\n                            sort: [{\n                                type: 'FIELD',\n                                field: 'cm:modified',\n                                ascending: false\n                            }],\n                            paging: {\n                                maxItems: pagination.maxItems,\n                                skipCount: pagination.skipCount\n                            }\n                        });\n                        return this.searchApi.search(query)\n                            .then((searchResult) => {\n                                    observer.next(searchResult);\n                                    observer.complete();\n                                },\n                                (err) => {\n                                    observer.error(err);\n                                    observer.complete();\n                                });\n                    },\n                    (err) => {\n                        observer.error(err);\n                        observer.complete();\n                    });\n        }).pipe(catchError((err) => this.handleError(err)));\n    }\n\n    /**\n     * Gets favorite files for the current user.\n     * @param pagination Specifies how to paginate the results\n     * @param includeFields List of data field names to include in the results\n     * @param where A string to restrict the returned objects by using a predicate\n     * @returns List of favorite files\n     */\n    loadFavorites(pagination: PaginationModel, includeFields: string[] = [], where?: string): Observable<NodePaging> {\n        const includeFieldsRequest = this.getIncludesFields(includeFields);\n        const defaultPredicate = '(EXISTS(target/file) OR EXISTS(target/folder))';\n\n        const options = {\n            maxItems: pagination.maxItems,\n            skipCount: pagination.skipCount,\n            where: where ? `${where} AND ${defaultPredicate}` : defaultPredicate,\n            include: includeFieldsRequest\n        };\n\n        return new Observable((observer) => {\n            this.favoritesApi.listFavorites('-me-', options)\n                .then((result: FavoritePaging) => {\n                        const page: FavoritePaging = {\n                            list: {\n                                entries: result.list.entries\n                                    .map(({ entry }: any) => {\n                                        const target = entry.target.file || entry.target.folder;\n                                        target.properties = {\n                                            ...(target.properties || {\n                                                'cm:title': entry.title || target.title,\n                                                'cm:description': entry.description || target.description\n                                            }),\n                                            ...(entry.properties || {})\n                                        };\n\n                                        return {\n                                            entry: target\n                                        };\n                                    }),\n                                pagination: result.list.pagination\n                            }\n                        };\n\n                        observer.next(page);\n                        observer.complete();\n                    },\n                    (err) => {\n                        observer.error(err);\n                        observer.complete();\n                    });\n        }).pipe(catchError((err) => this.handleError(err)));\n    }\n\n    /**\n     * Gets sites that the current user is a member of.\n     * @param pagination Specifies how to paginate the results\n     * @param where A string to restrict the returned objects by using a predicate\n     * @returns List of sites\n     */\n    loadMemberSites(pagination: PaginationModel, where?: string): Observable<SiteMemberPaging> {\n        const options = {\n            include: ['properties'],\n            maxItems: pagination.maxItems,\n            skipCount: pagination.skipCount,\n            where\n        };\n\n        return new Observable((observer) => {\n            this.sitesApi.listSiteMembershipsForPerson('-me-', options)\n                .then((result: SiteRolePaging) => {\n                        const page: SiteMemberPaging = new SiteMemberPaging({\n                            list: {\n                                entries: result.list.entries\n                                    .map(({ entry: { site } }: any) => {\n                                        site.allowableOperations = site.allowableOperations ? site.allowableOperations : [this.CREATE_PERMISSION];\n                                        site.name = site.name || site.title;\n                                        return {\n                                            entry: site\n                                        };\n                                    }),\n                                pagination: result.list.pagination\n                            }\n                        });\n\n                        observer.next(page);\n                        observer.complete();\n                    },\n                    (err) => {\n                        observer.error(err);\n                        observer.complete();\n                    });\n        }).pipe(catchError((err) => this.handleError(err)));\n    }\n\n    /**\n     * Gets all sites in the repository.\n     * @param pagination Specifies how to paginate the results\n     * @param where A string to restrict the returned objects by using a predicate\n     * @returns List of sites\n     */\n    loadSites(pagination: PaginationModel, where?: string): Observable<NodePaging> {\n        const options = {\n            include: ['properties', 'aspectNames'],\n            maxItems: pagination.maxItems,\n            skipCount: pagination.skipCount,\n            where\n        };\n\n        return new Observable((observer) => {\n            this.sitesApi\n                .listSites(options)\n                .then(\n                    (page) => {\n                        page.list.entries.map(\n                            ({ entry }: any) => {\n                                entry.name = entry.name || entry.title;\n                                return { entry };\n                            }\n                        );\n                        observer.next(page);\n                        observer.complete();\n                    },\n                    (err) => {\n                        observer.error(err);\n                        observer.complete();\n                    });\n        }).pipe(catchError((err) => this.handleError(err)));\n    }\n\n    /**\n     * Gets all items currently in the trash.\n     * @param pagination Specifies how to paginate the results\n     * @param includeFields List of data field names to include in the results\n     * @returns List of deleted items\n     */\n    loadTrashcan(pagination: PaginationModel, includeFields: string[] = []): Observable<DeletedNodesPaging> {\n        const includeFieldsRequest = this.getIncludesFields(includeFields);\n\n        const options = {\n            include: includeFieldsRequest,\n            maxItems: pagination.maxItems,\n            skipCount: pagination.skipCount\n        };\n\n        return from(this.trashcanApi.listDeletedNodes(options))\n            .pipe(catchError((err) => this.handleError(err)));\n\n    }\n\n    /**\n     * Gets shared links for the current user.\n     * @param pagination Specifies how to paginate the results\n     * @param includeFields List of data field names to include in the results\n     * @param where A string to restrict the returned objects by using a predicate\n     * @returns List of shared links\n     */\n    loadSharedLinks(pagination: PaginationModel, includeFields: string[] = [], where?: string): Observable<SharedLinkPaging> {\n        const includeFieldsRequest = this.getIncludesFields(includeFields);\n\n        const options = {\n            include: includeFieldsRequest,\n            maxItems: pagination.maxItems,\n            skipCount: pagination.skipCount,\n            where\n        };\n\n        return from(this.sharedLinksApi.listSharedLinks(options))\n            .pipe(catchError((err) => this.handleError(err)));\n    }\n\n    /**\n     * Is the folder ID one of the well-known aliases?\n     * @param folderId Folder ID name to check\n     * @returns True if the ID is a well-known name, false otherwise\n     */\n    isCustomSource(folderId: string): boolean {\n        let isCustomSources = false;\n        const sources = ['-trashcan-', '-sharedlinks-', '-sites-', '-mysites-', '-favorites-', '-recent-'];\n\n        if (sources.indexOf(folderId) > -1) {\n            isCustomSources = true;\n        }\n\n        return isCustomSources;\n    }\n\n    /**\n     * Is the folder ID a \"-my\", \"-root-\", or \"-shared-\" alias?\n     * @param folderId Folder ID name to check\n     * @returns True if the ID is one of the supported sources, false otherwise\n     */\n    isSupportedSource(folderId: string): boolean {\n        let isSupportedSources = false;\n        const sources = ['-my-', '-root-', '-shared-'];\n\n        if (sources.indexOf(folderId) > -1) {\n            isSupportedSources = true;\n        }\n\n        return isSupportedSources;\n    }\n\n    /**\n     * Gets a folder's contents.\n     * @param nodeId ID of the target folder node\n     * @param pagination Specifies how to paginate the results\n     * @param includeFields List of data field names to include in the results\n     * @param where  Filters the Node list using the *where* condition of the REST API (for example, isFolder=true). See the REST API documentation for more information.\n     * @returns List of items contained in the folder\n     */\n    loadFolderByNodeId(nodeId: string, pagination: PaginationModel, includeFields: string[] = [], where?: string): any {\n        if (nodeId === '-trashcan-') {\n            return this.loadTrashcan(pagination, includeFields);\n        } else if (nodeId === '-sharedlinks-') {\n            return this.loadSharedLinks(pagination, includeFields, where);\n        } else if (nodeId === '-sites-') {\n            return this.loadSites(pagination, where);\n        } else if (nodeId === '-mysites-') {\n            return this.loadMemberSites(pagination, where);\n        } else if (nodeId === '-favorites-') {\n            return this.loadFavorites(pagination, includeFields, where);\n        } else if (nodeId === '-recent-') {\n            return this.getRecentFiles('-me-', pagination);\n        }\n    }\n\n    // TODO: remove it from here\n\n    /**\n     * Gets the contents of one of the well-known aliases in the form of node ID strings.\n     * @param nodeId ID of the target folder node\n     * @param pagination Specifies how to paginate the results\n     * @returns List of node IDs\n     */\n    getCorrespondingNodeIds(nodeId: string, pagination: PaginationModel = {}): Observable<string[]> {\n        if (this.isCustomSource(nodeId)) {\n\n            return this.loadFolderByNodeId(nodeId, pagination)\n                .pipe(map((result: any): string[] => {\n                    return result.list.entries.map((node: any): string => this.getIdFromEntry(node, nodeId));\n                }));\n\n        } else if (nodeId) {\n            // cases when nodeId is '-my-', '-root-' or '-shared-'\n            return from(this.nodesApi.getNode(nodeId)\n                .then((node) => [node.entry.id]));\n        }\n\n        return of([]);\n    }\n\n    /**\n     * Chooses the correct ID for a node entry.\n     * @param node Node object\n     * @param nodeId ID of the node object\n     * @returns ID value\n     */\n    getIdFromEntry(node: any, nodeId: string): string {\n        if (nodeId === '-sharedlinks-') {\n            return node.entry.nodeId;\n        } else if (nodeId === '-sites-' || nodeId === '-mysites-') {\n            return node.entry.guid;\n        } else if (nodeId === '-favorites-') {\n            return node.entry.targetGuid;\n        } else {\n            return node.entry.id;\n        }\n    }\n\n    /**\n     * Does the well-known alias have a corresponding node ID?\n     * @param nodeId Node to check\n     * @returns True if the alias has a corresponding node ID, false otherwise\n     */\n    hasCorrespondingNodeIds(nodeId: string): boolean {\n        return this.isCustomSource(nodeId) || this.isSupportedSource(nodeId);\n    }\n\n    private getIncludesFields(includeFields: string[]): string[] {\n        return ['path', 'properties', 'allowableOperations', 'permissions', 'aspectNames', ...includeFields]\n            .filter((element, index, array) => index === array.indexOf(element));\n    }\n\n    private handleError(error: Response) {\n        this.logService.error(error);\n        return throwError(error || 'Server error');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport enum NodeAction {\n    ATTACH = 'ATTACH',\n    CHOOSE = 'CHOOSE',\n    COPY = 'COPY',\n    MOVE = 'MOVE',\n    NEXT = 'NEXT'\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    AlfrescoApiService, ContentService, LogService, PaginationModel\n} from '@alfresco/adf-core';\n\nimport { Injectable } from '@angular/core';\nimport { NodeEntry, NodePaging, NodesApi } from '@alfresco/js-api';\nimport { DocumentLoaderNode } from '../models/document-folder.model';\nimport { Observable, from, throwError, forkJoin } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { DocumentListLoader } from '../interfaces/document-list-loader.interface';\nimport { CustomResourcesService } from './custom-resources.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class DocumentListService implements DocumentListLoader {\n\n    static ROOT_ID = '-root-';\n\n    _nodesApi: NodesApi;\n    get nodes(): NodesApi {\n        this._nodesApi = this._nodesApi ?? new NodesApi(this.apiService.getInstance());\n        return this._nodesApi;\n    }\n\n    constructor(private contentService: ContentService,\n                private apiService: AlfrescoApiService,\n                private logService: LogService,\n                private customResourcesService: CustomResourcesService) {\n    }\n\n    /**\n     * Deletes a node.\n     * @param nodeId ID of the node to delete\n     * @returns Empty response when the operation is complete\n     */\n    deleteNode(nodeId: string): Observable<any> {\n        return from(this.nodes.deleteNode(nodeId));\n    }\n\n    /**\n     * Copy a node to destination node\n     *\n     * @param nodeId The id of the node to be copied\n     * @param targetParentId The id of the folder where the node will be copied\n     * @returns NodeEntry for the copied node\n     */\n    copyNode(nodeId: string, targetParentId: string): Observable<NodeEntry> {\n        return from(this.nodes.copyNode(nodeId, { targetParentId })).pipe(\n            catchError((err) => this.handleError(err))\n        );\n    }\n\n    /**\n     * Moves a node to destination node.\n     *\n     * @param nodeId The id of the node to be moved\n     * @param targetParentId The id of the folder where the node will be moved\n     * @returns NodeEntry for the moved node\n     */\n    moveNode(nodeId: string, targetParentId: string): Observable<NodeEntry> {\n        return from(this.nodes.moveNode(nodeId, { targetParentId })).pipe(\n            catchError((err) => this.handleError(err))\n        );\n    }\n\n    /**\n     * Gets the folder node with the specified relative name path below the root node.\n     * @param folder Path to folder.\n     * @param opts Options.\n     * @param includeFields Extra information to include (available options are \"aspectNames\", \"isLink\" and \"association\")\n     * @returns Details of the folder\n     */\n    getFolder(folder: string, opts?: any, includeFields: string[] = []): Observable<NodePaging> {\n        let rootNodeId = DocumentListService.ROOT_ID;\n        if (opts && opts.rootFolderId) {\n            rootNodeId = opts.rootFolderId;\n        }\n\n        const includeFieldsRequest = ['path', 'properties', 'allowableOperations', 'permissions', 'aspectNames', ...includeFields]\n            .filter((element, index, array) => index === array.indexOf(element));\n\n        const params: any = {\n            includeSource: true,\n            include: includeFieldsRequest\n        };\n\n        if (folder) {\n            params.relativePath = folder;\n        }\n\n        if (opts) {\n            if (opts.maxItems) {\n                params.maxItems = opts.maxItems;\n            }\n            if (opts.skipCount) {\n                params.skipCount = opts.skipCount;\n            }\n            if (opts.where) {\n                params.where = opts.where;\n            }\n            if (opts.orderBy) {\n                params.orderBy = opts.orderBy;\n            }\n        }\n\n        return from(this.nodes.listNodeChildren(rootNodeId, params)).pipe(\n            catchError((err) => this.handleError(err))\n        );\n    }\n\n    /**\n     * Gets a node via its node ID.\n     * @param nodeId ID of the target node\n     * @param includeFields Extra information to include (available options are \"aspectNames\", \"isLink\" and \"association\")\n     * @returns Details of the folder\n     */\n    getNode(nodeId: string, includeFields: string[] = []): Observable<NodeEntry> {\n        const includeFieldsRequest = ['path', 'properties', 'allowableOperations', 'permissions', 'definition', ...includeFields]\n            .filter((element, index, array) => index === array.indexOf(element));\n\n        const opts: any = {\n            includeSource: true,\n            include: includeFieldsRequest\n        };\n\n        return this.contentService.getNode(nodeId, opts);\n    }\n\n    /**\n     * Gets a folder node via its node ID.\n     * @param nodeId ID of the folder node\n     * @param includeFields Extra information to include (available options are \"aspectNames\", \"isLink\" and \"association\")\n     * @returns Details of the folder\n     */\n    getFolderNode(nodeId: string, includeFields: string[] = []): Observable<NodeEntry> {\n        const includeFieldsRequest = ['path', 'properties', 'allowableOperations', 'permissions', 'aspectNames', ...includeFields]\n            .filter((element, index, array) => index === array.indexOf(element));\n\n        const opts: any = {\n            includeSource: true,\n            include: includeFieldsRequest\n        };\n\n        return from(this.nodes.getNode(nodeId, opts)).pipe(\n            catchError((err) => this.handleError(err))\n        );\n    }\n\n    isCustomSourceService(nodeId): boolean {\n        return this.customResourcesService.isCustomSource(nodeId);\n    }\n\n    /**\n     * Load a folder by Node Id.\n     * @param nodeId ID of the folder node\n     * @param pagination\n     * @param includeFields List of data field names to include in the results\n     * @param where  Optionally filter the list\n     * @param orderBy order by node property\n     * @returns Details of the folder\n     */\n    loadFolderByNodeId(nodeId: string, pagination: PaginationModel, includeFields: string[], where?: string, orderBy?: string[]): Observable<DocumentLoaderNode> {\n        if (this.customResourcesService.isCustomSource(nodeId)) {\n            return this.customResourcesService.loadFolderByNodeId(nodeId, pagination, includeFields, where).pipe(\n                map((result: any) => new DocumentLoaderNode(null, result))\n            );\n        } else {\n            return this.retrieveDocumentNode(nodeId, pagination, includeFields, where, orderBy);\n        }\n    }\n\n    private retrieveDocumentNode(nodeId: string, pagination: PaginationModel, includeFields: string[], where?: string, orderBy?: string[]): Observable<DocumentLoaderNode> {\n        return forkJoin([\n            this.getFolderNode(nodeId, includeFields),\n            this.getFolder(null, {\n                maxItems: pagination.maxItems,\n                skipCount: pagination.skipCount,\n                orderBy: orderBy,\n                rootFolderId: nodeId,\n                where: where\n            }, includeFields)]).pipe(\n                map((results) => new DocumentLoaderNode(results[0], results[1]))\n            );\n    }\n\n    private handleError(error: any) {\n        this.logService.error(error);\n        return throwError(error || 'Server error');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { TranslationService, NotificationService, AllowableOperationsEnum, ContentService, UploadService } from '@alfresco/adf-core';\nimport { Node } from '@alfresco/js-api';\n\nimport { ContentNodeSelectorComponentData } from './content-node-selector.component-data.interface';\nimport { NodeEntryEvent } from '../document-list/components/node.event';\nimport { NodeAction } from '../document-list/models/node-action.enum';\n\n@Component({\n    selector: 'adf-content-node-selector',\n    templateUrl: './content-node-selector.component.html',\n    styleUrls: ['./content-node-selector.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class ContentNodeSelectorComponent implements OnInit {\n    title: string;\n    action: NodeAction;\n    buttonActionName: string;\n    chosenNode: Node[];\n    currentDirectoryId: string;\n    showingSearch = false;\n    hasAllowableOperations = false;\n    isLoading = true;\n    selectedTabIndex: number = 0;\n    uploadStarted: boolean = false;\n\n    emptyFolderImageUrl: string = './assets/images/empty_doc_lib.svg';\n    breadcrumbFolderNode: Node;\n\n    constructor(private translation: TranslationService,\n                private contentService: ContentService,\n                private notificationService: NotificationService,\n                private uploadService: UploadService,\n                private dialog: MatDialogRef<ContentNodeSelectorComponent>,\n                @Inject(MAT_DIALOG_DATA) public data: ContentNodeSelectorComponentData) {\n        this.action = data.actionName ?? NodeAction.CHOOSE;\n        this.buttonActionName = `NODE_SELECTOR.${this.action}`;\n        this.title = data.title;\n        this.currentDirectoryId = data.currentFolderId;\n    }\n\n    ngOnInit() {\n        this.dialog.keydownEvents().subscribe(event => {\n            // Esc\n            if (event.keyCode === 27) {\n                event.preventDefault();\n                event.stopImmediatePropagation();\n                this.close();\n            }\n        });\n\n        this.dialog.backdropClick().subscribe(() => {\n           this.close();\n        });\n\n        this.uploadService.fileUploadStarting.subscribe(() => {\n            this.uploadStarted = true;\n        });\n    }\n\n    close() {\n        this.dialog.close();\n    }\n\n    onSelect(nodeList: Node[]) {\n        this.chosenNode = nodeList;\n    }\n\n    onSiteChange(siteTitle: string) {\n        this.updateTitle(siteTitle);\n    }\n\n    onNavigationChange(pathElement: NodeEntryEvent) {\n        this.currentDirectoryId = pathElement.value.id;\n        this.isLoading = true;\n    }\n\n    onClick(): void {\n        this.data.select.next(this.chosenNode);\n        this.close();\n    }\n\n    updateTitle(siteTitle: string) {\n        if (this.action === NodeAction.CHOOSE && siteTitle) {\n            this.title = this.getTitleTranslation(this.action, siteTitle);\n        }\n    }\n\n    getTitleTranslation(action: NodeAction, name: string): string {\n        return this.translation.instant(`NODE_SELECTOR.${action}_ITEM`, { name: this.translation.instant(name) });\n    }\n\n    getSelectedCount(): number {\n        return this.chosenNode?.length || 0;\n    }\n\n    isCounterVisible(): boolean {\n        return this.action === NodeAction.ATTACH || this.action === NodeAction.CHOOSE;\n    }\n\n    isMultipleSelection(): boolean {\n        return this.data.selectionMode === 'multiple';\n    }\n\n    onError(error) {\n        this.notificationService.showError(error);\n    }\n\n    isChooseButtonDisabled(): boolean {\n        return this.uploadService.isUploading() || !this.hasNodeSelected();\n    }\n\n    hasNodeSelected(): boolean {\n        return this.chosenNode?.length > 0;\n    }\n\n    onShowingSearch(value: boolean) {\n        this.showingSearch = value;\n    }\n\n    onCurrentFolder(currentFolder: Node) {\n        this.hasAllowableOperations = this.contentService.hasAllowableOperations(currentFolder, AllowableOperationsEnum.CREATE);\n        this.breadcrumbFolderNode = currentFolder;\n    }\n\n    isNotAllowedToUpload() {\n        return this.showingSearch || !this.hasAllowableOperations;\n    }\n\n    onFolderLoaded() {\n        this.isLoading = false;\n    }\n\n    onTabSelectionChange(tabIndex: number) {\n        this.selectedTabIndex = tabIndex;\n    }\n\n    isFileServerTabSelected (): boolean {\n        return this.selectedTabIndex === 0;\n    }\n\n    isLocalUploadTabSelected (): boolean {\n        return this.selectedTabIndex === 1;\n    }\n\n    isUploadEnabled(): boolean {\n        return this.canPerformLocalUpload() && this.isLocalUploadTabSelected();\n    }\n\n    canPerformLocalUpload(): boolean {\n        return this.data?.showLocalUploadButton;\n    }\n\n    getWarningMessage(): string {\n        return this.showingSearch ? 'NODE_SELECTOR.UPLOAD_BUTTON_SEARCH_WARNING_MESSAGE' :\n            (this.hasNoPermissionToUpload() ? 'NODE_SELECTOR.UPLOAD_BUTTON_PERMISSION_WARNING_MESSAGE' : '');\n    }\n\n    hasNoPermissionToUpload(): boolean {\n        return (!this.hasAllowableOperations && !this.showingSearch) && !this.isLoading;\n    }\n\n    hasUploadError(): boolean {\n        return this.showingSearch || this.hasNoPermissionToUpload();\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport moment from 'moment-es6';\n\nimport { Component, Inject, OnInit, Optional, ViewEncapsulation } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormBuilder, FormGroup } from '@angular/forms';\n\nimport { NodeBodyLock, Node, NodeEntry, NodesApi } from '@alfresco/js-api';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\n\n@Component({\n    selector: 'adf-node-lock',\n    templateUrl: './node-lock.dialog.html',\n    encapsulation: ViewEncapsulation.None\n})\nexport class NodeLockDialogComponent implements OnInit {\n\n    form: FormGroup;\n    node: Node = null;\n    nodeName: string;\n\n    _nodesApi: NodesApi;\n    get nodesApi(): NodesApi {\n        this._nodesApi = this._nodesApi ?? new NodesApi(this.alfrescoApi.getInstance());\n        return this._nodesApi;\n    }\n\n    constructor(\n        private formBuilder: FormBuilder,\n        public dialog: MatDialogRef<NodeLockDialogComponent>,\n        private alfrescoApi: AlfrescoApiService,\n        @Optional()\n        @Inject(MAT_DIALOG_DATA)\n        public data: any\n    ) {\n    }\n\n    ngOnInit() {\n        const { node } = this.data;\n        this.nodeName = node.name;\n\n        this.form = this.formBuilder.group({\n            isLocked: node.isLocked || false,\n            allowOwner: node.properties['cm:lockType'] === 'WRITE_LOCK',\n            isTimeLock: !!node.properties['cm:expiryDate'],\n            time: !!node.properties['cm:expiryDate'] ? moment(node.properties['cm:expiryDate']) : moment()\n        });\n    }\n\n    private get lockTimeInSeconds(): number {\n        if (this.form.value.isTimeLock) {\n            const duration = moment.duration(moment(this.form.value.time).diff(moment()));\n            return duration.asSeconds();\n        }\n\n        return 0;\n    }\n\n    private get nodeBodyLock(): NodeBodyLock {\n        return new NodeBodyLock({\n            'timeToExpire': this.lockTimeInSeconds,\n            'type': this.form.value.allowOwner ? 'ALLOW_OWNER_CHANGES' : 'FULL',\n            'lifetime': 'PERSISTENT'\n        });\n    }\n\n    private toggleLock(): Promise<NodeEntry> {\n        const { data: { node } } = this;\n\n        if (this.form.value.isLocked) {\n            return this.nodesApi.lockNode(node.id, this.nodeBodyLock);\n        }\n\n        return this.nodesApi.unlockNode(node.id);\n    }\n\n    submit(): void {\n        this.toggleLock()\n            .then((node: NodeEntry) => {\n                this.data.node.isLocked = this.form.value.isLocked;\n                this.dialog.close(node.entry);\n            })\n            .catch((error: any) => this.data.onError(error));\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\nimport { EventEmitter, Injectable, Output } from '@angular/core';\nimport { ContentService, ThumbnailService, SitesService, TranslationService, AllowableOperationsEnum } from '@alfresco/adf-core';\nimport { Subject, Observable, throwError } from 'rxjs';\nimport { ShareDataRow } from '../document-list/data/share-data-row.model';\nimport { Node, NodeEntry, SitePaging } from '@alfresco/js-api';\nimport { DocumentListService } from '../document-list/services/document-list.service';\nimport { ContentNodeSelectorComponent } from './content-node-selector.component';\nimport { ContentNodeSelectorComponentData } from './content-node-selector.component-data.interface';\nimport { NodeAction } from '../document-list/models/node-action.enum';\nimport { NodeLockDialogComponent } from '../dialogs/node-lock.dialog';\nimport { switchMap } from 'rxjs/operators';\n\n@Injectable({\n    providedIn: 'root'\n})\n// tslint:disable-next-line: directive-class-suffix\nexport class ContentNodeDialogService {\n    static nonDocumentSiteContent = [\n        'blog',\n        'calendar',\n        'dataLists',\n        'discussions',\n        'links',\n        'wiki'\n    ];\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(private dialog: MatDialog,\n                private contentService: ContentService,\n                private documentListService: DocumentListService,\n                private siteService: SitesService,\n                private translation: TranslationService,\n                private thumbnailService: ThumbnailService) {\n    }\n\n    /**\n     * Opens a file browser at a chosen folder location.\n     * shows files and folders in the dialog search result.\n     * @param folderNodeId ID of the folder to use\n     * @returns Information about the selected file(s)\n     */\n    openFileBrowseDialogByFolderId(folderNodeId: string): Observable<Node[]> {\n        return this.documentListService.getFolderNode(folderNodeId).pipe(switchMap((nodeEntry: NodeEntry) => {\n            return this.openUploadFileDialog(NodeAction.CHOOSE, nodeEntry.entry, true);\n        }));\n    }\n\n    /**\n     * Opens a lock node dialog.\n     * @param contentEntry Node to lock\n     * @returns Error/status message (if any)\n     */\n    public openLockNodeDialog(contentEntry: Node): Subject<string> {\n        const observable: Subject<string> = new Subject<string>();\n\n        if (this.contentService.hasAllowableOperations(contentEntry, AllowableOperationsEnum.LOCK)) {\n            this.dialog.open(NodeLockDialogComponent, {\n                data: {\n                    node: contentEntry,\n                    onError: (error) => {\n                        this.error.emit(error);\n                        observable.error(error);\n                    }\n                },\n                width: '400px'\n            });\n        } else {\n            observable.error('OPERATION.FAIL.NODE.NO_PERMISSION');\n        }\n\n        return observable;\n    }\n\n    /**\n     * Opens a file browser at a chosen site location.\n     * shows files and folders in the dialog search result.\n     * @returns Information about the selected file(s)\n     */\n    openFileBrowseDialogBySite(): Observable<Node[]> {\n        return this.siteService.getSites().pipe(switchMap((response: SitePaging) => {\n            return this.openFileBrowseDialogByFolderId(response.list.entries[0].entry.guid);\n        }));\n    }\n\n    /**\n     * Opens a file browser at a default myFile location.\n     * shows files and folders in the dialog search result.\n     * @returns Information about the selected file(s)\n     */\n    openFileBrowseDialogByDefaultLocation(): Observable<Node[]> {\n        return this.openFileBrowseDialogByFolderId('-my-');\n    }\n\n    /**\n     * Opens a folder browser at a chosen site location.\n     * @returns Information about the selected folder(s)\n     */\n    openFolderBrowseDialogBySite(): Observable<Node[]> {\n        return this.openFolderBrowseDialogByFolderId('-my-');\n    }\n\n    /**\n     * Opens a folder browser at a chosen folder location.\n     * @param folderNodeId ID of the folder to use\n     * @returns Information about the selected folder(s)\n     */\n    openFolderBrowseDialogByFolderId(folderNodeId: string): Observable<Node[]> {\n        return this.documentListService.getFolderNode(folderNodeId).pipe(switchMap((node: NodeEntry) => {\n            return this.openUploadFolderDialog(NodeAction.CHOOSE, node.entry);\n        }));\n    }\n\n    /**\n     * Opens a dialog to copy or move an item to a new location.\n     * @param action Name of the action (eg, \"Copy\" or \"Move\") to show in the title\n     * @param contentEntry Item to be copied or moved\n     * @param permission Permission for the operation\n     * @param excludeSiteContent The site content that should be filtered out\n     * @returns Information about files that were copied/moved\n     */\n    openCopyMoveDialog(action: NodeAction, contentEntry: Node, permission?: string, excludeSiteContent?: string[]): Observable<Node[]> {\n        if (this.contentService.hasAllowableOperations(contentEntry, permission)) {\n\n            const select = new Subject<Node[]>();\n\n            const data: ContentNodeSelectorComponentData = {\n                title: this.getTitleTranslation(action, contentEntry.name),\n                actionName: action,\n                selectionMode: 'single',\n                currentFolderId: contentEntry.parentId,\n                imageResolver: this.imageResolver.bind(this),\n                where: '(isFolder=true)',\n                isSelectionValid: this.isCopyMoveSelectionValid.bind(this),\n                excludeSiteContent: excludeSiteContent || ContentNodeDialogService.nonDocumentSiteContent,\n                select: select\n            };\n\n            const dialogRef = this.openContentNodeDialog(data, 'adf-content-node-selector-dialog', '630px');\n            dialogRef.afterClosed().subscribe({ next: () => select.complete() });\n\n            return select;\n        } else {\n            const errors = new Error(JSON.stringify({ error: { statusCode: 403 } }));\n            return throwError(errors);\n        }\n    }\n\n    /**\n     * Gets the translation of the dialog title.\n     * @param action Name of the action to display in the dialog title\n     * @param name Name of the item on which the action is being performed\n     * @returns Translated version of the title\n     */\n    getTitleTranslation(action: string, name: string): string {\n        return this.translation.instant(`NODE_SELECTOR.${action.toUpperCase()}_ITEM`, { name });\n    }\n\n    /**\n     * Opens a dialog to choose folders to upload.\n     * @param action Name of the action to show in the title\n     * @param contentEntry  Item to upload\n     * @returns Information about the chosen folder(s)\n     */\n    openUploadFolderDialog(action: NodeAction, contentEntry: Node): Observable<Node[]> {\n        const select = new Subject<Node[]>();\n\n        const data: ContentNodeSelectorComponentData = {\n            title: this.getTitleTranslation(action, this.translation.instant('DROPDOWN.MY_FILES_OPTION')),\n            actionName: action,\n            selectionMode: 'single',\n            currentFolderId: contentEntry.id,\n            imageResolver: this.imageResolver.bind(this),\n            isSelectionValid: this.hasAllowableOperationsOnNodeFolder.bind(this),\n            where: '(isFolder=true)',\n            select: select\n        };\n\n        const dialogRef = this.openContentNodeDialog(data, 'adf-content-node-selector-dialog', '630px');\n        dialogRef.afterClosed().subscribe({ next: () => select.complete() });\n\n        return select;\n    }\n\n    /**\n     * Opens a dialog to choose a file to upload.\n     * @param action Name of the action to show in the title\n     * @param contentEntry Item to upload\n     * @param showFilesInResult Show files in dialog search result\n     * @returns Information about the chosen file(s)\n     */\n    openUploadFileDialog(action: NodeAction, contentEntry: Node, showFilesInResult = false): Observable<Node[]> {\n        const select = new Subject<Node[]>();\n\n        const data: ContentNodeSelectorComponentData = {\n            title: this.getTitleTranslation(action, this.translation.instant('DROPDOWN.MY_FILES_OPTION')),\n            actionName: action,\n            selectionMode: 'single',\n            currentFolderId: contentEntry.id,\n            imageResolver: this.imageResolver.bind(this),\n            isSelectionValid: (entry: Node) => entry.isFile,\n            select: select,\n            showFilesInResult\n        };\n\n        const dialogRef = this.openContentNodeDialog(data, 'adf-content-node-selector-dialog', '630px');\n        dialogRef.afterClosed().subscribe({ next: () => select.complete() });\n\n        return select;\n    }\n\n    private openContentNodeDialog(data: ContentNodeSelectorComponentData, panelClass: string, width: string): MatDialogRef<ContentNodeSelectorComponent> {\n        return this.dialog.open(ContentNodeSelectorComponent, {\n            data,\n            panelClass,\n            width,\n            disableClose: true\n        });\n    }\n\n    private imageResolver(row: ShareDataRow): string | null {\n        const entry: Node = row.node.entry;\n        if (!this.contentService.hasAllowableOperations(entry, 'create')) {\n            if (this.isNodeFolder(entry)) {\n                return this.thumbnailService.getMimeTypeIcon('disable/folder');\n            }\n        }\n\n        return null;\n    }\n\n    private hasAllowableOperationsOnNodeFolder(entry: Node): boolean {\n        return this.isNodeFolder(entry) && this.contentService.hasAllowableOperations(entry, 'create');\n    }\n\n    private isNodeFolder(entry: Node): boolean {\n        return entry.isFolder;\n    }\n\n    private isCopyMoveSelectionValid(entry: Node): boolean {\n        return this.hasEntityCreatePermission(entry) && !this.isSite(entry);\n    }\n\n    private hasEntityCreatePermission(entry: Node): boolean {\n        return this.contentService.hasAllowableOperations(entry, 'create');\n    }\n\n    private isSite(entry) {\n        return !!entry.guid || entry.nodeType === 'st:site' || entry.nodeType === 'st:sites';\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* tslint:disable:no-input-rename  */\n\nimport { Directive, ElementRef, Renderer2, HostListener, Input, AfterViewInit } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { AllowableOperationsEnum, ContentService } from '@alfresco/adf-core';\nimport { ContentNodeDialogService } from '../content-node-selector/content-node-dialog.service';\n\n@Directive({\n    selector: '[adf-node-lock]'\n})\nexport class NodeLockDirective implements AfterViewInit {\n\n    /** Node to lock/unlock. */\n    @Input('adf-node-lock')\n    node: Node;\n\n    @HostListener('click', [ '$event' ])\n    onClick(event) {\n        event.stopPropagation();\n        this.contentNodeDialogService.openLockNodeDialog(this.node);\n    }\n\n    constructor(\n        public element: ElementRef,\n        private renderer: Renderer2,\n        private contentService: ContentService,\n        private contentNodeDialogService: ContentNodeDialogService\n    ) {}\n\n    ngAfterViewInit() {\n        const hasAllowableOperations = this.contentService.hasAllowableOperations(this.node, AllowableOperationsEnum.LOCK);\n        this.renderer.setProperty(this.element.nativeElement, 'disabled', !hasAllowableOperations);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, Input, Component, OnInit, OnChanges, ComponentFactoryResolver, ViewContainerRef } from '@angular/core';\n\n@Directive({\n    selector: '[adf-node-counter]'\n})\nexport class NodeCounterDirective implements OnInit, OnChanges {\n\n    /** Number to display in the counter badge */\n    @Input('adf-node-counter')\n    counter: number;\n\n    componentRef: NodeCounterComponent;\n\n    constructor(\n        private resolver: ComponentFactoryResolver,\n        public viewContainerRef: ViewContainerRef\n    ) {}\n\n    ngOnInit() {\n        const componentFactory = this.resolver.resolveComponentFactory(NodeCounterComponent);\n        this.componentRef = this.viewContainerRef.createComponent(componentFactory).instance;\n        this.componentRef.counter = this.counter;\n    }\n\n    ngOnChanges() {\n        if (this.componentRef) {\n            this.componentRef.counter = this.counter;\n        }\n    }\n}\n\n@Component({\n    selector: 'adf-node-counter',\n    template: `\n        <div>{{ 'NODE_COUNTER.SELECTED_COUNT' | translate: { count: counter } }}</div>\n    `\n})\nexport class NodeCounterComponent {\n    counter: number;\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { NodeLockDirective } from './node-lock.directive';\nimport { NodeCounterComponent, NodeCounterDirective } from './node-counter.directive';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        TranslateModule\n    ],\n    declarations: [\n        NodeLockDirective,\n        NodeCounterDirective,\n        NodeCounterComponent\n    ],\n    exports: [\n        NodeLockDirective,\n        NodeCounterDirective\n    ]\n})\nexport class ContentDirectiveModule {\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AlfrescoApiService, LogService } from '@alfresco/adf-core';\nimport { Injectable } from '@angular/core';\nimport { RatingEntry, RatingBody, RatingsApi } from '@alfresco/js-api';\nimport { from, throwError, Observable } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { RatingServiceInterface } from './rating.service.interface';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class RatingService implements RatingServiceInterface {\n\n    _ratingsApi: RatingsApi;\n    get ratingsApi(): RatingsApi {\n        this._ratingsApi = this._ratingsApi ?? new RatingsApi(this.apiService.getInstance());\n        return this._ratingsApi;\n    }\n\n    constructor(private apiService: AlfrescoApiService, private logService: LogService) {\n    }\n\n    /**\n     * Gets the current user's rating for a node.\n     * @param nodeId Node to get the rating from\n     * @param ratingType Type of rating (can be \"likes\" or \"fiveStar\")\n     * @returns The rating value\n     */\n    getRating(nodeId: string, ratingType: any): Observable<RatingEntry | {}> {\n        return from(this.ratingsApi.getRating(nodeId, ratingType))\n            .pipe(\n                catchError(this.handleError)\n            );\n    }\n\n    /**\n     * Adds the current user's rating for a node.\n     * @param nodeId Target node for the rating\n     * @param ratingType Type of rating (can be \"likes\" or \"fiveStar\")\n     * @param vote Rating value (boolean for \"likes\", numeric 0..5 for \"fiveStar\")\n     * @returns Details about the rating, including the new value\n     */\n    postRating(nodeId: string, ratingType: string, vote: any): Observable<RatingEntry | {}> {\n        const ratingBody: RatingBody = new RatingBody({\n            'id': ratingType,\n            'myRating': vote\n        });\n        return from(this.ratingsApi.createRating(nodeId, ratingBody))\n            .pipe(\n                catchError(this.handleError)\n            );\n    }\n\n    /**\n     * Removes the current user's rating for a node.\n     * @param nodeId Target node\n     * @param ratingType Type of rating to remove (can be \"likes\" or \"fiveStar\")\n     * @returns Null response indicating that the operation is complete\n     */\n    deleteRating(nodeId: string, ratingType: any): Observable<any> {\n        return from(this.ratingsApi.deleteRating(nodeId, ratingType))\n            .pipe(\n                catchError(this.handleError)\n            );\n    }\n\n    private handleError(error: any): any {\n        this.logService.error(error);\n        return throwError(error || 'Server error');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation } from '@angular/core';\nimport { RatingService } from './services/rating.service';\nimport { RatingEntry } from '@alfresco/js-api';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\n\n@Component({\n    selector: 'adf-rating',\n    styleUrls: ['./rating.component.scss'],\n    templateUrl: './rating.component.html',\n    encapsulation: ViewEncapsulation.None\n})\nexport class RatingComponent implements OnChanges {\n\n    /** Identifier of the node to apply the rating to. */\n    @Input()\n    nodeId: string;\n\n    average: number = 0;\n\n    ratingsCounter = 0;\n\n    ratingType: string = 'fiveStar';\n\n    ratingValue: number;\n\n    /** Emitted when the \"vote\" gets changed. */\n    @Output()\n    changeVote = new EventEmitter();\n\n    stars: Array<any> = [];\n\n    onDestroy$ = new Subject<boolean>();\n\n    constructor(private ratingService: RatingService) {\n    }\n\n    ngOnChanges() {\n        this.ratingService.getRating(this.nodeId, this.ratingType)\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(\n            (ratingEntry: RatingEntry) => {\n                this.refreshRating(ratingEntry);\n            }\n        );\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    calculateStars() {\n        this.stars = [];\n        const roundedAverage = Math.round(this.average);\n\n        for (let i = 0; i < 5; i++) {\n            if (i < roundedAverage) {\n                this.stars.push({fill: true});\n            } else {\n                this.stars.push({fill: false});\n            }\n        }\n    }\n\n    updateVote(vote: number) {\n        if (this.ratingValue === vote) {\n            this.unRateItem();\n        } else {\n            this.rateItem(vote);\n        }\n    }\n\n    rateItem(vote: number) {\n        this.ratingService.postRating(this.nodeId, this.ratingType, vote)\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(\n            (ratingEntry: RatingEntry) => {\n                this.refreshRating(ratingEntry);\n            }\n        );\n    }\n\n    unRateItem() {\n        this.ratingService.deleteRating(this.nodeId, this.ratingType).subscribe(\n            () => {\n                this.ratingService.getRating(this.nodeId, this.ratingType)\n                    .pipe(takeUntil(this.onDestroy$))\n                    .subscribe(\n                    (ratingEntry: RatingEntry) => {\n                        this.refreshRating(ratingEntry);\n                    }\n                );\n            });\n    }\n\n    refreshRating(ratingEntry: RatingEntry) {\n        this.ratingValue = Number.parseFloat(ratingEntry.entry.myRating);\n        this.average = ratingEntry.entry.aggregate.average;\n        this.ratingsCounter = ratingEntry.entry.aggregate.numberOfRatings;\n        this.calculateStars();\n        this.changeVote.emit(this.average);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation } from '@angular/core';\nimport { RatingService } from './services/rating.service';\nimport { RatingEntry } from '@alfresco/js-api';\n\n@Component({\n    selector: 'adf-like',\n    styleUrls: ['./like.component.scss'],\n    templateUrl: './like.component.html',\n    encapsulation: ViewEncapsulation.None\n})\nexport class LikeComponent implements OnChanges {\n    /** Identifier of a node to apply likes to. */\n    @Input()\n    nodeId: string;\n\n    /** Emitted when the \"vote\" gets changed. */\n    @Output()\n    changeVote = new EventEmitter();\n\n    likesCounter: number = 0;\n    ratingType: string = 'likes';\n    isLike: boolean = false;\n\n    constructor(private ratingService: RatingService) {\n    }\n\n    ngOnChanges() {\n        this.clean();\n\n        this.ratingService.getRating(this.nodeId, this.ratingType).subscribe(\n            (ratingEntry: RatingEntry) => {\n                if (ratingEntry.entry.aggregate) {\n                    this.likesCounter = ratingEntry.entry.aggregate.numberOfRatings;\n                    if (ratingEntry.entry.ratedAt) {\n                        this.isLike = true;\n                    }\n                }\n            }\n        );\n    }\n\n    likeClick() {\n        if (this.isLike) {\n            this.ratingService.deleteRating(this.nodeId, this.ratingType).subscribe(\n                () => {\n                    this.likesCounter -= 1;\n                    this.isLike = false;\n                    this.changeVote.emit(this.likesCounter);\n                }\n            );\n        } else {\n            this.ratingService.postRating(this.nodeId, this.ratingType, true).subscribe(\n                (ratingEntry: RatingEntry) => {\n                    this.likesCounter = ratingEntry.entry.aggregate.numberOfRatings;\n                    this.isLike = true;\n                    this.changeVote.emit(this.likesCounter);\n                }\n            );\n        }\n    }\n\n    clean() {\n        this.isLike = false;\n        this.likesCounter = 0;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\n\nimport { LikeComponent } from './like.component';\nimport { RatingComponent } from './rating.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule\n    ],\n    exports: [\n        RatingComponent,\n        LikeComponent\n    ],\n    declarations: [\n        RatingComponent,\n        LikeComponent\n    ]\n})\nexport class SocialModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AlfrescoApiService, LogService } from '@alfresco/adf-core';\nimport { EventEmitter, Injectable, Output } from '@angular/core';\nimport { Observable, from, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { TagBody, TagPaging, TagEntry, TagsApi } from '@alfresco/js-api';\n\n@Injectable({\n    providedIn: 'root'\n})\n// tslint:disable-next-line: directive-class-suffix\nexport class TagService {\n\n    _tagsApi: TagsApi;\n    get tagsApi(): TagsApi {\n        this._tagsApi = this._tagsApi ?? new TagsApi(this.apiService.getInstance());\n        return this._tagsApi;\n    }\n\n    /** Emitted when tag information is updated. */\n    @Output()\n    refresh = new EventEmitter();\n\n    constructor(private apiService: AlfrescoApiService,\n                private logService: LogService) {\n    }\n\n    /**\n     * Gets a list of tags added to a node.\n     * @param nodeId ID of the target node\n     * @returns TagPaging object (defined in JS-API) containing the tags\n     */\n    getTagsByNodeId(nodeId: string): Observable<TagPaging> {\n        return from(this.tagsApi.listTagsForNode(nodeId)).pipe(\n            catchError((err) => this.handleError(err))\n        );\n    }\n\n    /**\n     * Gets a list of all the tags already defined in the repository.\n     * @param opts Options supported by JS-API\n     * @returns TagPaging object (defined in JS-API) containing the tags\n     */\n    getAllTheTags(opts?: any): Observable<TagPaging> {\n        return from(this.tagsApi.listTags(opts))\n            .pipe(catchError((err) => this.handleError(err)));\n    }\n\n    /**\n     * Adds a tag to a node.\n     * @param nodeId ID of the target node\n     * @param tagName Name of the tag to add\n     * @returns TagEntry object (defined in JS-API) with details of the new tag\n     */\n    addTag(nodeId: string, tagName: string): Observable<TagEntry> {\n        const tagBody = new TagBody();\n        tagBody.tag = tagName;\n\n        const observableAdd = from(this.tagsApi.createTagForNode(nodeId, [tagBody]));\n\n        observableAdd.subscribe((tagEntry: TagEntry) => {\n            this.refresh.emit(tagEntry);\n        }, (err) => {\n            this.handleError(err);\n        });\n\n        return observableAdd;\n    }\n\n    /**\n     * Removes a tag from a node.\n     * @param nodeId ID of the target node\n     * @param tag Name of the tag to remove\n     * @returns Null object when the operation completes\n     */\n    removeTag(nodeId: string, tag: string): Observable<any> {\n        const observableRemove = from(this.tagsApi.deleteTagFromNode(nodeId, tag));\n\n        observableRemove.subscribe((data) => {\n            this.refresh.emit(data);\n        }, (err) => {\n            this.handleError(err);\n        });\n\n        return observableRemove;\n    }\n\n    private handleError(error: any) {\n        this.logService.error(error);\n        return throwError(error || 'Server error');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TranslationService } from '@alfresco/adf-core';\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation, OnDestroy, OnInit } from '@angular/core';\nimport { TagService } from './services/tag.service';\nimport { Subject } from 'rxjs';\nimport { TagPaging } from '@alfresco/js-api';\nimport { takeUntil } from 'rxjs/operators';\n\n/**\n *\n * This component, provide a list of the tags relative a node with actions button to add or remove new tag\n */\n\n@Component({\n    selector: 'adf-tag-node-actions-list',\n    templateUrl: './tag-actions.component.html',\n    styleUrls: ['./tag-actions.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-tag-node-actions-list' }\n})\nexport class TagActionsComponent implements OnChanges, OnInit, OnDestroy {\n\n    /** The identifier of a node. */\n    @Input()\n    nodeId: string;\n\n    /** Emitted when a tag is added successfully. */\n    @Output()\n    successAdd: EventEmitter<any> = new EventEmitter();\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter();\n\n    /** Emitted when an action is chosen. */\n    @Output()\n    result = new EventEmitter();\n\n    newTagName: string;\n    tagsEntries: any;\n    errorMsg: string;\n    disableAddTag: boolean = true;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private tagService: TagService, private translateService: TranslationService) {\n    }\n\n    ngOnInit() {\n        this.tagService.refresh\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(() => this.refreshTag());\n    }\n\n    ngOnChanges() {\n        return this.refreshTag();\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    refreshTag() {\n        if (this.nodeId) {\n            this.tagService.getTagsByNodeId(this.nodeId).subscribe((tagPaging: TagPaging) => {\n                this.tagsEntries = tagPaging.list.entries;\n                this.disableAddTag = false;\n                this.result.emit(this.tagsEntries);\n            }, () => {\n                this.tagsEntries = null;\n                this.disableAddTag = true;\n                this.result.emit(this.tagsEntries);\n            });\n        }\n    }\n\n    addTag() {\n        if (this.searchTag(this.newTagName)) {\n            this.errorMsg = this.translateService.instant('TAG.MESSAGES.EXIST');\n            this.error.emit(this.errorMsg);\n        } else {\n            this.tagService.addTag(this.nodeId, this.newTagName).subscribe(() => {\n                this.newTagName = '';\n                this.successAdd.emit(this.nodeId);\n            });\n        }\n    }\n\n    searchTag(searchTagName: string) {\n        if (this.tagsEntries) {\n            return this.tagsEntries.find((currentTag) => {\n                return (searchTagName === currentTag.entry.tag);\n            });\n        }\n    }\n\n    cleanErrorMsg() {\n        this.errorMsg = '';\n    }\n\n    removeTag(tag: string) {\n        this.tagService.removeTag(this.nodeId, tag);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, OnInit, Output, ViewEncapsulation, OnDestroy } from '@angular/core';\nimport { TagService } from './services/tag.service';\nimport { PaginationModel } from '@alfresco/adf-core';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { TagEntry } from '@alfresco/js-api';\n\n/**\n * This component provide a list of all the tag inside the ECM\n */\n@Component({\n    selector: 'adf-tag-list',\n    templateUrl: './tag-list.component.html',\n    styleUrls: ['./tag-list.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-tag-list' }\n})\nexport class TagListComponent implements OnInit, OnDestroy {\n\n    /** Emitted when a tag is selected. */\n    @Output()\n    result = new EventEmitter();\n\n    /**\n     * Array of tags that are displayed\n     */\n    tagsEntries: TagEntry[] = [];\n\n    /**\n     * Number of items per iteration\n     */\n    size: number = 10;\n\n    defaultPagination: PaginationModel;\n    pagination: PaginationModel;\n\n    isLoading = false;\n    isSizeMinimum = true;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    /**\n     * Constructor\n     * @param tagService\n     */\n    constructor(private tagService: TagService) {\n\n        this.defaultPagination = {\n            skipCount: 0,\n            maxItems: this.size,\n            hasMoreItems: false\n        };\n\n        this.pagination = this.defaultPagination;\n\n        this.tagService.refresh\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(() => {\n                this.tagsEntries = [];\n                this.refreshTag(this.defaultPagination);\n            });\n    }\n\n    ngOnInit() {\n        this.refreshTag(this.defaultPagination);\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    refreshTag(opts?: any) {\n        this.tagService.getAllTheTags(opts).subscribe((tags) => {\n            this.tagsEntries = this.tagsEntries.concat(tags.list.entries);\n            this.pagination = tags.list.pagination;\n            this.result.emit(this.tagsEntries);\n            this.isLoading = false;\n        });\n    }\n\n    loadMoreTags() {\n        if (this.pagination.hasMoreItems) {\n            this.isLoading = true;\n            this.isSizeMinimum = false;\n\n            this.refreshTag({\n                skipCount: this.pagination.skipCount + this.pagination.count,\n                maxItems: this.size\n            });\n        }\n    }\n\n    loadLessTags() {\n        this.isSizeMinimum = false;\n        this.tagsEntries = this.tagsEntries.slice(0, this.tagsEntries.length - this.pagination.count);\n        this.pagination.skipCount = this.pagination.skipCount - this.pagination.count;\n        this.pagination.hasMoreItems = true;\n\n        if (this.tagsEntries.length <= this.size) {\n            this.isSizeMinimum = true;\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation, OnDestroy, OnInit } from '@angular/core';\nimport { TagService } from './services/tag.service';\nimport { TagEntry } from '@alfresco/js-api';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n/**\n *\n * This component, ShowNodeTag a list of the tag on relative a node\n */\n\n@Component({\n    selector: 'adf-tag-node-list',\n    templateUrl: './tag-node-list.component.html',\n    styleUrls: ['./tag-node-list.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-tag-node-list' }\n})\nexport class TagNodeListComponent implements OnChanges, OnDestroy, OnInit {\n    /** The identifier of a node. */\n    @Input()\n    nodeId: string;\n\n    /** Show delete button */\n    @Input()\n    showDelete = true;\n\n    tagsEntries: TagEntry[];\n\n    /** Emitted when a tag is selected. */\n    @Output()\n    results = new EventEmitter();\n\n    private onDestroy$ = new Subject<boolean>();\n\n    /**\n     * Constructor\n     * @param tagService\n     */\n    constructor(private tagService: TagService) {\n    }\n\n    ngOnChanges() {\n        this.refreshTag();\n    }\n\n    ngOnInit() {\n        this.tagService.refresh\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(() => this.refreshTag());\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    refreshTag() {\n        if (this.nodeId) {\n            this.tagService.getTagsByNodeId(this.nodeId).subscribe((tagPaging) => {\n                this.tagsEntries = tagPaging.list.entries;\n                this.results.emit(this.tagsEntries);\n            });\n        }\n    }\n\n    removeTag(tag: string) {\n        this.tagService.removeTag(this.nodeId, tag).subscribe(() => {\n            this.refreshTag();\n        });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { MaterialModule } from '../material.module';\nimport { TagActionsComponent } from './tag-actions.component';\nimport { TagListComponent } from './tag-list.component';\nimport { TagNodeListComponent } from './tag-node-list.component';\nimport { CoreModule } from '@alfresco/adf-core';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        FormsModule,\n        ReactiveFormsModule,\n        CoreModule\n    ],\n    exports: [\n        TagActionsComponent,\n        TagListComponent,\n        TagNodeListComponent\n    ],\n    declarations: [\n        TagActionsComponent,\n        TagListComponent,\n        TagNodeListComponent\n    ]\n})\nexport class TagModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ObjectDataTableAdapter, AlfrescoApiService, LogService } from '@alfresco/adf-core';\nimport { Component, EventEmitter, Input, OnChanges, Output } from '@angular/core';\nimport { WebscriptApi } from '@alfresco/js-api';\n\n/**\n * <adf-webscript-get [scriptPath]=\"string\"\n *                         [scriptArgs]=\"Object\"\n *                         [contextRoot]=\"string\"\n *                         [servicePath]=\"string\"\n *                         [contentType]=\"JSON|HTML|DATATABLE\"\n *                         (success)=\"customMethod($event)>\n * </adf-webscript-get>\n *\n * This component, provide a get webscript viewer\n *\n * @InputParam {string} scriptPath path to Web Script (as defined by Web Script)\n * @InputParam {Object} scriptArgs arguments to pass to Web Script\n * @InputParam {string} contextRoot path where application is deployed default value 'alfresco'\n * @InputParam {string} servicePath path where Web Script service is mapped default value 'service'\n * @InputParam {string} contentType JSON | HTML | DATATABLE | TEXT\n *\n * @Output - success - The event is emitted when the data are received\n *\n */\n@Component({\n    selector: 'adf-webscript-get',\n    templateUrl: './webscript.component.html'\n})\nexport class WebscriptComponent implements OnChanges {\n\n    _webscriptApi: WebscriptApi;\n    get webscriptApi(): WebscriptApi {\n        this._webscriptApi = this._webscriptApi ?? new WebscriptApi(this.apiService.getInstance());\n        return this._webscriptApi;\n    }\n\n    /** (required) Path to the webscript (as defined by webscript). */\n    @Input()\n    scriptPath: string;\n\n    /** Arguments to pass to the webscript. */\n    @Input()\n    scriptArgs: any;\n\n    /** Toggles whether to show or hide the data. */\n    @Input()\n    showData: boolean = true;\n\n    /** Path where the application is deployed */\n    @Input()\n    contextRoot: string = 'alfresco';\n\n    /** Path that the webscript service is mapped to. */\n    @Input()\n    servicePath: string = 'service';\n\n    /** Content type to interpret the data received from the webscript.\n     * Can be \"JSON\" , \"HTML\" , \"DATATABLE\" or \"TEXT\"\n     */\n    @Input()\n    contentType: string = 'TEXT';\n\n    /** Emitted when the operation succeeds. You can get the plain data from\n     * the webscript through the **success** event parameter and use it as you\n     * need in your application.\n     */\n    @Output()\n    success = new EventEmitter();\n\n    data: any = undefined;\n    showError: boolean = false;\n\n    constructor(private apiService: AlfrescoApiService,\n                private logService: LogService) {\n    }\n\n    ngOnChanges() {\n        if (this.showData) {\n            this.clean();\n        }\n\n        return new Promise<void>((resolve, reject) => {\n            this.webscriptApi.executeWebScript('GET', this.scriptPath, this.scriptArgs, this.contextRoot, this.servicePath).then((webScriptData) => {\n\n                this.data = webScriptData;\n\n                if (this.showData) {\n                    if (this.contentType === 'DATATABLE') {\n                        this.data = this.showDataAsDataTable(webScriptData);\n                    }\n                }\n\n                this.success.emit(this.data);\n\n                resolve();\n            }, (error) => {\n                this.logService.log('Error' + error);\n                reject();\n            });\n        });\n    }\n\n    /**\n     * show the data in a ng2-alfresco-datatable\n     *\n     * @param data\n     *\n     * @returns the data as datatable\n     */\n    showDataAsDataTable(data: any) {\n        const datatableData: any = null;\n        try {\n\n            if (!data.schema) {\n                data.schema = ObjectDataTableAdapter.generateSchema(data.data);\n            }\n\n            if (data.schema && data.schema.length > 0) {\n                this.data = new ObjectDataTableAdapter(data.data, data.schema);\n            }\n\n        } catch (error) {\n            this.logService.error('error during the cast as datatable');\n        }\n\n        return datatableData;\n    }\n\n    clean() {\n        this.data = undefined;\n    }\n\n    isDataTableContent() {\n        return this.contentType === 'DATATABLE';\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CoreModule } from '@alfresco/adf-core';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n\nimport { MaterialModule } from '../material.module';\nimport { WebscriptComponent } from './webscript.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        CoreModule\n    ],\n    exports: [\n        WebscriptComponent\n    ],\n    declarations: [\n        WebscriptComponent\n    ]\n})\nexport class WebScriptModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataRow, ObjectUtils, ThumbnailService, ContentService } from '@alfresco/adf-core';\nimport { MinimalNode, NodeEntry } from '@alfresco/js-api';\nimport { PermissionStyleModel } from './../models/permissions-style.model';\n\nexport class ShareDataRow implements DataRow {\n\n    static ERR_OBJECT_NOT_FOUND: string = 'Object source not found';\n\n    cache: { [key: string]: any } = {};\n    isSelected: boolean = false;\n    isDropTarget: boolean;\n    cssClass: string = '';\n    id: string;\n\n    get node(): NodeEntry {\n        return this.obj;\n    }\n\n    set node(value: NodeEntry) {\n        this.obj = value;\n        this.cache = {};\n    }\n\n    constructor(private obj: NodeEntry,\n                private contentService: ContentService,\n                private permissionsStyle: PermissionStyleModel[],\n                private thumbnailService?: ThumbnailService,\n                private allowDropFiles?: boolean) {\n        if (!obj) {\n            throw new Error(ShareDataRow.ERR_OBJECT_NOT_FOUND);\n        }\n\n        this.isDropTarget = allowDropFiles !== undefined ? this.allowDropFiles && this.checkNodeTypeAndPermissions(obj) : this.checkNodeTypeAndPermissions(obj);\n        if (permissionsStyle) {\n            this.cssClass = this.getPermissionClass(obj);\n        }\n        this.id = this.getId();\n    }\n\n    checkNodeTypeAndPermissions(nodeEntry: NodeEntry) {\n        return this.isFolderAndHasPermissionToUpload(nodeEntry) || this.isFileAndHasParentFolderPermissionToUpload(nodeEntry);\n    }\n\n    getPermissionClass(nodeEntity: NodeEntry): string {\n        let permissionsClasses = '';\n\n        this.permissionsStyle.forEach((currentPermissionsStyle: PermissionStyleModel) => {\n\n            if (this.applyPermissionStyleToFolder(nodeEntity.entry, currentPermissionsStyle) || this.applyPermissionStyleToFile(nodeEntity.entry, currentPermissionsStyle)) {\n\n                if (this.contentService.hasAllowableOperations(nodeEntity.entry, currentPermissionsStyle.permission)) {\n                    permissionsClasses += ` ${currentPermissionsStyle.css}`;\n                }\n            }\n\n        });\n\n        return permissionsClasses;\n    }\n\n    private applyPermissionStyleToFile(node: MinimalNode, currentPermissionsStyle: PermissionStyleModel): boolean {\n        return (currentPermissionsStyle.isFile && node.isFile);\n    }\n\n    private applyPermissionStyleToFolder(node: MinimalNode, currentPermissionsStyle: PermissionStyleModel): boolean {\n        return (currentPermissionsStyle.isFolder && node.isFolder);\n    }\n\n    isFolderAndHasPermissionToUpload(nodeEntry: NodeEntry): boolean {\n        return this.isFolder(nodeEntry) && this.contentService.hasAllowableOperations(nodeEntry.entry, 'create');\n    }\n\n    isFileAndHasParentFolderPermissionToUpload(nodeEntry: NodeEntry): boolean {\n        return this.isFile(nodeEntry) && this.contentService.hasAllowableOperations(nodeEntry.entry, 'update');\n    }\n\n    isFile(nodeEntry: NodeEntry): boolean {\n        return nodeEntry.entry && nodeEntry.entry.isFile;\n    }\n\n    isFolder(nodeEntry: NodeEntry): boolean {\n        return nodeEntry.entry && nodeEntry.entry.isFolder;\n    }\n\n    cacheValue(key: string, value: any): any {\n        this.cache[key] = value;\n        return value;\n    }\n\n    getValue(key: string): any {\n        if (this.cache[key] !== undefined) {\n            return this.cache[key];\n        }\n        return ObjectUtils.getValue(this.obj.entry, key);\n    }\n\n    imageErrorResolver(): any {\n        if (this.obj.entry.content) {\n            return this.thumbnailService.getMimeTypeIcon(this.obj.entry.content.mimeType);\n        }\n    }\n\n    hasValue(key: string): boolean {\n        return this.getValue(key) !== undefined;\n    }\n\n    getId(): string {\n        return this.obj.entry.id || undefined;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class ContentActionModel {\n    icon: string;\n    title: string;\n    handler: ContentActionHandler;\n    execute: Function;\n    target: string;\n    permission: string;\n    disableWithNoPermission: boolean = false;\n    disabled: boolean | Function = false;\n    visible: boolean | Function = true;\n\n    constructor(obj?: any) {\n        if (obj) {\n            this.icon = obj.icon;\n            this.title = obj.title;\n            this.handler = obj.handler;\n            this.execute = obj.execute;\n            this.target = obj.target;\n            this.permission = obj.permission;\n            this.disableWithNoPermission = obj.disableWithNoPermission;\n\n            if (obj.hasOwnProperty('disabled')) {\n                this.disabled = obj.disabled;\n            }\n\n            if (obj.hasOwnProperty('visible')) {\n                this.visible = obj.visible;\n            }\n        }\n    }\n}\n\nexport enum ContentActionTarget {\n    Document = 'document',\n    Folder = 'folder',\n    All = 'all'\n}\n\nexport type ContentActionHandler = (obj: any, target?: any, permission?: string) => any;\n\nexport class DocumentActionModel extends ContentActionModel {\n    constructor(json?: any)  {\n        super(json);\n        this.target = 'document';\n    }\n}\n\nexport class FolderActionModel extends  ContentActionModel {\n    constructor(json?: any)  {\n        super(json);\n        this.target = 'folder';\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    DataColumn,\n    DataRow,\n    DataSorting,\n    DataTableAdapter,\n    ThumbnailService,\n    ContentService\n} from '@alfresco/adf-core';\nimport { NodePaging, NodeEntry } from '@alfresco/js-api';\nimport { PermissionStyleModel } from './../models/permissions-style.model';\nimport { ShareDataRow } from './share-data-row.model';\nimport { RowFilter } from './row-filter.model';\n\nexport class ShareDataTableAdapter implements DataTableAdapter {\n\n    ERR_ROW_NOT_FOUND: string = 'Row not found';\n    ERR_COL_NOT_FOUND: string = 'Column not found';\n\n    private _sortingMode: string;\n    private sorting: DataSorting;\n    private rows: DataRow[];\n    private columns: DataColumn[];\n\n    private filter: RowFilter;\n    private imageResolver: any;\n\n    thumbnails: boolean = false;\n    permissionsStyle: PermissionStyleModel[];\n    selectedRow: DataRow;\n    allowDropFiles: boolean;\n\n    set sortingMode(value: string) {\n        let newValue = (value || 'client').toLowerCase();\n        if (newValue !== 'client' && newValue !== 'server') {\n            newValue = 'client';\n        }\n        this._sortingMode = newValue;\n    }\n\n    get sortingMode(): string {\n        return this._sortingMode;\n    }\n\n    constructor(private thumbnailService: ThumbnailService,\n                private contentService: ContentService,\n                schema: DataColumn[] = [],\n                sorting?: DataSorting,\n                sortingMode: string = 'client',\n                allowDropFiles: boolean = false) {\n        this.rows = [];\n        this.columns = schema || [];\n        this.sorting = sorting;\n        this.sortingMode = sortingMode;\n        this.allowDropFiles = allowDropFiles;\n    }\n\n    getRows(): Array<DataRow> {\n        return this.rows;\n    }\n\n    // TODO: disable this api\n    setRows(rows: Array<DataRow>) {\n        this.rows = rows || [];\n        this.sort();\n    }\n\n    getColumns(): Array<DataColumn> {\n        return this.columns;\n    }\n\n    setColumns(columns: Array<DataColumn>) {\n        this.columns = columns || [];\n    }\n\n    getValue(row: DataRow, col: DataColumn): any {\n        if (!row) {\n            throw new Error(this.ERR_ROW_NOT_FOUND);\n        }\n        if (!col) {\n            throw new Error(this.ERR_COL_NOT_FOUND);\n        }\n        const dataRow: ShareDataRow = <ShareDataRow> row;\n        const value: any = row.getValue(col.key);\n        if (dataRow.cache[col.key] !== undefined) {\n            return dataRow.cache[col.key];\n        }\n\n        if (col.key === '$thumbnail') {\n\n            if (this.imageResolver) {\n                const resolved = this.imageResolver(row, col);\n                if (resolved) {\n                    return resolved;\n                }\n            }\n\n            const node = (<ShareDataRow> row).node;\n\n            if (node.entry.isFolder) {\n                return this.getFolderIcon(node);\n            }\n\n            if (node.entry.isFile) {\n                if (this.thumbnails) {\n                    return this.thumbnailService.getDocumentThumbnailUrl(node);\n                }\n            }\n\n            if (node.entry.content) {\n                const mimeType = node.entry.content.mimeType;\n                if (mimeType) {\n                    return this.thumbnailService.getMimeTypeIcon(mimeType);\n                }\n            }\n\n            return this.thumbnailService.getDefaultMimeTypeIcon();\n        }\n\n        if (col.type === 'image') {\n\n            if (this.imageResolver) {\n                const resolved = this.imageResolver(row, col);\n                if (resolved) {\n                    return resolved;\n                }\n            }\n        }\n\n        return dataRow.cacheValue(col.key, value);\n    }\n\n    getSorting(): DataSorting {\n        return this.sorting;\n    }\n\n    setSorting(sorting: DataSorting): void {\n        this.sorting = sorting;\n\n        this.sortRows(this.rows, this.sorting);\n    }\n\n    sort(key?: string, direction?: string): void {\n        const sorting = this.sorting || new DataSorting();\n        if (key) {\n            sorting.key = key;\n            sorting.direction = direction || 'asc';\n        }\n        this.setSorting(sorting);\n    }\n\n    setFilter(filter: RowFilter) {\n        this.filter = filter;\n    }\n\n    setImageResolver(resolver: any) {\n        this.imageResolver = resolver;\n    }\n\n    private getFolderIcon(node: any) {\n        if (this.isSmartFolder(node)) {\n            return this.thumbnailService.getMimeTypeIcon('smartFolder');\n        } else if (this.isRuleFolder(node)) {\n            return this.thumbnailService.getMimeTypeIcon('ruleFolder');\n        } else if (this.isALinkFolder(node)) {\n            return this.thumbnailService.getMimeTypeIcon('linkFolder');\n        } else {\n            return this.thumbnailService.getMimeTypeIcon('folder');\n        }\n    }\n\n    isSmartFolder(node: any) {\n        const nodeAspects = this.getNodeAspectNames(node);\n        return nodeAspects.indexOf('smf:customConfigSmartFolder') > -1 ||\n            (nodeAspects.indexOf('smf:systemConfigSmartFolder') > -1);\n    }\n\n    isRuleFolder(node: any) {\n        const nodeAspects = this.getNodeAspectNames(node);\n        return nodeAspects.indexOf('rule:rules') > -1 ||\n            (nodeAspects.indexOf('rule:rules') > -1);\n    }\n\n    isALinkFolder(node: any) {\n        const nodeType = node.entry ? node.entry.nodeType : node.nodeType;\n        return nodeType === 'app:folderlink';\n    }\n\n    private getNodeAspectNames(node: any): any[] {\n        return node.entry?.aspectNames ? node.entry.aspectNames : (node.aspectNames ? node.aspectNames : []);\n    }\n\n    private sortRows(rows: DataRow[], sorting: DataSorting) {\n        if (this.sortingMode === 'server') {\n            return;\n        }\n\n        const options: Intl.CollatorOptions = {};\n\n        if (sorting?.key && rows?.length) {\n\n            if (sorting.key.includes('sizeInBytes') || sorting.key === 'name') {\n                options.numeric = true;\n            }\n\n            rows.sort((a: ShareDataRow, b: ShareDataRow) => {\n                if (a.node.entry.isFolder !== b.node.entry.isFolder) {\n                    return a.node.entry.isFolder ? -1 : 1;\n                }\n\n                let left = a.getValue(sorting.key);\n                if (left) {\n                    left = (left instanceof Date) ? left.valueOf().toString() : left.toString();\n                } else {\n                    left = '';\n                }\n\n                let right = b.getValue(sorting.key);\n                if (right) {\n                    right = (right instanceof Date) ? right.valueOf().toString() : right.toString();\n                } else {\n                    right = '';\n                }\n\n                return sorting.direction === 'asc'\n                    ? left.localeCompare(right, undefined, options)\n                    : right.localeCompare(left, undefined, options);\n            });\n        }\n    }\n\n    public loadPage(nodePaging: NodePaging, merge: boolean = false, allowDropFiles?: boolean) {\n        let shareDataRows: ShareDataRow[] = [];\n        if (allowDropFiles !== undefined) {\n            this.allowDropFiles = allowDropFiles;\n        }\n        if (nodePaging?.list) {\n            const nodeEntries: NodeEntry[] = nodePaging.list.entries;\n            if (nodeEntries?.length) {\n                shareDataRows = nodeEntries.map((item) => new ShareDataRow(item, this.contentService, this.permissionsStyle, this.thumbnailService, this.allowDropFiles));\n\n                if (this.filter) {\n                    shareDataRows = shareDataRows.filter(this.filter);\n                }\n\n                if (this.sortingMode !== 'server') {\n                    // Sort by first sortable or just first column\n                    if (this.columns?.length) {\n                        const sorting = this.getSorting();\n                        if (sorting) {\n                            this.sortRows(shareDataRows, sorting);\n                        } else {\n                            const sortable = this.columns.filter((c) => c.sortable);\n                            if (sortable.length > 0) {\n                                this.sort(sortable[0].key, 'asc');\n                            } else {\n                                this.sort(this.columns[0].key, 'asc');\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        if (merge) {\n            const listPrunedDuplicate = shareDataRows.filter((elementToFilter: any) => {\n                const isPresent = this.rows.find((currentRow: any) => {\n                    return currentRow.obj.entry.id === elementToFilter.obj.entry.id;\n                });\n\n                return !isPresent;\n            });\n\n            this.rows = this.rows.concat(listPrunedDuplicate);\n        } else {\n            this.rows = shareDataRows;\n        }\n    }\n\n    getSelectedRows(): DataRow[] {\n        return this.rows.filter((row: DataRow) => row.isSelected);\n    }\n\n    getRowByNodeId(nodeId: string): DataRow {\n       return this.rows.find((row: DataRow) => row.node.entry.id === nodeId);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport let presetsDefaultModel = {\n    '-trashcan-': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'name',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'path',\n            type: 'location',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.LOCATION',\n            sortable: true\n        },\n        {\n            key: 'content.sizeInBytes',\n            type: 'fileSize',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.SIZE',\n            sortable: true\n        },\n        {\n            key: 'archivedAt',\n            type: 'date',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.DELETED_ON',\n            format: 'timeAgo',\n            sortable: true\n        },\n        {\n            key: 'archivedByUser.displayName',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.DELETED_BY',\n            sortable: true\n        }\n    ],\n    '-sites-': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'title',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'visibility',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.STATUS',\n            sortable: true\n        }\n    ],\n    '-mysites-': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'title',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'visibility',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.STATUS',\n            sortable: true\n        }\n    ],\n    '-favorites-': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'name',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'path',\n            type: 'location',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.LOCATION',\n            sortable: true\n        },\n        {\n            key: 'content.sizeInBytes',\n            type: 'fileSize',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.SIZE',\n            sortable: true\n        },\n        {\n            key: 'modifiedAt',\n            type: 'date',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON',\n            format: 'timeAgo',\n            sortable: true\n        },\n        {\n            key: 'modifiedByUser.displayName',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_BY',\n            sortable: true\n        }\n    ],\n    '-recent-': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'name',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'path',\n            type: 'location',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.LOCATION',\n            cssClass: 'ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'content.sizeInBytes',\n            type: 'fileSize',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.SIZE',\n            sortable: true\n        },\n        {\n            key: 'modifiedAt',\n            type: 'date',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON',\n            format: 'timeAgo',\n            sortable: true\n        }\n    ],\n    '-sharedlinks-': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'name',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'path',\n            type: 'location',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.LOCATION',\n            cssClass: 'ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'content.sizeInBytes',\n            type: 'fileSize',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.SIZE',\n            sortable: true\n        },\n        {\n            key: 'modifiedAt',\n            type: 'date',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON',\n            format: 'timeAgo',\n            sortable: true\n        },\n        {\n            key: 'modifiedByUser.displayName',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_BY',\n            sortable: true\n        },\n        {\n            key: 'sharedByUser.displayName',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.SHARED_BY',\n            sortable: true\n        }\n    ],\n    'default': [\n        {\n            key: '$thumbnail',\n            type: 'image',\n            srTitle: 'ADF-DOCUMENT-LIST.LAYOUT.THUMBNAIL',\n            sortable: false\n        },\n        {\n            key: 'name',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.NAME',\n            cssClass: 'full-width ellipsis-cell',\n            sortable: true\n        },\n        {\n            key: 'content.sizeInBytes',\n            type: 'fileSize',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.SIZE',\n            sortable: true\n        },\n        {\n            key: 'modifiedAt',\n            type: 'date',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON',\n            format: 'timeAgo',\n            sortable: true\n        },\n        {\n            key: 'modifiedByUser.displayName',\n            type: 'text',\n            title: 'ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_BY',\n            sortable: true\n        }\n    ]\n};\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BaseEvent } from '@alfresco/adf-core';\nimport { NodeEntry, Node } from '@alfresco/js-api';\n\nexport class NodeEntityEvent extends BaseEvent<NodeEntry> {\n    constructor(nodeEntry: NodeEntry) {\n        super();\n        this.value = nodeEntry;\n    }\n}\n\nexport class NodeEntryEvent extends BaseEvent<Node> {\n    constructor(node: Node) {\n        super();\n        this.value = node;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* tslint:disable:rxjs-no-subject-value */\n\nimport {\n    AfterContentInit, Component, ContentChild, ElementRef, EventEmitter, HostListener, Input, NgZone,\n    OnChanges, OnDestroy, OnInit, Output, SimpleChanges, ViewChild, ViewEncapsulation\n} from '@angular/core';\n\nimport {\n    ContentService,\n    DataCellEvent,\n    DataColumn,\n    DataRowActionEvent,\n    DataSorting,\n    DataTableComponent,\n    DisplayMode,\n    ShowHeaderMode,\n    ObjectDataColumn,\n    PaginatedComponent,\n    AppConfigService,\n    DataColumnListComponent,\n    UserPreferencesService,\n    PaginationModel,\n    ThumbnailService,\n    CustomLoadingContentTemplateDirective,\n    CustomNoPermissionTemplateDirective,\n    CustomEmptyContentTemplateDirective,\n    RequestPaginationModel,\n    AlfrescoApiService,\n    UserPreferenceValues,\n    LockService,\n    DataRow\n} from '@alfresco/adf-core';\n\nimport { Node, NodeEntry, NodePaging, NodesApi, Pagination } from '@alfresco/js-api';\nimport { Subject, BehaviorSubject, of } from 'rxjs';\nimport { ShareDataRow } from './../data/share-data-row.model';\nimport { ShareDataTableAdapter } from './../data/share-datatable-adapter';\nimport { presetsDefaultModel } from '../models/preset.model';\nimport { ContentActionModel } from './../models/content-action.model';\nimport { PermissionStyleModel } from './../models/permissions-style.model';\nimport { NodeEntityEvent, NodeEntryEvent } from './node.event';\nimport { NavigableComponentInterface } from '../../breadcrumb/navigable-component.interface';\nimport { FilterSearch } from './../../search/models/filter-search.interface';\nimport { RowFilter } from '../data/row-filter.model';\nimport { DocumentListService } from '../services/document-list.service';\nimport { DocumentLoaderNode } from '../models/document-folder.model';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-document-list',\n    templateUrl: './document-list.component.html',\n    styleUrls: ['./document-list.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-document-list' }\n})\nexport class DocumentListComponent implements OnInit, OnChanges, OnDestroy, AfterContentInit, PaginatedComponent, NavigableComponentInterface {\n\n    static SINGLE_CLICK_NAVIGATION: string = 'click';\n    static DOUBLE_CLICK_NAVIGATION: string = 'dblclick';\n\n    DEFAULT_PAGINATION: Pagination = new Pagination({\n        hasMoreItems: false,\n        skipCount: 0,\n        maxItems: 25,\n        totalItems: 0\n    });\n\n    DEFAULT_SORTING: DataSorting[] = [\n        new DataSorting('name', 'asc'),\n        new DataSorting('isFolder', 'desc')\n    ];\n\n    @ContentChild(DataColumnListComponent)\n    columnList: DataColumnListComponent;\n\n    @ContentChild(CustomLoadingContentTemplateDirective)\n    customLoadingContent: CustomLoadingContentTemplateDirective;\n\n    @ContentChild(CustomNoPermissionTemplateDirective)\n    customNoPermissionsTemplate: CustomNoPermissionTemplateDirective;\n\n    @ContentChild(CustomEmptyContentTemplateDirective)\n    customNoContentTemplate: CustomEmptyContentTemplateDirective;\n\n    /** Include additional information about the node in the server request. For example: association, isLink, isLocked and others. */\n    @Input()\n    includeFields: string[];\n\n    /**\n     * Filters the Node list using the *where* condition of the REST API\n     * (for example, isFolder=true). See the REST API documentation for more information.\n     */\n    @Input()\n    where: string;\n\n    /** Change the display mode of the table. Can be \"list\" or \"gallery\". */\n    @Input()\n    display: string = DisplayMode.List;\n\n    /** Define a set of CSS styles to apply depending on the permission\n     * of the user on that node. See the Permission Style model\n     * page for further details and examples.\n     */\n    @Input()\n    permissionsStyle: PermissionStyleModel[] = [];\n\n    /** The default route for all the location-based columns (if declared). */\n    @Input()\n    locationFormat: string = '/';\n\n    /** Toggles navigation to folder content or file preview */\n    @Input()\n    navigate: boolean = true;\n\n    /** Toggles the header */\n    @Input()\n    showHeader = ShowHeaderMode.Data;\n\n    /** User interaction for folder navigation or file preview.\n     * Valid values are \"click\" and \"dblclick\". Default value: \"dblclick\"\n     */\n    @Input()\n    navigationMode: string = DocumentListComponent.DOUBLE_CLICK_NAVIGATION; // click|dblclick\n\n    /** Show document thumbnails rather than icons */\n    @Input()\n    thumbnails: boolean = false;\n\n    /** Row selection mode. Can be null, `single` or `multiple`. For `multiple` mode,\n     * you can use Cmd (macOS) or Ctrl (Win) modifier key to toggle selection for multiple rows.\n     */\n    @Input()\n    selectionMode: string = 'single'; // null|single|multiple\n\n    /** Toggles multiselect mode */\n    @Input()\n    multiselect: boolean = false;\n\n    /** Toggles content actions for each row */\n    @Input()\n    contentActions: boolean = false;\n\n    /** Position of the content actions dropdown menu. Can be set to \"left\" or \"right\". */\n    @Input()\n    contentActionsPosition: string = 'right'; // left|right\n\n    /** Toggles context menus for each row */\n    @Input()\n    contextMenuActions: boolean = false;\n\n    /** Custom image for empty folder. Default value: './assets/images/empty_doc_lib.svg' */\n    @Input()\n    emptyFolderImageUrl: string = './assets/images/empty_doc_lib.svg';\n\n    /**\n     * When true, this enables you to drop files directly into subfolders shown\n     * as items in the list or into another file to trigger updating it's version.\n     * When false, the dropped file will be added to the\n     * current folder (ie, the one containing all the items shown in the list).\n     * See the Upload directive for further details about how the file drop is\n     * handled.\n     */\n    @Input()\n    allowDropFiles: boolean = false;\n\n    /** Defines default sorting. The format is an array of 2 strings `[key, direction]`\n     * i.e. `['name', 'desc']` or `['name', 'asc']`. Set this value only if you want to\n     * override the default sorting detected by the component based on columns.\n     */\n    @Input()\n    sorting: string[] | DataSorting = ['name', 'asc'];\n\n    /** Defines default sorting. The format is an array of strings `[key direction, otherKey otherDirection]`\n     * i.e. `['name desc', 'nodeType asc']` or `['name asc']`. Set this value if you want a base\n     * rule to be added to the sorting apart from the one driven by the header.\n     */\n    @Input()\n    additionalSorting: DataSorting = new DataSorting('isFolder', 'desc');\n\n    /** Defines sorting mode. Can be either `client` (items in the list\n     * are sorted client-side) or `server` (the ordering supplied by the\n     * server is used without further client-side sorting).\n     * Note that the `server` option *does not* request the server to sort the data\n     * before delivering it.\n     */\n    @Input()\n    sortingMode: 'server' | 'client' = 'server';\n\n    /** The inline style to apply to every row. See\n     * the Angular NgStyle\n     * docs for more details and usage examples.\n     */\n    @Input()\n    rowStyle: { [key: string]: any; };\n\n    /** The CSS class to apply to every row */\n    @Input()\n    rowStyleClass: string;\n\n    /** Toggles the loading state and animated spinners for the component. Used in\n     * combination with `navigate=false` to perform custom navigation and loading\n     * state indication.\n     */\n    @Input()\n    loading: boolean = false;\n\n    /** @hidden */\n    @Input()\n    _rowFilter: RowFilter | null = null;\n\n    /**\n     * Custom function to choose whether to show or hide rows.\n     * See the [Row Filter Model](row-filter.model.md) page for\n     * more information.\n     */\n    @Input()\n    set rowFilter(rowFilter: RowFilter) {\n        this._rowFilter = rowFilter;\n        if (this.data) {\n            this.data.setFilter(this._rowFilter);\n            if (this.currentFolderId) {\n                this.reload();\n            }\n        }\n    }\n\n    get rowFilter(): RowFilter {\n        return this._rowFilter;\n    }\n\n    /**\n     * Custom function to choose image file paths to show. See the\n     * [Image Resolver Model](image-resolver.model.md) page for\n     * more information.\n     */\n    @Input()\n    imageResolver: any | null = null;\n\n    /** Toggles the sticky header mode. */\n    @Input()\n    stickyHeader: boolean = false;\n\n    /** Toggles the header filters mode. */\n    @Input()\n    headerFilters: boolean = false;\n\n    /** Initial value for filter. */\n    @Input()\n    filterValue: any;\n\n    /** The ID of the folder node to display or a reserved string alias for special sources */\n    @Input()\n    currentFolderId: string = null;\n\n    /** Array of nodes to be pre-selected. All nodes in the\n     * array are pre-selected in multi selection mode, but only the first node\n     * is pre-selected in single selection mode.\n     */\n    @Input()\n    preselectNodes: NodeEntry[] = [];\n\n    /** The Document list will show all the nodes contained in the NodePaging entity */\n    @Input()\n    node: NodePaging = null;\n\n    /** Default value is stored in the user preference settings. Use this only if you are not using pagination. */\n    @Input()\n    maxItems: number = this.DEFAULT_PAGINATION.maxItems;\n\n    /** Emitted when the user clicks a list node */\n    @Output()\n    nodeClick: EventEmitter<NodeEntityEvent> = new EventEmitter<NodeEntityEvent>();\n\n    /** Emitted when the user double-clicks a list node */\n    @Output()\n    nodeDblClick: EventEmitter<NodeEntityEvent> = new EventEmitter<NodeEntityEvent>();\n\n    /** Emitted when the current display folder changes */\n    @Output()\n    folderChange: EventEmitter<NodeEntryEvent> = new EventEmitter<NodeEntryEvent>();\n\n    /** Emitted when the user acts upon files with either single or double click\n     * (depends on `navigation-mode`). Useful for integration with the\n     * Viewer component.\n     */\n    @Output()\n    preview: EventEmitter<NodeEntityEvent> = new EventEmitter<NodeEntityEvent>();\n\n    /** Emitted when the Document List has loaded all items and is ready for use */\n    @Output()\n    ready: EventEmitter<NodePaging> = new EventEmitter();\n\n    /** Emitted when the API fails to get the Document List data */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter();\n\n    /** Emitted when the node selection change */\n    @Output()\n    nodeSelected: EventEmitter<NodeEntry[]> = new EventEmitter<NodeEntry[]>();\n\n    /** Emitted when a filter value is selected */\n    @Output()\n    filterSelection: EventEmitter<FilterSearch[]> = new EventEmitter();\n\n    @ViewChild('dataTable', { static: true })\n    dataTable: DataTableComponent;\n\n    actions: ContentActionModel[] = [];\n    contextActionHandler: Subject<any> = new Subject();\n    data: ShareDataTableAdapter;\n    noPermission: boolean = false;\n    selection = new Array<NodeEntry>();\n    $folderNode: Subject<Node> = new Subject<Node>();\n    allowFiltering: boolean = true;\n    orderBy: string[] = null;\n    preselectedRows: DataRow[] = [];\n\n    // @deprecated 3.0.0\n    folderNode: Node;\n\n    private _pagination: PaginationModel = this.DEFAULT_PAGINATION;\n    pagination: BehaviorSubject<PaginationModel> = new BehaviorSubject<PaginationModel>(this.DEFAULT_PAGINATION);\n    sortingSubject: BehaviorSubject<DataSorting[]> = new BehaviorSubject<DataSorting[]>(this.DEFAULT_SORTING);\n\n    private layoutPresets = {};\n    private rowMenuCache: { [key: string]: ContentActionModel[] } = {};\n    private loadingTimeout;\n    private onDestroy$ = new Subject<boolean>();\n\n    _nodesApi: NodesApi;\n    get nodesApi(): NodesApi {\n        this._nodesApi = this._nodesApi ?? new NodesApi(this.alfrescoApiService.getInstance());\n        return this._nodesApi;\n    }\n\n    constructor(private documentListService: DocumentListService,\n                private ngZone: NgZone,\n                private elementRef: ElementRef,\n                private appConfig: AppConfigService,\n                private userPreferencesService: UserPreferencesService,\n                private contentService: ContentService,\n                private thumbnailService: ThumbnailService,\n                private alfrescoApiService: AlfrescoApiService,\n                private lockService: LockService) {\n        this.userPreferencesService\n            .select(UserPreferenceValues.PaginationSize)\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(pagSize => {\n                this.maxItems = this._pagination.maxItems = pagSize;\n            });\n    }\n\n    getContextActions(node: NodeEntry) {\n        if (node && node.entry) {\n            const actions = this.getNodeActions(node);\n            if (actions && actions.length > 0) {\n                return actions.map((currentAction: ContentActionModel) => {\n                    return {\n                        model: currentAction,\n                        node: node,\n                        subject: this.contextActionHandler\n                    };\n                });\n            }\n        }\n        return null;\n    }\n\n    get hasCustomLayout(): boolean {\n        return this.columnList && this.columnList.columns && this.columnList.columns.length > 0;\n    }\n\n    private getDefaultSorting(): DataSorting {\n        let defaultSorting: DataSorting;\n        if (Array.isArray(this.sorting)) {\n            const [key, direction] = this.sorting;\n            defaultSorting = new DataSorting(key, direction);\n        } else {\n            defaultSorting = new DataSorting(this.sorting.key, this.sorting.direction);\n        }\n\n        return defaultSorting;\n    }\n\n    private getLayoutPreset(name: string = 'default'): DataColumn[] {\n        return (this.layoutPresets[name] || this.layoutPresets['default']).map((col) => new ObjectDataColumn(col));\n    }\n\n    isMobile(): boolean {\n        return !!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n    }\n\n    isEmpty() {\n        return !this.data || this.data.getRows().length === 0;\n    }\n\n    ngOnInit() {\n        this.rowMenuCache = {};\n        this.loadLayoutPresets();\n        this.data = new ShareDataTableAdapter(this.thumbnailService, this.contentService, null, this.getDefaultSorting(),\n            this.sortingMode, this.allowDropFiles);\n        this.data.thumbnails = this.thumbnails;\n        this.data.permissionsStyle = this.permissionsStyle;\n\n        if (this._rowFilter) {\n            this.data.setFilter(this._rowFilter);\n        }\n\n        if (this.imageResolver) {\n            this.data.setImageResolver(this.imageResolver);\n        }\n\n        this.contextActionHandler\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(val => this.contextActionCallback(val));\n\n        this.enforceSingleClickNavigationForMobile();\n    }\n\n    ngAfterContentInit() {\n        if (this.columnList) {\n            this.columnList.columns.changes\n                .pipe(takeUntil(this.onDestroy$))\n                .subscribe(() => this.setTableSchema());\n        }\n        this.setTableSchema();\n    }\n\n    private setTableSchema() {\n        let schema: DataColumn[] = [];\n\n        if (this.hasCustomLayout) {\n            schema = this.columnList.columns.map((c) => <DataColumn> c);\n        }\n\n        if (!this.data) {\n            this.data = new ShareDataTableAdapter(this.thumbnailService, this.contentService, schema, this.getDefaultSorting(), this.sortingMode);\n        } else if (schema && schema.length > 0) {\n            this.data.setColumns(schema);\n        }\n\n        const columns = this.data.getColumns();\n        if (!columns || columns.length === 0) {\n            this.setupDefaultColumns(this.currentFolderId);\n        }\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (!changes['preselectNodes']) {\n            this.resetSelection();\n        }\n\n        if (Array.isArray(this.sorting)) {\n            const [key, direction] = this.sorting;\n            this.orderBy = this.buildOrderByArray(key, direction);\n        } else {\n            this.orderBy = this.buildOrderByArray(this.sorting.key, this.sorting.direction);\n        }\n\n        if (this.data) {\n            this.data.thumbnails = this.thumbnails;\n        }\n\n        if (changes.sortingMode && !changes.sortingMode.firstChange && this.data) {\n            this.data.sortingMode = changes.sortingMode.currentValue;\n        }\n\n        if (changes.sorting && !changes.sorting.firstChange && this.data) {\n            const newValue = changes.sorting.currentValue;\n            if (newValue && newValue.length > 0) {\n                const [key, direction] = newValue;\n                this.data.setSorting(new DataSorting(key, direction));\n            }\n        }\n\n        if (this.currentFolderId && changes['currentFolderId']?.currentValue !== changes['currentFolderId']?.previousValue) {\n            this.loadFolder();\n        }\n\n        if (this.data) {\n            if (changes.node && changes.node.currentValue) {\n                const merge = this._pagination ? this._pagination.merge : false;\n                this.data.loadPage(changes.node.currentValue, merge, null);\n                this.preserveExistingSelection();\n                this.onPreselectNodes();\n                this.onDataReady(changes.node.currentValue);\n            } else if (changes.imageResolver) {\n                this.data.setImageResolver(changes.imageResolver.currentValue);\n            }\n        }\n    }\n\n    reload() {\n        this.ngZone.run(() => {\n            this.resetSelection();\n            this.reloadWithoutResettingSelection();\n        });\n    }\n\n    reloadWithoutResettingSelection() {\n        if (this.node) {\n            if (this.data) {\n                this.data.loadPage(this.node, this._pagination.merge, null);\n                this.preserveExistingSelection();\n            }\n            this.onPreselectNodes();\n            this.syncPagination();\n            this.onDataReady(this.node);\n        } else {\n            this.loadFolder();\n        }\n    }\n\n    contextActionCallback(action) {\n        if (action) {\n            this.executeContentAction(action.node, action.model);\n        }\n    }\n\n    getNodeActions(node: NodeEntry | any): ContentActionModel[] {\n        if (node && node.entry) {\n            let target = null;\n\n            if (node.entry.isFile) {\n                target = 'document';\n            } else if (node.entry.isFolder) {\n                target = 'folder';\n            }\n\n            if (target) {\n                const actions = this.rowMenuCache[node.entry.id];\n                if (actions) {\n                    actions.forEach((action) => {\n                        this.refreshAction(action, node);\n                    });\n                    return actions;\n                }\n\n                const actionsByTarget = this.actions\n                    .filter((entry) => {\n                        const isVisible = (typeof entry.visible === 'function')\n                            ? entry.visible(node)\n                            : entry.visible;\n\n                        return isVisible && entry.target.toLowerCase() === target;\n                    })\n                    .map((action) => new ContentActionModel(action));\n\n                actionsByTarget.forEach((action) => {\n                    this.refreshAction(action, node);\n                });\n\n                this.rowMenuCache[node.entry.id] = actionsByTarget;\n                return actionsByTarget;\n            }\n        }\n\n        return [];\n    }\n\n    private refreshAction(action: ContentActionModel, node: NodeEntry) {\n        action.disabled = this.isActionDisabled(action, node);\n        action.visible = this.isActionVisible(action, node);\n    }\n\n    private isActionVisible(action: ContentActionModel, node: NodeEntry): boolean {\n        if (typeof action.visible === 'function') {\n            return action.visible(node);\n        }\n\n        return action.visible;\n    }\n\n    private isActionDisabled(action: ContentActionModel, node: NodeEntry): boolean {\n        if (typeof action.disabled === 'function') {\n            return action.disabled(node);\n        }\n\n        if ((action.permission &&\n            action.disableWithNoPermission &&\n            !this.contentService.hasAllowableOperations(node.entry, action.permission)) ||\n            this.lockService.isLocked(node.entry)) {\n            return true;\n        } else {\n            return action.disabled;\n        }\n    }\n\n    @HostListener('contextmenu', ['$event'])\n    onShowContextMenu(e?: Event) {\n        if (e && this.contextMenuActions) {\n            e.preventDefault();\n        }\n    }\n\n    navigateTo(node: Node | string): boolean {\n        if (typeof node === 'string') {\n            this.resetNewFolderPagination();\n            this.currentFolderId = node;\n            this.folderChange.emit(new NodeEntryEvent(<Node> { id: node }));\n            this.reload();\n            return true;\n        } else {\n            if (this.canNavigateFolder(node)) {\n                this.resetNewFolderPagination();\n                this.currentFolderId = this.getNodeFolderDestinationId(node);\n                this.folderChange.emit(new NodeEntryEvent(<Node> { id: this.currentFolderId }));\n                this.reload();\n                return true;\n            }\n        }\n        return false;\n    }\n\n    private getNodeFolderDestinationId(node: Node) {\n        return this.isLinkFolder(node) ? node.properties['cm:destination'] : node.id;\n    }\n\n    private isLinkFolder(node: Node) {\n        return node.nodeType === 'app:folderlink' && node.properties &&\n            node.properties['cm:destination'];\n    }\n\n    updateCustomSourceData(nodeId: string): void {\n        this.currentFolderId = nodeId;\n    }\n\n    /**\n     * Invoked when executing content action for a document or folder.\n     * @param node Node to be the context of the execution.\n     * @param action Action to be executed against the context.\n     */\n    executeContentAction(node: NodeEntry, action: ContentActionModel) {\n        if (node && node.entry && action) {\n            const handlerSub = (typeof action.handler === 'function') ? action.handler(node, this, action.permission) : of(true);\n\n            if (typeof action.execute === 'function' && handlerSub) {\n                handlerSub\n                    .pipe(takeUntil(this.onDestroy$))\n                    .subscribe(() => action.execute(node));\n            }\n        }\n    }\n\n    private setLoadingState(value: boolean) {\n        if (this.data?.getRows().length > 0) {\n            if (value) {\n                clearTimeout(this.loadingTimeout);\n                this.loadingTimeout = setTimeout(() => {\n                    this.loading = true;\n                }, 1000);\n            } else {\n                clearTimeout(this.loadingTimeout);\n                this.loading = false;\n            }\n        } else {\n            clearTimeout(this.loadingTimeout);\n            this.loading = value;\n        }\n    }\n\n    loadFolder() {\n        if (!this._pagination.merge) {\n            this.setLoadingState(true);\n        }\n\n        if (!this.hasCustomLayout) {\n            this.setupDefaultColumns(this.currentFolderId);\n        }\n\n        if (this.documentListService.isCustomSourceService(this.currentFolderId)) {\n            this.updateCustomSourceData(this.currentFolderId);\n        }\n\n        this.documentListService.loadFolderByNodeId(this.currentFolderId, this._pagination, this.includeFields, this.where, this.orderBy)\n            .subscribe((documentNode: DocumentLoaderNode) => {\n                if (documentNode.currentNode) {\n                    this.folderNode = documentNode.currentNode.entry;\n                    this.$folderNode.next(documentNode.currentNode.entry);\n                }\n                this.onPageLoaded(documentNode.children);\n            }, (err) => {\n                this.handleError(err);\n            });\n    }\n\n    resetSelection() {\n        this.dataTable.resetSelection();\n        this.selection = [];\n        this.noPermission = false;\n    }\n\n    onPageLoaded(nodePaging: NodePaging) {\n        if (nodePaging) {\n            if (this.data) {\n                this.data.loadPage(nodePaging, this._pagination.merge, this.allowDropFiles);\n                this.preserveExistingSelection();\n            }\n            this.onPreselectNodes();\n            this.setLoadingState(false);\n            this.onDataReady(nodePaging);\n        }\n    }\n\n    onSortingChanged(event: CustomEvent) {\n        this.orderBy = this.buildOrderByArray(event.detail.sortingKey, event.detail.direction);\n        this.sortingSubject.next([this.additionalSorting, event.detail]);\n\n        if (this.sortingMode === 'server') {\n            this.reload();\n        }\n    }\n\n    private buildOrderByArray(currentKey: string, currentDirection: string): string[] {\n        return [\n            `${this.additionalSorting.key} ${this.additionalSorting.direction}`,\n            `${currentKey} ${currentDirection}`\n        ];\n    }\n\n    /**\n     * Creates a set of predefined columns.\n     */\n    setupDefaultColumns(preset: string = 'default'): void {\n        if (this.data) {\n            const columns = this.getLayoutPreset(preset);\n            this.data.setColumns(columns);\n        }\n    }\n\n    onPreviewFile(node: NodeEntry) {\n        if (node) {\n            this.preview.emit(new NodeEntityEvent(node));\n        }\n    }\n\n    onNodeClick(nodeEntry: NodeEntry) {\n        const domEvent = new CustomEvent('node-click', {\n            detail: {\n                sender: this,\n                node: nodeEntry\n            },\n            bubbles: true\n        });\n\n        this.elementRef.nativeElement.dispatchEvent(domEvent);\n\n        const event = new NodeEntityEvent(nodeEntry);\n        this.nodeClick.emit(event);\n\n        if (!event.defaultPrevented) {\n            if (this.navigate && this.navigationMode === DocumentListComponent.SINGLE_CLICK_NAVIGATION) {\n                this.executeActionClick(nodeEntry);\n            }\n        }\n\n    }\n\n    onNodeDblClick(nodeEntry: NodeEntry) {\n        const domEvent = new CustomEvent('node-dblclick', {\n            detail: {\n                sender: this,\n                node: nodeEntry\n            },\n            bubbles: true\n        });\n        this.elementRef.nativeElement.dispatchEvent(domEvent);\n\n        const event = new NodeEntityEvent(nodeEntry);\n        this.nodeDblClick.emit(event);\n\n        if (!event.defaultPrevented) {\n            if (this.navigate && this.navigationMode === DocumentListComponent.DOUBLE_CLICK_NAVIGATION) {\n                this.executeActionClick(nodeEntry);\n            }\n        }\n    }\n\n    executeActionClick(nodeEntry: NodeEntry) {\n        if (nodeEntry && nodeEntry.entry) {\n            if (nodeEntry.entry.isFile) {\n                this.onPreviewFile(nodeEntry);\n            }\n\n            if (nodeEntry.entry.isFolder) {\n                this.navigateTo(nodeEntry.entry);\n            }\n\n            if (nodeEntry.entry['guid']) {\n                const options = {\n                    include: this.includeFields\n                };\n\n                this.nodesApi.getNode(nodeEntry.entry['guid'], options)\n                    .then((node: NodeEntry) => {\n                        this.navigateTo(node.entry);\n                    });\n            }\n        }\n    }\n\n    onNodeSelect(event: { row: ShareDataRow, selection: Array<ShareDataRow> }) {\n        this.selection = event.selection.map((entry) => entry.node);\n        const domEvent = new CustomEvent('node-select', {\n            detail: {\n                node: event.row ? event.row.node : null,\n                selection: this.selection\n            },\n            bubbles: true\n        });\n        this.nodeSelected.emit(this.selection);\n        this.elementRef.nativeElement.dispatchEvent(domEvent);\n    }\n\n    onNodeUnselect(event: { row: ShareDataRow, selection: Array<ShareDataRow> }) {\n        this.selection = event.selection.map((entry) => entry.node);\n        const domEvent = new CustomEvent('node-unselect', {\n            detail: {\n                node: event.row ? event.row.node : null,\n                selection: this.selection\n            },\n            bubbles: true\n        });\n        this.nodeSelected.emit(this.selection);\n        this.elementRef.nativeElement.dispatchEvent(domEvent);\n    }\n\n    onShowRowContextMenu(event: DataCellEvent) {\n        if (this.contextMenuActions) {\n            const args = event.value;\n            const node = (<ShareDataRow> args.row).node;\n            if (node) {\n                args.actions = this.getContextActions(node) || [];\n            }\n        }\n    }\n\n    onShowRowActionsMenu(event: DataCellEvent) {\n        if (this.contentActions) {\n            const args = event.value;\n            const node = (<ShareDataRow> args.row).node;\n            if (node) {\n                args.actions = this.getNodeActions(node) || [];\n            }\n        }\n    }\n\n    onExecuteRowAction(event: DataRowActionEvent) {\n        if (this.contentActions) {\n            const args = event.value;\n            const node = (<ShareDataRow> args.row).node;\n            const action = (<ContentActionModel> args.action);\n            this.executeContentAction(node, action);\n        }\n    }\n\n    private enforceSingleClickNavigationForMobile(): void {\n        if (this.isMobile()) {\n            this.navigationMode = DocumentListComponent.SINGLE_CLICK_NAVIGATION;\n        }\n    }\n\n    canNavigateFolder(node: Node): boolean {\n        let canNavigateFolder: boolean = false;\n\n        if (node && node.isFolder) {\n            canNavigateFolder = true;\n        }\n\n        return canNavigateFolder;\n    }\n\n    private loadLayoutPresets(): void {\n        const externalSettings = this.appConfig.get('document-list.presets', null);\n        this.layoutPresets = externalSettings ? Object.assign({}, presetsDefaultModel, externalSettings) : presetsDefaultModel;\n    }\n\n    private onDataReady(nodePaging: NodePaging) {\n        this.ready.emit(nodePaging);\n        this.pagination.next(nodePaging.list.pagination);\n    }\n\n    updatePagination(requestPaginationModel: RequestPaginationModel) {\n        this._pagination.maxItems = requestPaginationModel.maxItems;\n        this._pagination.merge = requestPaginationModel.merge;\n        this._pagination.skipCount = requestPaginationModel.skipCount;\n        this.reload();\n    }\n\n    private syncPagination() {\n        this.node.list.pagination.maxItems = this._pagination.maxItems;\n        this.node.list.pagination.skipCount = this._pagination.skipCount;\n    }\n\n    onFilterSelectionChange(activeFilters: FilterSearch[]) {\n        this.filterSelection.emit(activeFilters);\n    }\n\n    resetNewFolderPagination() {\n        this._pagination.skipCount = 0;\n        this._pagination.maxItems = this.maxItems;\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    private handleError(err: any) {\n        if (err.message) {\n            try {\n                if (JSON.parse(err.message).error.statusCode === 403) {\n                    this.noPermission = true;\n                }\n            } catch (error) {\n            }\n        }\n        this.setLoadingState(false);\n        this.error.emit(err);\n    }\n\n    getPreselectedNodesBasedOnSelectionMode(): NodeEntry[] {\n        return this.hasPreselectedNodes() ? (this.isSingleSelectionMode() ? [this.preselectNodes[0]] : this.preselectNodes) : [];\n    }\n\n    getPreselectedRowsBasedOnSelectionMode(): DataRow[] {\n        return this.hasPreselectedRows() ? (this.isSingleSelectionMode() ? [this.preselectedRows[0]] : this.preselectedRows) : [];\n    }\n\n    getSelectionBasedOnSelectionMode(): DataRow[] {\n        return this.hasPreselectedRows() ? (this.isSingleSelectionMode() ? [this.preselectedRows[0]] : this.data.getSelectedRows()) : this.data.getSelectedRows();\n    }\n\n    onPreselectNodes() {\n        if (this.hasPreselectedNodes()) {\n            this.preselectRowsOfPreselectedNodes();\n            const preselectedRows = this.getPreselectedRowsBasedOnSelectionMode();\n            const selectedNodes = this.data.getSelectedRows();\n\n            for (const node of preselectedRows) {\n                this.dataTable.selectRow(node, true);\n            }\n            this.onNodeSelect({ row: undefined, selection: <ShareDataRow[]> selectedNodes });\n        }\n    }\n\n    preserveExistingSelection() {\n        if (this.isMultipleSelectionMode()) {\n            for (const selection of this.selection) {\n                const rowOfSelection = this.data.getRowByNodeId(selection.entry.id);\n                if (rowOfSelection) {\n                    rowOfSelection.isSelected = true;\n                }\n            }\n        }\n    }\n\n    preselectRowsOfPreselectedNodes() {\n        this.preselectedRows = [];\n        const preselectedNodes = this.getPreselectedNodesBasedOnSelectionMode();\n\n        preselectedNodes.forEach((preselectedNode: NodeEntry) => {\n            const rowOfPreselectedNode = this.data.getRowByNodeId(preselectedNode.entry.id);\n            if (rowOfPreselectedNode) {\n                rowOfPreselectedNode.isSelected = true;\n                this.preselectedRows.push(rowOfPreselectedNode);\n            }\n        });\n    }\n\n    unselectRowFromNodeId(nodeId: string) {\n        const rowToUnselect = this.data.getRowByNodeId(nodeId);\n        if (rowToUnselect?.isSelected) {\n            rowToUnselect.isSelected = false;\n            this.dataTable.selectRow(rowToUnselect, false);\n            const selection = this.getSelectionBasedOnSelectionMode();\n            this.onNodeUnselect({ row: undefined, selection: <ShareDataRow[]> selection });\n        }\n    }\n\n    isSingleSelectionMode(): boolean {\n        return this.selectionMode === 'single';\n    }\n\n    isMultipleSelectionMode(): boolean {\n        return this.selectionMode === 'multiple';\n    }\n\n    hasPreselectedNodes(): boolean {\n        return this.preselectNodes?.length > 0;\n    }\n\n    hasPreselectedRows(): boolean {\n        return this.preselectedRows?.length > 0;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class PermissionModel {\n    type: string;\n    action: string;\n    permission: string;\n\n    constructor(obj?: any) {\n        if (obj) {\n            this.type = obj.type || null;\n            this.action = obj.action || null;\n            this.permission = obj.permission || null;\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable, Output, EventEmitter } from '@angular/core';\nimport { Node, NodeEntry } from '@alfresco/js-api';\nimport { Subject } from 'rxjs';\nimport { AlfrescoApiService, ContentService, NodeDownloadDirective, DownloadService } from '@alfresco/adf-core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { DocumentListService } from './document-list.service';\nimport { ContentNodeDialogService } from '../../content-node-selector/content-node-dialog.service';\nimport { NodeAction } from '../models/node-action.enum';\n\n@Injectable({\n    providedIn: 'root'\n})\n// tslint:disable-next-line: directive-class-suffix\nexport class NodeActionsService {\n\n    @Output()\n    error = new EventEmitter<any>();\n\n    constructor(private contentDialogService: ContentNodeDialogService,\n                public dialogRef: MatDialog,\n                public content: ContentService,\n                private documentListService?: DocumentListService,\n                private apiService?: AlfrescoApiService,\n                private dialog?: MatDialog,\n                private downloadService?: DownloadService) {}\n\n    downloadNode(node: NodeEntry) {\n        new NodeDownloadDirective(this.apiService, this.downloadService, this.dialog)\n            .downloadNode(node);\n    }\n\n    /**\n     * Copy content node\n     *\n     * @param contentEntry node to copy\n     * @param permission permission which is needed to apply the action\n     */\n    copyContent(contentEntry: Node, permission?: string): Subject<string> {\n        return this.doFileOperation(NodeAction.COPY, 'content', contentEntry, permission);\n    }\n\n    /**\n     * Copy folder node\n     *\n     * @param contentEntry node to copy\n     * @param permission permission which is needed to apply the action\n     */\n    copyFolder(contentEntry: Node, permission?: string): Subject<string> {\n        return this.doFileOperation(NodeAction.COPY, 'folder', contentEntry, permission);\n    }\n\n    /**\n     * Move content node\n     *\n     * @param contentEntry node to move\n     * @param permission permission which is needed to apply the action\n     */\n    moveContent(contentEntry: Node, permission?: string): Subject<string> {\n        return this.doFileOperation(NodeAction.MOVE, 'content', contentEntry, permission);\n    }\n\n    /**\n     * Move folder node\n     *\n     * @param contentEntry node to move\n     * @param permission permission which is needed to apply the action\n     */\n    moveFolder(contentEntry: Node, permission?: string): Subject<string> {\n        return this.doFileOperation(NodeAction.MOVE, 'folder', contentEntry, permission);\n    }\n\n    /**\n     * General method for performing the given operation (copy|move)\n     *\n     * @param action the action to perform (copy|move)\n     * @param type type of the content (content|folder)\n     * @param contentEntry the contentEntry which has to have the action performed on\n     * @param permission permission which is needed to apply the action\n     */\n    private doFileOperation(action: NodeAction.COPY | NodeAction.MOVE, type: 'content' | 'folder', contentEntry: Node, permission?: string): Subject<string> {\n        const observable = new Subject<string>();\n\n        this.contentDialogService\n            .openCopyMoveDialog(action, contentEntry, permission)\n            .subscribe((selections: Node[]) => {\n                const selection = selections[0];\n                this.documentListService[`${action.toLowerCase()}Node`].call(this.documentListService, contentEntry.id, selection.id)\n                    .subscribe(\n                    observable.next.bind(observable, `OPERATION.SUCCESS.${type.toUpperCase()}.${action}`),\n                    observable.error.bind(observable)\n                    );\n            },\n            (error) => {\n                observable.error(error);\n                return observable;\n            });\n        return observable;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentService, TranslationService } from '@alfresco/adf-core';\nimport { Injectable } from '@angular/core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { Observable, Subject, throwError, of } from 'rxjs';\nimport { ContentActionHandler } from '../models/content-action.model';\nimport { PermissionModel } from '../models/permissions.model';\nimport { DocumentListService } from './document-list.service';\nimport { NodeActionsService } from './node-actions.service';\nimport { ContentNodeDialogService } from '../../content-node-selector/content-node-dialog.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class DocumentActionsService {\n\n    permissionEvent: Subject<PermissionModel> = new Subject<PermissionModel>();\n    error: Subject<Error> = new Subject<Error>();\n    success: Subject<string> = new Subject<string>();\n\n    private handlers: { [id: string]: ContentActionHandler; } = {};\n\n    constructor(private nodeActionsService: NodeActionsService,\n                private contentNodeDialogService: ContentNodeDialogService,\n                private translation: TranslationService,\n                private documentListService?: DocumentListService,\n                private contentService?: ContentService) {\n        this.setupActionHandlers();\n    }\n\n    /**\n     * Gets the handler for an action.\n     * @param key Identifier of the action\n     * @returns The handler for the action\n     */\n    getHandler(key: string): ContentActionHandler {\n        if (key) {\n            const lKey = key.toLowerCase();\n            return this.handlers[lKey] || null;\n        }\n        return null;\n    }\n\n    /**\n     * Sets a new handler for an action.\n     * @param key Identifier of the action\n     * @param handler Handler for the action\n     * @returns False if the key was an empty/null string, true otherwise\n     */\n    setHandler(key: string, handler: ContentActionHandler): boolean {\n        if (key) {\n            const lKey = key.toLowerCase();\n            this.handlers[lKey] = handler;\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Checks if actions can be executed for an item.\n     * @param nodeEntry Item to receive an action\n     * @returns True if the action can be executed on this item, false otherwise\n     */\n    canExecuteAction(nodeEntry: NodeEntry): boolean {\n        return this.documentListService && nodeEntry && nodeEntry.entry.isFile === true;\n    }\n\n    private setupActionHandlers() {\n        this.handlers['copy'] = this.copyNode.bind(this);\n        this.handlers['move'] = this.moveNode.bind(this);\n        this.handlers['delete'] = this.deleteNode.bind(this);\n        this.handlers['download'] = this.downloadNode.bind(this);\n        this.handlers['lock'] = this.lockNode.bind(this);\n    }\n\n    private lockNode(node: NodeEntry) {\n        return this.contentNodeDialogService.openLockNodeDialog(node.entry);\n    }\n\n    private downloadNode(obj: NodeEntry) {\n        this.nodeActionsService.downloadNode(obj);\n    }\n\n    private copyNode(node: NodeEntry, _target?: any, permission?: string) {\n        const actionObservable = this.nodeActionsService.copyContent(node.entry, permission);\n        this.prepareHandlers(actionObservable);\n        return actionObservable;\n    }\n\n    private moveNode(node: NodeEntry, _target?: any, permission?: string) {\n        const actionObservable = this.nodeActionsService.moveContent(node.entry, permission);\n        this.prepareHandlers(actionObservable);\n        return actionObservable;\n    }\n\n    private prepareHandlers(actionObservable): void {\n        actionObservable.subscribe(\n            (fileOperationMessage) => {\n                this.success.next(fileOperationMessage);\n            },\n            this.error.next.bind(this.error)\n        );\n    }\n\n    private deleteNode(node: NodeEntry, _target?: any, permission?: string): Observable<any> {\n        if (this.canExecuteAction(node)) {\n            if (this.contentService.hasAllowableOperations(node.entry, permission)) {\n                const handlerObservable = this.documentListService.deleteNode(node.entry.id);\n                handlerObservable.subscribe(() => {\n                    const message = this.translation.instant('CORE.DELETE_NODE.SINGULAR', { name: node.entry.name });\n                    this.success.next(message);\n                }, () => {\n                    const message = this.translation.instant('CORE.DELETE_NODE.ERROR_SINGULAR', { name: node.entry.name });\n                    this.error.next(message);\n                });\n                return handlerObservable;\n            } else {\n                this.permissionEvent.next(new PermissionModel({\n                    type: 'content',\n                    action: 'delete',\n                    permission: permission\n                }));\n                return throwError(new Error('No permission to delete'));\n            }\n        }\n\n        return of();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentService, TranslationService } from '@alfresco/adf-core';\nimport { Injectable } from '@angular/core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { Observable, Subject, throwError, of } from 'rxjs';\nimport { ContentActionHandler } from '../models/content-action.model';\nimport { PermissionModel } from '../models/permissions.model';\nimport { DocumentListService } from './document-list.service';\nimport { NodeActionsService } from './node-actions.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class FolderActionsService {\n\n    permissionEvent: Subject<PermissionModel> = new Subject<PermissionModel>();\n    error: Subject<Error> = new Subject<Error>();\n    success: Subject<string> = new Subject<string>();\n\n    private handlers: { [id: string]: ContentActionHandler; } = {};\n\n    constructor(private nodeActionsService: NodeActionsService,\n                private documentListService: DocumentListService,\n                private contentService: ContentService,\n                private translation: TranslationService) {\n        this.setupActionHandlers();\n    }\n\n    /**\n     * Gets the handler function for an action.\n     * @param key Identifier for the action\n     * @returns The handler function\n     */\n    getHandler(key: string): ContentActionHandler {\n        if (key) {\n            const lKey = key.toLowerCase();\n            return this.handlers[lKey] || null;\n        }\n        return null;\n    }\n\n    /**\n     * Sets a new handler function for an action.\n     * @param key Identifier for the action\n     * @param handler The new handler function\n     * @returns True if the key was a valid action identifier, false otherwise\n     */\n    setHandler(key: string, handler: ContentActionHandler): boolean {\n        if (key) {\n            const lKey = key.toLowerCase();\n            this.handlers[lKey] = handler;\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Checks if an action is available for a particular item.\n     * @param nodeEntry Item to check\n     * @returns True if the action is available, false otherwise\n     */\n    canExecuteAction(nodeEntry: NodeEntry): boolean {\n        return this.documentListService && nodeEntry && nodeEntry.entry.isFolder === true;\n    }\n\n    private setupActionHandlers() {\n        this.handlers['copy'] = this.copyNode.bind(this);\n        this.handlers['move'] = this.moveNode.bind(this);\n        this.handlers['delete'] = this.deleteNode.bind(this);\n        this.handlers['download'] = this.downloadNode.bind(this);\n    }\n\n    private downloadNode(nodeEntry: NodeEntry) {\n        this.nodeActionsService.downloadNode(nodeEntry);\n    }\n\n    private copyNode(nodeEntry: NodeEntry, target?: any, permission?: string) {\n        const actionObservable = this.nodeActionsService.copyFolder(nodeEntry.entry, permission);\n        this.prepareHandlers(actionObservable, target);\n        return actionObservable;\n    }\n\n    private moveNode(nodeEntry: NodeEntry, target?: any, permission?: string) {\n        const actionObservable = this.nodeActionsService.moveFolder(nodeEntry.entry, permission);\n        this.prepareHandlers(actionObservable, target);\n        return actionObservable;\n    }\n\n    private prepareHandlers(actionObservable: Observable<any>, target?: any): void {\n        actionObservable.subscribe(\n            (fileOperationMessage) => {\n                if (target && typeof target.reload === 'function') {\n                    target.reload();\n                }\n                this.success.next(fileOperationMessage);\n            },\n            this.error.next.bind(this.error)\n        );\n    }\n\n    private deleteNode(node: NodeEntry, target?: any, permission?: string): Observable<any> {\n        if (this.canExecuteAction(node)) {\n            if (this.contentService.hasAllowableOperations(node.entry, permission)) {\n                const handlerObservable = this.documentListService.deleteNode(node.entry.id);\n                handlerObservable.subscribe(() => {\n                    if (target && typeof target.reload === 'function') {\n                        target.reload();\n                    }\n\n                    const message = this.translation.instant('CORE.DELETE_NODE.SINGULAR', { name: node.entry.name });\n                    this.success.next(message);\n                }, () => {\n                    const message = this.translation.instant('CORE.DELETE_NODE.ERROR_SINGULAR', { name: node.entry.name });\n                    this.error.next(message);\n                });\n\n                return handlerObservable;\n            } else {\n                this.permissionEvent.next(new PermissionModel({type: 'folder', action: 'delete', permission: permission}));\n                return throwError(new Error('No permission to delete'));\n            }\n        }\n\n        return of();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n /* tslint:disable:component-selector  */\n\nimport { Component } from '@angular/core';\n\nimport { ContentActionModel } from './../../models/content-action.model';\nimport { DocumentListComponent } from './../document-list.component';\n\n@Component({\n    selector: 'content-actions',\n    template: ''\n})\nexport class ContentActionListComponent {\n\n    constructor(private documentList: DocumentListComponent) {\n    }\n\n    /**\n     * Registers action handler within the parent document list component.\n     * @param action Action model to register.\n     */\n    registerAction(action: ContentActionModel): boolean {\n        if (this.documentList && action) {\n            this.documentList.actions.push(action);\n            return true;\n        }\n        return false;\n    }\n\n    unregisterAction(action: ContentActionModel): boolean {\n        if (this.documentList && action) {\n            const idx = this.documentList.actions.indexOf(action);\n            if (idx >= 0) {\n                this.documentList.actions.splice(idx, 1);\n                return true;\n            }\n        }\n        return false;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n /* tslint:disable:component-selector  */\n\nimport { Component, EventEmitter, Input, OnInit, Output, OnChanges, SimpleChanges, OnDestroy } from '@angular/core';\n\nimport { ContentActionHandler } from '../../models/content-action.model';\nimport { DocumentActionsService } from '../../services/document-actions.service';\nimport { FolderActionsService } from '../../services/folder-actions.service';\nimport { ContentActionModel, ContentActionTarget } from './../../models/content-action.model';\nimport { ContentActionListComponent } from './content-action-list.component';\nimport { Subscription } from 'rxjs';\n\n@Component({\n    selector: 'content-action',\n    template: '',\n    providers: [\n        DocumentActionsService,\n        FolderActionsService\n    ]\n})\nexport class ContentActionComponent implements OnInit, OnChanges, OnDestroy {\n\n    /** The title of the action as shown in the menu. */\n    @Input()\n    title: string = 'Action';\n\n    /** The name of the icon to display next to the menu command (can be left blank). */\n    @Input()\n    icon: string;\n\n    /** Visibility state (see examples). */\n    @Input()\n    visible: boolean | Function = true;\n\n    /** System actions. Can be \"delete\", \"download\", \"copy\" or \"move\". */\n    @Input()\n    handler: string;\n\n    /** Type of item that the action applies to. Can be \"document\" or \"folder\" */\n    @Input()\n    target: string = ContentActionTarget.All;\n\n    /** The permission type. */\n    @Input()\n    permission: string;\n\n    /** Should this action be disabled in the menu if the user doesn't have permission for it? */\n    @Input()\n    disableWithNoPermission: boolean;\n\n    /** Is the menu item disabled? */\n    @Input()\n    disabled: boolean | Function = false;\n\n    /** Emitted when the user selects the action from the menu. */\n    @Output()\n    execute = new EventEmitter();\n\n    /** Emitted when a permission error occurs */\n    @Output()\n    permissionEvent = new EventEmitter();\n\n    /** Emitted when an error occurs during the action.\n     * Applies to copy and move actions.\n     */\n    @Output()\n    error = new EventEmitter();\n\n    /** Emitted when the action succeeds with the success string message.\n     * Applies to copy, move and delete actions.\n     */\n    @Output()\n    success = new EventEmitter();\n\n    documentActionModel: ContentActionModel;\n    folderActionModel: ContentActionModel;\n\n    private subscriptions: Subscription[] = [];\n\n    constructor(\n        private list: ContentActionListComponent,\n        private documentActions: DocumentActionsService,\n        private folderActions: FolderActionsService) {\n    }\n\n    ngOnInit() {\n        if (this.target === ContentActionTarget.All) {\n            this.folderActionModel = this.generateAction(ContentActionTarget.Folder);\n            this.documentActionModel = this.generateAction(ContentActionTarget.Document);\n        } else {\n            this.documentActionModel = this.generateAction(this.target);\n        }\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (changes.visible && !changes.visible.firstChange) {\n            if (this.documentActionModel) {\n                this.documentActionModel.visible = changes.visible.currentValue;\n            }\n            if (this.folderActionModel) {\n                this.folderActionModel.visible = changes.visible.currentValue;\n            }\n        }\n\n        if (changes.disabled && !changes.disabled.firstChange) {\n            if (this.documentActionModel) {\n                this.documentActionModel.disabled = changes.disabled.currentValue;\n            }\n            if (this.folderActionModel) {\n                this.folderActionModel.disabled = changes.disabled.currentValue;\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this.subscriptions.forEach((subscription) => subscription.unsubscribe());\n        this.subscriptions = [];\n\n        if (this.documentActionModel) {\n            this.unregister(this.documentActionModel);\n            this.documentActionModel = null;\n        }\n\n        if (this.folderActionModel) {\n            this.unregister(this.folderActionModel);\n            this.folderActionModel = null;\n        }\n    }\n\n    register(model: ContentActionModel): boolean {\n        if (this.list) {\n            return this.list.registerAction(model);\n        }\n        return false;\n    }\n\n    unregister(model: ContentActionModel): boolean {\n        if (this.list) {\n            return this.list.unregisterAction(model);\n        }\n        return false;\n    }\n\n    private generateAction(target: string): ContentActionModel {\n        const model = new ContentActionModel({\n            title: this.title,\n            icon: this.icon,\n            permission: this.permission,\n            disableWithNoPermission: this.disableWithNoPermission,\n            target: target,\n            disabled: this.disabled,\n            visible: this.visible\n        });\n        if (this.handler) {\n            model.handler = this.getSystemHandler(target, this.handler);\n        }\n\n        if (this.execute) {\n            model.execute = (value: any): void => {\n                this.execute.emit({ value });\n            };\n        }\n\n        this.register(model);\n        return model;\n    }\n\n    getSystemHandler(target: string, name: string): ContentActionHandler {\n        if (target) {\n            target = target.toLowerCase();\n\n            if (target === ContentActionTarget.Document) {\n                if (this.documentActions) {\n                    this.subscriptions.push(\n                        this.documentActions.permissionEvent.subscribe((permission) => {\n                            this.permissionEvent.emit(permission);\n                        }),\n                        this.documentActions.error.subscribe((errors) => {\n                            this.error.emit(errors);\n                        }),\n                        this.documentActions.success.subscribe((message) => {\n                            this.success.emit(message);\n                        })\n                    );\n\n                    return this.documentActions.getHandler(name);\n                }\n                return null;\n            }\n\n            if (target === ContentActionTarget.Folder) {\n                if (this.folderActions) {\n                    this.subscriptions.push(\n                        this.folderActions.permissionEvent.subscribe((permission) => {\n                            this.permissionEvent.emit(permission);\n                        }),\n                        this.folderActions.error.subscribe((errors) => {\n                            this.error.emit(errors);\n                        }),\n                        this.folderActions.success.subscribe((message) => {\n                            this.success.emit(message);\n                        })\n                    );\n\n                    return this.folderActions.getHandler(name);\n                }\n                return null;\n            }\n        }\n        return null;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    OnInit,\n    Input,\n    ElementRef,\n    OnDestroy\n} from '@angular/core';\nimport { NodeEntry, Site } from '@alfresco/js-api';\nimport { ShareDataRow } from '../../data/share-data-row.model';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-library-name-column',\n    template: `\n        <span\n            role=\"link\"\n            [attr.aria-label]=\"'NAME_COLUMN_LINK.ACCESSIBILITY.ARIA_LABEL' | translate:{\n                name:  displayText$ | async\n            }\"\n            class=\"adf-datatable-cell-value\"\n            title=\"{{ displayTooltip$ | async }}\"\n            (click)=\"onClick()\">\n\n            {{ displayText$ | async }}\n        </span>\n    `,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    host: {\n        class: 'adf-datatable-content-cell adf-datatable-link adf-library-name-column'\n    }\n})\nexport class LibraryNameColumnComponent implements OnInit, OnDestroy {\n    @Input()\n    context: any;\n\n    displayTooltip$ = new BehaviorSubject<string>('');\n    displayText$ = new BehaviorSubject<string>('');\n    node: NodeEntry;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(\n        private element: ElementRef,\n        private alfrescoApiService: AlfrescoApiService\n    ) {}\n\n    ngOnInit() {\n        this.updateValue();\n\n        this.alfrescoApiService.nodeUpdated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(node => {\n                const row: ShareDataRow = this.context.row;\n                if (row) {\n                    const { entry } = row.node;\n\n                    if (entry === node) {\n                        row.node = { entry };\n                        this.updateValue();\n                    }\n                }\n            });\n    }\n\n    protected updateValue() {\n        this.node = this.context.row.node;\n        const rows: Array<ShareDataRow> = this.context.data.rows || [];\n        if (this.node && this.node.entry) {\n            this.displayText$.next(\n                this.makeLibraryTitle(<any> this.node.entry, rows)\n            );\n            this.displayTooltip$.next(this.makeLibraryTooltip(this.node.entry));\n        }\n    }\n\n    onClick() {\n        this.element.nativeElement.dispatchEvent(\n            new CustomEvent('name-click', {\n                bubbles: true,\n                detail: {\n                    node: this.node\n                }\n            })\n        );\n    }\n\n    makeLibraryTooltip(library: any): string {\n        const { description, title } = library;\n\n        return description || title || '';\n    }\n\n    makeLibraryTitle(library: Site, rows: Array<ShareDataRow>): string {\n        const entries = rows.map((row: ShareDataRow) => row.node.entry);\n        const { title, id } = library;\n\n        let isDuplicate = false;\n\n        if (entries) {\n            isDuplicate = entries.some((entry: any) => {\n                return entry.id !== id && entry.title === title;\n            });\n        }\n\n        return isDuplicate ? `${title} (${id})` : `${title}`;\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    OnInit,\n    Input,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    OnDestroy\n} from '@angular/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { SiteEntry, Site } from '@alfresco/js-api';\nimport { ShareDataRow } from '../../data/share-data-row.model';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-library-role-column',\n    template: `\n        <span class=\"adf-datatable-cell-value\" title=\"{{ (displayText$ | async) | translate }}\">\n            {{ (displayText$ | async) | translate }}\n        </span>\n    `,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-library-role-column adf-datatable-content-cell' }\n})\nexport class LibraryRoleColumnComponent implements OnInit, OnDestroy {\n    @Input()\n    context: any;\n\n    displayText$ = new BehaviorSubject<string>('');\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private api: AlfrescoApiService) {}\n\n    ngOnInit() {\n        this.updateValue();\n\n        this.api.nodeUpdated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(node => {\n                const row: ShareDataRow = this.context.row;\n                if (row) {\n                    const { entry } = row.node;\n\n                    if (entry === node) {\n                        row.node = { entry };\n                        this.updateValue();\n                    }\n                }\n            });\n    }\n\n    protected updateValue() {\n        const node: SiteEntry = this.context.row.node;\n        if (node && node.entry) {\n            const role: string = node.entry.role;\n            switch (role) {\n                case Site.RoleEnum.SiteManager:\n                    this.displayText$.next('LIBRARY.ROLE.MANAGER');\n                    break;\n                case Site.RoleEnum.SiteCollaborator:\n                    this.displayText$.next('LIBRARY.ROLE.COLLABORATOR');\n                    break;\n                case Site.RoleEnum.SiteContributor:\n                    this.displayText$.next('LIBRARY.ROLE.CONTRIBUTOR');\n                    break;\n                case Site.RoleEnum.SiteConsumer:\n                    this.displayText$.next('LIBRARY.ROLE.CONSUMER');\n                    break;\n                default:\n                    this.displayText$.next('LIBRARY.ROLE.NONE');\n                    break;\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnInit, OnDestroy } from '@angular/core';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { Site, SiteEntry } from '@alfresco/js-api';\nimport { ShareDataRow } from '../../data/share-data-row.model';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-library-status-column',\n    template: `\n        <span class=\"adf-datatable-cell-value\" title=\"{{ (displayText$ | async) | translate }}\">\n            {{ (displayText$ | async) | translate }}\n        </span>\n    `,\n    host: { class: 'adf-library-status-column adf-datatable-content-cell' }\n})\nexport class LibraryStatusColumnComponent implements OnInit, OnDestroy {\n    @Input()\n    context: any;\n\n    displayText$ = new BehaviorSubject<string>('');\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private api: AlfrescoApiService) {}\n\n    ngOnInit() {\n        this.updateValue();\n\n        this.api.nodeUpdated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(node => {\n                const row: ShareDataRow = this.context.row;\n                if (row) {\n                    const { entry } = row.node;\n\n                    if (entry === node) {\n                        row.node = { entry };\n                        this.updateValue();\n                    }\n                }\n            });\n    }\n\n    protected updateValue() {\n        const node: SiteEntry = this.context.row.node;\n        if (node && node.entry) {\n            const visibility: string = node.entry.visibility;\n\n            switch (visibility) {\n                case Site.VisibilityEnum.PUBLIC:\n                    this.displayText$.next('LIBRARY.VISIBILITY.PUBLIC');\n                    break;\n                case Site.VisibilityEnum.PRIVATE:\n                    this.displayText$.next('LIBRARY.VISIBILITY.PRIVATE');\n                    break;\n                case Site.VisibilityEnum.MODERATED:\n                    this.displayText$.next('LIBRARY.VISIBILITY.MODERATED');\n                    break;\n                default:\n                    this.displayText$.next('UNKNOWN');\n                    break;\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    Input,\n    OnInit,\n    ChangeDetectionStrategy,\n    ViewEncapsulation,\n    ElementRef,\n    OnDestroy\n} from '@angular/core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { ShareDataRow } from '../../data/share-data-row.model';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-name-column',\n    template: `\n        <span\n            role=\"link\"\n            [attr.aria-label]=\"'NAME_COLUMN_LINK.ACCESSIBILITY.ARIA_LABEL' | translate:{\n                name:  displayText$ | async\n            }\"\n            class=\"adf-datatable-cell-value\"\n            title=\"{{ node | adfNodeNameTooltip }}\"\n            (click)=\"onClick()\">\n\n            {{ displayText$ | async }}\n        </span>\n    `,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-datatable-content-cell adf-datatable-link adf-name-column' }\n})\nexport class NameColumnComponent implements OnInit, OnDestroy {\n    @Input()\n    context: any;\n\n    @Input()\n    key = 'name';\n\n    displayText$ = new BehaviorSubject<string>('');\n    node: NodeEntry;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private element: ElementRef, private alfrescoApiService: AlfrescoApiService) {}\n\n    ngOnInit() {\n        this.updateValue();\n\n        this.alfrescoApiService.nodeUpdated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(node => {\n                const row: ShareDataRow = this.context.row;\n                if (row) {\n                    const { entry } = row.node;\n\n                    if (entry === node) {\n                        row.node = { entry };\n                        this.updateValue();\n                    }\n                }\n            });\n    }\n\n    protected updateValue() {\n        this.node = this.context.row.node;\n\n        if (this.node && this.node.entry) {\n            const displayText = this.context.row.getValue(this.key);\n            this.displayText$.next(displayText || this.node.entry.id);\n        }\n    }\n\n    onClick() {\n        this.element.nativeElement.dispatchEvent(\n            new CustomEvent('name-click', {\n                bubbles: true,\n                detail: {\n                    node: this.node\n                }\n            })\n        );\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { InjectionToken } from '@angular/core';\nimport { BaseQueryBuilderService } from './services/base-query-builder.service';\n\nexport const SEARCH_QUERY_SERVICE_TOKEN = new InjectionToken<BaseQueryBuilderService>('QueryService');\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { Subject, Observable, from, ReplaySubject } from 'rxjs';\nimport { AlfrescoApiService, AppConfigService } from '@alfresco/adf-core';\nimport {\n    QueryBody,\n    RequestFacetFields,\n    RequestFacetField,\n    RequestSortDefinitionInner,\n    ResultSetPaging,\n    RequestHighlight,\n    RequestScope,\n    SearchApi\n} from '@alfresco/js-api';\nimport { SearchCategory } from '../models/search-category.interface';\nimport { FilterQuery } from '../models/filter-query.interface';\nimport { SearchRange } from '../models/search-range.interface';\nimport { SearchConfiguration } from '../models/search-configuration.interface';\nimport { FacetQuery } from '../models/facet-query.interface';\nimport { SearchSortingDefinition } from '../models/search-sorting-definition.interface';\nimport { FacetField } from '../models/facet-field.interface';\nimport { FacetFieldBucket } from '../models/facet-field-bucket.interface';\nimport { SearchForm } from '../models/search-form.interface';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport abstract class BaseQueryBuilderService {\n\n    _searchApi: SearchApi;\n    get searchApi(): SearchApi {\n        this._searchApi = this._searchApi ?? new SearchApi(this.alfrescoApiService.getInstance());\n        return this._searchApi;\n    }\n\n    /*  Stream that emits the search configuration whenever the user change the search forms */\n    configUpdated = new Subject<SearchConfiguration>();\n\n    /*  Stream that emits the query before search whenever user search  */\n    updated = new Subject<QueryBody>();\n\n    /*  Stream that emits the results whenever user search  */\n    executed = new Subject<ResultSetPaging>();\n\n    /*  Stream that emits the error whenever user search  */\n    error = new Subject();\n\n    /*  Stream that emits search forms  */\n    searchForms = new ReplaySubject<SearchForm[]>(1);\n\n    categories: SearchCategory[] = [];\n    queryFragments: { [id: string]: string } = {};\n    filterQueries: FilterQuery[] = [];\n    paging: { maxItems?: number; skipCount?: number } = null;\n    sorting: SearchSortingDefinition[] = [];\n    sortingOptions: SearchSortingDefinition[] = [];\n    private scope: RequestScope;\n    private selectedConfiguration: number;\n    private _userQuery = '';\n\n    protected userFacetBuckets: { [key: string]: FacetFieldBucket[] } = {};\n\n    get userQuery(): string {\n        return this._userQuery;\n    }\n\n    set userQuery(value: string) {\n        value = (value || '').trim();\n        this._userQuery = value ? `(${value})` : '';\n    }\n\n    config: SearchConfiguration = {\n        categories: []\n    };\n\n    // TODO: to be supported in future iterations\n    ranges: { [id: string]: SearchRange } = {};\n\n    constructor(protected appConfig: AppConfigService, protected alfrescoApiService: AlfrescoApiService) {\n        this.resetToDefaults();\n    }\n\n    public abstract loadConfiguration(): SearchConfiguration | SearchConfiguration[];\n\n    public abstract isFilterServiceActive(): boolean;\n\n    public resetToDefaults() {\n        const currentConfig = this.getDefaultConfiguration();\n        this.resetSearchOptions();\n        this.configUpdated.next(currentConfig);\n        this.searchForms.next(this.getSearchFormDetails());\n        this.setUpSearchConfiguration(currentConfig);\n    }\n\n    public getDefaultConfiguration(): SearchConfiguration | undefined {\n        const configurations = this.loadConfiguration();\n\n        if (this.selectedConfiguration !== undefined) {\n            return configurations[this.selectedConfiguration];\n        }\n\n        if (Array.isArray(configurations)) {\n            return configurations.find((configuration) => configuration.default);\n        }\n        return configurations;\n    }\n\n    public updateSelectedConfiguration(index: number): void {\n        const currentConfig = this.loadConfiguration();\n        if (Array.isArray(currentConfig) && currentConfig[index] !== undefined) {\n            this.selectedConfiguration = index;\n            this.configUpdated.next(currentConfig[index]);\n            this.searchForms.next(this.getSearchFormDetails());\n            this.resetSearchOptions();\n            this.setUpSearchConfiguration(currentConfig[index]);\n            this.update();\n        }\n    }\n\n    private resetSearchOptions(): void {\n        this.categories = [];\n        this.queryFragments = {};\n        this.filterQueries = [];\n        this.sorting = [];\n        this.sortingOptions = [];\n        this.userFacetBuckets = {};\n        this.scope = null;\n    }\n\n    public getSearchFormDetails(): SearchForm[] {\n        const configurations = this.loadConfiguration();\n        if (Array.isArray(configurations)) {\n            return configurations.map((configuration, index) => ({\n                index,\n                name: configuration.name || 'SEARCH.UNKNOWN_CONFIGURATION',\n                default: configuration.default || false,\n                selected: this.selectedConfiguration !== undefined ? index === this.selectedConfiguration : configuration.default\n            }));\n        } else if (!!configurations) {\n            return [{\n                index: 0,\n                name: configurations.name || 'SEARCH.UNKNOWN_CONFIGURATION',\n                default: true,\n                selected: true\n            }];\n        }\n        return [];\n    }\n\n    private setUpSearchConfiguration(currentConfiguration: SearchConfiguration) {\n        if (currentConfiguration) {\n            this.config = JSON.parse(JSON.stringify(currentConfiguration));\n            this.categories = (this.config.categories || []).filter(\n                category => category.enabled\n            );\n            this.filterQueries = this.config.filterQueries || [];\n            this.userFacetBuckets = {};\n            if (this.config.sorting) {\n                this.sorting = this.config.sorting.defaults || [];\n                this.sortingOptions = this.config.sorting.options || [];\n            }\n        }\n    }\n\n    /**\n     * Adds a facet bucket to a field.\n     * @param field The target field\n     * @param bucket Bucket to add\n     */\n    addUserFacetBucket(field: FacetField, bucket: FacetFieldBucket) {\n        if (field && field.field && bucket) {\n            const buckets = this.userFacetBuckets[field.field] || [];\n            const existing = buckets.find((facetBucket) => facetBucket.label === bucket.label);\n            if (!existing) {\n                buckets.push(bucket);\n            }\n            this.userFacetBuckets[field.field] = buckets;\n        }\n    }\n\n    /**\n     * Gets the buckets currently added to a field\n     * @param field The target fields\n     * @returns Bucket array\n     */\n    getUserFacetBuckets(field: string) {\n        return this.userFacetBuckets[field] || [];\n    }\n\n    /**\n     * Removes an existing bucket from a field.\n     * @param field The target field\n     * @param bucket Bucket to remove\n     */\n    removeUserFacetBucket(field: FacetField, bucket: FacetFieldBucket) {\n        if (field && field.field && bucket) {\n            const buckets = this.userFacetBuckets[field.field] || [];\n            this.userFacetBuckets[field.field] = buckets\n                .filter((facetBucket) => facetBucket.label !== bucket.label);\n        }\n    }\n\n    /**\n     * Adds a filter query to the current query.\n     * @param query Query string to add\n     */\n    addFilterQuery(query: string): void {\n        if (query) {\n            const existing = this.filterQueries.find((filterQuery) => filterQuery.query === query);\n            if (!existing) {\n                this.filterQueries.push({ query: query });\n            }\n        }\n    }\n\n    /**\n     * Removes an existing filter query.\n     * @param query The query to remove\n     */\n    removeFilterQuery(query: string): void {\n        if (query) {\n            this.filterQueries = this.filterQueries\n                .filter((filterQuery) => filterQuery.query !== query);\n        }\n    }\n\n    /**\n     * Gets a facet query by label.\n     * @param label Label of the query\n     * @returns Facet query data\n     */\n    getFacetQuery(label: string): FacetQuery {\n        if (label && this.hasFacetQueries) {\n            const result = this.config.facetQueries.queries.find((query) => query.label === label);\n            if (result) {\n                return { ...result };\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Gets a facet field by label.\n     * @param label Label of the facet field\n     * @returns Facet field data\n     */\n    getFacetField(label: string): FacetField {\n        if (label) {\n            const fields = this.config.facetFields.fields || [];\n            const result = fields.find((field) => field.label === label);\n            if (result) {\n                result.label = this.getSupportedLabel(result.label);\n                return { ...result };\n            }\n        }\n        return null;\n    }\n\n    setScope(scope: RequestScope) {\n        this.scope = scope;\n    }\n\n    getScope(): RequestScope {\n        return this.scope;\n    }\n\n    /**\n     * Builds the current query and triggers the `updated` event.\n     */\n    update(queryBody?: QueryBody): void {\n        const query = queryBody ? queryBody : this.buildQuery();\n        this.updated.next(query);\n    }\n\n    /**\n     * Builds and executes the current query.\n     * @returns Nothing\n     */\n    async execute(queryBody?: QueryBody) {\n        try {\n            const query = queryBody ? queryBody : this.buildQuery();\n            if (query) {\n                const resultSetPaging: ResultSetPaging = await this.searchApi.search(query);\n                this.executed.next(resultSetPaging);\n            }\n        } catch (error) {\n            this.error.next(error);\n\n            this.executed.next({\n                list: {\n                    pagination: {\n                        totalItems: 0\n                    },\n                    entries: []\n                }\n            });\n        }\n    }\n\n    search(queryBody: QueryBody): Observable<ResultSetPaging> {\n        const promise = this.searchApi.search(queryBody);\n\n        promise.then((resultSetPaging) => {\n            this.executed.next(resultSetPaging);\n        });\n\n        return from(promise);\n    }\n\n    /**\n     * Builds the current query.\n     * @returns The finished query\n     */\n    buildQuery(): QueryBody {\n        const query = this.getFinalQuery();\n\n        const include = this.config.include || [];\n        if (include.length === 0) {\n            include.push('path', 'allowableOperations');\n        }\n\n        if (query) {\n\n            const result: QueryBody = <QueryBody> {\n                query: {\n                    query: query,\n                    language: 'afts'\n                },\n                include: include,\n                paging: this.paging,\n                fields: this.config.fields,\n                filterQueries: this.filterQueries,\n                facetQueries: this.facetQueries,\n                facetIntervals: this.facetIntervals,\n                facetFields: this.facetFields,\n                sort: this.sort,\n                highlight: this.highlight\n            };\n\n            if (this.scope) {\n                result['scope'] = this.scope;\n            }\n\n            result['facetFormat'] = 'V2';\n            return result;\n        }\n\n        return null;\n    }\n\n    /**\n     * Gets the primary sorting definition.\n     * @returns The primary sorting definition\n     */\n    getPrimarySorting(): SearchSortingDefinition {\n        if (this.sorting && this.sorting.length > 0) {\n            return this.sorting[0];\n        }\n        return null;\n    }\n\n    /**\n     * Gets all pre-configured sorting options that users can choose from.\n     * @returns Pre-configured sorting options\n     */\n    getSortingOptions(): SearchSortingDefinition[] {\n        if (this.config && this.config.sorting) {\n            return this.config.sorting.options || [];\n        }\n        return [];\n    }\n\n    /**\n     * Gets the query group.\n     * @param query Target query\n     * @returns Query group\n     */\n    getQueryGroup(query) {\n        return query.group || this.config.facetQueries.label || 'Facet Queries';\n    }\n\n    /**\n     * Checks if FacetQueries has been defined\n     * @returns True if defined, false otherwise\n     */\n    get hasFacetQueries(): boolean {\n        if (this.config\n            && this.config.facetQueries\n            && this.config.facetQueries.queries\n            && this.config.facetQueries.queries.length > 0) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Checks if FacetIntervals has been defined\n     * @returns True if defined, false otherwise\n     */\n    get hasFacetIntervals(): boolean {\n        return this.config\n            && this.config.facetIntervals\n            && this.config.facetIntervals.intervals\n            && this.config.facetIntervals.intervals.length > 0;\n\n    }\n\n    get hasFacetHighlight(): boolean {\n        return !!(this.config && this.config.highlight);\n    }\n\n    protected get sort(): RequestSortDefinitionInner[] {\n        return this.sorting.map((def) => {\n            return new RequestSortDefinitionInner({\n                type: def.type,\n                field: def.field,\n                ascending: def.ascending\n            });\n        });\n    }\n\n    protected get facetQueries(): FacetQuery[] {\n        if (this.hasFacetQueries) {\n            return this.config.facetQueries.queries.map((query) => {\n                query.group = this.getQueryGroup(query);\n                return <FacetQuery> { ...query };\n            });\n        }\n\n        return null;\n    }\n\n    protected get facetIntervals(): any {\n        if (this.hasFacetIntervals) {\n            const configIntervals = this.config.facetIntervals;\n\n            return {\n                intervals: configIntervals.intervals.map((interval) => <any> {\n                    label: this.getSupportedLabel(interval.label),\n                    field: interval.field,\n                    sets: interval.sets.map((set) => <any> {\n                        label: this.getSupportedLabel(set.label),\n                        start: set.start,\n                        end: set.end,\n                        startInclusive: set.startInclusive,\n                        endInclusive: set.endInclusive\n                    })\n                })\n            };\n        }\n\n        return null;\n    }\n\n    protected get highlight(): RequestHighlight {\n        return this.hasFacetHighlight ? this.config.highlight : null;\n    }\n\n    protected getFinalQuery(): string {\n        let query = '';\n\n        this.categories.forEach((facet) => {\n            const customQuery = this.queryFragments[facet.id];\n            if (customQuery) {\n                if (query.length > 0) {\n                    query += ' AND ';\n                }\n                query += `(${customQuery})`;\n            }\n        });\n\n        let result = [this.userQuery, query]\n            .filter((entry) => entry)\n            .join(' AND ');\n\n        if (this.userFacetBuckets) {\n            Object.keys(this.userFacetBuckets).forEach((key) => {\n                const subQuery = (this.userFacetBuckets[key] || [])\n                    .filter((bucket) => bucket.filterQuery)\n                    .map((bucket) => bucket.filterQuery)\n                    .join(' OR ');\n                if (subQuery) {\n                    if (result.length > 0) {\n                        result += ' AND ';\n                    }\n                    result += `(${subQuery})`;\n                }\n            });\n        }\n\n        return result;\n    }\n\n    protected get facetFields(): RequestFacetFields {\n        const facetFields = this.config.facetFields && this.config.facetFields.fields;\n\n        if (facetFields && facetFields.length > 0) {\n            return {\n                facets: facetFields.map((facet) => <RequestFacetField> {\n                    field: facet.field,\n                    mincount: facet.mincount,\n                    label: this.getSupportedLabel(facet.label),\n                    limit: facet.limit,\n                    offset: facet.offset,\n                    prefix: facet.prefix\n                })\n            };\n        }\n\n        return null;\n    }\n\n    /**\n     * Encloses a label name with double quotes if it contains whitespace characters.\n     * @param configLabel Original label text\n     * @returns Label, possibly with quotes if it contains spaces\n     */\n    getSupportedLabel(configLabel: string): string {\n        const spaceInsideLabelIndex = configLabel.search(/\\s/g);\n        if (spaceInsideLabelIndex > -1) {\n            return `\"${configLabel}\"`;\n        }\n        return configLabel;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AlfrescoApiService, AppConfigService, NodesApiService, DataSorting } from '@alfresco/adf-core';\nimport { SearchConfiguration } from '../models/search-configuration.interface';\nimport { BaseQueryBuilderService } from './base-query-builder.service';\nimport { SearchCategory } from '../models/search-category.interface';\nimport { MinimalNode, QueryBody } from '@alfresco/js-api';\nimport { filter } from 'rxjs/operators';\nimport { Observable } from 'rxjs';\nimport { SearchSortingDefinition } from '../models/search-sorting-definition.interface';\nimport { FilterSearch } from '../models/filter-search.interface';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SearchHeaderQueryBuilderService extends BaseQueryBuilderService {\n\n    private customSources = ['-trashcan-', '-sharedlinks-', '-sites-', '-mysites-', '-favorites-', '-recent-', '-my-'];\n\n    activeFilters: FilterSearch[] = [];\n\n    constructor(appConfig: AppConfigService,\n                alfrescoApiService: AlfrescoApiService,\n                private nodeApiService: NodesApiService) {\n        super(appConfig, alfrescoApiService);\n\n        this.updated.pipe(\n            filter((query: QueryBody) => !!query)).subscribe(() => {\n            this.execute();\n        });\n    }\n\n    public isFilterServiceActive(): boolean {\n        return true;\n    }\n\n    loadConfiguration(): SearchConfiguration {\n        return this.appConfig.get<SearchConfiguration>('search-headers');\n    }\n\n    setupCurrentPagination(maxItems: number, skipCount: number) {\n        if (!this.paging ||\n            (this.paging &&\n                this.paging.maxItems !== maxItems || this.paging.skipCount !== skipCount)) {\n            this.paging = { maxItems, skipCount };\n            this.execute();\n        }\n    }\n\n    setActiveFilter(columnActivated: string, filterValue: string) {\n        const selectedFilter = this.activeFilters.find((activeFilter) => activeFilter.key === columnActivated);\n        if (!selectedFilter) {\n            this.activeFilters.push(<FilterSearch> {\n                key: columnActivated,\n                value: filterValue\n            });\n        } else {\n            selectedFilter.value = filterValue;\n        }\n    }\n\n    resetActiveFilters() {\n        this.activeFilters = [];\n    }\n\n    getActiveFilters(): FilterSearch[] {\n        return this.activeFilters;\n    }\n\n    isNoFilterActive(): boolean {\n        return this.activeFilters.length === 0;\n    }\n\n    removeActiveFilter(columnRemoved: string) {\n        const filterIndex = this.activeFilters.map((activeFilter) => activeFilter.key).indexOf(columnRemoved);\n        if (filterIndex >= 0) {\n            this.activeFilters.splice(filterIndex, 1);\n        }\n    }\n\n    setSorting(dataSorting: DataSorting[]) {\n        this.sorting = [];\n        dataSorting.forEach((columnSorting: DataSorting) => {\n            const fieldValue = this.getSortingFieldFromColumnName(columnSorting.key);\n            if (fieldValue) {\n                const optionAscending = columnSorting.direction.toLocaleLowerCase() === 'asc';\n                const type = fieldValue === 'score' ? 'SCORE' : 'FIELD';\n                const currentSort: SearchSortingDefinition = {\n                    key: columnSorting.key,\n                    label: 'current',\n                    type: type,\n                    field: fieldValue,\n                    ascending: optionAscending\n                };\n                this.sorting.push(currentSort);\n            }\n        });\n\n        this.execute();\n    }\n\n    private getSortingFieldFromColumnName(columnName: string) {\n        if (this.sortingOptions.length > 0) {\n            const sortOption: SearchSortingDefinition = this.sortingOptions.find((option: SearchSortingDefinition) => option.key === columnName);\n            return sortOption ? sortOption.field : '';\n        }\n        return '';\n    }\n\n    getCategoryForColumn(columnKey: string): SearchCategory {\n        let foundCategory = null;\n        if (this.categories !== null) {\n            foundCategory = this.categories.find(\n                category => category.columnKey === columnKey\n            );\n        }\n        return foundCategory;\n    }\n\n    setCurrentRootFolderId(currentFolderId: string) {\n        const alreadyAddedFilter = this.filterQueries.find(filterQueries =>\n            filterQueries.query.includes(currentFolderId)\n        );\n\n        if (alreadyAddedFilter !== undefined) {\n            this.filterQueries = [];\n        }\n\n        this.filterQueries = [{\n            query: `PARENT:\"workspace://SpacesStore/${currentFolderId}\"`\n        }];\n\n        this.execute();\n    }\n\n    isCustomSourceNode(currentNodeId: string): boolean {\n        return this.customSources.includes(currentNodeId);\n    }\n\n    getNodeIdForCustomSource(customSourceId: string): Observable<MinimalNode> {\n        return this.nodeApiService.getNode(customSourceId);\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, OnInit, OnChanges, SimpleChanges, Input, Output, EventEmitter } from '@angular/core';\nimport { PaginationModel, DataSorting } from '@alfresco/adf-core';\nimport { DocumentListComponent } from '../document-list.component';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../../search/search-query-service.token';\nimport { SearchHeaderQueryBuilderService } from '../../../search/services/search-header-query-builder.service';\nimport { FilterSearch } from './../../../search/models/filter-search.interface';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { NodePaging, MinimalNode } from '@alfresco/js-api';\n\n@Component({\n    selector: 'adf-filter-header',\n    templateUrl: './filter-header.component.html',\n    providers: [{ provide: SEARCH_QUERY_SERVICE_TOKEN, useClass: SearchHeaderQueryBuilderService}]\n})\nexport class FilterHeaderComponent implements OnInit, OnChanges {\n\n    /** (optional) Initial filter value to sort . */\n    @Input()\n    value: any = {};\n\n    /** The id of the current folder of the document list. */\n    @Input()\n    currentFolderId: string;\n\n    /** Emitted when a filter value is selected */\n    @Output()\n    filterSelection: EventEmitter<FilterSearch[]> = new EventEmitter();\n\n    isFilterServiceActive: boolean;\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(@Inject(DocumentListComponent) private documentList: DocumentListComponent,\n                @Inject(SEARCH_QUERY_SERVICE_TOKEN) private searchFilterQueryBuilder: SearchHeaderQueryBuilderService) {\n        this.isFilterServiceActive = this.searchFilterQueryBuilder.isFilterServiceActive();\n    }\n\n    ngOnInit() {\n        this.searchFilterQueryBuilder.executed\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((newNodePaging: NodePaging) => {\n                this.documentList.node = newNodePaging;\n                this.documentList.reload();\n            });\n\n        this.initDataPagination();\n        this.initDataSorting();\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (changes['currentFolderId'] && changes['currentFolderId'].currentValue) {\n            this.resetFilterHeader();\n            this.configureSearchParent(changes['currentFolderId'].currentValue);\n        }\n    }\n\n    onFilterSelectionChange() {\n        this.filterSelection.emit(this.searchFilterQueryBuilder.getActiveFilters());\n        if (this.searchFilterQueryBuilder.isNoFilterActive()) {\n            this.documentList.node = null;\n            this.documentList.reload();\n        }\n    }\n\n    resetFilterHeader() {\n        this.searchFilterQueryBuilder.resetActiveFilters();\n    }\n\n    initDataPagination() {\n        this.documentList.pagination\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((newPagination: PaginationModel) => {\n                this.searchFilterQueryBuilder.setupCurrentPagination(newPagination.maxItems, newPagination.skipCount);\n            });\n    }\n\n    initDataSorting() {\n        this.documentList.sortingSubject\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((sorting: DataSorting[]) => {\n                this.searchFilterQueryBuilder.setSorting(sorting);\n            });\n    }\n\n    private configureSearchParent(currentFolderId: string) {\n        if (this.searchFilterQueryBuilder.isCustomSourceNode(currentFolderId)) {\n            this.searchFilterQueryBuilder.getNodeIdForCustomSource(currentFolderId).subscribe((node: MinimalNode) => {\n                this.initSearchHeader(node.id);\n            });\n        } else {\n            this.initSearchHeader(currentFolderId);\n        }\n    }\n\n    private initSearchHeader(currentFolderId: string) {\n        this.searchFilterQueryBuilder.setCurrentRootFolderId(currentFolderId);\n        if (this.value) {\n            Object.keys(this.value).forEach((columnKey) => {\n                this.searchFilterQueryBuilder.setActiveFilter(columnKey, this.value[columnKey]);\n            });\n        }\n\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Component,\n  ChangeDetectionStrategy,\n  ViewEncapsulation,\n  OnInit,\n  Input\n} from '@angular/core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { ShareDataRow } from '../../data/share-data-row.model';\n\n@Component({\n  selector: 'adf-trashcan-name-column',\n  template: `\n    <ng-container *ngIf=\"!isLibrary\">\n      <span class=\"adf-datatable-cell-value\" title=\"{{ node | adfNodeNameTooltip }}\">{{ displayText }}</span>\n    </ng-container>\n    <ng-container *ngIf=\"isLibrary\">\n      <span class=\"adf-datatable-cell-value\" title=\"{{ displayTooltip }}\">{{ displayText }}</span>\n    </ng-container>\n  `,\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  encapsulation: ViewEncapsulation.None,\n  host: { class: 'adf-datatable-content-cell adf-trashcan-name-column' }\n})\nexport class TrashcanNameColumnComponent implements OnInit {\n  @Input()\n  context: any;\n\n  isLibrary = false;\n  displayText: string;\n  displayTooltip: string;\n  node: NodeEntry;\n\n  ngOnInit() {\n    this.node = this.context.row.node;\n    const rows: Array<ShareDataRow> = this.context.data.rows || [];\n\n    if (this.node && this.node.entry) {\n      this.isLibrary = this.node.entry.nodeType === 'st:site';\n\n      if (this.isLibrary) {\n        const { properties } = this.node.entry;\n\n        this.displayText = this.makeLibraryTitle(this.node.entry, rows);\n        this.displayTooltip =\n          properties['cm:description'] || properties['cm:title'];\n      } else {\n        this.displayText = this.node.entry.name || this.node.entry.id;\n      }\n    }\n  }\n\n  makeLibraryTitle(library: any, rows: Array<ShareDataRow>): string {\n    const entries = rows.map((r: ShareDataRow) => r.node.entry);\n    const { id } = library;\n    const title = library.properties['cm:title'];\n\n    let isDuplicate = false;\n\n    if (entries) {\n      isDuplicate = entries.some((entry: any) => {\n        return entry.id !== id && entry.properties['cm:title'] === title;\n      });\n    }\n\n    return isDuplicate\n      ? `${library.properties['cm:title']} (${library.name})`\n      : `${library.properties['cm:title']}`;\n  }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// note: contains only limited subset of available fields\n\nimport { NodeEntry, Node } from '@alfresco/js-api';\n\nexport class NodePaging {\n    list: NodePagingList;\n}\n\nexport class NodePagingList {\n    pagination: Pagination;\n    entries: NodeMinimalEntry[];\n}\n\nexport class NodeMinimalEntry implements NodeEntry {\n    entry: NodeMinimal;\n}\n\nexport class Pagination {\n    count: number;\n    hasMoreItems: boolean;\n    totalItems: number;\n    skipCount: number;\n    maxItems: number;\n}\n\nexport class NodeMinimal implements Node {\n    id: string;\n    parentId: string;\n    name: string;\n    nodeType: string;\n    isFolder: boolean;\n    isFile: boolean;\n    modifiedAt: Date;\n    modifiedByUser: UserInfo;\n    createdAt: Date;\n    createdByUser: UserInfo;\n    content: ContentInfo;\n    path: PathInfoEntity;\n    properties: NodeProperties = {};\n    aspectNames: string[];\n}\n\nexport class UserInfo {\n    displayName: string;\n    id: string;\n}\n\nexport class ContentInfo {\n    mimeType: string;\n    mimeTypeName: string;\n    sizeInBytes: number;\n    encoding: string;\n}\n\nexport class PathInfoEntity {\n    elements: PathElementEntity[];\n    isComplete: boolean;\n    name: string;\n}\n\nexport class PathElementEntity {\n    id: string;\n    name: string;\n}\n\nexport interface NodeProperties {\n    [key: string]: any;\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AllowableOperationsEnum } from '@alfresco/adf-core';\n\nexport class PermissionStyleModel {\n    css: string;\n    permission: AllowableOperationsEnum;\n    isFolder: boolean = true;\n    isFile: boolean = true;\n\n    constructor(css: string, permission: AllowableOperationsEnum, isFile: boolean = true, isFolder: boolean = true) {\n        this.css = css;\n        this.permission = permission;\n        this.isFile = isFile;\n        this.isFolder = isFolder;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FileModel, FileUploadStatus, UploadService, UserPreferencesService, FileUploadDeleteEvent, FileUploadCompleteEvent } from '@alfresco/adf-core';\nimport { ChangeDetectorRef, Component, Input, Output, EventEmitter, OnDestroy, OnInit, ViewChild, HostBinding, ElementRef, ViewEncapsulation } from '@angular/core';\nimport { Subscription, merge, Subject } from 'rxjs';\nimport { FileUploadingListComponent } from './file-uploading-list.component';\nimport { Direction } from '@angular/cdk/bidi';\nimport { takeUntil, delay } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-file-uploading-dialog',\n    templateUrl: './file-uploading-dialog.component.html',\n    styleUrls: ['./file-uploading-dialog.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class FileUploadingDialogComponent implements OnInit, OnDestroy {\n    /** Dialog direction. Can be 'ltr' or 'rtl. */\n    private direction: Direction = 'ltr';\n    private onDestroy$ = new Subject<boolean>();\n\n    @ViewChild('uploadList')\n    uploadList: FileUploadingListComponent;\n\n    /** Dialog position. Can be 'left' or 'right'. */\n    @Input()\n    position: string = 'right';\n\n    /** Makes the dialog always visible even when there are no uploads. */\n    @Input()\n    alwaysVisible: boolean = false;\n\n    /** Emitted when a file in the list has an error. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter();\n\n    @HostBinding('attr.adfUploadDialogRight')\n    public get isPositionRight(): boolean {\n        return (this.direction === 'ltr' && this.position === 'right')\n            || (this.direction === 'rtl' && this.position === 'left')\n            || null;\n    }\n    @HostBinding('attr.adfUploadDialogLeft')\n    public get isPositionLeft(): boolean {\n        return (this.direction === 'ltr' && this.position === 'left')\n            || (this.direction === 'rtl' && this.position === 'right')\n            || null;\n    }\n\n    filesUploadingList: FileModel[] = [];\n    isDialogActive: boolean = false;\n    totalCompleted: number = 0;\n    totalErrors: number = 0;\n    isDialogMinimized: boolean = false;\n    isConfirmation: boolean = false;\n\n    private listSubscription: Subscription;\n    private counterSubscription: Subscription;\n    private fileUploadSubscription: Subscription;\n    private errorSubscription: Subscription;\n    private dialogActive = new Subject<boolean>();\n\n    constructor(\n        private uploadService: UploadService,\n        private changeDetector: ChangeDetectorRef,\n        private userPreferencesService: UserPreferencesService,\n        private elementRef: ElementRef) {\n    }\n\n    ngOnInit() {\n        this.dialogActive\n            .pipe(\n                delay(100),\n                takeUntil(this.onDestroy$)\n            )\n            .subscribe(() => {\n                const element: any = this.elementRef.nativeElement.querySelector('#upload-dialog');\n                if (element) {\n                    element.focus();\n                }\n            });\n\n        this.listSubscription = this.uploadService.queueChanged\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(fileList => {\n                this.filesUploadingList = fileList;\n\n                if (this.filesUploadingList.length && !this.isDialogActive) {\n                    this.isDialogActive = true;\n                    this.dialogActive.next();\n                } else {\n                    this.dialogActive.next();\n                }\n            });\n\n        this.counterSubscription = merge(\n            this.uploadService.fileUploadComplete,\n            this.uploadService.fileUploadDeleted\n        )\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((event: FileUploadCompleteEvent | FileUploadDeleteEvent) => {\n                this.totalCompleted = event.totalComplete;\n                this.changeDetector.detectChanges();\n            });\n\n        this.errorSubscription = this.uploadService.fileUploadError\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(event => {\n                this.totalErrors = event.totalError;\n                this.changeDetector.detectChanges();\n            });\n\n        this.fileUploadSubscription = this.uploadService.fileUpload\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(() => {\n                this.changeDetector.detectChanges();\n            });\n\n        this.uploadService.fileDeleted\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(objId => {\n                if (this.filesUploadingList) {\n                    const uploadedFile = this.filesUploadingList.find((file) => {\n                        return file.data ? file.data.entry.id === objId : false;\n                    });\n                    if (uploadedFile) {\n                        uploadedFile.status = FileUploadStatus.Cancelled;\n                        this.changeDetector.detectChanges();\n                    }\n                }\n            });\n\n        this.userPreferencesService.select('textOrientation')\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((textOrientation: Direction) => {\n                this.direction = textOrientation;\n            });\n    }\n\n    /**\n     * Toggle confirmation message.\n     */\n    toggleConfirmation() {\n        this.isConfirmation = !this.isConfirmation;\n\n        if (!this.isConfirmation) {\n            this.dialogActive.next();\n        }\n\n        if (this.isDialogMinimized) {\n            this.isDialogMinimized = false;\n        }\n    }\n\n    /**\n     * Cancel uploads and hide confirmation\n     */\n    cancelAllUploads() {\n        this.toggleConfirmation();\n        this.dialogActive.next();\n        this.uploadList.cancelAllFiles();\n    }\n\n    /**\n     * Toggle dialog minimized state.\n     */\n    toggleMinimized(): void {\n        this.isDialogMinimized = !this.isDialogMinimized;\n        this.changeDetector.detectChanges();\n    }\n\n    /**\n     * Dismiss dialog\n     */\n    close(): void {\n        this.isConfirmation = false;\n        this.totalCompleted = 0;\n        this.totalErrors = 0;\n        this.filesUploadingList = [];\n        this.isDialogActive = false;\n        this.isDialogMinimized = false;\n        this.uploadService.clearQueue();\n        this.changeDetector.detectChanges();\n    }\n\n    ngOnDestroy() {\n        this.uploadService.clearQueue();\n        this.listSubscription.unsubscribe();\n        this.counterSubscription.unsubscribe();\n        this.fileUploadSubscription.unsubscribe();\n        this.errorSubscription.unsubscribe();\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    canShowDialog(): boolean {\n        return this.isDialogActive || this.alwaysVisible;\n    }\n\n    canShowCancelAll(): boolean {\n        return this.filesUploadingList?.length && this.hasUploadInProgress();\n    }\n\n    canCloseDialog(): boolean {\n        return !this.hasUploadInProgress() && !this.alwaysVisible;\n    }\n\n    hasUploadInProgress(): boolean {\n        return (!this.uploadList?.isUploadCompleted() && !this.uploadList?.isUploadCancelled());\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FileModel, FileUploadStatus } from '@alfresco/adf-core';\nimport { Component, EventEmitter, Input, Output, ViewEncapsulation } from '@angular/core';\n\n@Component({\n    selector: 'adf-file-uploading-list-row',\n    templateUrl: './file-uploading-list-row.component.html',\n    styleUrls: ['./file-uploading-list-row.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class FileUploadingListRowComponent {\n    @Input()\n    file: FileModel;\n\n    @Output()\n    cancel: EventEmitter<FileModel> = new EventEmitter<FileModel>();\n\n    @Output()\n    remove: EventEmitter<FileModel> = new EventEmitter<FileModel>();\n\n    FileUploadStatus = FileUploadStatus;\n\n    onCancel(file: FileModel): void {\n        this.cancel.emit(file);\n    }\n\n    onRemove(file: FileModel): void {\n        this.remove.emit(file);\n    }\n\n    showCancelledStatus(): boolean {\n        return this.file.status === FileUploadStatus.Cancelled ||\n            this.file.status === FileUploadStatus.Aborted ||\n            this.file.status === FileUploadStatus.Deleted;\n    }\n\n    get versionNumber(): string {\n        return this.file.data.entry.properties['cm:versionLabel'];\n    }\n\n    get mimeType(): string {\n        if (this.file && this.file.file && this.file.file.type) {\n            return this.file.file.type;\n        }\n\n        return 'default';\n    }\n\n    isUploadVersion(): boolean {\n        return (\n            !!this.file.data &&\n            this.file.options &&\n            this.file.options.newVersion &&\n            this.file.data.entry.properties &&\n            this.file.data.entry.properties['cm:versionLabel']\n        );\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    FileModel,\n    FileUploadStatus,\n    NodesApiService,\n    TranslationService,\n    UploadService\n} from '@alfresco/adf-core';\nimport {\n    Component,\n    ContentChild,\n    Input,\n    Output,\n    TemplateRef,\n    EventEmitter\n} from '@angular/core';\nimport { Observable, forkJoin, of } from 'rxjs';\nimport { map, catchError } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-file-uploading-list',\n    templateUrl: './file-uploading-list.component.html',\n    styleUrls: ['./file-uploading-list.component.scss']\n})\nexport class FileUploadingListComponent {\n    FileUploadStatus = FileUploadStatus;\n\n    @ContentChild(TemplateRef)\n    template: any;\n\n    @Input()\n    files: FileModel[] = [];\n\n    /** Emitted when a file in the list has an error. */\n    @Output()\n    error = new EventEmitter<any>();\n\n    constructor(\n        private uploadService: UploadService,\n        private nodesApi: NodesApiService,\n        private translateService: TranslationService) {\n    }\n\n    /**\n     * Cancel file upload\n     *\n     * @param file File model to cancel upload for.\n     *\n     * @memberOf FileUploadingListComponent\n     */\n    cancelFile(file: FileModel): void {\n        if (file.status === FileUploadStatus.Pending) {\n            file.status = FileUploadStatus.Cancelled;\n        } else {\n            this.uploadService.cancelUpload(file);\n        }\n    }\n\n    /**\n     * Remove uploaded file\n     *\n     * @param file File model to remove upload for.\n     *\n     * @memberOf FileUploadingListComponent\n     */\n    removeFile(file: FileModel): void {\n        this.deleteNode(file).subscribe(() => {\n            if (file.status === FileUploadStatus.Error) {\n                this.notifyError(file);\n            }\n\n            this.cancelNodeVersionInstances(file);\n            this.uploadService.cancelUpload(file);\n        });\n    }\n\n    /**\n     * Calls the appropriate methods for each file, depending on state\n     */\n    cancelAllFiles(): void {\n        const deletedFiles: Observable<FileModel>[] = [];\n\n        this.files.forEach((file) => {\n            if (this.isUploadingFile(file)) {\n                this.uploadService.cancelUpload(file);\n            } else if (file.status === FileUploadStatus.Complete) {\n                deletedFiles.push(this.deleteNode(file));\n            }\n        });\n\n        forkJoin(...deletedFiles).subscribe((files: FileModel[]) => {\n            const errors = files.filter(\n                (file) => file.status === FileUploadStatus.Error\n            );\n\n            if (errors.length) {\n                this.notifyError(...errors);\n            }\n\n            this.uploadService.cancelUpload(...files);\n        });\n    }\n\n    /**\n     * Checks if all the files are uploaded false if there is at least one file in Progress | Starting | Pending\n     */\n    isUploadCompleted(): boolean {\n        return (\n            !this.isUploadCancelled() &&\n            Boolean(this.files.length) &&\n            !this.files.some(\n                ({ status }) =>\n                    status === FileUploadStatus.Starting ||\n                    status === FileUploadStatus.Progress ||\n                    status === FileUploadStatus.Pending\n            )\n        );\n    }\n\n    /**\n     * Check if all the files are Cancelled | Aborted | Error. false if there is at least one file in uploading states\n     */\n    isUploadCancelled(): boolean {\n        return (\n            !!this.files.length &&\n            this.files.every(\n                ({ status }) =>\n                    status === FileUploadStatus.Aborted ||\n                    status === FileUploadStatus.Cancelled ||\n                    status === FileUploadStatus.Deleted\n            )\n        );\n    }\n\n    private deleteNode(file: FileModel): Observable<FileModel> {\n        const { id } = file.data.entry;\n\n        return this.nodesApi.deleteNode(id, { permanent: true }).pipe(\n            map(() => {\n                file.status = FileUploadStatus.Deleted;\n                return file;\n            }),\n            catchError(() => {\n                file.status = FileUploadStatus.Error;\n                return of(file);\n            })\n        );\n    }\n\n    private cancelNodeVersionInstances(file: FileModel) {\n        this.files\n            .filter(\n                (item) =>\n                    item.options.newVersion &&\n                    item.data.entry.id === file.data.entry.id\n\n            )\n            .map((item) => {\n                item.status = FileUploadStatus.Deleted;\n            });\n    }\n\n    private notifyError(...files: FileModel[]) {\n        let messageError: string = null;\n\n        if (files.length === 1) {\n            messageError = this.translateService.instant(\n                'FILE_UPLOAD.MESSAGES.REMOVE_FILE_ERROR',\n                { fileName: files[0].name }\n            );\n        } else {\n            messageError = this.translateService.instant(\n                'FILE_UPLOAD.MESSAGES.REMOVE_FILES_ERROR',\n                { total: files.length }\n            );\n        }\n\n        this.error.emit(messageError);\n    }\n\n    private isUploadingFile(file: FileModel): boolean {\n        return file.status === FileUploadStatus.Pending ||\n            file.status === FileUploadStatus.Starting ||\n            file.status === FileUploadStatus.Progress;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FileModel, UploadService } from '@alfresco/adf-core';\nimport { EventEmitter } from '@angular/core';\n\nexport class UploadFilesEvent {\n    private isDefaultPrevented: boolean = false;\n\n    get defaultPrevented() {\n        return this.isDefaultPrevented;\n    }\n\n    preventDefault() {\n        this.isDefaultPrevented = true;\n    }\n\n    constructor(\n        public files: Array<FileModel>,\n        private uploadService: UploadService,\n        private successEmitter: EventEmitter<any>,\n        private errorEmitter: EventEmitter<any>\n    ) {}\n\n    pauseUpload() {\n        this.preventDefault();\n    }\n\n    resumeUpload() {\n        if (this.files && this.files.length > 0) {\n            this.uploadService.addToQueue(...this.files);\n            this.uploadService.uploadFilesInTheQueue(this.successEmitter, this.errorEmitter);\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FileModel, FileInfo, UploadService, TranslationService, FileUploadErrorEvent } from '@alfresco/adf-core';\nimport { EventEmitter, Input, Output, OnInit, OnDestroy, NgZone, Directive } from '@angular/core';\nimport { Subject } from 'rxjs';\nimport { UploadFilesEvent } from '../upload-files.event';\nimport { takeUntil } from 'rxjs/operators';\n\n@Directive()\n// tslint:disable-next-line: directive-class-suffix\nexport abstract class UploadBase implements OnInit, OnDestroy {\n\n    /** Sets a limit on the maximum size (in bytes) of a file to be uploaded.\n     * Has no effect if undefined.\n     */\n    @Input()\n    maxFilesSize: number;\n\n    /** The ID of the root. Use the nodeId for\n     * Content Services or the taskId/processId for Process Services.\n     */\n    @Input()\n    rootFolderId: string = '-root-';\n\n    /** Toggles component disabled state (if there is no node permission checking). */\n    @Input()\n    disabled: boolean = false;\n\n    /** Filter for accepted file types. */\n    @Input()\n    acceptedFilesType: string = '*';\n\n    /** Toggles versioning. */\n    @Input()\n    versioning: boolean = false;\n\n    /** majorVersion boolean field to true to indicate a major version should be created. */\n    @Input()\n    majorVersion: boolean = false;\n\n    /** When you overwrite existing content, you can use the comment field to add a version comment that appears in the version history */\n    @Input()\n    comment: string;\n\n    /** Custom node type for uploaded file */\n    @Input()\n    nodeType: string = 'cm:content';\n\n    /** Emitted when the file is uploaded successfully. */\n    @Output()\n    success = new EventEmitter();\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error = new EventEmitter<FileUploadErrorEvent>();\n\n    /** Emitted when the upload begins. */\n    @Output()\n    beginUpload = new EventEmitter<UploadFilesEvent>();\n\n    /** Emitted when dropping a file over another file to update the version. */\n    @Output()\n    updateFileVersion = new EventEmitter<CustomEvent>();\n\n    protected onDestroy$ = new Subject<boolean>();\n\n    constructor(protected uploadService: UploadService,\n                protected translationService: TranslationService,\n                protected ngZone: NgZone) {\n    }\n\n    ngOnInit() {\n        this.uploadService.fileUploadError\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(error => this.error.emit(error));\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    /**\n     * Upload a list of file in the specified path\n     * @param files\n     */\n    uploadFiles(files: File[]): void {\n        const filteredFiles: FileModel[] = files\n            .map<FileModel>((file: File) => {\n                return this.createFileModel(file, this.rootFolderId, ((<any> file).webkitRelativePath || '').replace(/\\/[^\\/]*$/, ''));\n            });\n\n        this.uploadQueue(filteredFiles);\n    }\n\n    uploadFilesInfo(files: FileInfo[]): void {\n        const filteredFiles: FileModel[] = files\n            .map<FileModel>((fileInfo: FileInfo) => {\n                return this.createFileModel(fileInfo.file, this.rootFolderId, fileInfo.relativeFolder);\n            });\n\n        this.uploadQueue(filteredFiles);\n    }\n\n    private uploadQueue(files: FileModel[]) {\n        const filteredFiles = files\n            .filter(this.isFileAcceptable.bind(this))\n            .filter(this.isFileSizeAcceptable.bind(this));\n\n        this.ngZone.run(() => {\n            const event = new UploadFilesEvent(\n                [...filteredFiles],\n                this.uploadService,\n                this.success,\n                this.error\n            );\n            this.beginUpload.emit(event);\n\n            if (!event.defaultPrevented) {\n                if (filteredFiles.length > 0) {\n                    this.uploadService.addToQueue(...filteredFiles);\n                    this.uploadService.uploadFilesInTheQueue(this.success, this.error);\n                }\n            }\n        });\n    }\n\n    /**\n     * Checks if the given file is allowed by the extension filters\n     *\n     * @param file FileModel\n     */\n    protected isFileAcceptable(file: FileModel): boolean {\n        if (this.acceptedFilesType === '*') {\n            return true;\n        }\n\n        const allowedExtensions = this.acceptedFilesType\n            .split(',')\n            .map((ext) => ext.trim().replace(/^\\./, ''));\n\n        return allowedExtensions.indexOf(file.extension) !== -1;\n    }\n\n    /**\n     * Creates FileModel from File\n     *\n     * @param file\n     * @param parentId\n     * @param path\n     * @param id\n     */\n    protected createFileModel(file: File, parentId: string, path: string, id?: string): FileModel {\n        return new FileModel(file, {\n            comment: this.comment,\n            majorVersion: this.majorVersion,\n            newVersion: this.versioning,\n            parentId: parentId,\n            path: path,\n            nodeType: this.nodeType\n        }, id);\n    }\n\n    protected isFileSizeAllowed(file: FileModel) {\n        let isFileSizeAllowed = true;\n        if (this.isMaxFileSizeDefined()) {\n            isFileSizeAllowed = this.isFileSizeCorrect(file);\n        }\n\n        return isFileSizeAllowed;\n    }\n\n    protected isMaxFileSizeDefined() {\n        return this.maxFilesSize !== undefined && this.maxFilesSize !== null;\n    }\n\n    protected isFileSizeCorrect(file: FileModel) {\n        return this.maxFilesSize >= 0 && file.size <= this.maxFilesSize;\n    }\n\n    /**\n     * Checks if the given file is an acceptable size\n     *\n     * @param file FileModel\n     */\n    private isFileSizeAcceptable(file: FileModel): boolean {\n        let acceptableSize = true;\n\n        if (!this.isFileSizeAllowed(file)) {\n            acceptableSize = false;\n\n            const message = this.translationService.instant(\n                'FILE_UPLOAD.MESSAGES.EXCEED_MAX_FILE_SIZE',\n                { fileName: file.name }\n            );\n\n            this.error.emit(message);\n        }\n\n        return acceptableSize;\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    ContentService, EXTENDIBLE_COMPONENT, FileUtils,\n    LogService, NodeAllowableOperationSubject, TranslationService, UploadService, AllowableOperationsEnum\n} from '@alfresco/adf-core';\nimport {\n    Component, EventEmitter, forwardRef, Input,\n    OnChanges, OnInit, Output, SimpleChanges, ViewEncapsulation, NgZone\n} from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { Subject } from 'rxjs';\nimport { PermissionModel } from '../../document-list/models/permissions.model';\nimport { UploadBase } from './base-upload/upload-base';\n\n@Component({\n    selector: 'adf-upload-button',\n    templateUrl: './upload-button.component.html',\n    styleUrls: ['./upload-button.component.scss'],\n    viewProviders: [\n        { provide: EXTENDIBLE_COMPONENT, useExisting: forwardRef(() => UploadButtonComponent) }\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class UploadButtonComponent extends UploadBase implements OnInit, OnChanges, NodeAllowableOperationSubject {\n\n    /** Allows/disallows upload folders (only for Chrome). */\n    @Input()\n    uploadFolders: boolean = false;\n\n    /** Allows/disallows multiple files */\n    @Input()\n    multipleFiles: boolean = false;\n\n    /** Defines the text of the upload button. */\n    @Input()\n    staticTitle: string;\n\n    /** Custom tooltip text. */\n    @Input()\n    tooltip: string = null;\n\n    /** Custom added file. The upload button type will be 'button' instead of 'file' */\n    @Input()\n    file: File;\n\n    /** Emitted when create permission is missing. */\n    @Output()\n    permissionEvent: EventEmitter<PermissionModel> = new EventEmitter<PermissionModel>();\n\n    private hasAllowableOperations: boolean = false;\n\n    protected permissionValue: Subject<boolean> = new Subject<boolean>();\n\n    constructor(protected uploadService: UploadService,\n                private contentService: ContentService,\n                protected translationService: TranslationService,\n                protected logService: LogService,\n                protected ngZone: NgZone) {\n        super(uploadService, translationService, ngZone);\n    }\n\n    ngOnInit() {\n        this.permissionValue.subscribe((permission: boolean) => {\n            this.hasAllowableOperations = permission;\n        });\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        const rootFolderId = changes['rootFolderId'];\n        if (rootFolderId && rootFolderId.currentValue) {\n            this.checkPermission();\n        }\n    }\n\n    isButtonDisabled(): boolean {\n        return this.disabled ? true : undefined;\n    }\n\n    onFilesAdded($event: any): void {\n        const files: File[] = FileUtils.toFileArray($event.currentTarget.files);\n\n        if (this.hasAllowableOperations) {\n            this.uploadFiles(files);\n        } else {\n            this.permissionEvent.emit(new PermissionModel({ type: 'content', action: 'upload', permission: 'create' }));\n        }\n        // reset the value of the input file\n        $event.target.value = '';\n    }\n\n    onClickUploadButton(): void {\n        if (this.file) {\n            const files: File[] = [this.file];\n\n            if (this.hasAllowableOperations) {\n                this.uploadFiles(files);\n            } else {\n                this.permissionEvent.emit(new PermissionModel({ type: 'content', action: 'upload', permission: 'create' }));\n            }\n        }\n    }\n\n    onDirectoryAdded($event: any): void {\n        if (this.hasAllowableOperations) {\n            const files: File[] = FileUtils.toFileArray($event.currentTarget.files);\n            this.uploadFiles(files);\n        } else {\n            this.permissionEvent.emit(new PermissionModel({ type: 'content', action: 'upload', permission: 'create' }));\n        }\n        // reset the value of the input file\n        $event.target.value = '';\n    }\n\n    checkPermission() {\n        if (this.rootFolderId) {\n            const opts: any = {\n                includeSource: true,\n                include: ['allowableOperations']\n            };\n\n            this.contentService.getNode(this.rootFolderId, opts).subscribe(\n                (res) => this.permissionValue.next(this.nodeHasPermission(res.entry, AllowableOperationsEnum.CREATE)),\n                (error: { error: Error }) => {\n                    if (error && error.error) {\n                        this.error.emit({ error: error.error.message } as any);\n                    } else {\n                        this.error.emit({ error: 'FILE_UPLOAD.BUTTON.PERMISSION_CHECK_ERROR'} as any);\n                    }\n                }\n            );\n        }\n    }\n\n    nodeHasPermission(node: Node, permission: AllowableOperationsEnum | string): boolean {\n        return this.contentService.hasAllowableOperations(node, permission);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AllowableOperationsEnum, FileModel, EXTENDIBLE_COMPONENT } from '@alfresco/adf-core';\nimport { Component, forwardRef, Input, OnChanges, ViewEncapsulation, OnInit } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { UploadButtonComponent } from './upload-button.component';\n\n@Component({\n    selector: 'adf-upload-version-button',\n    templateUrl: './upload-button.component.html',\n    styleUrls: ['./upload-button.component.scss'],\n    viewProviders: [\n        { provide: EXTENDIBLE_COMPONENT, useExisting: forwardRef(() => UploadVersionButtonComponent) }\n    ],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-upload-version-button' }\n})\nexport class UploadVersionButtonComponent extends UploadButtonComponent implements OnChanges, OnInit {\n\n    /** (**Required**) The node to be versioned. */\n    @Input()\n    node: Node;\n\n    protected createFileModel(file: File): FileModel {\n        const fileModel = super.createFileModel(file, this.rootFolderId, ((<any> file).webkitRelativePath || '').replace(/\\/[^\\/]*$/, ''), this.node.id);\n\n        if (!this.isFileAcceptable(fileModel)) {\n            const message = this.translationService.instant('FILE_UPLOAD.VERSION.MESSAGES.INCOMPATIBLE_VERSION');\n            this.error.emit(message);\n        }\n\n        return fileModel;\n    }\n\n    ngOnInit() {\n        super.ngOnInit();\n        this.checkPermission();\n    }\n\n    checkPermission() {\n        this.permissionValue.next(this.nodeHasPermission(this.node, AllowableOperationsEnum.UPDATE));\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    EXTENDIBLE_COMPONENT, FileInfo, FileModel, FileUtils, NodeAllowableOperationSubject,\n    NotificationService, TranslationService, UploadService, ContentService, AllowableOperationsEnum\n} from '@alfresco/adf-core';\nimport { Component, forwardRef, ViewEncapsulation, NgZone } from '@angular/core';\nimport { UploadBase } from './base-upload/upload-base';\n\n@Component({\n    selector: 'adf-upload-drag-area',\n    templateUrl: './upload-drag-area.component.html',\n    styleUrls: ['./upload-drag-area.component.scss'],\n    host: {'class': 'adf-upload-drag-area'},\n    viewProviders: [\n        {provide: EXTENDIBLE_COMPONENT, useExisting: forwardRef(() => UploadDragAreaComponent)}\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class UploadDragAreaComponent extends UploadBase implements NodeAllowableOperationSubject {\n\n    constructor(protected uploadService: UploadService,\n                protected translationService: TranslationService,\n                private notificationService: NotificationService,\n                private contentService: ContentService,\n                protected ngZone: NgZone) {\n        super(uploadService, translationService, ngZone);\n    }\n\n    /**\n     * Method called when files are dropped in the drag area.\n     *\n     * @param files - files dropped in the drag area.\n     */\n    onFilesDropped(files: File[]): void {\n        if (!this.disabled && files.length) {\n            this.uploadFiles(files);\n        }\n    }\n\n    /**\n     * Called when a folder are dropped in the drag area\n     *\n     * @param folder - name of the dropped folder\n     */\n    onFolderEntityDropped(folder: any): void {\n        if (!this.disabled && folder.isDirectory) {\n            FileUtils.flatten(folder).then((filesInfo) => {\n                this.uploadFilesInfo(filesInfo);\n            });\n        }\n    }\n\n    /**\n     * Show undo notification bar.\n     *\n     * @param latestFilesAdded - files in the upload queue enriched with status flag and xhr object.\n     */\n    showUndoNotificationBar(latestFilesAdded: FileModel[]) {\n        let messageTranslate: any, actionTranslate: any;\n        messageTranslate = this.translationService.get('FILE_UPLOAD.MESSAGES.PROGRESS');\n        actionTranslate = this.translationService.get('FILE_UPLOAD.ACTION.UNDO');\n\n        this.notificationService.openSnackMessageAction(messageTranslate.value, actionTranslate.value, 3000).onAction().subscribe(() => {\n            this.uploadService.cancelUpload(...latestFilesAdded);\n        });\n    }\n\n    /** Returns true or false considering the component options and node permissions */\n    isDroppable(): boolean {\n        return !this.disabled;\n    }\n\n    /**\n     * Handles 'upload-files' events raised by child components.\n     *\n     * @param event DOM event\n     */\n    onUploadFiles(event: CustomEvent) {\n        event.stopPropagation();\n        event.preventDefault();\n        const isAllowed: boolean = this.isTargetNodeFolder(event) ?\n            this.contentService.hasAllowableOperations(event.detail.data.obj.entry, AllowableOperationsEnum.CREATE)\n            : this.contentService.hasAllowableOperations(event.detail.data.obj.entry, AllowableOperationsEnum.UPDATE);\n        if (isAllowed) {\n            if (!this.isTargetNodeFolder(event) && event.detail.files.length === 1) {\n                this.updateFileVersion.emit(event);\n            } else {\n                const fileInfo: FileInfo[] = event.detail.files;\n                if (this.isTargetNodeFolder(event)) {\n                    const destinationFolderName = event.detail.data.obj.entry.name;\n                    fileInfo.map((file) => file.relativeFolder = destinationFolderName ? destinationFolderName.concat(file.relativeFolder) : file.relativeFolder);\n                }\n                if (fileInfo && fileInfo.length > 0) {\n                    this.uploadFilesInfo(fileInfo);\n                }\n            }\n        }\n    }\n\n    private isTargetNodeFolder(event: CustomEvent): boolean {\n        return event.detail.data.obj && event.detail.data.obj.entry.isFolder;\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Pipe, PipeTransform } from '@angular/core';\nimport { TranslationService } from '@alfresco/adf-core';\n\n@Pipe({\n    name: 'adfFileUploadError',\n    pure: true\n})\nexport class FileUploadErrorPipe implements PipeTransform {\n\n    constructor(private translation: TranslationService) {\n    }\n\n    transform(errorCode: number): string {\n        return this.translation.instant(`FILE_UPLOAD.ERRORS.${errorCode || 'GENERIC'}`);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* tslint:disable:no-input-rename  */\n\nimport { FileUtils } from '@alfresco/adf-core';\nimport { Directive, ElementRef, EventEmitter, Input, NgZone, OnDestroy, OnInit, Output } from '@angular/core';\n\n@Directive({\n    selector: '[adf-file-draggable]'\n})\nexport class FileDraggableDirective implements OnInit, OnDestroy {\n\n    files: File [];\n\n    /** Enables/disables drag-and-drop functionality. */\n    @Input('adf-file-draggable')\n    enabled = true;\n\n    /** Emitted when one or more files are dragged and dropped onto the draggable element. */\n    @Output()\n    filesDropped = new EventEmitter<File[]>();\n\n    /** Emitted when a directory is dragged and dropped onto the draggable element. */\n    @Output()\n    folderEntityDropped = new EventEmitter<any>();\n\n    private cssClassName = 'adf-file-draggable__input-focus';\n    private element: HTMLElement;\n\n    constructor(el: ElementRef, private ngZone: NgZone) {\n        this.element = el.nativeElement;\n    }\n\n    ngOnInit() {\n        this.ngZone.runOutsideAngular(() => {\n            this.element.addEventListener('dragenter', this.onDragEnter.bind(this));\n            this.element.addEventListener('dragover', this.onDragOver.bind(this));\n            this.element.addEventListener('dragleave', this.onDragLeave.bind(this));\n            this.element.addEventListener('drop', this.onDropFiles.bind(this));\n        });\n    }\n\n    ngOnDestroy() {\n        this.element.removeEventListener('dragenter', this.onDragEnter);\n        this.element.removeEventListener('dragover', this.onDragOver);\n        this.element.removeEventListener('dragleave', this.onDragLeave);\n        this.element.removeEventListener('drop', this.onDropFiles);\n    }\n\n    /**\n     * Method called when files is dropped in the drag and drop area.\n     * @param event DOM event.\n     */\n    onDropFiles(event: any): void {\n        if (this.enabled && !event.defaultPrevented) {\n            this.preventDefault(event);\n\n            // Chrome, Edge, Firefox, Opera (Files + Folders)\n            const items = event.dataTransfer.items;\n            if (items) {\n                const files: File[] = [];\n\n                for (let i = 0; i < items.length; i++) {\n                    if (items[i].webkitGetAsEntry) {\n                        const item = items[i].webkitGetAsEntry();\n\n                        if (item) {\n                            if (item.isFile) {\n                                const file = items[i].getAsFile();\n\n                                if (file) {\n                                    files.push(file);\n                                }\n                            } else if (item.isDirectory) {\n                                this.folderEntityDropped.emit(item);\n                            }\n                        }\n                    }\n                }\n                if (files.length > 0) {\n                    this.filesDropped.emit(files);\n                }\n            } else {\n                // IE, Safari, Chrome, Edge, Firefox, Opera (Files only)\n                const files = FileUtils.toFileArray(event.dataTransfer.files);\n                this.filesDropped.emit(files);\n            }\n\n            this.element.classList.remove(this.cssClassName);\n        }\n    }\n\n    /**\n     * Change the style of the drag area when a file drag in.\n     *\n     * @param event - DOM event.\n     */\n    onDragEnter(event: DragEvent): void {\n        if (this.enabled && !event.defaultPrevented) {\n            this.preventDefault(event);\n            event.dataTransfer.dropEffect = 'copy';\n            this.element.classList.add(this.cssClassName);\n        }\n    }\n\n    /**\n     * Change the style of the drag area when a file drag out.\n     *\n     * @param event - DOM event.\n     */\n    onDragLeave(event: Event): void {\n        if (this.enabled && !event.defaultPrevented) {\n            this.preventDefault(event);\n            this.element.classList.remove(this.cssClassName);\n        }\n    }\n\n    /**\n     * Change the style of the drag area when a file is over the drag area.\n     *\n     * @param event\n     */\n    onDragOver(event: DragEvent): void {\n        if (this.enabled && !event.defaultPrevented) {\n            this.preventDefault(event);\n            event.dataTransfer.dropEffect = 'copy';\n            this.element.classList.add(this.cssClassName);\n        }\n    }\n\n    /**\n     * Prevent default and stop propagation of the DOM event.\n     *\n     * @param $event - DOM event.\n     */\n    preventDefault(event: Event): void {\n        event.stopPropagation();\n        event.preventDefault();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, HostListener } from '@angular/core';\n\n@Directive({\n    selector: '[adf-toggle-icon]',\n    exportAs: 'toggleIcon'\n})\nexport class ToggleIconDirective {\n    private isFocus: boolean = false;\n    private toggle: boolean = false;\n\n    @HostListener('mouseenter') onMouseEnter() {\n        if (!this.isFocus) {\n            this.toggle = true;\n        }\n    }\n\n    @HostListener('mouseleave') onMouseLeave() {\n        if (!this.isFocus) {\n            this.toggle = false;\n        }\n\n        if (this.isFocus && this.toggle) {\n            this.isFocus = false;\n            this.toggle = false;\n        }\n    }\n\n    @HostListener('focus') onFocus() {\n        this.isFocus = true;\n        this.toggle = true;\n    }\n\n    @HostListener('blur') onBlur() {\n        this.isFocus = false;\n        this.toggle = false;\n    }\n\n    get isToggled(): boolean {\n        return this.toggle;\n    }\n\n    get isFocused(): boolean {\n        return this.isFocus;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\nimport { FileUploadingDialogComponent } from './components/file-uploading-dialog.component';\nimport { FileUploadingListRowComponent } from './components/file-uploading-list-row.component';\nimport { FileUploadingListComponent } from './components/file-uploading-list.component';\nimport { UploadButtonComponent } from './components/upload-button.component';\nimport { UploadVersionButtonComponent } from './components/upload-version-button.component';\nimport { UploadDragAreaComponent } from './components/upload-drag-area.component';\nimport { FileUploadErrorPipe } from './pipes/file-upload-error.pipe';\nimport { CoreModule } from '@alfresco/adf-core';\nimport { FileDraggableDirective } from './directives/file-draggable.directive';\nimport { ToggleIconDirective } from './directives/toggle-icon.directive';\nimport { A11yModule } from '@angular/cdk/a11y';\n\n@NgModule({\n    imports: [\n        CoreModule,\n        CommonModule,\n        MaterialModule,\n        A11yModule\n    ],\n    declarations: [\n        FileDraggableDirective,\n        UploadDragAreaComponent,\n        UploadButtonComponent,\n        UploadVersionButtonComponent,\n        FileUploadingDialogComponent,\n        FileUploadingListComponent,\n        FileUploadingListRowComponent,\n        FileUploadErrorPipe,\n        ToggleIconDirective\n    ],\n    exports: [\n        FileDraggableDirective,\n        UploadDragAreaComponent,\n        UploadButtonComponent,\n        UploadVersionButtonComponent,\n        FileUploadingDialogComponent,\n        FileUploadingListComponent,\n        FileUploadingListRowComponent,\n        FileUploadErrorPipe,\n        ToggleIconDirective\n    ]\n})\nexport class UploadModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, ViewEncapsulation } from '@angular/core';\n\n@Component({\n    selector: 'adf-empty-search-result',\n    templateUrl: './empty-search-result.component.html',\n    encapsulation: ViewEncapsulation.None\n})\nexport class EmptySearchResultComponent {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AuthenticationService, ThumbnailService, SearchTextInputComponent } from '@alfresco/adf-core';\nimport { Component, EventEmitter, Input, OnDestroy, Output,\n         QueryList, ViewEncapsulation, ViewChild, ViewChildren, TemplateRef, ContentChild } from '@angular/core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { Subject } from 'rxjs';\nimport { SearchComponent } from './search.component';\nimport { MatListItem } from '@angular/material/list';\nimport { EmptySearchResultComponent } from './empty-search-result.component';\n\n@Component({\n    selector: 'adf-search-control',\n    templateUrl: './search-control.component.html',\n    styleUrls: ['./search-control.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-control' }\n})\nexport class SearchControlComponent implements OnDestroy {\n\n    /** Toggles highlighting of the search term in the results. */\n    @Input()\n    highlight: boolean = false;\n\n    /** Type of the input field to render, e.g. \"search\" or \"text\" (default). */\n    @Input()\n    inputType: string = 'text';\n\n    /** Toggles \"find-as-you-type\" suggestions for possible matches. */\n    @Input()\n    liveSearchEnabled: boolean = true;\n\n    /** Toggles auto-completion of the search input field. */\n    @Input()\n    autocomplete: boolean = false;\n\n    /** Toggles whether to use an expanding search control. If false\n     * then a regular input is used.\n     */\n    @Input()\n    expandable: boolean = true;\n\n    /** Maximum number of results to show in the live search. */\n    @Input()\n    liveSearchMaxResults: number = 5;\n\n    /** Emitted when the search is submitted by pressing the ENTER key.\n     * The search term is provided as the value of the event.\n     */\n    @Output()\n    submit: EventEmitter<any> = new EventEmitter();\n\n    /** Emitted when the search term is changed. The search term is provided\n     * in the 'value' property of the returned object.  If the term is less\n     * than three characters in length then it is truncated to an empty\n     * string.\n     */\n    @Output()\n    searchChange: EventEmitter<string> = new EventEmitter();\n\n    /** Emitted when a file item from the list of \"find-as-you-type\" results is selected. */\n    @Output()\n    optionClicked: EventEmitter<any> = new EventEmitter();\n\n    @ViewChild('searchTextInput')\n    searchTextInput: SearchTextInputComponent;\n\n    @ViewChild('search')\n    searchAutocomplete: SearchComponent;\n\n    @ViewChildren(MatListItem)\n    private listResultElement: QueryList<MatListItem>;\n\n    @ContentChild(EmptySearchResultComponent)\n    emptySearchTemplate: EmptySearchResultComponent;\n\n    focusSubject = new Subject<FocusEvent>();\n    noSearchResultTemplate: TemplateRef <any> = null;\n    searchTerm: string = '';\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(\n        public authService: AuthenticationService,\n        private thumbnailService: ThumbnailService\n    ) {}\n\n    isNoSearchTemplatePresent(): boolean {\n        return !!this.emptySearchTemplate;\n    }\n\n    ngOnDestroy(): void {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    isLoggedIn(): boolean {\n        return this.authService.isEcmLoggedIn();\n    }\n\n    inputChange(value: string) {\n        this.searchTerm = value;\n        this.searchChange.emit(value);\n    }\n\n    getMimeTypeIcon(node: NodeEntry): string {\n        const mimeType = this.getMimeType(node);\n        return this.thumbnailService.getMimeTypeIcon(mimeType);\n    }\n\n    getMimeType(node: NodeEntry): string {\n        let mimeType: string;\n\n        if (node.entry.content && node.entry.content.mimeType) {\n            mimeType = node.entry.content.mimeType;\n        }\n        if (node.entry.isFolder) {\n            mimeType = 'folder';\n        }\n        return mimeType;\n    }\n\n    elementClicked(item: any) {\n        if (item.entry) {\n            this.optionClicked.next(item);\n            this.focusSubject.next(new FocusEvent('blur'));\n        }\n    }\n\n    onFocus(event: FocusEvent): void {\n        this.focusSubject.next(event);\n    }\n\n    onBlur(event: FocusEvent): void {\n        const nextElement: any = this.getNextElementSibling(<Element> event.target);\n        if (!nextElement && !this.isListElement(event)) {\n            this.focusSubject.next(event);\n        }\n    }\n\n    onSelectFirstResult() {\n        if ( this.listResultElement && this.listResultElement.length > 0) {\n            const firstElement: MatListItem = <MatListItem> this.listResultElement.first;\n            firstElement._getHostElement().focus();\n        }\n    }\n\n    onRowArrowDown(event: Event): void {\n        const nextElement: any = this.getNextElementSibling(<Element> event.target);\n        if (nextElement) {\n            nextElement.focus();\n        }\n    }\n\n    onRowArrowUp(event: Event): void {\n        const previousElement: any = this.getPreviousElementSibling(<Element> event.target);\n        if (previousElement) {\n            previousElement.focus();\n        } else {\n            this.focusSubject.next(new FocusEvent('focus'));\n        }\n    }\n\n    onReset(status: boolean) {\n        if (status) {\n            this.searchAutocomplete.resetResults();\n        }\n    }\n\n    private isListElement(event: any): boolean {\n        return event.relatedTarget && event.relatedTarget.children[0] && event.relatedTarget.children[0].className === 'mat-list-item-content';\n    }\n\n    private getNextElementSibling(node: Element): Element {\n        return node.nextElementSibling;\n    }\n\n    private getPreviousElementSibling(node: Element): Element {\n        return node.previousElementSibling;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SearchService, SearchComponentInterface } from '@alfresco/adf-core';\nimport {\n    AfterContentInit,\n    Component,\n    ContentChild,\n    ElementRef,\n    EventEmitter,\n    Input,\n    OnChanges,\n    Output,\n    TemplateRef,\n    ViewChild,\n    ViewEncapsulation,\n    OnDestroy\n} from '@angular/core';\nimport { NodePaging, ResultSetPaging } from '@alfresco/js-api';\nimport { Subject } from 'rxjs';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-search',\n    templateUrl: './search.component.html',\n    styleUrls: ['./search.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    preserveWhitespaces: false,\n    exportAs: 'searchAutocomplete',\n    host: {\n        'class': 'adf-search'\n    }\n})\nexport class SearchComponent implements SearchComponentInterface, AfterContentInit, OnChanges, OnDestroy {\n\n    @ViewChild('panel', { static: true })\n    panel: ElementRef;\n\n    @ContentChild(TemplateRef)\n    template: TemplateRef<any>;\n\n    /** Function that maps an option's value to its display value in the trigger. */\n    @Input()\n    displayWith: ((value: any) => string) | null = null;\n\n    /** Maximum number of results to show in the search. */\n    @Input()\n    maxResults: number = 20;\n\n    /** Number of results to skip from the results pagination. */\n    @Input()\n    skipResults: number = 0;\n\n    /** Search term to use when executing the search. Updating this value will\n     * run a new search and update the results.\n     */\n    @Input()\n    searchTerm: string = '';\n\n    /** CSS class for display. */\n    @Input('class')\n    set classList(classList: string) {\n        if (classList && classList.length) {\n            classList.split(' ').forEach((className) => this._classList[className.trim()] = true);\n            this._elementRef.nativeElement.className = '';\n        }\n    }\n\n    /** Emitted when search results have fully loaded. */\n    @Output()\n    resultLoaded: EventEmitter<NodePaging> = new EventEmitter();\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter();\n\n    showPanel: boolean = false;\n    results: NodePaging;\n\n    get isOpen(): boolean {\n        return this._isOpen && this.showPanel;\n    }\n\n    set isOpen(value: boolean) {\n        this._isOpen = value;\n    }\n\n    _isOpen: boolean = false;\n    keyPressedStream = new Subject<string>();\n    _classList: { [key: string]: boolean } = {};\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private searchService: SearchService,\n                private _elementRef: ElementRef) {\n        this.keyPressedStream\n            .pipe(\n                debounceTime(200),\n                takeUntil(this.onDestroy$)\n            )\n            .subscribe(searchedWord => {\n                this.loadSearchResults(searchedWord);\n            });\n\n        searchService.dataLoaded\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(\n                nodePaging => this.onSearchDataLoaded(nodePaging),\n                error => this.onSearchDataError(error)\n            );\n    }\n\n    ngAfterContentInit() {\n        this.setVisibility();\n    }\n\n    ngOnChanges(changes) {\n        if (changes.searchTerm && changes.searchTerm.currentValue) {\n            this.loadSearchResults(changes.searchTerm.currentValue);\n        }\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    resetResults() {\n        this.cleanResults();\n        this.setVisibility();\n    }\n\n    reload() {\n        this.loadSearchResults(this.searchTerm);\n    }\n\n    private cleanResults() {\n        if (this.results) {\n            this.results = {};\n        }\n    }\n\n    private loadSearchResults(searchTerm?: string) {\n        this.resetResults();\n        if (searchTerm) {\n            this.searchService.search(searchTerm, this.maxResults, this.skipResults).subscribe(\n                (result) => this.onSearchDataLoaded(result),\n                (err) => this.onSearchDataError(err)\n            );\n        } else {\n            this.cleanResults();\n        }\n    }\n\n    onSearchDataLoaded(resultSetPaging: ResultSetPaging) {\n        if (resultSetPaging) {\n            this.results = <NodePaging> resultSetPaging;\n            this.resultLoaded.emit(this.results);\n            this.isOpen = true;\n            this.setVisibility();\n        }\n    }\n\n    onSearchDataError(error) {\n        if (error && error.status !== 400) {\n            this.results = null;\n            this.error.emit(error);\n        }\n    }\n\n    hidePanel() {\n        if (this.isOpen) {\n            this._classList['adf-search-show'] = false;\n            this._classList['adf-search-hide'] = true;\n            this.isOpen = false;\n        }\n    }\n\n    setVisibility() {\n        this.showPanel = !!this.results && !!this.results.list;\n        this._classList['adf-search-show'] = this.showPanel;\n        this._classList['adf-search-hide'] = !this.showPanel;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { Subject } from 'rxjs';\n\n@Component({\n    selector: 'adf-search-text',\n    templateUrl: './search-text.component.html',\n    styleUrls: ['./search-text.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-text' }\n})\nexport class SearchTextComponent implements SearchWidget, OnInit {\n\n    /** The content of the text box. */\n    @Input()\n    value = '';\n\n    id: string;\n    settings: SearchWidgetSettings;\n    context: SearchQueryBuilderService;\n    startValue: string;\n    isActive = false;\n    enableChangeUpdate = true;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    ngOnInit() {\n        if (this.context && this.settings && this.settings.pattern) {\n            const pattern = new RegExp(this.settings.pattern, 'g');\n            const match = pattern.exec(this.context.queryFragments[this.id] || '');\n            if (this.settings.allowUpdateOnChange !== undefined &&\n                this.settings.allowUpdateOnChange !== null) {\n                this.enableChangeUpdate = this.settings.allowUpdateOnChange;\n            }\n\n            if (match && match.length > 1) {\n                this.value = match[1];\n            }\n\n            if (this.startValue) {\n                this.setValue(this.startValue);\n            }\n        }\n    }\n\n    clear() {\n        this.isActive = false;\n        this.value = '';\n        if (this.enableChangeUpdate) {\n            this.updateQuery(null);\n        }\n    }\n\n    reset() {\n        this.value = '';\n        this.updateQuery(null);\n    }\n\n    onChangedHandler(event) {\n        this.value = event.target.value;\n        this.isActive = !!this.value;\n        if (this.enableChangeUpdate) {\n            this.updateQuery(this.value);\n        }\n    }\n\n    private updateQuery(value: string) {\n        this.displayValue$.next(value);\n        if (this.context && this.settings && this.settings.field) {\n            this.context.queryFragments[this.id] = value ? `${this.settings.field}:'${this.getSearchPrefix()}${value}${this.getSearchSuffix()}'` : '';\n            this.context.update();\n        }\n    }\n\n    submitValues() {\n        this.updateQuery(this.value);\n    }\n\n    hasValidValue() {\n        return !!this.value;\n    }\n\n    getCurrentValue() {\n        return this.value;\n    }\n\n    setValue(value: string) {\n        this.value = value;\n        this.displayValue$.next(this.value);\n        this.submitValues();\n    }\n\n    private getSearchPrefix(): string {\n        return this.settings.searchPrefix ? this.settings.searchPrefix : '';\n    }\n\n    private getSearchSuffix(): string {\n        return this.settings.searchSuffix ? this.settings.searchSuffix : '';\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEFAULT_PAGE_SIZE = 5;\n\nexport class SearchFilterList<T> implements Iterable<T> {\n\n    private filteredItems: T[] = [];\n    private _filterText: string = '';\n\n    items: T[] = [];\n    pageSize: number = DEFAULT_PAGE_SIZE;\n    currentPageSize: number = DEFAULT_PAGE_SIZE;\n\n    get filterText(): string {\n        return this._filterText;\n    }\n\n    set filterText(value: string) {\n        this._filterText = value;\n        this.applyFilter();\n    }\n\n    private _filter: (item: T) => boolean = () => true;\n\n    get filter(): (item: T) => boolean {\n        return this._filter;\n    }\n\n    set filter(value: (item: T) => boolean ) {\n        this._filter = value;\n        this.applyFilter();\n    }\n\n    private applyFilter() {\n        if (this.filter) {\n            this.filteredItems = this.items.filter(this.filter);\n        } else {\n            this.filteredItems = this.items;\n        }\n        this.currentPageSize = this.pageSize;\n    }\n\n    /** Returns visible portion of the items.  */\n    get visibleItems(): T[] {\n        return this.filteredItems.slice(0, this.currentPageSize);\n    }\n\n    /** Returns entire collection length including items not displayed on the page. */\n    get length(): number {\n        return this.items.length;\n    }\n\n    /** Detects whether more items can be displayed. */\n    get canShowMoreItems(): boolean {\n        return this.filteredItems.length > this.currentPageSize;\n    }\n\n    /** Detects whether less items can be displayed. */\n    get canShowLessItems(): boolean {\n        return this.currentPageSize > this.pageSize;\n    }\n\n    /** Detects whether content fits single page. */\n    get fitsPage(): boolean {\n        return this.pageSize >= this.filteredItems.length;\n    }\n\n    constructor(items: T[] = [], pageSize?: number) {\n        this.items = items;\n        this.filteredItems = items;\n        this.pageSize = pageSize || DEFAULT_PAGE_SIZE;\n        this.currentPageSize = pageSize || DEFAULT_PAGE_SIZE;\n    }\n\n    /** Display more items. */\n    showMoreItems() {\n        if (this.canShowMoreItems) {\n            this.currentPageSize += this.pageSize;\n        }\n    }\n\n    /** Display less items. */\n    showLessItems() {\n        if (this.canShowLessItems) {\n            this.currentPageSize -= this.pageSize;\n        }\n    }\n\n    /** Reset entire collection and page settings. */\n    clear() {\n        this.currentPageSize = this.pageSize;\n        this.items = [];\n        this.filteredItems = [];\n        this.filterText = '';\n    }\n\n    addItem(item: T) {\n        if (!item) {\n            return;\n        }\n        this.items.push(item);\n        this.applyFilter();\n    }\n\n    deleteItem(item: T) {\n        const removeIndex = this.items.indexOf(item);\n        if (removeIndex > -1) {\n            this.items.splice(removeIndex, 1);\n            this.filteredItems.splice(removeIndex, 1);\n        }\n    }\n\n    [Symbol.iterator](): Iterator<T> {\n        let pointer = 0;\n        const items = this.visibleItems;\n\n        return {\n            next(): IteratorResult<T> {\n                if (pointer < items.length) {\n                    return {\n                        done: false,\n                        value: items[pointer++]\n                    };\n                } else {\n                    return {\n                        done: true,\n                        value: null\n                    };\n                }\n            }\n        };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MatRadioChange } from '@angular/material/radio';\n\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { SearchFilterList } from '../../models/search-filter-list.model';\nimport { Subject } from 'rxjs';\n\nexport interface SearchRadioOption {\n    name: string;\n    value: string;\n}\n\n@Component({\n    selector: 'adf-search-radio',\n    templateUrl: './search-radio.component.html',\n    styleUrls: ['./search-radio.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-radio' }\n})\nexport class SearchRadioComponent implements SearchWidget, OnInit {\n\n    /** The value of the selected radio button. */\n    @Input()\n    value: string;\n\n    id: string;\n    settings: SearchWidgetSettings;\n    context: SearchQueryBuilderService;\n    options: SearchFilterList<SearchRadioOption>;\n    pageSize = 5;\n    isActive = false;\n    startValue: any;\n    enableChangeUpdate: boolean;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    constructor() {\n        this.options = new SearchFilterList<SearchRadioOption>();\n    }\n\n    ngOnInit() {\n        if (this.settings) {\n            this.pageSize = this.settings.pageSize || 5;\n\n            if (this.settings.options && this.settings.options.length > 0) {\n                this.options = new SearchFilterList<SearchRadioOption>(\n                    this.settings.options, this.pageSize\n                );\n            }\n        }\n\n        const initialValue = this.getSelectedValue();\n\n        if (initialValue !== null) {\n            this.value = initialValue;\n            this.context.queryFragments[this.id] = initialValue;\n        } else if (this.startValue !== null) {\n            this.value = initialValue;\n            this.context.queryFragments[this.id] = initialValue;\n        }\n        this.enableChangeUpdate = this.settings.allowUpdateOnChange ?? true;\n        this.updateDisplayValue();\n    }\n\n    private getSelectedValue(): string {\n        const options: any[] = this.settings['options'] || [];\n        if (options && options.length > 0) {\n            this.isActive = true;\n\n            let selected = options.find((opt) => opt.default);\n            if (!selected) {\n                selected = options[0];\n            }\n            return selected.value;\n        }\n        return null;\n    }\n\n    submitValues() {\n        this.setValue(this.value);\n        this.updateDisplayValue();\n        this.context.update();\n    }\n\n    hasValidValue() {\n        const currentValue = this.getSelectedValue();\n        return !!currentValue;\n    }\n\n    setValue(newValue: string) {\n        this.value = newValue;\n        this.context.queryFragments[this.id] = newValue;\n        if (this.enableChangeUpdate) {\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    getCurrentValue() {\n        return this.getSelectedValue();\n    }\n\n    updateDisplayValue(): void {\n        const selectOptions = this.options.items.find(({ value}) => value === this.value);\n        if (selectOptions) {\n            this.displayValue$.next(selectOptions.name);\n        } else {\n            this.displayValue$.next('');\n        }\n    }\n\n    changeHandler(event: MatRadioChange) {\n        this.setValue(event.value);\n    }\n\n    clear() {\n        this.isActive = false;\n        const initialValue = this.getSelectedValue();\n        if (initialValue !== null) {\n            this.setValue(initialValue);\n        }\n    }\n\n    reset() {\n        const initialValue = this.getSelectedValue();\n        if (initialValue !== null) {\n            this.setValue(initialValue);\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { MatSliderChange } from '@angular/material/slider';\nimport { Subject } from 'rxjs';\n\n@Component({\n    selector: 'adf-search-slider',\n    templateUrl: './search-slider.component.html',\n    styleUrls: ['./search-slider.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-slider' }\n})\nexport class SearchSliderComponent implements SearchWidget, OnInit {\n    isActive?: boolean;\n    startValue: any;\n\n    id: string;\n    settings: SearchWidgetSettings;\n    context: SearchQueryBuilderService;\n    step: number;\n    min: number;\n    max: number;\n    thumbLabel = false;\n    enableChangeUpdate: boolean;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    /** The numeric value represented by the slider. */\n    @Input()\n    value: number | null;\n\n    ngOnInit() {\n        if (this.settings) {\n            if (this.settings.hasOwnProperty('min')) {\n                this.min = this.settings['min'];\n            }\n\n            if (this.settings.hasOwnProperty('max')) {\n                this.max = this.settings['max'];\n            }\n\n            if (this.settings.hasOwnProperty('step')) {\n                this.step = this.settings['step'];\n            }\n\n            this.thumbLabel = this.settings['thumbLabel'] ? true : false;\n            this.enableChangeUpdate = this.settings.allowUpdateOnChange ?? true;\n        }\n\n        if (this.startValue) {\n            this.setValue(this.startValue);\n        }\n    }\n\n    clear() {\n        this.value = this.min || 0;\n        if (this.enableChangeUpdate) {\n            this.updateQuery(null);\n        }\n    }\n\n    reset() {\n        this.value = this.min || 0;\n        this.updateQuery(null);\n    }\n\n    onChangedHandler(event: MatSliderChange) {\n        this.value = event.value;\n        if (this.enableChangeUpdate) {\n            this.updateQuery(this.value);\n        }\n    }\n\n    submitValues() {\n        this.updateQuery(this.value);\n    }\n\n    hasValidValue() {\n        return !!this.value;\n    }\n\n    getCurrentValue() {\n        return this.value;\n    }\n\n    setValue(value: any) {\n        this.value = value;\n        this.submitValues();\n    }\n\n    private updateQuery(value: number | null) {\n        this.displayValue$.next( this.value ? `${this.value} ${this.settings.unit ?? ''}` : '' );\n        if (this.id && this.context && this.settings && this.settings.field) {\n            if (value === null) {\n                this.context.queryFragments[this.id] = '';\n            } else {\n                this.context.queryFragments[this.id] = `${this.settings.field}:[0 TO ${value}]`;\n            }\n            this.context.update();\n        }\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ErrorStateMatcher } from '@angular/material/core';\nimport { FormControl, FormGroupDirective, NgForm } from '@angular/forms';\n\nexport class LiveErrorStateMatcher implements ErrorStateMatcher {\n\n    isErrorState(control: FormControl | null, form: FormGroupDirective | NgForm | null): boolean {\n        const isSubmitted = form && form.submitted;\n        return !!(control && control.invalid && (control.dirty || control.touched || (!control.pristine && isSubmitted)));\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { LiveErrorStateMatcher } from '../../forms/live-error-state-matcher';\nimport { Subject } from 'rxjs';\n\n@Component({\n    selector: 'adf-search-number-range',\n    templateUrl: './search-number-range.component.html',\n    styleUrls: ['./search-number-range.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-number-range' }\n})\nexport class SearchNumberRangeComponent implements SearchWidget, OnInit {\n\n    from: FormControl;\n    to: FormControl;\n\n    form: FormGroup;\n    matcher = new LiveErrorStateMatcher();\n\n    id: string;\n    settings?: SearchWidgetSettings;\n    context?: SearchQueryBuilderService;\n\n    field: string;\n    format = '[{FROM} TO {TO}]';\n\n    isActive = false;\n    startValue: any;\n\n    validators: Validators;\n    enableChangeUpdate: boolean;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    ngOnInit(): void {\n\n        if (this.settings) {\n            this.field = this.settings.field;\n            this.format = this.settings.format || '[{FROM} TO {TO}]';\n        }\n\n        this.validators = Validators.compose([\n            Validators.required,\n            Validators.pattern(/^-?(0|[1-9]\\d*)?$/),\n            Validators.min(0)\n        ]);\n\n        if (this.startValue) {\n            this.from = new FormControl(this.startValue['from'], this.validators);\n            this.to = new FormControl(this.startValue['to'], this.validators);\n        } else {\n            this.from = new FormControl('', this.validators);\n            this.to = new FormControl('', this.validators);\n        }\n\n        this.form = new FormGroup({\n            from: this.from,\n            to: this.to\n        }, this.formValidator);\n\n        this.enableChangeUpdate = this.settings?.allowUpdateOnChange ?? true;\n        this.updateDisplayValue();\n    }\n\n    formValidator(formGroup: FormGroup) {\n        return parseInt(formGroup.get('from').value, 10) < parseInt(formGroup.get('to').value, 10) ? null : {'mismatch': true};\n    }\n\n    apply(model: { from: string, to: string }, isValid: boolean) {\n        if (isValid && this.id && this.context && this.field) {\n            this.updateDisplayValue();\n            this.isActive = true;\n\n            const map = new Map<string, string>();\n            map.set('FROM', model.from);\n            map.set('TO', model.to);\n\n            const value = this.formatString(this.format, map);\n\n            this.context.queryFragments[this.id] = `${this.field}:${value}`;\n            this.context.update();\n        }\n    }\n\n    private formatString(str: string, map: Map<string, string>): string {\n        let result = str;\n\n        map.forEach((value, key) => {\n            const expr = new RegExp('{' + key + '}', 'gm');\n            result = result.replace(expr, value);\n        });\n\n        return result;\n    }\n\n    submitValues() {\n        this.apply(this.form.value, this.form.valid);\n    }\n\n    hasValidValue() {\n        return this.form.valid;\n    }\n\n    getCurrentValue() {\n        return this.form.value;\n    }\n\n    updateDisplayValue(): void {\n        if (this.form.invalid || this.form.pristine) {\n            this.displayValue$.next('');\n        } else {\n            this.displayValue$.next(`${this.form.value.from} - ${this.form.value.to} ${this.settings.unit ?? ''}`);\n        }\n    }\n\n    setValue(value: any) {\n        this.form['from'].setValue(value);\n        this.form['to'].setValue(value);\n        this.updateDisplayValue();\n    }\n\n    clear() {\n        this.isActive = false;\n\n        this.form.reset({\n            from: '',\n            to: ''\n        });\n\n        if (this.id && this.context) {\n            this.context.queryFragments[this.id] = '';\n            this.updateDisplayValue();\n            if (this.enableChangeUpdate) {\n                this.context.update();\n            }\n        }\n    }\n\n    reset() {\n        this.clear();\n        if (this.id && this.context) {\n            this.context.update();\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MatCheckboxChange } from '@angular/material/checkbox';\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { SearchFilterList } from '../../models/search-filter-list.model';\nimport { TranslationService } from '@alfresco/adf-core';\nimport { Subject } from 'rxjs';\n\nexport interface SearchListOption {\n    name: string;\n    value: string;\n    checked: boolean;\n}\n\n@Component({\n    selector: 'adf-search-check-list',\n    templateUrl: './search-check-list.component.html',\n    styleUrls: ['./search-check-list.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-check-list' }\n})\nexport class SearchCheckListComponent implements SearchWidget, OnInit {\n\n    id: string;\n    settings?: SearchWidgetSettings;\n    context?: SearchQueryBuilderService;\n    options: SearchFilterList<SearchListOption>;\n    operator: string = 'OR';\n    startValue: SearchListOption = null;\n    pageSize = 5;\n    isActive = false;\n    enableChangeUpdate = true;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    constructor(private translationService: TranslationService) {\n        this.options = new SearchFilterList<SearchListOption>();\n    }\n\n    ngOnInit(): void {\n        if (this.settings) {\n            this.operator = this.settings.operator || 'OR';\n            this.pageSize = this.settings.pageSize || 5;\n\n            if (this.settings.options && this.settings.options.length > 0) {\n                this.options = new SearchFilterList(this.settings.options, this.pageSize);\n            }\n            this.enableChangeUpdate = this.settings.allowUpdateOnChange ?? true;\n        }\n\n        if (this.startValue) {\n            this.setValue(this.startValue);\n        }\n    }\n\n    clear() {\n        this.isActive = false;\n        this.clearOptions();\n        if (this.id && this.context && this.enableChangeUpdate) {\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    clearOptions() {\n        this.options.items.forEach((opt) => {\n            opt.checked = false;\n        });\n\n        if (this.id && this.context) {\n            this.context.queryFragments[this.id] = '';\n        }\n    }\n\n    reset() {\n        this.isActive = false;\n        this.clearOptions();\n        if (this.id && this.context) {\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    updateDisplayValue(): void {\n        const displayValue = this.options.items\n            .filter((option) => option.checked)\n            .map(({name}) => this.translationService.instant(name))\n            .join(', ');\n        this.displayValue$.next(displayValue);\n    }\n\n    changeHandler(event: MatCheckboxChange, option: any) {\n        option.checked = event.checked;\n        const checkedValues = this.getCheckedValues();\n        this.isActive = !!checkedValues.length;\n        if (this.enableChangeUpdate) {\n            this.submitValues();\n        }\n    }\n\n    hasValidValue() {\n        const checkedValues = this.getCheckedValues();\n        return !!checkedValues.length;\n    }\n\n    getCurrentValue() {\n        return this.getCheckedValues();\n    }\n\n    setValue(value: any) {\n        this.options.items.filter((item) => value.includes(item.value))\n            .map((item) => item.checked = true);\n        this.submitValues();\n    }\n\n    private getCheckedValues() {\n        return this.options.items\n            .filter((option) => option.checked)\n            .map((option) => option.value);\n    }\n\n    submitValues() {\n        const checkedValues = this.getCheckedValues();\n        const query = checkedValues.join(` ${this.operator} `);\n        if (this.id && this.context) {\n            this.context.queryFragments[this.id] = query;\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, OnDestroy, OnInit, ViewEncapsulation } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { DateAdapter, MAT_DATE_FORMATS, MAT_DATE_LOCALE } from '@angular/material/core';\nimport {\n    MOMENT_DATE_FORMATS,\n    MomentDateAdapter,\n    UserPreferencesService,\n    UserPreferenceValues\n} from '@alfresco/adf-core';\n\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { LiveErrorStateMatcher } from '../../forms/live-error-state-matcher';\nimport { Moment } from 'moment';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\nexport interface DateRangeValue {\n    from: string;\n    to: string;\n}\n\ndeclare let moment: any;\n\nconst DEFAULT_FORMAT_DATE: string = 'DD/MM/YYYY';\n\n@Component({\n    selector: 'adf-search-date-range',\n    templateUrl: './search-date-range.component.html',\n    styleUrls: ['./search-date-range.component.scss'],\n    providers: [\n        { provide: DateAdapter, useClass: MomentDateAdapter, deps: [MAT_DATE_LOCALE] },\n        { provide: MAT_DATE_FORMATS, useValue: MOMENT_DATE_FORMATS }\n    ],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-date-range' }\n})\nexport class SearchDateRangeComponent implements SearchWidget, OnInit, OnDestroy {\n\n    from: FormControl;\n    to: FormControl;\n\n    form: FormGroup;\n    matcher = new LiveErrorStateMatcher();\n\n    id: string;\n    settings?: SearchWidgetSettings;\n    context?: SearchQueryBuilderService;\n    datePickerFormat: string;\n    maxDate: any;\n    fromMaxDate: any;\n    isActive = false;\n    startValue: any;\n    enableChangeUpdate: boolean;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private dateAdapter: DateAdapter<Moment>,\n                private userPreferencesService: UserPreferencesService) {\n    }\n\n    getFromValidationMessage(): string {\n        return this.from.hasError('invalidOnChange') || this.hasParseError(this.from) ? 'SEARCH.FILTER.VALIDATION.INVALID-DATE' :\n            this.from.hasError('matDatepickerMax') ? 'SEARCH.FILTER.VALIDATION.BEYOND-MAX-DATE' :\n            this.from.hasError('required') ? 'SEARCH.FILTER.VALIDATION.REQUIRED-VALUE' :\n            '';\n    }\n\n    getToValidationMessage(): string {\n        return this.to.hasError('invalidOnChange') || this.hasParseError(this.to) ? 'SEARCH.FILTER.VALIDATION.INVALID-DATE' :\n            this.to.hasError('matDatepickerMin') ? 'SEARCH.FILTER.VALIDATION.NO-DAYS' :\n            this.to.hasError('matDatepickerMax') ? 'SEARCH.FILTER.VALIDATION.BEYOND-MAX-DATE' :\n            this.to.hasError('required') ? 'SEARCH.FILTER.VALIDATION.REQUIRED-VALUE' :\n            '';\n    }\n\n    ngOnInit() {\n        this.datePickerFormat = this.settings?.dateFormat ? this.settings.dateFormat : DEFAULT_FORMAT_DATE;\n\n        const customDateAdapter = <MomentDateAdapter> <any> this.dateAdapter;\n        customDateAdapter.overrideDisplayFormat = this.datePickerFormat;\n\n        this.userPreferencesService\n            .select(UserPreferenceValues.Locale)\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(locale => this.setLocale(locale));\n\n        const validators = Validators.compose([\n            Validators.required\n        ]);\n\n        if (this.settings && this.settings.maxDate) {\n            if (this.settings.maxDate === 'today') {\n                this.maxDate = this.dateAdapter.today().endOf('day');\n            } else {\n                this.maxDate = moment(this.settings.maxDate).endOf('day');\n            }\n        }\n\n        if (this.startValue) {\n            const splitValue = this.startValue.split('||');\n            const fromValue = this.dateAdapter.parse(splitValue[0], this.datePickerFormat);\n            const toValue = this.dateAdapter.parse(splitValue[1], this.datePickerFormat);\n            this.from = new FormControl(fromValue, validators);\n            this.to = new FormControl(toValue, validators);\n        } else {\n            this.from = new FormControl('', validators);\n            this.to = new FormControl('', validators);\n        }\n\n        this.form = new FormGroup({\n            from: this.from,\n            to: this.to\n        });\n\n        this.setFromMaxDate();\n        this.enableChangeUpdate = this.settings?.allowUpdateOnChange ?? true;\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    apply(model: { from: string, to: string }, isValid: boolean) {\n        if (isValid && this.id && this.context && this.settings && this.settings.field) {\n            this.isActive = true;\n\n            const start = moment(model.from).startOf('day').format();\n            const end = moment(model.to).endOf('day').format();\n\n            this.context.queryFragments[this.id] = `${this.settings.field}:['${start}' TO '${end}']`;\n\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    submitValues() {\n        this.apply(this.form.value, this.form.valid);\n    }\n\n    hasValidValue(): boolean {\n        return this.form.valid;\n    }\n\n    getCurrentValue(): DateRangeValue {\n        return {\n            from: this.dateAdapter.format(this.form.value.from, this.datePickerFormat),\n            to: this.dateAdapter.format(this.form.value.from, this.datePickerFormat)\n        };\n    }\n\n    updateDisplayValue(): void {\n        if (this.form.invalid || this.form.pristine) {\n            this.displayValue$.next('');\n        } else {\n            this.displayValue$.next(`${this.dateAdapter.format(this.form.value.from, this.datePickerFormat)} - ${this.dateAdapter.format(this.form.value.to, this.datePickerFormat)}`);\n        }\n    }\n\n    setValue(parsedDate: string) {\n        const splitValue = parsedDate.split('||');\n        const fromValue = this.dateAdapter.parse(splitValue[0], this.datePickerFormat);\n        const toValue = this.dateAdapter.parse(splitValue[1], this.datePickerFormat);\n        this.from.setValue(fromValue);\n        this.from.markAsDirty();\n        this.from.markAsTouched();\n        this.to.setValue(toValue);\n        this.to.markAsDirty();\n        this.to.markAsTouched();\n        this.submitValues();\n    }\n    clear() {\n        this.isActive = false;\n        this.form.reset({\n            from: '',\n            to: ''\n        });\n\n        if (this.id && this.context) {\n            this.context.queryFragments[this.id] = '';\n            if (this.enableChangeUpdate) {\n                this.updateQuery();\n            }\n        }\n        this.setFromMaxDate();\n    }\n\n    reset() {\n        this.clear();\n        this.updateQuery();\n    }\n\n    private updateQuery() {\n        if (this.id && this.context) {\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    onChangedHandler(event: any, formControl: FormControl) {\n\n        const inputValue = event.value;\n        const formatDate = this.dateAdapter.parse(inputValue, this.datePickerFormat);\n        if (formatDate && formatDate.isValid()) {\n            formControl.setValue(formatDate);\n        } else if (formatDate) {\n            formControl.setErrors({\n                'invalidOnChange': true\n            });\n        }\n\n        this.setFromMaxDate();\n    }\n\n    setLocale(locale) {\n        this.dateAdapter.setLocale(locale);\n        moment.locale(locale);\n    }\n\n    hasParseError(formControl): boolean {\n        return formControl.hasError('matDatepickerParse') && formControl.getError('matDatepickerParse').text;\n    }\n\n    forcePlaceholder(event: any) {\n        event.srcElement.click();\n    }\n\n    setFromMaxDate() {\n        this.fromMaxDate = (!this.to.value || this.maxDate && (moment(this.maxDate).isBefore(this.to.value))) ? this.maxDate : moment(this.to.value);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, OnDestroy, OnInit, ViewEncapsulation } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { UserPreferencesService, UserPreferenceValues } from '@alfresco/adf-core';\n\nimport { SearchWidget } from '../../models/search-widget.interface';\nimport { SearchWidgetSettings } from '../../models/search-widget-settings.interface';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { LiveErrorStateMatcher } from '../../forms/live-error-state-matcher';\nimport { Moment } from 'moment';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\nimport { DatetimeAdapter, MAT_DATETIME_FORMATS } from '@mat-datetimepicker/core';\nimport { MAT_MOMENT_DATETIME_FORMATS } from '@mat-datetimepicker/moment';\n\nexport interface DatetimeRangeValue {\n    from: string;\n    to: string;\n}\n\ndeclare let moment: any;\n\nconst DEFAULT_DATETIME_FORMAT: string = 'DD/MM/YYYY HH:mm';\n\n@Component({\n    selector: 'adf-search-datetime-range',\n    templateUrl: './search-datetime-range.component.html',\n    styleUrls: ['./search-datetime-range.component.scss'],\n    providers: [\n        { provide: MAT_DATETIME_FORMATS, useValue: MAT_MOMENT_DATETIME_FORMATS }\n    ],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-date-range' }\n})\nexport class SearchDatetimeRangeComponent implements SearchWidget, OnInit, OnDestroy {\n\n    from: FormControl;\n    to: FormControl;\n\n    form: FormGroup;\n    matcher = new LiveErrorStateMatcher();\n\n    id: string;\n    settings?: SearchWidgetSettings;\n    context?: SearchQueryBuilderService;\n    datetimePickerFormat: string;\n    maxDatetime: any;\n    fromMaxDatetime: any;\n    isActive = false;\n    startValue: any;\n    enableChangeUpdate: boolean;\n    displayValue$: Subject<string> = new Subject<string>();\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private dateAdapter: DatetimeAdapter<Moment>,\n                private userPreferencesService: UserPreferencesService) {\n    }\n\n    getFromValidationMessage(): string {\n        return this.from.hasError('invalidOnChange') || this.hasParseError(this.from) ? 'SEARCH.FILTER.VALIDATION.INVALID-DATETIME' :\n            this.from.hasError('matDatepickerMax') ? 'SEARCH.FILTER.VALIDATION.BEYOND-MAX-DATETIME' :\n            this.from.hasError('required') ? 'SEARCH.FILTER.VALIDATION.REQUIRED-VALUE' :\n            '';\n    }\n\n    getToValidationMessage(): string {\n        return this.to.hasError('invalidOnChange') || this.hasParseError(this.to) ? 'SEARCH.FILTER.VALIDATION.INVALID-DATETIME' :\n            this.to.hasError('matDatepickerMin') ? 'SEARCH.FILTER.VALIDATION.NO-DAYS' :\n            this.to.hasError('matDatepickerMax') ? 'SEARCH.FILTER.VALIDATION.BEYOND-MAX-DATETIME' :\n            this.to.hasError('required') ? 'SEARCH.FILTER.VALIDATION.REQUIRED-VALUE' :\n            '';\n    }\n\n    ngOnInit() {\n        this.datetimePickerFormat = this.settings?.datetimeFormat ? this.settings.datetimeFormat : DEFAULT_DATETIME_FORMAT;\n\n        this.userPreferencesService\n            .select(UserPreferenceValues.Locale)\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(locale => this.setLocale(locale));\n\n        const validators = Validators.compose([\n            Validators.required\n        ]);\n\n        if (this.settings && this.settings.maxDatetime) {\n            this.maxDatetime = moment(this.settings.maxDatetime);\n        }\n\n        if (this.startValue) {\n            const splitValue = this.startValue.split('||');\n            const fromValue = this.dateAdapter.parse(splitValue[0], this.datetimePickerFormat);\n            const toValue = this.dateAdapter.parse(splitValue[1], this.datetimePickerFormat);\n            this.from = new FormControl(fromValue, validators);\n            this.to = new FormControl(toValue, validators);\n        } else {\n            this.from = new FormControl('', validators);\n            this.to = new FormControl('', validators);\n        }\n\n        this.form = new FormGroup({\n            from: this.from,\n            to: this.to\n        });\n\n        this.setFromMaxDatetime();\n        this.enableChangeUpdate = this.settings?.allowUpdateOnChange ?? true;\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    apply(model: { from: string, to: string }, isValid: boolean) {\n        if (isValid && this.id && this.context && this.settings && this.settings.field) {\n            this.isActive = true;\n\n            const start = moment.utc(model.from).startOf('minute').format();\n            const end = moment.utc(model.to).endOf('minute').format();\n\n            this.context.queryFragments[this.id] = `${this.settings.field}:['${start}' TO '${end}']`;\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    submitValues() {\n        this.apply(this.form.value, this.form.valid);\n    }\n\n    hasValidValue(): boolean {\n        return this.form.valid;\n    }\n\n    getCurrentValue(): DatetimeRangeValue {\n        return {\n            from: this.dateAdapter.format(this.form.value.from, this.datetimePickerFormat),\n            to: this.dateAdapter.format(this.form.value.to, this.datetimePickerFormat)\n        };\n    }\n\n    updateDisplayValue(): void {\n        if (this.form.invalid || this.form.pristine) {\n            this.displayValue$.next('');\n        } else {\n            this.displayValue$.next(`${this.dateAdapter.format(this.form.value.from, this.datetimePickerFormat)} - ${this.dateAdapter.format(this.form.value.to, this.datetimePickerFormat)}`);\n        }\n    }\n\n    setValue(parsedDate: string) {\n        const splitValue = parsedDate.split('||');\n        const fromValue = this.dateAdapter.parse(splitValue[0], this.datetimePickerFormat);\n        const toValue = this.dateAdapter.parse(splitValue[1], this.datetimePickerFormat);\n        this.from.setValue(fromValue);\n        this.from.markAsDirty();\n        this.from.markAsTouched();\n        this.to.setValue(toValue);\n        this.to.markAsDirty();\n        this.to.markAsTouched();\n        this.submitValues();\n    }\n\n    clear() {\n        this.isActive = false;\n        this.form.reset({\n            from: '',\n            to: ''\n        });\n        if (this.id && this.context) {\n            this.context.queryFragments[this.id] = '';\n        }\n\n        if (this.id && this.context && this.enableChangeUpdate) {\n            this.updateQuery();\n        }\n        this.setFromMaxDatetime();\n    }\n\n    reset() {\n        this.clear();\n        this.updateQuery();\n    }\n\n    private updateQuery() {\n        if (this.id && this.context) {\n            this.updateDisplayValue();\n            this.context.update();\n        }\n    }\n\n    onChangedHandler(event: any, formControl: FormControl) {\n\n        const inputValue = event.value;\n        const formatDate = this.dateAdapter.parse(inputValue, this.datetimePickerFormat);\n        if (formatDate && formatDate.isValid()) {\n            formControl.setValue(formatDate);\n        } else if (formatDate) {\n            formControl.setErrors({\n                'invalidOnChange': true\n            });\n        }\n\n        this.setFromMaxDatetime();\n    }\n\n    setLocale(locale) {\n        this.dateAdapter.setLocale(locale);\n        moment.locale(locale);\n    }\n\n    hasParseError(formControl): boolean {\n        return formControl.hasError('matDatepickerParse') && formControl.getError('matDatepickerParse').text;\n    }\n\n    forcePlaceholder(event: any) {\n        event.srcElement.click();\n    }\n\n    setFromMaxDatetime() {\n        this.fromMaxDatetime = (!this.to.value || this.maxDatetime && (moment(this.maxDatetime).isBefore(this.to.value))) ? this.maxDatetime : moment(this.to.value);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable, Type } from '@angular/core';\nimport { SearchTextComponent } from '../components/search-text/search-text.component';\nimport { SearchRadioComponent } from '../components/search-radio/search-radio.component';\nimport { SearchSliderComponent } from '../components/search-slider/search-slider.component';\nimport { SearchNumberRangeComponent } from '../components/search-number-range/search-number-range.component';\nimport { SearchCheckListComponent } from '../components/search-check-list/search-check-list.component';\nimport { SearchDateRangeComponent } from '../components/search-date-range/search-date-range.component';\nimport { SearchDatetimeRangeComponent } from '../components/search-datetime-range/search-datetime-range.component';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SearchFilterService {\n\n    /**\n     * Contains string-to-type mappings for registered widgets.\n     */\n    widgets: { [id: string]: Type<{}> } = {\n        'text': SearchTextComponent,\n        'radio': SearchRadioComponent,\n        'slider': SearchSliderComponent,\n        'number-range': SearchNumberRangeComponent,\n        'check-list': SearchCheckListComponent,\n        'date-range': SearchDateRangeComponent,\n        'datetime-range': SearchDatetimeRangeComponent\n    };\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    Input,\n    ViewChild,\n    ViewContainerRef,\n    OnInit,\n    OnDestroy,\n    ComponentRef,\n    ComponentFactoryResolver,\n    Inject,\n    SimpleChanges,\n    OnChanges\n} from '@angular/core';\nimport { SearchFilterService } from '../../services/search-filter.service';\nimport { BaseQueryBuilderService } from '../../services/base-query-builder.service';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\nimport { Observable } from 'rxjs';\n\n@Component({\n    selector: 'adf-search-widget-container',\n    template: '<div #content></div>'\n})\nexport class SearchWidgetContainerComponent implements OnInit, OnDestroy, OnChanges {\n\n    @ViewChild('content', { read: ViewContainerRef, static: true })\n    content: ViewContainerRef;\n\n    @Input()\n    id: string;\n\n    @Input()\n    selector: string;\n\n    @Input()\n    settings: any;\n\n    @Input()\n    config: any;\n\n    @Input()\n    value: any;\n\n    componentRef: ComponentRef<any>;\n\n    constructor(\n        private searchFilterService: SearchFilterService,\n        @Inject(SEARCH_QUERY_SERVICE_TOKEN) private queryBuilder: BaseQueryBuilderService,\n        private componentFactoryResolver: ComponentFactoryResolver) {\n    }\n\n    ngOnInit() {\n        const componentType = this.searchFilterService.widgets[this.selector];\n        if (componentType) {\n            const factory = this.componentFactoryResolver.resolveComponentFactory(componentType);\n            if (factory) {\n                this.content.clear();\n                this.componentRef = this.content.createComponent(factory, 0);\n                this.setupWidget(this.componentRef);\n            }\n        }\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (changes['value']?.currentValue && this.componentRef?.instance) {\n            this.componentRef.instance.isActive = true;\n            this.componentRef.instance.setValue(changes['value'].currentValue);\n        }\n    }\n\n    private setupWidget(ref: ComponentRef<any>) {\n        if (ref && ref.instance) {\n            ref.instance.id = this.id;\n            ref.instance.settings = {...this.settings};\n            ref.instance.context = this.queryBuilder;\n            if (this.value) {\n                ref.instance.isActive = true;\n                ref.instance.startValue = this.value;\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        if (this.componentRef) {\n            this.componentRef.destroy();\n            this.componentRef = null;\n        }\n    }\n\n    applyInnerWidget() {\n        this.componentRef.instance.submitValues();\n    }\n\n    setValue(currentValue: string | Object) {\n        this.componentRef.instance.isActive = true;\n        this.componentRef.instance.setValue(currentValue);\n    }\n\n    hasValueSelected() {\n        return this.componentRef.instance.hasValidValue();\n    }\n\n    getCurrentValue() {\n        return this.componentRef.instance.getCurrentValue();\n    }\n\n    getDisplayValue(): Observable<string> | null {\n        if (!this.componentRef?.instance) {\n            return null;\n        }\n        return this.componentRef.instance.displayValue$;\n    }\n\n    resetInnerWidget() {\n        if (this.componentRef && this.componentRef.instance) {\n            this.componentRef.instance.reset();\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AlfrescoApiService, AppConfigService } from '@alfresco/adf-core';\nimport { SearchConfiguration } from '../models/search-configuration.interface';\nimport { BaseQueryBuilderService } from './base-query-builder.service';\n\n@Injectable()\nexport class SearchQueryBuilderService extends BaseQueryBuilderService {\n\n    public isFilterServiceActive(): boolean {\n        return false;\n    }\n\n    constructor(appConfig: AppConfigService, alfrescoApiService: AlfrescoApiService) {\n        super(appConfig, alfrescoApiService);\n    }\n\n    public loadConfiguration(): SearchConfiguration {\n        return this.appConfig.get<SearchConfiguration>('search');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Inject, Injectable, OnDestroy } from '@angular/core';\nimport { FacetField } from '../models/facet-field.interface';\nimport { Subject } from 'rxjs';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../search-query-service.token';\nimport { SearchQueryBuilderService } from './search-query-builder.service';\nimport { SearchService, TranslationService } from '@alfresco/adf-core';\nimport { takeUntil } from 'rxjs/operators';\nimport { GenericBucket, GenericFacetResponse, ResultSetContext, ResultSetPaging } from '@alfresco/js-api';\nimport { SearchFilterList } from '../models/search-filter-list.model';\nimport { FacetFieldBucket } from '../models/facet-field-bucket.interface';\n\nexport interface SelectedBucket {\n    field: FacetField;\n    bucket: FacetFieldBucket;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class SearchFacetFiltersService implements OnDestroy {\n\n    /** All facet field items to be displayed in the component. These are updated according to the response.\n     *  When a new search is performed, the already existing items are updated with the new bucket count values and\n     *  the newly received items are added to the responseFacets.\n     */\n    responseFacets: FacetField[] = null;\n\n    /** shows the facet chips */\n    selectedBuckets: SelectedBucket[] = [];\n\n    private DEFAULT_PAGE_SIZE = 5;\n    private readonly facetQueriesPageSize = this.DEFAULT_PAGE_SIZE;\n    private readonly onDestroy$ = new Subject<boolean>();\n\n    constructor(@Inject(SEARCH_QUERY_SERVICE_TOKEN) public queryBuilder: SearchQueryBuilderService,\n                private searchService: SearchService,\n                private translationService: TranslationService) {\n        if (queryBuilder.config && queryBuilder.config.facetQueries) {\n            this.facetQueriesPageSize = queryBuilder.config.facetQueries.pageSize || this.DEFAULT_PAGE_SIZE;\n        }\n\n        this.queryBuilder.configUpdated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(() => {\n                this.selectedBuckets = [];\n                this.responseFacets = null;\n            });\n\n        this.queryBuilder.updated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((query) => this.queryBuilder.execute(query));\n\n        this.queryBuilder.executed\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((resultSetPaging: ResultSetPaging) => {\n                this.onDataLoaded(resultSetPaging);\n                this.searchService.dataLoaded.next(resultSetPaging);\n            });\n    }\n\n    onDataLoaded(data: any) {\n        const context = data.list.context;\n\n        if (context) {\n            this.parseFacets(context);\n        } else {\n            this.responseFacets = null;\n        }\n    }\n\n    private parseFacets(context: ResultSetContext) {\n        this.parseFacetFields(context);\n        this.parseFacetIntervals(context);\n        this.parseFacetQueries(context);\n    }\n\n    private parseFacetItems(context: ResultSetContext, configFacetFields: FacetField[], itemType: string) {\n        configFacetFields.forEach((field) => {\n            const responseField = this.findFacet(context, itemType, field.label);\n            const responseBuckets = this.getResponseBuckets(responseField, field)\n                .filter(this.getFilterByMinCount(field.mincount));\n            const alreadyExistingField = this.findResponseFacet(itemType, field.label);\n\n            if (alreadyExistingField) {\n                const alreadyExistingBuckets = alreadyExistingField.buckets && alreadyExistingField.buckets.items || [];\n\n                this.updateExistingBuckets(responseField, responseBuckets, alreadyExistingField, alreadyExistingBuckets);\n            } else if (responseField) {\n                if (responseBuckets.length > 0) {\n                    const bucketList = new SearchFilterList<FacetFieldBucket>(responseBuckets, field.pageSize);\n                    bucketList.filter = this.getBucketFilterFunction(bucketList);\n\n                    if (!this.responseFacets) {\n                        this.responseFacets = [];\n                    }\n                    this.responseFacets.push(<FacetField> {\n                        ...field,\n                        type: responseField.type || itemType,\n                        label: field.label,\n                        pageSize: field.pageSize | this.DEFAULT_PAGE_SIZE,\n                        currentPageSize: field.pageSize | this.DEFAULT_PAGE_SIZE,\n                        buckets: bucketList\n                    });\n                }\n            }\n        });\n    }\n\n    private parseFacetFields(context: ResultSetContext) {\n        const configFacetFields = this.queryBuilder.config.facetFields && this.queryBuilder.config.facetFields.fields || [];\n        this.parseFacetItems(context, configFacetFields, 'field');\n    }\n\n    private parseFacetIntervals(context: ResultSetContext) {\n        const configFacetIntervals = this.queryBuilder.config.facetIntervals && this.queryBuilder.config.facetIntervals.intervals || [];\n        this.parseFacetItems(context, configFacetIntervals, 'interval');\n    }\n\n    private parseFacetQueries(context: ResultSetContext) {\n        const facetQuerySetting = this.queryBuilder.config.facetQueries?.settings || {};\n        const configFacetQueries = this.queryBuilder.config.facetQueries && this.queryBuilder.config.facetQueries.queries || [];\n        const configGroups = configFacetQueries.reduce((acc, query) => {\n            const group = this.queryBuilder.getQueryGroup(query);\n            if (acc[group]) {\n                acc[group].push(query);\n            } else {\n                acc[group] = [query];\n            }\n            return acc;\n        }, []);\n\n        const mincount = this.queryBuilder.config.facetQueries && this.queryBuilder.config.facetQueries.mincount;\n        const mincountFilter = this.getFilterByMinCount(mincount);\n\n        Object.keys(configGroups).forEach((group) => {\n            const responseField = this.findFacet(context, 'query', group);\n            const responseBuckets = this.getResponseQueryBuckets(responseField, configGroups[group])\n                .filter(mincountFilter);\n            const alreadyExistingField = this.findResponseFacet('query', group);\n\n            if (alreadyExistingField) {\n                const alreadyExistingBuckets = alreadyExistingField.buckets && alreadyExistingField.buckets.items || [];\n\n                this.updateExistingBuckets(responseField, responseBuckets, alreadyExistingField, alreadyExistingBuckets);\n            } else if (responseField) {\n                if (responseBuckets.length > 0) {\n                    const bucketList = new SearchFilterList<FacetFieldBucket>(responseBuckets, this.facetQueriesPageSize);\n                    bucketList.filter = this.getBucketFilterFunction(bucketList);\n\n                    if (!this.responseFacets) {\n                        this.responseFacets = [];\n                    }\n                    this.responseFacets.push(<FacetField> {\n                        field: group,\n                        type: responseField.type || 'query',\n                        label: group,\n                        pageSize: this.DEFAULT_PAGE_SIZE,\n                        currentPageSize: this.DEFAULT_PAGE_SIZE,\n                        buckets: bucketList,\n                        settings: facetQuerySetting\n                    });\n                }\n            }\n        });\n\n    }\n\n    private getResponseBuckets(responseField: GenericFacetResponse, configField: FacetField): FacetFieldBucket[] {\n        return ((responseField && responseField.buckets) || []).map((respBucket) => {\n\n            respBucket['count'] = this.getCountValue(respBucket);\n            respBucket.filterQuery = respBucket.filterQuery || this.getCorrespondingFilterQuery(configField, respBucket.label);\n            return <FacetFieldBucket> {\n                ...respBucket,\n                checked: false,\n                display: respBucket.display,\n                label: respBucket.label\n            };\n        });\n    }\n\n    private getResponseQueryBuckets(responseField: GenericFacetResponse, configGroup: any): FacetFieldBucket[] {\n        return (configGroup || []).map((query) => {\n            const respBucket = ((responseField && responseField.buckets) || [])\n                .find((bucket) => bucket.label === query.label) || {};\n\n            respBucket['count'] = this.getCountValue(respBucket);\n            return <FacetFieldBucket> {\n                ...respBucket,\n                checked: false,\n                display: respBucket.display,\n                label: respBucket.label\n            };\n        });\n    }\n\n    private getCountValue(bucket: GenericBucket): number {\n        return (!!bucket && !!bucket.metrics && bucket.metrics[0]?.value?.count) || 0;\n    }\n\n    getBucketCountDisplay(bucket: FacetFieldBucket): string {\n        return bucket.count === null ? '' : `(${bucket.count})`;\n    }\n\n    private getFilterByMinCount(mincountInput: number) {\n        return (bucket) => {\n            let mincount = mincountInput;\n            if (mincount === undefined) {\n                mincount = 1;\n            }\n            return bucket.count >= mincount;\n        };\n    }\n\n    private getCorrespondingFilterQuery(configFacetItem: FacetField, bucketLabel: string): string {\n        let filterQuery = null;\n\n        if (configFacetItem.field && bucketLabel) {\n\n            if (configFacetItem.sets) {\n                const configSet = configFacetItem.sets.find((set) => bucketLabel === set.label);\n\n                if (configSet) {\n                    filterQuery = this.buildIntervalQuery(configFacetItem.field, configSet);\n                }\n\n            } else {\n                filterQuery = `${configFacetItem.field}:\"${bucketLabel}\"`;\n            }\n        }\n\n        return filterQuery;\n    }\n\n    private buildIntervalQuery(fieldName: string, interval: any): string {\n        const start = interval.start;\n        const end = interval.end;\n        const startLimit = (interval.startInclusive === undefined || interval.startInclusive === true) ? '[' : '<';\n        const endLimit = (interval.endInclusive === undefined || interval.endInclusive === true) ? ']' : '>';\n\n        return `${fieldName}:${startLimit}\"${start}\" TO \"${end}\"${endLimit}`;\n    }\n\n    private findFacet(context: ResultSetContext, itemType: string, fieldLabel: string): GenericFacetResponse {\n        return (context.facets || []).find((response) => response.type === itemType && response.label === fieldLabel) || {};\n    }\n\n    private findResponseFacet(itemType: string, fieldLabel: string): FacetField {\n        return (this.responseFacets || []).find((response) => response.type === itemType && response.label === fieldLabel);\n    }\n\n    private updateExistingBuckets(responseField, responseBuckets, alreadyExistingField, alreadyExistingBuckets) {\n        const bucketsToDelete = [];\n\n        alreadyExistingBuckets\n            .map((bucket) => {\n                const responseBucket = ((responseField && responseField.buckets) || []).find((respBucket) => respBucket.label === bucket.label);\n\n                if (!responseBucket) {\n                    bucketsToDelete.push(bucket);\n                }\n                bucket.count = this.getCountValue(responseBucket);\n                return bucket;\n            });\n\n        const hasSelection = this.selectedBuckets\n            .find((selBuckets) => alreadyExistingField.label === selBuckets.field.label && alreadyExistingField.type === selBuckets.field.type);\n\n        if (!hasSelection && bucketsToDelete.length) {\n            bucketsToDelete.forEach((bucket) => {\n                alreadyExistingField.buckets.deleteItem(bucket);\n            });\n        }\n\n        responseBuckets.forEach((respBucket) => {\n            const existingBucket = alreadyExistingBuckets.find((oldBucket) => oldBucket.label === respBucket.label);\n\n            if (!existingBucket) {\n                alreadyExistingField.buckets.addItem(respBucket);\n            }\n        });\n    }\n\n    private getBucketFilterFunction(bucketList) {\n        return (bucket: FacetFieldBucket): boolean => {\n            if (bucket && bucketList.filterText) {\n                const pattern = (bucketList.filterText || '').toLowerCase();\n                const label = (this.translationService.instant(bucket.display) || this.translationService.instant(bucket.label)).toLowerCase();\n                return this.queryBuilder.config.filterWithContains ? label.indexOf(pattern) !== -1 : label.startsWith(pattern);\n            }\n            return true;\n        };\n    }\n\n    unselectFacetBucket(field: FacetField, bucket: FacetFieldBucket) {\n        if (bucket) {\n            bucket.checked = false;\n            this.queryBuilder.removeUserFacetBucket(field, bucket);\n            this.updateSelectedBuckets();\n            this.queryBuilder.update();\n        }\n    }\n\n    /* update adf-search-chip-list component view */\n    updateSelectedBuckets() {\n        if (this.responseFacets) {\n            this.selectedBuckets = [];\n            for (const field of this.responseFacets) {\n                if (field.buckets) {\n                    this.selectedBuckets.push(\n                        ...this.queryBuilder.getUserFacetBuckets(field.field)\n                            .filter((bucket) => bucket.checked)\n                            .map((bucket) => {\n                                return {field, bucket};\n                            })\n                    );\n                }\n            }\n        } else {\n            this.selectedBuckets = [];\n        }\n    }\n\n    ngOnDestroy(): void {\n        this.onDestroy$.next();\n        this.onDestroy$.complete();\n    }\n\n    resetAllSelectedBuckets() {\n        this.responseFacets.forEach((field) => {\n            if (field && field.buckets) {\n                for (const bucket of field.buckets.items) {\n                    bucket.checked = false;\n                    this.queryBuilder.removeUserFacetBucket(field, bucket);\n                }\n                this.updateSelectedBuckets();\n            }\n        });\n        this.queryBuilder.update();\n    }\n\n    resetQueryFragments() {\n        this.queryBuilder.queryFragments = {};\n        this.queryBuilder.resetToDefaults();\n    }\n\n    reset() {\n        this.responseFacets = [];\n        this.selectedBuckets = [];\n        this.queryBuilder.resetToDefaults();\n        this.queryBuilder.update();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, Input, ViewEncapsulation } from '@angular/core';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { FacetFieldBucket } from '../../models/facet-field-bucket.interface';\nimport { FacetField } from '../../models/facet-field.interface';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\nimport { SearchFacetFiltersService } from '../../services/search-facet-filters.service';\n\n@Component({\n    selector: 'adf-search-filter',\n    templateUrl: './search-filter.component.html',\n    styleUrls: ['./search-filter.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-filter' }\n})\nexport class SearchFilterComponent {\n\n    /** Toggles whether to show or not the context facet filters. */\n    @Input()\n    showContextFacets: boolean = true;\n\n    facetQueriesLabel: string = 'Facet Queries';\n    facetExpanded = {\n        'default': false\n    };\n    displayResetButton: boolean;\n\n    constructor(@Inject(SEARCH_QUERY_SERVICE_TOKEN) public queryBuilder: SearchQueryBuilderService,\n                public facetFiltersService: SearchFacetFiltersService) {\n        if (queryBuilder.config && queryBuilder.config.facetQueries) {\n            this.facetQueriesLabel = queryBuilder.config.facetQueries.label || 'Facet Queries';\n            this.facetExpanded['query'] = queryBuilder.config.facetQueries.expanded;\n        }\n        if (queryBuilder.config && queryBuilder.config.facetFields) {\n            this.facetExpanded['field'] = queryBuilder.config.facetFields.expanded;\n        }\n        if (queryBuilder.config && queryBuilder.config.facetIntervals) {\n            this.facetExpanded['interval'] = queryBuilder.config.facetIntervals.expanded;\n        }\n        this.displayResetButton = this.queryBuilder.config && !!this.queryBuilder.config.resetButton;\n    }\n\n    shouldExpand(field: FacetField): boolean {\n        return this.facetExpanded[field.type] || this.facetExpanded['default'];\n    }\n\n    getBucketCountDisplay(bucket: FacetFieldBucket): string {\n        return bucket.count === null ? '' : `(${bucket.count})`;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, ViewEncapsulation, Input } from '@angular/core';\nimport { SearchFilterComponent } from '../../components/search-filter/search-filter.component';\nimport { SearchFacetFiltersService } from '../../services/search-facet-filters.service';\n\n@Component({\n    selector: 'adf-search-chip-list',\n    templateUrl: './search-chip-list.component.html',\n    styleUrls: ['./search-chip-list.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-chip-list' }\n})\nexport class SearchChipListComponent {\n\n    @Input()\n    /** @deprecated This is not required since ADF 4.5.0 */\n    searchFilter: SearchFilterComponent;\n\n    /** Flag used to enable the display of a clear-all-filters button. */\n    @Input()\n    clearAll: boolean = false;\n\n    constructor(public facetFiltersService: SearchFacetFiltersService) {}\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { SearchCategory } from '../search/models/search-category.interface';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ContentNodeSelectorPanelService {\n\n    propertyTypes = ['d:text', 'd:date', 'd:datetime'];\n    modelPropertyTypeToSearchFilterTypeMap = new Map<string, string> ();\n    customModels: any[];\n\n    constructor() {\n        this.modelPropertyTypeToSearchFilterTypeMap.set(this.propertyTypes[0], 'text');\n        this.modelPropertyTypeToSearchFilterTypeMap.set(this.propertyTypes[1], 'date-range');\n        this.modelPropertyTypeToSearchFilterTypeMap.set(this.propertyTypes[2], 'datetime-range');\n    }\n\n    convertCustomModelPropertiesToSearchCategories(): SearchCategory[] {\n        const searchConfig: SearchCategory[] = [];\n        this.customModels?.forEach( (propertyModel) => {\n            searchConfig.push(this.convertModelPropertyIntoSearchFilter(propertyModel));\n        });\n\n        return searchConfig;\n    }\n\n    convertModelPropertyIntoSearchFilter(modelProperty: any): SearchCategory {\n        let filterSearch: SearchCategory;\n        if (this.isTypeSupported(modelProperty.dataType)) {\n            filterSearch = {\n                id : modelProperty.prefixedName,\n                name: modelProperty.prefixedName,\n                expanded: false,\n                enabled: true,\n                component: {\n                    selector: this.modelPropertyTypeToSearchFilterTypeMap.get(modelProperty.dataType),\n                    settings: {\n                        pattern: `${modelProperty.prefixedName}:'(.*?)'`,\n                        field: `${modelProperty.prefixedName}`,\n                        placeholder: `Enter the ${modelProperty.name}`\n                    }\n                }\n            };\n        }\n        return filterSearch;\n    }\n\n    isTypeSupported(dataType: string): boolean {\n        return this.propertyTypes.includes(dataType);\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, OnInit, ViewEncapsulation } from '@angular/core';\nimport { ContentNodeSelectorPanelService } from '../../../content-node-selector/content-node-selector-panel.service';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\n\n@Component({\n    selector: 'adf-search-panel',\n    templateUrl: './search-panel.component.html',\n    styleUrls: ['./search-panel.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-panel' }\n\n})\nexport class SearchPanelComponent implements OnInit {\n\n    constructor(private contentNodeSelectorPanelService: ContentNodeSelectorPanelService,\n                @Inject(SEARCH_QUERY_SERVICE_TOKEN) private queryBuilderService: SearchQueryBuilderService) {\n    }\n\n    ngOnInit(): void {\n        this.queryBuilderService.categories = this.contentNodeSelectorPanelService.convertCustomModelPropertiesToSearchCategories();\n    }\n\n    hasCustomModels(): boolean {\n        return this.contentNodeSelectorPanelService?.customModels?.length > 0;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, OnInit, ViewEncapsulation, Inject } from '@angular/core';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { SearchSortingDefinition } from '../../models/search-sorting-definition.interface';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\n\n@Component({\n    selector: 'adf-search-sorting-picker',\n    templateUrl: './search-sorting-picker.component.html',\n    styleUrls: ['./search-sorting-picker.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-search-sorting-picker' }\n})\nexport class SearchSortingPickerComponent implements OnInit {\n\n    options: SearchSortingDefinition[] = [];\n    value: string;\n    ascending: boolean;\n\n    constructor(@Inject(SEARCH_QUERY_SERVICE_TOKEN) private queryBuilder: SearchQueryBuilderService) {}\n\n    ngOnInit() {\n        this.options = this.queryBuilder.getSortingOptions();\n\n        const primary = this.queryBuilder.getPrimarySorting();\n        if (primary) {\n            this.value = primary.key;\n            this.ascending = primary.ascending;\n        }\n    }\n\n    onValueChanged(key: string) {\n        this.value = key;\n        this.ascending = this.getSortingOrder();\n        this.applySorting();\n    }\n\n    onSortingChanged(ascending: boolean) {\n        this.ascending = ascending;\n        this.applySorting();\n    }\n\n    private findOptionByKey(key: string): SearchSortingDefinition {\n        if (key) {\n            return this.options.find((opt) => opt.key === key);\n        }\n        return null;\n    }\n\n    private applySorting() {\n        const option = this.findOptionByKey(this.value);\n        if (option) {\n            this.queryBuilder.sorting = [{\n                ...option,\n                ascending: this.ascending\n            }];\n            this.queryBuilder.update();\n        }\n    }\n\n    private getSortingOrder(): boolean {\n        const option = this.findOptionByKey(this.value);\n        if (option) {\n            return option.ascending;\n        }\n\n        return this.queryBuilder.getPrimarySorting().ascending;\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    Input,\n    Output,\n    OnInit,\n    EventEmitter,\n    ViewEncapsulation,\n    ViewChild,\n    Inject,\n    OnDestroy,\n    ElementRef\n} from '@angular/core';\nimport { ConfigurableFocusTrapFactory, ConfigurableFocusTrap } from '@angular/cdk/a11y';\nimport { DataColumn, TranslationService } from '@alfresco/adf-core';\nimport { SearchWidgetContainerComponent } from '../search-widget-container/search-widget-container.component';\nimport { SearchHeaderQueryBuilderService } from '../../services/search-header-query-builder.service';\nimport { SearchCategory } from '../../models/search-category.interface';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\nimport { Subject } from 'rxjs';\nimport { MatMenuTrigger } from '@angular/material/menu';\n\n@Component({\n    selector: 'adf-search-filter-container',\n    templateUrl: './search-filter-container.component.html',\n    styleUrls: ['./search-filter-container.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class SearchFilterContainerComponent implements OnInit, OnDestroy {\n\n    /** The column the filter will be applied on. */\n    @Input()\n    col: DataColumn;\n\n    /** The column the filter will be applied on. */\n    @Input()\n    value: any;\n\n    /** Emitted when a filter value is selected */\n    @Output()\n    filterChange: EventEmitter<any> = new EventEmitter();\n\n    @ViewChild(SearchWidgetContainerComponent)\n    widgetContainer: SearchWidgetContainerComponent;\n\n    @ViewChild('filterContainer')\n    filterContainer: ElementRef;\n\n    category: SearchCategory;\n    focusTrap: ConfigurableFocusTrap;\n    initialValue: any;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(@Inject(SEARCH_QUERY_SERVICE_TOKEN) private searchFilterQueryBuilder: SearchHeaderQueryBuilderService,\n                private translationService: TranslationService,\n                private focusTrapFactory: ConfigurableFocusTrapFactory) {\n    }\n\n    ngOnInit() {\n        this.category = this.searchFilterQueryBuilder.getCategoryForColumn(this.col.key);\n        this.initialValue = this.value && this.value[this.col.key] ? this.value[this.col.key] : undefined;\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    onKeyPressed(event: KeyboardEvent, menuTrigger: MatMenuTrigger) {\n        if (event.key === 'Enter' && this.widgetContainer.selector !== 'check-list') {\n            this.onApply();\n            menuTrigger.closeMenu();\n        }\n    }\n\n    onApply() {\n        if (this.widgetContainer.hasValueSelected()) {\n            this.searchFilterQueryBuilder.setActiveFilter(this.category.columnKey, this.widgetContainer.getCurrentValue());\n            this.filterChange.emit();\n            this.widgetContainer.applyInnerWidget();\n        } else {\n            this.resetSearchFilter();\n        }\n    }\n\n    onClearButtonClick(event: Event) {\n        event.stopPropagation();\n        this.resetSearchFilter();\n    }\n\n    resetSearchFilter() {\n        this.widgetContainer.resetInnerWidget();\n        this.searchFilterQueryBuilder.removeActiveFilter(this.category.columnKey);\n        this.filterChange.emit();\n    }\n\n    getTooltipTranslation(columnTitle: string): string {\n        if (!columnTitle) {\n            columnTitle = 'SEARCH.SEARCH_HEADER.TYPE';\n        }\n        return this.translationService.instant('SEARCH.SEARCH_HEADER.FILTER_BY', { category: this.translationService.instant(columnTitle) });\n    }\n\n    isActive(): boolean {\n        return this.widgetContainer && this.widgetContainer.componentRef && this.widgetContainer.componentRef.instance.isActive;\n    }\n\n    onMenuOpen() {\n        if (this.filterContainer && !this.focusTrap) {\n            this.focusTrap = this.focusTrapFactory.create(this.filterContainer.nativeElement);\n            this.focusTrap.focusInitialElement();\n        }\n    }\n\n    onClosed() {\n        this.focusTrap.destroy();\n        this.focusTrap = null;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Inject, Output, ViewEncapsulation } from '@angular/core';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { SearchForm } from '../../models/search-form.interface';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\n\n@Component({\n  selector: 'adf-search-form',\n  templateUrl: './search-form.component.html',\n  styleUrls: ['./search-form.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class SearchFormComponent {\n\n    /** Emitted when the form change */\n    @Output()\n    formChange: EventEmitter<SearchForm> = new EventEmitter<SearchForm>();\n\n    constructor(@Inject(SEARCH_QUERY_SERVICE_TOKEN) public queryBuilder: SearchQueryBuilderService) {\n    }\n\n    onSelectionChange(form: SearchForm) {\n        this.queryBuilder.updateSelectedConfiguration(form.index);\n        this.formChange.emit(form);\n    }\n\n    getSelected(forms: SearchForm[]): string {\n        return forms.find((form) => form.selected)?.name;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, Input, ViewEncapsulation } from '@angular/core';\nimport { SearchFacetFiltersService } from '../../services/search-facet-filters.service';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\n\n@Component({\n    selector: 'adf-search-filter-chips',\n    templateUrl: './search-filter-chips.component.html',\n    styleUrls: ['./search-filter-chips.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class SearchFilterChipsComponent {\n    /** Toggles whether to show or not the context facet filters. */\n    @Input()\n    showContextFacets: boolean = true;\n\n    constructor(\n        @Inject(SEARCH_QUERY_SERVICE_TOKEN)\n        public queryBuilder: SearchQueryBuilderService,\n        public facetFiltersService: SearchFacetFiltersService) {}\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Output, ViewEncapsulation } from '@angular/core';\n\n@Component({\n  selector: 'adf-search-filter-menu-card',\n  templateUrl: './search-filter-menu-card.component.html',\n  styleUrls: ['./search-filter-menu-card.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class SearchFilterMenuCardComponent {\n    @Output()\n    close = new EventEmitter();\n\n    onClose() {\n        this.close.emit();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, Input, ViewEncapsulation } from '@angular/core';\nimport { FacetField } from '../../models/facet-field.interface';\nimport { MatCheckboxChange } from '@angular/material/checkbox';\nimport { FacetFieldBucket } from '../../models/facet-field-bucket.interface';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../../search-query-service.token';\nimport { SearchQueryBuilderService } from '../../services/search-query-builder.service';\nimport { SearchFacetFiltersService } from '../../services/search-facet-filters.service';\nimport { FacetWidget } from '../../models/facet-widget.interface';\nimport { TranslationService } from '@alfresco/adf-core';\nimport { Subject } from 'rxjs';\n\n@Component({\n    selector: 'adf-search-facet-field',\n    templateUrl: './search-facet-field.component.html',\n    styleUrls: ['./search-facet-field.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class SearchFacetFieldComponent implements FacetWidget {\n\n    @Input()\n    field!: FacetField;\n\n    displayValue$: Subject<string> = new Subject<string>();\n\n    constructor(@Inject(SEARCH_QUERY_SERVICE_TOKEN) public queryBuilder: SearchQueryBuilderService,\n                private searchFacetFiltersService: SearchFacetFiltersService,\n                private translationService: TranslationService) {\n    }\n\n    get canUpdateOnChange() {\n       return  this.field.settings?.allowUpdateOnChange ?? true;\n    }\n\n    onToggleBucket(event: MatCheckboxChange, field: FacetField, bucket: FacetFieldBucket) {\n        if (event && bucket) {\n            if (event.checked) {\n                this.selectFacetBucket(field, bucket);\n            } else {\n                this.unselectFacetBucket(field, bucket);\n            }\n        }\n    }\n\n    selectFacetBucket(field: FacetField, bucket: FacetFieldBucket) {\n        if (bucket) {\n            bucket.checked = true;\n            this.queryBuilder.addUserFacetBucket(field, bucket);\n            this.searchFacetFiltersService.updateSelectedBuckets();\n            if (this.canUpdateOnChange) {\n                this.updateDisplayValue();\n                this.queryBuilder.update();\n            }\n        }\n    }\n\n    unselectFacetBucket(field: FacetField, bucket: FacetFieldBucket) {\n        if (bucket) {\n            bucket.checked = false;\n            this.queryBuilder.removeUserFacetBucket(field, bucket);\n            this.searchFacetFiltersService.updateSelectedBuckets();\n            if (this.canUpdateOnChange) {\n                this.updateDisplayValue();\n                this.queryBuilder.update();\n            }\n        }\n    }\n\n    canResetSelectedBuckets(field: FacetField): boolean {\n        if (field && field.buckets) {\n            return field.buckets.items.some((bucket) => bucket.checked);\n        }\n        return false;\n    }\n\n    resetSelectedBuckets(field: FacetField) {\n        if (field && field.buckets) {\n            for (const bucket of field.buckets.items) {\n                bucket.checked = false;\n                this.queryBuilder.removeUserFacetBucket(field, bucket);\n            }\n            this.searchFacetFiltersService.updateSelectedBuckets();\n            if (this.canUpdateOnChange) {\n                this.queryBuilder.update();\n            }\n        }\n    }\n\n    getBucketCountDisplay(bucket: FacetFieldBucket): string {\n        return bucket.count === null ? '' : `(${bucket.count})`;\n    }\n\n    updateDisplayValue(): void {\n        if (!this.field.buckets?.items) {\n            this.displayValue$.next('');\n        } else {\n            const displayValue = this.field.buckets?.items?.filter((item) => item.checked)\n                .map((item) => this.translationService.instant(item.display || item.label))\n                .join(', ');\n            this.displayValue$.next(displayValue);\n        }\n    }\n\n    reset(): void {\n        this.resetSelectedBuckets(this.field);\n        this.updateDisplayValue();\n        this.queryBuilder.update();\n    }\n\n    submitValues(): void {\n        this.updateDisplayValue();\n        this.queryBuilder.update();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, ElementRef, Input, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { SearchCategory } from '../../../models/search-category.interface';\nimport { ConfigurableFocusTrap, ConfigurableFocusTrapFactory } from '@angular/cdk/a11y';\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport { SearchWidgetContainerComponent } from '../../search-widget-container/search-widget-container.component';\n\n@Component({\n  selector: 'adf-search-widget-chip',\n  templateUrl: './search-widget-chip.component.html',\n  encapsulation: ViewEncapsulation.None\n})\nexport class SearchWidgetChipComponent  {\n\n    @Input()\n    category: SearchCategory;\n\n    @ViewChild('menuContainer', { static: false })\n    menuContainer: ElementRef;\n\n    @ViewChild('menuTrigger', { static: false })\n    menuTrigger: MatMenuTrigger;\n\n    @ViewChild(SearchWidgetContainerComponent, { static: false })\n    widgetContainerComponent: SearchWidgetContainerComponent;\n\n    focusTrap: ConfigurableFocusTrap;\n\n    constructor(private focusTrapFactory: ConfigurableFocusTrapFactory) {}\n\n    onMenuOpen() {\n        if (this.menuContainer && !this.focusTrap) {\n            this.focusTrap = this.focusTrapFactory.create(this.menuContainer.nativeElement);\n            this.focusTrap.focusInitialElement();\n        }\n    }\n\n    onClosed() {\n        this.focusTrap.destroy();\n        this.focusTrap = null;\n    }\n\n    onRemove() {\n        this.widgetContainerComponent.resetInnerWidget();\n        this.menuTrigger.closeMenu();\n    }\n\n    onApply() {\n        this.widgetContainerComponent.applyInnerWidget();\n        this.menuTrigger.closeMenu();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, ElementRef, Input, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { ConfigurableFocusTrap, ConfigurableFocusTrapFactory } from '@angular/cdk/a11y';\nimport { FacetField } from '../../../models/facet-field.interface';\nimport { MatMenuTrigger } from '@angular/material/menu';\nimport { SearchFacetFieldComponent } from '../../search-facet-field/search-facet-field.component';\n\n@Component({\n  selector: 'adf-search-facet-chip',\n  templateUrl: './search-facet-chip.component.html',\n  encapsulation: ViewEncapsulation.None\n})\nexport class SearchFacetChipComponent {\n    @Input()\n    field: FacetField;\n\n    @ViewChild('menuContainer', { static: false })\n    menuContainer: ElementRef;\n\n    @ViewChild('menuTrigger', { static: false })\n    menuTrigger: MatMenuTrigger;\n\n    @ViewChild(SearchFacetFieldComponent, { static: false })\n    facetFieldComponent: SearchFacetFieldComponent;\n\n    focusTrap: ConfigurableFocusTrap;\n\n    constructor(private focusTrapFactory: ConfigurableFocusTrapFactory) {}\n\n    onMenuOpen() {\n        if (this.menuContainer && !this.focusTrap) {\n            this.focusTrap = this.focusTrapFactory.create(this.menuContainer.nativeElement);\n            this.focusTrap.focusInitialElement();\n        }\n    }\n\n    onClosed() {\n        this.focusTrap.destroy();\n        this.focusTrap = null;\n    }\n\n    onRemove() {\n        this.facetFieldComponent.reset();\n        this.menuTrigger.closeMenu();\n    }\n\n    onApply() {\n        this.facetFieldComponent.submitValues();\n        this.menuTrigger.closeMenu();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, HostListener } from '@angular/core';\nimport { SearchFacetFiltersService } from '../services/search-facet-filters.service';\n\n@Directive({\n  selector: '[adf-reset-search]'\n})\nexport class ResetSearchDirective {\n    @HostListener('click')\n    onClick() {\n        this.filterService.reset();\n    }\n\n    constructor(private filterService: SearchFacetFiltersService) { }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MaterialModule } from '../material.module';\n\nimport { CoreModule } from '@alfresco/adf-core';\n\nimport { SearchControlComponent } from './components/search-control.component';\nimport { SearchComponent } from './components/search.component';\nimport { EmptySearchResultComponent } from './components/empty-search-result.component';\nimport { SearchWidgetContainerComponent } from './components/search-widget-container/search-widget-container.component';\nimport { SearchFilterComponent } from './components/search-filter/search-filter.component';\nimport { SearchChipListComponent } from './components/search-chip-list/search-chip-list.component';\nimport { SearchTextComponent } from './components/search-text/search-text.component';\nimport { SearchRadioComponent } from './components/search-radio/search-radio.component';\nimport { SearchSliderComponent } from './components/search-slider/search-slider.component';\nimport { SearchNumberRangeComponent } from './components/search-number-range/search-number-range.component';\nimport { SearchPanelComponent } from './components/search-panel/search-panel.component';\nimport { SearchCheckListComponent } from './components/search-check-list/search-check-list.component';\nimport { SearchDateRangeComponent } from './components/search-date-range/search-date-range.component';\nimport { SearchSortingPickerComponent } from './components/search-sorting-picker/search-sorting-picker.component';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from './search-query-service.token';\nimport { SearchQueryBuilderService } from './services/search-query-builder.service';\nimport { SearchFilterContainerComponent } from './components/search-filter-container/search-filter-container.component';\nimport { SearchDatetimeRangeComponent } from './components/search-datetime-range/search-datetime-range.component';\nimport { SearchFormComponent } from './components/search-form/search-form.component';\nimport { SearchFilterChipsComponent } from './components/search-filter-chips/search-filter-chips.component';\nimport { SearchFilterMenuCardComponent } from './components/search-filter-chips/search-filter-menu-card/search-filter-menu-card.component';\nimport { SearchFacetFieldComponent } from './components/search-facet-field/search-facet-field.component';\nimport { SearchWidgetChipComponent } from './components/search-filter-chips/search-widget-chip/search-widget-chip.component';\nimport { SearchFacetChipComponent } from './components/search-filter-chips/search-facet-chip/search-facet-chip.component';\nimport { ResetSearchDirective } from './components/reset-search.directive';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MaterialModule,\n        CoreModule\n    ],\n    declarations: [\n        SearchComponent,\n        SearchControlComponent,\n        EmptySearchResultComponent,\n        SearchFilterComponent,\n        SearchChipListComponent,\n        SearchWidgetContainerComponent,\n        SearchTextComponent,\n        SearchRadioComponent,\n        SearchSliderComponent,\n        SearchNumberRangeComponent,\n        SearchPanelComponent,\n        SearchCheckListComponent,\n        SearchDateRangeComponent,\n        SearchDatetimeRangeComponent,\n        SearchSortingPickerComponent,\n        SearchFilterContainerComponent,\n        SearchFormComponent,\n        SearchFilterChipsComponent,\n        SearchFilterMenuCardComponent,\n        SearchFacetFieldComponent,\n        SearchWidgetChipComponent,\n        SearchFacetChipComponent,\n        ResetSearchDirective\n    ],\n    exports: [\n        SearchComponent,\n        SearchControlComponent,\n        EmptySearchResultComponent,\n        SearchFilterComponent,\n        SearchChipListComponent,\n        SearchWidgetContainerComponent,\n        SearchTextComponent,\n        SearchRadioComponent,\n        SearchSliderComponent,\n        SearchNumberRangeComponent,\n        SearchPanelComponent,\n        SearchCheckListComponent,\n        SearchDateRangeComponent,\n        SearchDatetimeRangeComponent,\n        SearchSortingPickerComponent,\n        SearchFilterContainerComponent,\n        SearchFormComponent,\n        SearchFilterChipsComponent,\n        SearchFilterMenuCardComponent,\n        SearchFacetFieldComponent,\n        ResetSearchDirective\n    ],\n    providers: [\n        { provide: SEARCH_QUERY_SERVICE_TOKEN, useExisting: SearchQueryBuilderService }\n    ]\n})\nexport class SearchModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnInit, Output, ViewEncapsulation } from '@angular/core';\nimport { SitesService, LogService, InfiniteSelectScrollDirective } from '@alfresco/adf-core';\nimport { SitePaging, SiteEntry } from '@alfresco/js-api';\nimport { MatSelectChange } from '@angular/material/select';\n\nexport enum Relations {\n    Members = 'members',\n    Containers = 'containers'\n}\n\n@Component({\n    selector: 'adf-sites-dropdown',\n    styleUrls: ['./sites-dropdown.component.scss'],\n    templateUrl: './sites-dropdown.component.html',\n    encapsulation: ViewEncapsulation.None,\n    host: { 'class': 'adf-sites-dropdown' }\n})\nexport class DropdownSitesComponent implements OnInit {\n\n    /** Hide the \"My Files\" option. */\n    @Input()\n    hideMyFiles: boolean = false;\n\n    /** A custom list of sites to be displayed by the dropdown. If no value\n     * is given, the sites of the current user are displayed by default. A\n     * list of objects only with properties 'title' and 'guid' is enough to\n     * be able to display the dropdown.\n     */\n    @Input()\n    siteList: SitePaging = null;\n\n    /** Id of the selected site */\n    @Input()\n    value: string = null;\n\n    /** Text or a translation key to act as a placeholder. Default value is the\n     * key \"DROPDOWN.PLACEHOLDER_LABEL\".\n     */\n    @Input()\n    placeholder: string = 'DROPDOWN.PLACEHOLDER_LABEL';\n\n    /** Filter for the results of the sites query. Possible values are\n     * \"members\" and \"containers\". When \"members\" is used, the site list\n     * will be restricted to the sites that the user is a member of.\n     */\n    @Input()\n    relations: string;\n\n    /** Emitted when the user selects a site. When the default option is selected,\n     * an empty model is emitted.\n     */\n    @Output()\n    change: EventEmitter<SiteEntry> = new EventEmitter();\n\n    private loading = true;\n    private skipCount = 0;\n\n    selected: SiteEntry = null;\n    MY_FILES_VALUE = '-my-';\n\n    constructor(private sitesService: SitesService,\n                private logService: LogService) {\n    }\n\n    ngOnInit() {\n        if (!this.siteList) {\n            this.loadSiteList();\n        }\n    }\n\n    loadAllOnScroll() {\n        if (this.isInfiniteScrollingEnabled()) {\n            this.loading = true;\n            this.loadSiteList();\n        }\n    }\n\n    selectedSite(event: MatSelectChange) {\n        this.change.emit(event.value);\n    }\n\n    private loadSiteList() {\n        const extendedOptions: any = {\n            skipCount: this.skipCount,\n            maxItems: InfiniteSelectScrollDirective.MAX_ITEMS\n        };\n\n        this.skipCount += InfiniteSelectScrollDirective.MAX_ITEMS;\n\n        if (this.relations) {\n            extendedOptions.relations = [this.relations];\n        }\n\n        this.sitesService.getSites(extendedOptions).subscribe((sitePaging: SitePaging) => {\n\n                if (!this.siteList) {\n                    this.siteList = this.relations === Relations.Members ? this.filteredResultsByMember(sitePaging) : sitePaging;\n\n                    if (!this.hideMyFiles) {\n                        const siteEntry = new SiteEntry({\n                            entry: {\n                                id: this.MY_FILES_VALUE,\n                                guid: this.MY_FILES_VALUE,\n                                title: 'DROPDOWN.MY_FILES_OPTION'\n                            }\n                        });\n\n                        this.siteList.list.entries.unshift(siteEntry);\n\n                        if (!this.value) {\n                            this.value = this.MY_FILES_VALUE;\n                        }\n                    }\n\n                } else {\n                    const siteList: SitePaging = this.relations === Relations.Members ? this.filteredResultsByMember(sitePaging) : sitePaging;\n\n                    this.siteList.list.entries = this.siteList.list.entries.concat(siteList.list.entries);\n                    this.siteList.list.pagination = sitePaging.list.pagination;\n                }\n\n                this.selected = this.siteList.list.entries.find((site: SiteEntry) => site.entry.id === this.value);\n\n                if (this.value && !this.selected && this.siteListHasMoreItems()) {\n                    this.loadSiteList();\n                }\n\n                this.loading = false;\n            },\n            (error) => {\n                this.logService.error(error);\n            });\n    }\n\n    showLoading(): boolean {\n        return this.loading && this.siteListHasMoreItems();\n    }\n\n    isInfiniteScrollingEnabled(): boolean {\n        return !this.loading && this.siteListHasMoreItems();\n    }\n\n    private siteListHasMoreItems(): boolean {\n        return this.siteList && this.siteList.list.pagination && this.siteList.list.pagination.hasMoreItems;\n    }\n\n    private filteredResultsByMember(sites: SitePaging): SitePaging {\n        const loggedUserName = this.sitesService.getEcmCurrentLoggedUserName();\n        sites.list.entries = sites.list.entries.filter((site) => this.isCurrentUserMember(site, loggedUserName));\n        return sites;\n    }\n\n    private isCurrentUserMember(site, loggedUserName): boolean {\n        return site.entry.visibility === 'PUBLIC' ||\n            !!site.relations.members.list.entries.find((member) => {\n                return member.entry.id.toLowerCase() === loggedUserName.toLowerCase();\n            });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FlexLayoutModule } from '@angular/flex-layout';\nimport { CoreModule, EditJsonDialogModule } from '@alfresco/adf-core';\n\nimport { MaterialModule } from '../material.module';\nimport { UploadModule } from '../upload/upload.module';\n\nimport { ContentActionListComponent } from './components/content-action/content-action-list.component';\nimport { ContentActionComponent } from './components/content-action/content-action.component';\nimport { DocumentListComponent } from './components/document-list.component';\n\nimport { TrashcanNameColumnComponent } from './components/trashcan-name-column/trashcan-name-column.component';\nimport { LibraryStatusColumnComponent } from './components/library-status-column/library-status-column.component';\nimport { LibraryRoleColumnComponent } from './components/library-role-column/library-role-column.component';\nimport { LibraryNameColumnComponent } from './components/library-name-column/library-name-column.component';\nimport { NameColumnComponent } from './components/name-column/name-column.component';\nimport { FilterHeaderComponent } from './components/filter-header/filter-header.component';\nimport { SearchModule } from './../search/search.module';\n\n@NgModule({\n    imports: [\n        CoreModule,\n        CommonModule,\n        FlexLayoutModule,\n        MaterialModule,\n        UploadModule,\n        EditJsonDialogModule,\n        SearchModule\n    ],\n    declarations: [\n        DocumentListComponent,\n        TrashcanNameColumnComponent,\n        LibraryStatusColumnComponent,\n        LibraryRoleColumnComponent,\n        LibraryNameColumnComponent,\n        NameColumnComponent,\n        ContentActionComponent,\n        ContentActionListComponent,\n        FilterHeaderComponent\n    ],\n    exports: [\n        DocumentListComponent,\n        TrashcanNameColumnComponent,\n        LibraryStatusColumnComponent,\n        LibraryRoleColumnComponent,\n        LibraryNameColumnComponent,\n        NameColumnComponent,\n        ContentActionComponent,\n        ContentActionListComponent,\n        FilterHeaderComponent\n    ]\n})\nexport class DocumentListModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { DropdownSitesComponent } from './sites-dropdown.component';\nimport { CoreModule } from '@alfresco/adf-core';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        FormsModule,\n        ReactiveFormsModule,\n        CoreModule\n    ],\n    exports: [\n        DropdownSitesComponent\n    ],\n    declarations: [\n        DropdownSitesComponent\n    ]\n})\nexport class SitesDropdownModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    EventEmitter,\n    Input,\n    OnChanges,\n    OnInit,\n    Output,\n    ViewChild,\n    ViewEncapsulation,\n    OnDestroy\n} from '@angular/core';\nimport { MatSelect } from '@angular/material/select';\nimport { Node, PathElementEntity } from '@alfresco/js-api';\nimport { DocumentListComponent } from '../document-list';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-breadcrumb',\n    templateUrl: './breadcrumb.component.html',\n    styleUrls: ['./breadcrumb.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { 'class': 'adf-breadcrumb' }\n})\nexport class BreadcrumbComponent implements OnInit, OnChanges, OnDestroy {\n\n    /** Active node, builds UI based on folderNode.path.elements collection. */\n    @Input()\n    folderNode: Node = null;\n\n    /** (optional) Name of the root element of the breadcrumb. You can use\n     * this property to rename \"Company Home\" to \"Personal Files\" for\n     * example. You can use an i18n resource key for the property value.\n     */\n    @Input()\n    root: string = null;\n\n    /** (optional) The id of the root element. You can use this property\n     * to set a custom element the breadcrumb should start with.\n     */\n    @Input()\n    rootId: string = null;\n\n    /** (optional) Document List component to operate with. The list will\n     * update when the breadcrumb is clicked.\n     */\n    @Input()\n    target: DocumentListComponent;\n\n    /** Transformation to be performed on the chosen/folder node before building\n     * the breadcrumb UI. Can be useful when custom formatting is needed for the\n     * breadcrumb. You can change the path elements from the node that are used to\n     * build the breadcrumb using this function.\n     */\n    @Input()\n    transform: (node) => any;\n\n    @ViewChild('dropdown')\n    dropdown: MatSelect;\n\n    /** Maximum number of nodes to display before wrapping them with a dropdown element.  */\n    @Input()\n    maxItems: number;\n\n    previousNodes: PathElementEntity[];\n    lastNodes: PathElementEntity[];\n\n    route: PathElementEntity[] = [];\n\n    private onDestroy$ = new Subject<boolean>();\n\n    get hasRoot(): boolean {\n        return !!this.root;\n    }\n\n    /** If true, prevents the user from navigating away from the active node. */\n    @Input()\n    readOnly: boolean = false;\n\n    /** Emitted when the user clicks on a breadcrumb. */\n    @Output()\n    navigate = new EventEmitter<PathElementEntity>();\n\n    ngOnInit() {\n        this.transform = this.transform ? this.transform : null;\n\n        if (this.target) {\n            this.target.$folderNode\n                .pipe(takeUntil(this.onDestroy$))\n                .subscribe((folderNode: Node) => {\n                    this.folderNode = folderNode;\n                    this.recalculateNodes();\n                });\n        }\n    }\n\n    ngOnChanges(): void {\n        this.recalculateNodes();\n    }\n\n    protected recalculateNodes(): void {\n        const node: Node = this.transform ? this.transform(this.folderNode) : this.folderNode;\n\n        this.route = this.parseRoute(node);\n\n        if (this.maxItems && this.route.length > this.maxItems) {\n            this.lastNodes = this.route.slice(this.route.length - this.maxItems);\n            this.previousNodes = this.route.slice(0, this.route.length - this.maxItems);\n            this.previousNodes.reverse();\n        } else {\n            this.lastNodes = this.route;\n            this.previousNodes = null;\n        }\n    }\n\n    open(): void {\n        if (this.dropdown) {\n            this.dropdown.open();\n            this.dropdown.focus();\n        }\n    }\n\n    hasPreviousNodes(): boolean {\n        return !!this.previousNodes;\n    }\n\n    parseRoute(node: Node): PathElementEntity[] {\n        if (node && node.path) {\n            const route = <PathElementEntity[]> (node.path.elements || []).slice();\n\n            route.push(<PathElementEntity> {\n                id: node.id,\n                name: node.name,\n                node: node\n            });\n\n            const rootPos = this.getElementPosition(route, this.rootId);\n            if (rootPos > 0) {\n                route.splice(0, rootPos);\n            }\n\n            if (rootPos === -1 && this.rootId) {\n                route[0].id = this.rootId;\n            }\n\n            if (this.root) {\n                route[0].name = this.root;\n            }\n\n            return route;\n        }\n\n        return [];\n    }\n\n    private getElementPosition(route: PathElementEntity[], nodeId: string): number {\n        let position: number = -1;\n\n        if (route && route.length > 0 && nodeId) {\n            position = route.findIndex((el) => el.id === nodeId);\n        }\n\n        return position;\n    }\n\n    breadcrumbItemIsAnchor(lastItem): boolean {\n        return !this.readOnly && !lastItem;\n    }\n\n    onRoutePathClick(route: PathElementEntity, event?: Event): void {\n        if (event && event.type === 'click') {\n            event.preventDefault();\n        }\n\n        this.onRouteClick(route);\n    }\n\n    onRouteClick(route: PathElementEntity) {\n        if (route && !this.readOnly) {\n            this.navigate.emit(route);\n\n            if (this.target) {\n                this.target.navigateTo(route.id);\n            }\n        }\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, OnChanges, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { MatSelect } from '@angular/material/select';\nimport { PathElementEntity, Node } from '@alfresco/js-api';\nimport { BreadcrumbComponent } from './breadcrumb.component';\n\n@Component({\n    selector: 'adf-dropdown-breadcrumb',\n    templateUrl: './dropdown-breadcrumb.component.html',\n    styleUrls: ['./dropdown-breadcrumb.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { 'class': 'adf-dropdown-breadcrumb' }\n})\nexport class DropdownBreadcrumbComponent extends BreadcrumbComponent implements OnChanges {\n\n    @ViewChild('dropdown')\n    dropdown: MatSelect;\n\n    currentNode: PathElementEntity;\n    previousNodes: PathElementEntity[];\n\n    /**\n     * Calculate the current and previous nodes from the route array\n     */\n    protected recalculateNodes(): void {\n        const node: Node = this.transform ? this.transform(this.folderNode) : this.folderNode;\n\n        this.route = this.parseRoute(node);\n        this.currentNode = this.route[this.route.length - 1];\n        this.previousNodes = this.route.slice(0, this.route.length - 1).reverse();\n    }\n\n    /**\n     * Opens the node picker menu\n     */\n    open(): void {\n        if (this.dropdown) {\n            this.dropdown.open();\n            this.dropdown.focus();\n        }\n    }\n\n    /**\n     * Return if route has more than one element (means: we are not in the root directory)\n     */\n    hasPreviousNodes(): boolean {\n        return this.previousNodes.length > 0;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\n\nimport { BreadcrumbComponent } from './breadcrumb.component';\nimport { DropdownBreadcrumbComponent } from './dropdown-breadcrumb.component';\nimport { CoreModule } from '@alfresco/adf-core';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        CoreModule\n    ],\n    exports: [\n        BreadcrumbComponent,\n        DropdownBreadcrumbComponent\n    ],\n    declarations: [\n        BreadcrumbComponent,\n        DropdownBreadcrumbComponent\n    ]\n})\nexport class BreadcrumbModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, ViewEncapsulation, SecurityContext } from '@angular/core';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { DomSanitizer } from '@angular/platform-browser';\n\nexport interface ConfirmDialogComponentProps {\n    title?: string;\n    message?: string;\n    yesLabel?: string;\n    thirdOptionLabel?: string;\n    noLabel?: string;\n    htmlContent?: string;\n}\n\n@Component({\n    selector: 'adf-confirm-dialog',\n    templateUrl: './confirm.dialog.html',\n    styleUrls: ['./confirm.dialog.scss'],\n    host: { 'class': 'adf-confirm-dialog' },\n    encapsulation: ViewEncapsulation.None\n})\nexport class ConfirmDialogComponent {\n\n    title: string;\n    message: string;\n    yesLabel: string;\n    noLabel: string;\n    thirdOptionLabel: string;\n    htmlContent: string;\n\n    constructor(@Inject(MAT_DIALOG_DATA) data: ConfirmDialogComponentProps, private sanitizer: DomSanitizer) {\n        data = data || {};\n        this.title = data.title || 'ADF_CONFIRM_DIALOG.CONFIRM';\n        this.message = data.message || 'ADF_CONFIRM_DIALOG.MESSAGE';\n        this.yesLabel = data.yesLabel || 'ADF_CONFIRM_DIALOG.YES_LABEL';\n        this.thirdOptionLabel = data.thirdOptionLabel;\n        this.noLabel = data.noLabel || 'ADF_CONFIRM_DIALOG.NO_LABEL';\n        this.htmlContent = data.htmlContent;\n    }\n\n    sanitizedHtmlContent(): string {\n        return this.sanitizer.sanitize(SecurityContext.HTML, this.htmlContent);\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { ContentApi } from '@alfresco/js-api';\nimport { Observable, of } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class ContentVersionService {\n    private _contentApi: ContentApi;\n\n    get contentApi(): ContentApi {\n        if (!this._contentApi) {\n            this._contentApi = new ContentApi(this.alfrescoApi.getInstance());\n        }\n        return this._contentApi;\n    }\n\n    constructor(private alfrescoApi: AlfrescoApiService) {}\n\n    /**\n     * Get content URL for the given nodeId and specific version.\n     * @param nodeId The ID of the node\n     * @param versionId The ID of the version\n     * @param attachment Retrieve content as an attachment for download\n     * @returns The URL address pointing to the content.\n     */\n    getVersionContentUrl(nodeId: string, versionId: string, attachment?: boolean): Observable<string> {\n        let nodeDownloadUrl = this.contentApi.getContentUrl(nodeId, attachment);\n        nodeDownloadUrl = nodeDownloadUrl.replace('/content', '/versions/' + versionId + '/content');\n\n        return of(nodeDownloadUrl);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AlfrescoApiService, ContentService } from '@alfresco/adf-core';\nimport { Component, Input, OnChanges, ViewEncapsulation, EventEmitter, Output } from '@angular/core';\nimport { VersionsApi, Node, VersionEntry, VersionPaging, NodesApi, NodeEntry, ContentApi } from '@alfresco/js-api';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ConfirmDialogComponent } from '../dialogs/confirm.dialog';\nimport { ContentVersionService } from './content-version.service';\n\n@Component({\n    selector: 'adf-version-list',\n    templateUrl: './version-list.component.html',\n    styleUrls: ['./version-list.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: {\n        'class': 'adf-version-list'\n    }\n})\nexport class VersionListComponent implements OnChanges {\n\n    _contentApi: ContentApi;\n    get contentApi(): ContentApi {\n        this._contentApi = this._contentApi ?? new ContentApi(this.alfrescoApi.getInstance());\n        return this._contentApi;\n    }\n\n    _versionsApi: VersionsApi;\n    get versionsApi(): VersionsApi {\n        this._versionsApi = this._versionsApi ?? new VersionsApi(this.alfrescoApi.getInstance());\n        return this._versionsApi;\n    }\n\n    _nodesApi: NodesApi;\n    get nodesApi(): NodesApi {\n        this._nodesApi = this._nodesApi ?? new NodesApi(this.alfrescoApi.getInstance());\n        return this._nodesApi;\n    }\n\n    versions: VersionEntry[] = [];\n    isLoading = true;\n\n    /** The target node. */\n    @Input()\n    node: Node;\n\n    /** Toggles showing/hiding of comments */\n    @Input()\n    showComments = true;\n\n    /** Enable/disable downloading a version of the current node. */\n    @Input()\n    allowDownload = true;\n\n    /** Enable/disable viewing a version of the current node. */\n    @Input()\n    allowViewVersions = true;\n\n    /** Toggles showing/hiding of version actions */\n    @Input()\n    showActions = true;\n\n    /** Emitted when a version is restored */\n    @Output()\n    restored = new EventEmitter<Node>();\n\n    /** Emitted when a version is deleted */\n    @Output()\n    deleted = new EventEmitter<Node>();\n\n    /** Emitted when viewing a version */\n    @Output()\n    viewVersion = new EventEmitter<string>();\n\n    constructor(private alfrescoApi: AlfrescoApiService,\n                private contentService: ContentService,\n                private contentVersionService: ContentVersionService,\n                private dialog: MatDialog) {\n    }\n\n    ngOnChanges() {\n        this.loadVersionHistory();\n    }\n\n    canUpdate(): boolean {\n        return this.contentService.hasAllowableOperations(this.node, 'update') && this.versions.length > 1;\n    }\n\n    canDelete(): boolean {\n        return this.contentService.hasAllowableOperations(this.node, 'delete') && this.versions.length > 1;\n    }\n\n    restore(versionId: string) {\n        if (this.canUpdate()) {\n            this.versionsApi\n                .revertVersion(this.node.id, versionId, { majorVersion: true, comment: '' })\n                .then(() =>\n                    this.nodesApi.getNode(\n                        this.node.id,\n                        { include: ['permissions', 'path', 'isFavorite', 'allowableOperations'] }\n                    )\n                )\n                .then((node) => this.onVersionRestored(node));\n        }\n    }\n\n    onViewVersion(versionId: string) {\n        this.viewVersion.emit(versionId);\n    }\n\n    loadVersionHistory() {\n        this.isLoading = true;\n        this.versionsApi.listVersionHistory(this.node.id).then((versionPaging: VersionPaging) => {\n            this.versions = versionPaging.list.entries;\n            this.isLoading = false;\n        });\n    }\n\n    downloadVersion(versionId: string) {\n        if (this.allowDownload) {\n            this.contentVersionService\n                .getVersionContentUrl(this.node.id, versionId, true)\n                .subscribe(versionDownloadUrl => this.downloadContent(versionDownloadUrl));\n        }\n    }\n\n    deleteVersion(versionId: string) {\n        if (this.canUpdate()) {\n            const dialogRef = this.dialog.open(ConfirmDialogComponent, {\n                data: {\n                    title: 'ADF_VERSION_LIST.CONFIRM_DELETE.TITLE',\n                    message: 'ADF_VERSION_LIST.CONFIRM_DELETE.MESSAGE',\n                    yesLabel: 'ADF_VERSION_LIST.CONFIRM_DELETE.YES_LABEL',\n                    noLabel: 'ADF_VERSION_LIST.CONFIRM_DELETE.NO_LABEL'\n                },\n                minWidth: '250px'\n            });\n\n            dialogRef.afterClosed().subscribe((result) => {\n                if (result === true) {\n                    this.versionsApi\n                        .deleteVersion(this.node.id, versionId)\n                        .then(() => this.onVersionDeleted(this.node));\n                }\n            });\n        }\n    }\n\n    onVersionDeleted(node: any) {\n        this.loadVersionHistory();\n        this.deleted.emit(node);\n    }\n\n    onVersionRestored(node: NodeEntry) {\n        this.loadVersionHistory();\n        this.restored.emit(node?.entry);\n    }\n\n    downloadContent(url: string) {\n        if (url) {\n            const link = document.createElement('a');\n\n            link.style.display = 'none';\n            link.href = url;\n\n            document.body.appendChild(link);\n            link.click();\n            document.body.removeChild(link);\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, ViewEncapsulation, ViewChild, Output, EventEmitter, OnInit } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { VersionListComponent } from './version-list.component';\nimport { ContentService, AlfrescoApiService, FileUploadErrorEvent } from '@alfresco/adf-core';\nimport { trigger, state, style, animate, transition } from '@angular/animations';\n\n@Component({\n    selector: 'adf-version-manager',\n    templateUrl: './version-manager.component.html',\n    styleUrls: ['./version-manager.component.scss'],\n    animations: [\n        trigger('uploadToggle', [\n            state('open', style({height: '175px', opacity: 1, visibility: 'visible'})),\n            state('close', style({height: '0%', opacity: 0, visibility: 'hidden'})),\n            transition('open => close', [\n                style({visibility: 'hidden'}),\n                animate('0.4s cubic-bezier(0.25, 0.8, 0.25, 1)')\n            ]),\n            transition('close => open', [\n                style({visibility: 'visible'}),\n                animate('0.4s cubic-bezier(0.25, 0.8, 0.25, 1)')\n            ])\n        ])\n    ],\n    encapsulation: ViewEncapsulation.None\n})\nexport class VersionManagerComponent implements OnInit {\n\n    /** Target node to manage version history. */\n    @Input()\n    node: Node;\n\n    /** New file for updating current version. */\n    @Input()\n    newFileVersion: File;\n\n    /** Toggles showing/hiding of comments. */\n    @Input()\n    showComments = true;\n\n    /** Toggles showing/hiding the version comparison component. */\n    @Input()\n    showVersionComparison = false;\n\n    /** Enable/disable downloading a version of the current node. */\n    @Input()\n    allowDownload = true;\n\n    /** Emitted when a file is uploaded successfully. */\n    @Output()\n    uploadSuccess = new EventEmitter<Node>();\n\n    /** Emitted when an error occurs during upload. */\n    @Output()\n    uploadError = new EventEmitter<FileUploadErrorEvent>();\n\n    /** Emitted when an cancelling during upload. */\n    @Output()\n    uploadCancel = new EventEmitter<boolean>();\n\n    /** Emitted when viewing a version. */\n    @Output()\n    viewVersion = new EventEmitter<string>();\n\n    @ViewChild('versionList', { static: true })\n    versionListComponent: VersionListComponent;\n\n    uploadState: string = 'close';\n\n    constructor(private contentService: ContentService,\n                private alfrescoApiService: AlfrescoApiService) {\n    }\n\n    ngOnInit() {\n        if (this.newFileVersion) {\n            this.toggleNewVersion();\n        }\n    }\n\n    refresh(node: Node) {\n        this.alfrescoApiService.nodeUpdated.next(node);\n        this.versionListComponent.loadVersionHistory();\n        this.uploadSuccess.emit(node);\n        this.uploadState = 'close';\n    }\n\n    onUploadSuccess(event: any) {\n        this.showVersionComparison = false;\n        this.newFileVersion = null;\n        this.alfrescoApiService.nodeUpdated.next(event.value.entry);\n        this.versionListComponent.loadVersionHistory();\n        this.uploadSuccess.emit(event.value.entry);\n        this.uploadState = 'close';\n    }\n\n    onUploadError(event: FileUploadErrorEvent) {\n        this.uploadError.emit(event);\n    }\n\n    onUploadCancel() {\n        this.uploadState = 'close';\n        this.showVersionComparison = false;\n        this.newFileVersion = null;\n        this.uploadCancel.emit(true);\n    }\n\n    onViewVersion(versionId: string) {\n        this.viewVersion.emit(versionId);\n    }\n\n    toggleNewVersion() {\n        this.uploadState = this.uploadState === 'open' ? 'close' : 'open';\n    }\n\n    canUpdate(): boolean {\n        return this.contentService.hasAllowableOperations(this.node, 'update');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnDestroy, OnInit, Output, ViewEncapsulation } from '@angular/core';\nimport { Node, Version } from '@alfresco/js-api';\nimport { ContentService, FileUploadErrorEvent, FileUploadEvent, UploadService } from '@alfresco/adf-core';\nimport { Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-version-upload',\n    templateUrl: './version-upload.component.html',\n    styleUrls: ['./version-upload.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { 'class': 'adf-version-upload' }\n})\nexport class VersionUploadComponent implements OnInit, OnDestroy {\n\n    semanticVersion: string = 'minor';\n    comment: string;\n    uploadVersion: boolean = false;\n    disabled: boolean = false;\n    onDestroy$ = new Subject();\n    majorVersion = '2.0';\n    minorVersion = '1.1';\n\n    /** The target node. */\n    @Input()\n    node: Node;\n\n    /** New file for updating current version. */\n    @Input()\n    newFileVersion: File;\n\n    /** Toggles showing/hiding upload button. */\n    @Input()\n    showUploadButton: boolean = true;\n\n    /** Toggles showing/hiding of cancel button. */\n    @Input()\n    showCancelButton: boolean = true;\n\n    /** Current version for a target node */\n    @Input()\n    set currentVersion(version: Version) {\n        if (version) {\n            this.minorVersion = this.getNextMinorVersion(version.id);\n            this.majorVersion = this.getNextMajorVersion(version.id);\n        }\n    }\n\n    /** Emitted when the file is uploaded successfully. */\n    @Output()\n    success = new EventEmitter();\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error = new EventEmitter<FileUploadErrorEvent>();\n\n    /** Emitted when an cancelling during upload. */\n    @Output()\n    cancel = new EventEmitter();\n\n    /** Emitted when the version is changed. */\n    @Output()\n    versionChanged = new EventEmitter<boolean>();\n\n    /** Emitted when the comment is changed. */\n    @Output()\n    commentChanged = new EventEmitter<string>();\n\n    /** Emitted when the upload starts */\n    @Output()\n    uploadStarted = new EventEmitter<FileUploadEvent>();\n\n    constructor(private contentService: ContentService, private uploadService: UploadService) {\n    }\n\n    ngOnInit() {\n        this.uploadService.fileUploadStarting\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((event: FileUploadEvent) => {\n                this.disabled = true;\n                this.uploadStarted.emit(event);\n            });\n    }\n\n    canUpload(): boolean {\n        return this.contentService.hasAllowableOperations(this.node, 'update') && !this.disabled;\n    }\n\n    isMajorVersion(): boolean {\n        return this.semanticVersion !== 'minor';\n    }\n\n    cancelUpload() {\n        this.disabled = false;\n        this.cancel.emit();\n    }\n\n    onVersionChange() {\n        this.versionChanged.emit(this.isMajorVersion());\n    }\n\n    onCommentChange() {\n        this.commentChanged.emit(this.comment);\n    }\n\n    onSuccess(event: any) {\n        this.disabled = false;\n        this.success.emit(event);\n    }\n\n    onError(event: FileUploadErrorEvent) {\n        this.disabled = false;\n        this.error.emit(event);\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next();\n        this.onDestroy$.complete();\n    }\n\n    getNextMinorVersion(version: string): string {\n        const { major, minor } = this.getParsedVersion(version);\n        return `${major}.${minor + 1}`;\n    }\n\n    getNextMajorVersion(version: string): string {\n        const { major} = this.getParsedVersion(version);\n        return `${major + 1 }.0`;\n    }\n\n    private getParsedVersion(version: string) {\n        const minor = version.indexOf('.') !== -1 ? Number(version.substr(version.indexOf('.') + 1)) : 0;\n        const major = parseInt(version, 10);\n        return { minor, major };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, ViewEncapsulation } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { ThumbnailService } from '@alfresco/adf-core';\n\n@Component({\n    selector: 'adf-version-comparison',\n    templateUrl: './version-comparison.component.html',\n    styleUrls: ['./version-comparison.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class VersionComparisonComponent {\n\n    /** Target node. */\n    @Input()\n    node: Node;\n\n    /** New file for updating current version. */\n    @Input()\n    newFileVersion: File;\n\n    constructor(public thumbnailService: ThumbnailService) {\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\n\nimport { VersionUploadComponent } from './version-upload.component';\nimport { VersionManagerComponent } from './version-manager.component';\nimport { VersionListComponent } from './version-list.component';\nimport { UploadModule } from '../upload/upload.module';\nimport { CoreModule } from '@alfresco/adf-core';\nimport { VersionComparisonComponent } from './version-comparison.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        CoreModule,\n        UploadModule,\n        FormsModule\n    ],\n    exports: [\n        VersionUploadComponent,\n        VersionManagerComponent,\n        VersionListComponent,\n        FormsModule,\n        VersionComparisonComponent\n    ],\n    declarations: [\n        VersionUploadComponent,\n        VersionManagerComponent,\n        VersionListComponent,\n        VersionComparisonComponent\n    ]\n})\nexport class VersionManagerModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Input, ChangeDetectionStrategy, Component, OnInit, ViewEncapsulation } from '@angular/core';\nimport { DataRow } from '@alfresco/adf-core';\n\n@Component({\n    selector: 'adf-name-location-cell',\n    template: `\n        <div class=\"adf-name-location-cell-name adf-datatable-cell-value\" [title]=\"name\">{{ name }}</div>\n        <div class=\"adf-name-location-cell-location adf-datatable-cell-value\" [title]=\"path\">{{ path }}</div>\n    `,\n    styleUrls: ['./name-location-cell.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    host: { class: 'adf-name-location-cell adf-datatable-content-cell' }\n})\nexport class NameLocationCellComponent implements OnInit {\n\n    name: string = '';\n    path: string = '';\n\n    @Input()\n    row: DataRow;\n\n    ngOnInit() {\n        if (this.row) {\n            this.name = this.row.getValue('name');\n\n            const fullPath = this.row.getValue('path');\n            if (fullPath) {\n                this.path = fullPath.name || '';\n            }\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    EventEmitter,\n    Input,\n    OnInit,\n    Output,\n    ViewChild,\n    ViewEncapsulation,\n    OnDestroy,\n    Inject\n} from '@angular/core';\nimport {\n    HighlightDirective,\n    UserPreferencesService,\n    UserPreferenceValues,\n    InfinitePaginationComponent, PaginatedComponent,\n    NodesApiService,\n    SitesService,\n    UploadService,\n    FileUploadCompleteEvent,\n    FileUploadDeleteEvent,\n    AppConfigService,\n    DataSorting,\n    ShowHeaderMode\n} from '@alfresco/adf-core';\nimport { FormControl } from '@angular/forms';\nimport { Node, NodePaging, Pagination, SiteEntry, SitePaging, NodeEntry, QueryBody, RequestScope } from '@alfresco/js-api';\nimport { DocumentListComponent } from '../document-list/components/document-list.component';\nimport { RowFilter } from '../document-list/data/row-filter.model';\nimport { ImageResolver } from '../document-list/data/image-resolver.model';\nimport { debounceTime, takeUntil } from 'rxjs/operators';\nimport { CustomResourcesService } from '../document-list/services/custom-resources.service';\nimport { NodeEntryEvent, ShareDataRow } from '../document-list';\nimport { Subject } from 'rxjs';\nimport { SEARCH_QUERY_SERVICE_TOKEN } from '../search/search-query-service.token';\nimport { SearchQueryBuilderService } from '../search/services/search-query-builder.service';\nimport { ContentNodeSelectorPanelService } from './content-node-selector-panel.service';\n\nexport type ValidationFunction = (entry: Node) => boolean;\n\nexport const defaultValidation = () => true;\n\n@Component({\n    selector: 'adf-content-node-selector-panel',\n    templateUrl: './content-node-selector-panel.component.html',\n    styleUrls: ['./content-node-selector-panel.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { 'class': 'adf-content-node-selector-panel' },\n    providers: [{\n        provide: SEARCH_QUERY_SERVICE_TOKEN,\n        useClass: SearchQueryBuilderService\n    }]\n})\nexport class ContentNodeSelectorPanelComponent implements OnInit, OnDestroy {\n\n    DEFAULT_PAGINATION: Pagination = new Pagination({\n        maxItems: 25,\n        skipCount: 0\n    });\n\n    private showSiteList = true;\n    private showSearchField = true;\n    private showCounter = false;\n\n    /** If true will restrict the search and breadcrumbs to the currentFolderId */\n    @Input()\n    restrictRootToCurrentFolderId: boolean = false;\n\n    /** Node ID of the folder currently listed. */\n    @Input()\n    currentFolderId: string = null;\n\n    /** Hide the \"My Files\" option added to the site list by default.\n     * See the [Sites Dropdown component](sites-dropdown.component.md)\n     * for more information.\n     */\n    @Input()\n    dropdownHideMyFiles: boolean = false;\n\n    /** Custom site for site dropdown. This is the same as the `siteList`.\n     * property of the Sites Dropdown component (see its doc page\n     * for more information).\n     */\n    @Input()\n    dropdownSiteList: SitePaging = null;\n\n    _rowFilter: RowFilter = defaultValidation;\n\n    /** Custom *where* filter function. See the\n     * Document List component\n     * for more information.\n     */\n    @Input()\n    where: string;\n\n    /**\n     * Custom row filter function. See the\n     * [Row Filter Model](row-filter.model.md) page\n     * for more information.\n     */\n    @Input()\n    set rowFilter(rowFilter: RowFilter) {\n        this.createRowFilter(rowFilter);\n    }\n\n    get rowFilter(): RowFilter {\n        return this._rowFilter;\n    }\n\n    _excludeSiteContent: string[] = [];\n\n    /** Custom list of site content componentIds.\n     * Used to filter out the corresponding items from the displayed nodes\n     */\n    @Input()\n    set excludeSiteContent(excludeSiteContent: string[]) {\n        this._excludeSiteContent = excludeSiteContent;\n        this.createRowFilter(this._rowFilter);\n    }\n\n    get excludeSiteContent(): string[] {\n        return this._excludeSiteContent;\n    }\n\n    /**\n     * Custom image resolver function. See the\n     * [Image Resolver Model](image-resolver.model.md) page\n     * for more information.\n     */\n    @Input()\n    imageResolver: ImageResolver = null;\n\n    /** Number of items shown per page in the list. */\n    @Input()\n    pageSize: number = this.DEFAULT_PAGINATION.maxItems;\n\n    /** Define the selection mode for document list. The allowed values are single or multiple */\n    @Input()\n    selectionMode: 'single' | 'multiple' = 'single';\n\n    /** Function used to decide if the selected node has permission to be selected.\n     * Default value is a function that always returns true.\n     */\n    @Input()\n    isSelectionValid: ValidationFunction = defaultValidation;\n\n    /** Transformation to be performed on the chosen/folder node before building the\n     * breadcrumb UI. Can be useful when custom formatting is needed for the breadcrumb.\n     * You can change the path elements from the node that are used to build the\n     * breadcrumb using this function.\n     */\n    @Input()\n    breadcrumbTransform: (node) => any;\n\n    /** Toggle search input rendering */\n    @Input()\n    set showSearch(value: boolean) {\n        if (value !== undefined && value !== null) {\n            this.showSearchField = value;\n        }\n    }\n\n    get showSearch(): boolean {\n        return this.showSearchField;\n    }\n\n    /** Toggle sites list dropdown rendering */\n    @Input()\n    set showDropdownSiteList(value: boolean) {\n        if (value !== undefined && value !== null) {\n            this.showSiteList = value;\n        }\n    }\n\n    get showDropdownSiteList(): boolean {\n        return this.showSiteList;\n    }\n\n    /** Shows the files and folders in the search result */\n    @Input()\n    set showFilesInResult(value: boolean) {\n        if (value !== undefined && value !== null) {\n            const showFilesQuery = `TYPE:'cm:folder'${value ? \" OR TYPE:'cm:content'\" : ''}`;\n            this.queryBuilderService.addFilterQuery(showFilesQuery);\n        }\n    }\n\n    /** Shows the node counter in the breadcrumb */\n    @Input()\n    set showNodeCounter(value: boolean) {\n        this.showCounter = value ?? false;\n    }\n\n    get showNodeCounter(): boolean {\n        return this.showCounter;\n    }\n\n    /** Emitted when the user has chosen an item. */\n    @Output()\n    select = new EventEmitter<Node[]>();\n\n    /** Emitted when the navigation changes. */\n    @Output()\n    navigationChange = new EventEmitter<NodeEntryEvent>();\n\n    /** Emitted when the select site changes. */\n    @Output()\n    siteChange = new EventEmitter<string>();\n\n    /** Emitted when search is running. */\n    @Output()\n    showingSearch = new EventEmitter<boolean>();\n\n    /** Emitted when current folder loaded. */\n    @Output()\n    currentFolder = new EventEmitter<Node>();\n\n    /** Emitted when folder loaded. */\n    @Output()\n    folderLoaded: EventEmitter<any> = new EventEmitter<any>();\n\n    @ViewChild('documentList', { static: true })\n    documentList: DocumentListComponent;\n\n    @ViewChild(HighlightDirective, { static: true })\n    highlighter: HighlightDirective;\n\n    nodePaging: NodePaging | null = null;\n    siteId: null | string;\n    breadcrumbRootId: null | string;\n    searchTerm: string = '';\n    showingSearchResults: boolean = false;\n    loadingSearchResults: boolean = false;\n    inDialog: boolean = false;\n    _chosenNode: Node[] = null;\n    selectionWithoutValidation: Node[] = null;\n    folderIdToShow: string | null = null;\n    breadcrumbFolderTitle: string | null = null;\n    startSiteGuid: string | null = null;\n    hasValidQuery: boolean = false;\n    showHeader = ShowHeaderMode.Never;\n\n    @ViewChild(InfinitePaginationComponent, { static: true })\n    infinitePaginationComponent: InfinitePaginationComponent;\n\n    infiniteScroll: boolean = false;\n    debounceSearch: number = 200;\n    searchInput: FormControl = new FormControl();\n\n    target: PaginatedComponent;\n    preselectedNodes: NodeEntry[] = [];\n    currentUploadBatch: NodeEntry[] = [];\n\n    sorting: string[] | DataSorting;\n\n    searchPanelExpanded: boolean = false;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private customResourcesService: CustomResourcesService,\n                @Inject(SEARCH_QUERY_SERVICE_TOKEN) public queryBuilderService: SearchQueryBuilderService,\n                private userPreferencesService: UserPreferencesService,\n                private nodesApiService: NodesApiService,\n                private uploadService: UploadService,\n                private sitesService: SitesService,\n                private appConfigService: AppConfigService,\n                private contentNodeSelectorPanelService: ContentNodeSelectorPanelService) {\n    }\n\n    set chosenNode(value: Node[]) {\n        this._chosenNode = value;\n        this.select.next(value);\n    }\n\n    get chosenNode() {\n        return this._chosenNode;\n    }\n\n    getSelectedCount(): number {\n        return this.chosenNode?.length || 0;\n    }\n\n    ngOnInit() {\n        this.searchInput.valueChanges\n            .pipe(\n                debounceTime(this.debounceSearch),\n                takeUntil(this.onDestroy$)\n            )\n            .subscribe((searchValue: string) => {\n                this.searchTerm = searchValue;\n                this.queryBuilderService.userQuery = searchValue.length > 0 ? `${searchValue}*` : searchValue ;\n                this.queryBuilderService.update();\n            });\n\n        this.queryBuilderService.updated\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((queryBody: QueryBody) => {\n                if (queryBody) {\n                    this.hasValidQuery = true;\n                    this.prepareDialogForNewSearch(queryBody);\n                    this.queryBuilderService.execute(queryBody);\n                } else {\n                    this.hasValidQuery = false;\n                    this.resetFolderToShow();\n                    this.clearSearch();\n                }\n            });\n\n        this.queryBuilderService.executed\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((results: NodePaging) => {\n                if (this.hasValidQuery) {\n                    this.showSearchResults(results);\n                }\n            });\n\n        this.userPreferencesService\n            .select(UserPreferenceValues.PaginationSize)\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(pagSize => this.pageSize = pagSize);\n\n        this.target = this.documentList;\n        this.folderIdToShow = this.currentFolderId;\n        if (this.currentFolderId) {\n            if (this.restrictRootToCurrentFolderId) {\n                this.breadcrumbRootId = this.currentFolderId;\n                this.siteId = this.currentFolderId;\n            } else {\n                this.getStartSite();\n            }\n        }\n\n        this.breadcrumbTransform = this.breadcrumbTransform ? this.breadcrumbTransform : null;\n        this.isSelectionValid = this.isSelectionValid ? this.isSelectionValid : defaultValidation;\n        this.onFileUploadEvent();\n        this.onFileUploadDeletedEvent();\n        this.resetPagination();\n        this.setSearchScopeToNodes();\n\n        this.documentList.$folderNode\n        .pipe(takeUntil(this.onDestroy$))\n        .subscribe((currentNode: Node) => {\n            this.currentFolder.emit(currentNode);\n    });\n\n        this.sorting = this.appConfigService.get('adf-content-node-selector.sorting', ['createdAt', 'desc']);\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    toggleSearchPanel() {\n        this.searchPanelExpanded = !this.searchPanelExpanded;\n    }\n\n    hasCustomModels(): boolean {\n        return this.contentNodeSelectorPanelService?.customModels?.length > 0;\n    }\n\n    private onFileUploadEvent() {\n        this.uploadService.fileUploadComplete\n            .pipe(\n                debounceTime(500),\n                takeUntil(this.onDestroy$)\n            )\n            .subscribe((fileUploadEvent: FileUploadCompleteEvent) => {\n                this.currentUploadBatch.push(fileUploadEvent.data);\n                if (!this.uploadService.isUploading()) {\n                    this.preselectedNodes = this.getPreselectNodesBasedOnSelectionMode();\n                    this.currentUploadBatch = [];\n                    this.documentList.reloadWithoutResettingSelection();\n                }\n            });\n    }\n\n    private onFileUploadDeletedEvent() {\n        this.uploadService.fileUploadDeleted\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe((deletedFileEvent: FileUploadDeleteEvent) => {\n                this.documentList.unselectRowFromNodeId(deletedFileEvent.file.data.entry.id);\n                this.documentList.reloadWithoutResettingSelection();\n            });\n    }\n\n    private getStartSite() {\n        this.nodesApiService.getNode(this.currentFolderId).subscribe((startNodeEntry) => {\n            this.startSiteGuid = this.sitesService.getSiteNameFromNodePath(startNodeEntry);\n            if (this.startSiteGuid) {\n                this.sitesService.getSite(this.startSiteGuid).subscribe((startSiteEntry) => {\n                    if (startSiteEntry instanceof SiteEntry) {\n                        this.siteChange.emit(startSiteEntry.entry.title);\n                    }\n                });\n            }\n        });\n    }\n\n    private createRowFilter(filter?: RowFilter) {\n        if (!filter) {\n            filter = () => true;\n        }\n        this._rowFilter = (value: ShareDataRow, index: number, array: ShareDataRow[]) => {\n            return filter(value, index, array) &&\n                !this.isExcludedSiteContent(value);\n        };\n    }\n\n    private isExcludedSiteContent(row: ShareDataRow): boolean {\n        const entry = row.node.entry;\n        if (this._excludeSiteContent && this._excludeSiteContent.length &&\n            entry &&\n            entry.properties &&\n            entry.properties['st:componentId']) {\n            const excludedItem = this._excludeSiteContent.find(\n                (id: string) => entry.properties['st:componentId'] === id\n            );\n            return !!excludedItem;\n        }\n        return false;\n    }\n\n    /**\n     * Updates the site attribute and starts a new search\n     *\n     * @param chosenSite SiteEntry to search within\n     */\n    siteChanged(chosenSite: SiteEntry): void {\n        this.siteId = chosenSite.entry.guid;\n        this.setTitleIfCustomSite(chosenSite);\n        this.siteChange.emit(chosenSite.entry.title);\n        this.queryBuilderService.update();\n    }\n\n    /**\n     * Returns the actually selected|entered folder node or null in case of searching for the breadcrumb\n     */\n    get breadcrumbFolderNode(): Node | null {\n        let folderNode: Node;\n\n        if (this.showingSearchResults && this.selectionWithoutValidation?.length) {\n            folderNode = this.selectionWithoutValidation[0];\n        } else {\n            folderNode = this.documentList.folderNode;\n        }\n\n        return folderNode;\n    }\n\n    /**\n     * Prepares the dialog for a new search\n     */\n    prepareDialogForNewSearch(queryBody: QueryBody): void {\n        this.target = queryBody ? null : this.documentList;\n        if (this.target) {\n            this.infinitePaginationComponent.reset();\n        }\n        this.folderIdToShow = null;\n        this.preselectedNodes = [];\n        this.loadingSearchResults = true;\n        this.addCorrespondingNodeIdsQuery();\n        this.resetChosenNode();\n    }\n\n    /**\n     * Clear the search input and reset to last folder node in which search was performed\n     */\n    clear(): void {\n        this.searchTerm = '';\n        this.queryBuilderService.userQuery = '';\n        this.queryBuilderService.update();\n    }\n\n    /**\n     * Resets the folder to be shown with the site selection or the initial landing folder\n     */\n    resetFolderToShow(): void {\n        this.folderIdToShow = this.siteId || this.currentFolderId;\n    }\n\n    /**\n     * Clear the search input and search related data\n     */\n    clearSearch() {\n        this.searchTerm = '';\n        this.nodePaging = null;\n        this.resetPagination();\n        this.resetChosenNode();\n        this.showingSearchResults = false;\n        this.showingSearch.emit(this.showingSearchResults);\n    }\n\n    private addCorrespondingNodeIdsQuery() {\n        let extraParentFiltering = '';\n\n        if (this.customResourcesService.hasCorrespondingNodeIds(this.siteId)) {\n            this.customResourcesService.getCorrespondingNodeIds(this.siteId)\n                .subscribe((nodeIds) => {\n                    if (nodeIds && nodeIds.length) {\n                        nodeIds\n                            .filter((id) => id !== this.siteId)\n                            .forEach((extraId) => {\n                                extraParentFiltering += ` OR ANCESTOR:'workspace://SpacesStore/${extraId}'`;\n                            });\n                    }\n                    const parentFiltering = this.siteId ? `ANCESTOR:'workspace://SpacesStore/${this.siteId}'${extraParentFiltering}` : '';\n                    this.queryBuilderService.addFilterQuery(parentFiltering);\n                });\n        } else {\n            const parentFiltering = this.siteId ? `ANCESTOR:'workspace://SpacesStore/${this.siteId}'` : '';\n            this.queryBuilderService.addFilterQuery(parentFiltering);\n        }\n    }\n\n    private setSearchScopeToNodes() {\n        const scope: RequestScope = {\n            locations: 'nodes'\n        };\n        this.queryBuilderService.setScope(scope);\n    }\n\n    /**\n     * Show the results of the search\n     *\n     * @param results Search results\n     */\n    private showSearchResults(results: NodePaging): void {\n        this.showingSearchResults = true;\n        this.loadingSearchResults = false;\n        this.showingSearch.emit(this.showingSearchResults);\n\n        this.nodePaging = results;\n    }\n\n    /**\n     * Sets showingSearchResults state to be able to differentiate between search results or folder results\n     */\n    onFolderChange($event: NodeEntryEvent): void {\n        this.folderIdToShow = $event.value.id;\n        this.showingSearchResults = false;\n        this.infiniteScroll = false;\n        this.breadcrumbFolderTitle = null;\n        this.preselectedNodes = [];\n        this.clearSearch();\n        this.navigationChange.emit($event);\n    }\n\n    /**\n     * Attempts to set the currently loaded node\n     */\n    onFolderLoaded(nodePaging: NodePaging): void {\n        this.updatePaginationAfterRowFilter(nodePaging);\n        if (!this.showingSearchResults) {\n            this.attemptNodeSelection(this.documentList.folderNode);\n        }\n        this.folderLoaded.emit();\n    }\n\n    /**\n     * Updates pagination.hasMoreItems to false after filtering only folders during 'COPY' and 'MOVE' action\n     */\n    updatePaginationAfterRowFilter(nodePaging: NodePaging): void {\n        if (this.documentList.data.getRows().length < nodePaging.list.pagination.maxItems) {\n            nodePaging.list.pagination.hasMoreItems = false;\n        }\n    }\n\n    /**\n     * Returns whether breadcrumb has to be shown or not\n     */\n    showBreadcrumbs() {\n        return !this.showingSearchResults || this.chosenNode;\n    }\n\n    /**\n     * Loads the next batch of search results\n     *\n     * @param pagination Pagination object\n     */\n    getNextPageOfSearch(pagination: Pagination): void {\n        this.infiniteScroll = true;\n        this.queryBuilderService.paging.maxItems = pagination.maxItems;\n        this.queryBuilderService.paging.skipCount = pagination.skipCount;\n\n        if (this.searchTerm.length > 0) {\n            this.queryBuilderService.update();\n        }\n    }\n\n    /**\n     * Selects node as chosen if it has the right permission, clears the selection otherwise\n     *\n     * @param entry\n     */\n    private attemptNodeSelection(entry: Node): void {\n        if (entry && this.isSelectionValid(entry)) {\n            this.chosenNode = [entry];\n        }\n    }\n\n    /**\n     * Clears the chosen node\n     */\n    resetChosenNode(): void {\n        this.chosenNode = null;\n    }\n\n    /**\n     * It filters and emit the selection coming from the document list\n     *\n     * @param nodesEntries\n     */\n    onCurrentSelection(nodesEntries: NodeEntry[]): void {\n        const validNodesEntity = nodesEntries.filter((node) => this.isSelectionValid(node.entry));\n        this.chosenNode = validNodesEntity.map((node) => node.entry);\n        this.selectionWithoutValidation = nodesEntries.map(node => node.entry);\n    }\n\n    setTitleIfCustomSite(site: SiteEntry) {\n        if (this.customResourcesService.isCustomSource(site.entry.guid)) {\n            this.breadcrumbFolderTitle = site.entry.title;\n            if (this.documentList.folderNode.path.elements) {\n                this.breadcrumbFolderNode.name = site.entry.title;\n                this.documentList.folderNode.path.elements = null;\n            }\n        } else {\n            this.breadcrumbFolderTitle = null;\n        }\n    }\n\n    hasPreselectNodes(): boolean {\n        return this.preselectedNodes?.length > 0;\n    }\n\n    isSingleSelectionMode(): boolean {\n        return this.selectionMode === 'single';\n    }\n\n    getPreselectNodesBasedOnSelectionMode(): NodeEntry[] {\n        let selectedNodes: NodeEntry[] = [];\n\n        if (this.currentUploadBatch?.length) {\n            if (this.isSingleSelectionMode()) {\n                selectedNodes = [this.currentUploadBatch[this.currentUploadBatch.length - 1]];\n            } else {\n                selectedNodes = this.currentUploadBatch;\n            }\n        }\n\n        return selectedNodes;\n    }\n\n    private resetPagination(): void {\n        this.queryBuilderService.paging = {\n            maxItems: this.pageSize,\n            skipCount: this.DEFAULT_PAGINATION.skipCount\n        };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MaterialModule } from '../material.module';\n\nimport { ContentNodeSelectorPanelComponent } from './content-node-selector-panel.component';\nimport { ContentNodeSelectorComponent } from './content-node-selector.component';\nimport { SitesDropdownModule } from '../site-dropdown/sites-dropdown.module';\nimport { BreadcrumbModule } from '../breadcrumb/breadcrumb.module';\nimport { SearchModule } from '../search/search.module';\nimport { CoreModule } from '@alfresco/adf-core';\nimport { DocumentListModule } from '../document-list/document-list.module';\nimport { NameLocationCellComponent } from './name-location-cell/name-location-cell.component';\nimport { UploadModule } from '../upload/upload.module';\nimport { SearchQueryBuilderService } from '../search/services/search-query-builder.service';\nimport { ContentDirectiveModule } from '../directives/content-directive.module';\n\n@NgModule({\n    imports: [\n        FormsModule,\n        ReactiveFormsModule,\n        CoreModule,\n        CommonModule,\n        MaterialModule,\n        SitesDropdownModule,\n        BreadcrumbModule,\n        SearchModule,\n        DocumentListModule,\n        UploadModule,\n        ContentDirectiveModule\n    ],\n    exports: [\n        ContentNodeSelectorPanelComponent,\n        NameLocationCellComponent,\n        ContentNodeSelectorComponent\n    ],\n    declarations: [\n        ContentNodeSelectorPanelComponent,\n        NameLocationCellComponent,\n        ContentNodeSelectorComponent\n    ],\n    providers: [SearchQueryBuilderService]\n})\nexport class ContentNodeSelectorModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FormControl } from '@angular/forms';\n\nconst I18N_ERRORS_PATH = 'CORE.FOLDER_DIALOG.FOLDER_NAME.ERRORS';\n\nexport function forbidSpecialCharacters({ value }: FormControl) {\n    const specialCharacters: RegExp = /([\\*\\\"\\<\\>\\\\\\/\\?\\:\\|])/;\n    const isValid: boolean = !specialCharacters.test(value);\n\n    return (isValid) ? null : {\n        message: `${I18N_ERRORS_PATH}.SPECIAL_CHARACTERS`\n    };\n}\n\nexport function forbidEndingDot({ value }: FormControl) {\n    const isValid: boolean = ((value || '').trim().split('').pop() !== '.');\n\n    return isValid ? null : {\n        message: `${I18N_ERRORS_PATH}.ENDING_DOT`\n    };\n}\n\nexport function forbidOnlySpaces({ value }: FormControl) {\n    const isValid: boolean = !!((value || '')).trim();\n\n    return isValid ? null : {\n        message: `${I18N_ERRORS_PATH}.ONLY_SPACES`\n    };\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable } from 'rxjs';\n\nimport { Component, Inject, OnInit, Optional, EventEmitter, Output, ViewEncapsulation } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\n\nimport { Node } from '@alfresco/js-api';\nimport { NodesApiService, TranslationService } from '@alfresco/adf-core';\n\nimport { forbidEndingDot, forbidOnlySpaces, forbidSpecialCharacters } from './folder-name.validators';\n\n@Component({\n    selector: 'adf-folder-dialog',\n    templateUrl: './folder.dialog.html',\n    styleUrls: ['./folder.dialog.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class FolderDialogComponent implements OnInit {\n\n    form: FormGroup;\n\n    folder: Node = null;\n\n    /** Emitted when the edit/create folder give error for example a folder with same name already exist\n     */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter<any>();\n\n    /** Emitted when the edit/create folder is successfully created/modified\n     */\n    @Output()\n    success: EventEmitter<any> = new EventEmitter<Node>();\n\n    editTitle = 'CORE.FOLDER_DIALOG.EDIT_FOLDER_TITLE';\n    createTitle = 'CORE.FOLDER_DIALOG.CREATE_FOLDER_TITLE';\n    nodeType = 'cm:folder';\n\n    constructor(\n        private formBuilder: FormBuilder,\n        private dialog: MatDialogRef<FolderDialogComponent>,\n        private nodesApi: NodesApiService,\n        private translation: TranslationService,\n        @Optional()\n        @Inject(MAT_DIALOG_DATA)\n        public data: any\n    ) {\n        if (data) {\n            this.editTitle = data.editTitle || this.editTitle;\n            this.createTitle = data.createTitle || this.createTitle;\n            this.nodeType = data.nodeType || this.nodeType;\n        }\n    }\n\n    get editing(): boolean {\n        return !!this.data.folder;\n    }\n\n    ngOnInit() {\n        const { folder } = this.data;\n        let name = '';\n        let title = '';\n        let description = '';\n\n        if (folder) {\n            const { properties } = folder;\n\n            name = folder.name || '';\n            title = properties?.['cm:title'] ?? '';\n            description = properties?.['cm:description'] ?? '';\n        }\n\n        const validators = {\n            name: [\n                Validators.required,\n                forbidSpecialCharacters,\n                forbidEndingDot,\n                forbidOnlySpaces\n            ]\n        };\n\n        this.form = this.formBuilder.group({\n            name: [ name, validators.name ],\n            title: [ title ],\n            description: [ description ]\n        });\n    }\n\n    get name(): string {\n        const { name } = this.form.value;\n\n        return (name || '').trim();\n    }\n\n    get title(): string {\n        const { title } = this.form.value;\n\n        return (title || '').trim();\n    }\n\n    get description(): string {\n        const { description } = this.form.value;\n\n        return (description || '').trim();\n    }\n\n    private get properties(): any {\n        const { title, description } = this;\n\n        return {\n            'cm:title': title,\n            'cm:description': description\n        };\n    }\n\n    private create(): Observable<Node> {\n        const { name, properties, nodeType, nodesApi, data: { parentNodeId} } = this;\n        return nodesApi.createFolder(parentNodeId, { name, properties, nodeType });\n    }\n\n    private edit(): Observable<Node> {\n        const { name, properties, nodesApi, data: { folder: { id: nodeId }} } = this;\n        return nodesApi.updateNode(nodeId, { name, properties });\n    }\n\n    submit() {\n        const { form, dialog, editing } = this;\n\n        if (!form.valid) { return; }\n\n        (editing ? this.edit() : this.create())\n            .subscribe(\n                (folder: Node) => {\n                    this.success.emit(folder);\n                    dialog.close(folder);\n                },\n                (error) => this.handleError(error)\n            );\n    }\n\n    handleError(error: any): any {\n        let errorMessage = 'CORE.MESSAGES.ERRORS.GENERIC';\n\n        try {\n            const { error: { statusCode } } = JSON.parse(error.message);\n\n            if (statusCode === 409) {\n                errorMessage = 'CORE.MESSAGES.ERRORS.EXISTENT_FOLDER';\n            }\n        } catch (err) { /* Do nothing, keep the original message */ }\n\n        this.error.emit(this.translation.instant(errorMessage));\n\n        return error;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Observable, Subject } from 'rxjs';\nimport {\n    Component,\n    OnInit,\n    Output,\n    EventEmitter,\n    OnDestroy,\n    ViewEncapsulation\n} from '@angular/core';\nimport {\n    FormBuilder,\n    FormGroup,\n    Validators,\n    FormControl,\n    AbstractControl\n} from '@angular/forms';\nimport { MatDialogRef } from '@angular/material/dialog';\nimport { QueriesApi, SiteBodyCreate, SiteEntry, SitePaging } from '@alfresco/js-api';\nimport { AlfrescoApiService, SitesService } from '@alfresco/adf-core';\nimport { debounceTime, finalize, mergeMap, takeUntil } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-library-dialog',\n    styleUrls: ['./library.dialog.scss'],\n    templateUrl: './library.dialog.html',\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-library-dialog' }\n})\nexport class LibraryDialogComponent implements OnInit, OnDestroy {\n    /** Emitted when an error occurs. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter<any>();\n\n    /** Emitted when the new library is created successfully. The\n     * event parameter is a SiteEntry object with the details of the\n     * newly-created library.\n     */\n    @Output()\n    success: EventEmitter<any> = new EventEmitter<any>();\n\n    onDestroy$: Subject<boolean> = new Subject<boolean>();\n\n    createTitle = 'LIBRARY.DIALOG.CREATE_TITLE';\n    libraryTitleExists = false;\n    form: FormGroup;\n    visibilityOption: any;\n    visibilityOptions = [\n        { value: 'PUBLIC', label: 'LIBRARY.VISIBILITY.PUBLIC', disabled: false },\n        { value: 'PRIVATE', label: 'LIBRARY.VISIBILITY.PRIVATE', disabled: false },\n        {\n            value: 'MODERATED',\n            label: 'LIBRARY.VISIBILITY.MODERATED',\n            disabled: false\n        }\n    ];\n    disableCreateButton = false;\n\n    _queriesApi: QueriesApi;\n    get queriesApi(): QueriesApi {\n        this._queriesApi = this._queriesApi ?? new QueriesApi(this.alfrescoApiService.getInstance());\n        return this._queriesApi;\n    }\n\n    constructor(\n        private alfrescoApiService: AlfrescoApiService,\n        private sitesService: SitesService,\n        private formBuilder: FormBuilder,\n        private dialog: MatDialogRef<LibraryDialogComponent>\n    ) {\n    }\n\n    ngOnInit() {\n        const validators = {\n            id: [\n                Validators.required,\n                Validators.maxLength(72),\n                this.forbidSpecialCharacters\n            ],\n            title: [\n                Validators.required,\n                this.forbidOnlySpaces,\n                Validators.minLength(2),\n                Validators.maxLength(256)\n            ],\n            description: [Validators.maxLength(512)]\n        };\n\n        this.form = this.formBuilder.group({\n            title: [null, validators.title],\n            id: [null, validators.id, this.createSiteIdValidator()],\n            description: ['', validators.description]\n        });\n\n        this.visibilityOption = this.visibilityOptions[0].value;\n\n        this.form.controls['title'].valueChanges\n            .pipe(\n                debounceTime(500),\n                mergeMap(\n                    (title) => this.checkLibraryNameExists(title),\n                    (title) => title\n                ),\n                takeUntil(this.onDestroy$)\n            )\n            .subscribe((title: string) => {\n                if (!this.form.controls['id'].dirty && this.canGenerateId(title)) {\n                    this.form.patchValue({ id: this.sanitize(title.trim()) });\n                    this.form.controls['id'].markAsTouched();\n                }\n            });\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    get title(): string {\n        const { title } = this.form.value;\n\n        return (title || '').trim();\n    }\n\n    get id(): string {\n        const { id } = this.form.value;\n\n        return (id || '').trim();\n    }\n\n    get description(): string {\n        const { description } = this.form.value;\n\n        return (description || '').trim();\n    }\n\n    get visibility(): string {\n        return this.visibilityOption || '';\n    }\n\n    submit() {\n        const { form, dialog } = this;\n\n        if (!form.valid) {\n            return;\n        }\n\n        this.disableCreateButton = true;\n        this.create().pipe(finalize(() => this.disableCreateButton = false)).subscribe(\n            (node: SiteEntry) => {\n                this.success.emit(node);\n                dialog.close(node);\n            },\n            (error) => this.handleError(error)\n        );\n    }\n\n    visibilityChangeHandler(event) {\n        this.visibilityOption = event.value;\n    }\n\n    private create(): Observable<SiteEntry> {\n        const { title, id, description, visibility } = this;\n        const siteBody = <SiteBodyCreate> {\n            id,\n            title,\n            description,\n            visibility\n        };\n\n        return this.sitesService.createSite(siteBody);\n    }\n\n    private sanitize(input: string) {\n        return input.replace(/[\\s\\s]+/g, '-').replace(/[^A-Za-z0-9-]/g, '');\n    }\n\n    private canGenerateId(title) {\n        return Boolean(title.replace(/[^A-Za-z0-9-]/g, '').length);\n    }\n\n    private handleError(error: any): any {\n        try {\n            const {\n                error: { statusCode }\n            } = JSON.parse(error.message);\n\n            if (statusCode === 409) {\n                this.form.controls['id'].setErrors({\n                    message: 'LIBRARY.ERRORS.CONFLICT'\n                });\n            }\n        } catch (error) {\n\n        }\n\n        return error;\n    }\n\n    private async checkLibraryNameExists(libraryTitle: string) {\n        let entries = [];\n\n        try {\n            entries = (await this.findLibraryByTitle(libraryTitle)).list.entries;\n        } catch {\n            entries = [];\n        }\n\n        if (entries.length) {\n            this.libraryTitleExists = entries[0].entry.title.toLowerCase() === libraryTitle.toLowerCase();\n        } else {\n            this.libraryTitleExists = false;\n        }\n    }\n\n    private findLibraryByTitle(libraryTitle: string): Promise<SitePaging> {\n        return this.queriesApi.findSites(libraryTitle, {\n                maxItems: 1,\n                fields: ['title']\n            });\n    }\n\n    private forbidSpecialCharacters({ value }: FormControl) {\n        if (value === null || value.length === 0) {\n            return null;\n        }\n\n        const validCharacters: RegExp = /[^A-Za-z0-9-]/;\n        const isValid: boolean = !validCharacters.test(value);\n\n        return isValid\n            ? null\n            : {\n                message: 'LIBRARY.ERRORS.ILLEGAL_CHARACTERS'\n            };\n    }\n\n    private forbidOnlySpaces({ value }: FormControl) {\n        if (value === null || value.length === 0) {\n            return null;\n        }\n\n        const isValid: boolean = !!(value || '').trim();\n\n        return isValid\n            ? null\n            : {\n                message: 'LIBRARY.ERRORS.ONLY_SPACES'\n            };\n    }\n\n    private createSiteIdValidator() {\n        let timer;\n\n        return (control: AbstractControl) => {\n            if (timer) {\n                clearTimeout(timer);\n            }\n\n            return new Promise((resolve) => {\n                timer = setTimeout(() => {\n                    return this.sitesService.getSite(control.value).subscribe(\n                        () => resolve({ message: 'LIBRARY.ERRORS.EXISTENT_SITE' }),\n                        () => resolve(null)\n                    );\n                }, 300);\n            });\n        };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { CoreModule } from '@alfresco/adf-core';\n\nimport { MaterialModule } from '../material.module';\nimport { FolderDialogComponent } from './folder.dialog';\nimport { NodeLockDialogComponent } from './node-lock.dialog';\nimport { ConfirmDialogComponent } from './confirm.dialog';\nimport { MatDatetimepickerModule } from '@mat-datetimepicker/core';\nimport { MatMomentDatetimeModule } from '@mat-datetimepicker/moment';\nimport { LibraryDialogComponent } from './library/library.dialog';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        CoreModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MatMomentDatetimeModule,\n        MatDatetimepickerModule\n    ],\n    declarations: [\n        FolderDialogComponent,\n        NodeLockDialogComponent,\n        ConfirmDialogComponent,\n        LibraryDialogComponent\n    ],\n    exports: [\n        FolderDialogComponent,\n        NodeLockDialogComponent,\n        ConfirmDialogComponent,\n        LibraryDialogComponent\n    ]\n})\nexport class DialogModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* tslint:disable:no-input-rename  */\n\nimport { Directive, HostListener, Input, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Node } from '@alfresco/js-api';\nimport { FolderDialogComponent } from '../dialogs/folder.dialog';\nimport { ContentService } from '@alfresco/adf-core';\n\nconst DEFAULT_FOLDER_PARENT_ID = '-my-';\n\n@Directive({\n    selector: '[adf-create-folder]'\n})\nexport class FolderCreateDirective {\n    static DIALOG_WIDTH: number = 400;\n\n    /** Parent folder where the new folder will be located after creation. */\n    @Input('adf-create-folder')\n    parentNodeId: string = DEFAULT_FOLDER_PARENT_ID;\n\n    /** Title of folder creation dialog. */\n    @Input()\n    title: string = null;\n\n    /** Type of node to create. */\n    @Input()\n    nodeType = 'cm:folder';\n\n    /** Emitted when an error occurs (eg, a folder with same name already exists). */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter<any>();\n\n    /** Emitted when the folder is created successfully. */\n    @Output()\n    success: EventEmitter<Node> = new EventEmitter<Node>();\n\n    @HostListener('click', [ '$event' ])\n    onClick(event) {\n        event.preventDefault();\n        this.openDialog();\n    }\n\n    constructor(\n        public dialogRef: MatDialog,\n        public content: ContentService\n    ) {}\n\n    private get dialogConfig() {\n        const { DIALOG_WIDTH: width } = FolderCreateDirective;\n        const { parentNodeId, title: createTitle, nodeType } = this;\n\n        return {\n            data: { parentNodeId, createTitle, nodeType },\n            width: `${width}px`\n        };\n    }\n\n    private openDialog(): void {\n        const { dialogRef, dialogConfig, content } = this;\n        const dialogInstance = dialogRef.open(FolderDialogComponent, dialogConfig);\n\n        dialogInstance.componentInstance.error.subscribe((error) => {\n            this.error.emit(error);\n        });\n\n        dialogInstance.componentInstance.success.subscribe((node: Node) => {\n            this.success.emit(node);\n        });\n\n        dialogInstance.afterClosed().subscribe((node: Node) => {\n            if (node) {\n                content.folderCreate.next(node);\n            }\n        });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* tslint:disable:no-input-rename  */\n\nimport { Directive, ElementRef, HostListener, Input, Output, EventEmitter } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { Node } from '@alfresco/js-api';\n\nimport { FolderDialogComponent } from '../dialogs/folder.dialog';\nimport { ContentService } from '@alfresco/adf-core';\n\n@Directive({\n    selector: '[adf-edit-folder]'\n})\nexport class FolderEditDirective {\n    static DIALOG_WIDTH: number = 400;\n\n    /** Folder node to edit. */\n    @Input('adf-edit-folder')\n    folder: Node;\n\n    /** Emitted when an error occurs (eg, a folder with same name already exists). */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter<any>();\n\n    /** Title of folder edit dialog. */\n    @Input()\n    title: string = null;\n\n    /** Emitted when the folder has been edited successfully. */\n    @Output()\n    success: EventEmitter<Node> = new EventEmitter<Node>();\n\n    @HostListener('click', [ '$event' ])\n    onClick(event) {\n        event.preventDefault();\n        if (this.folder) {\n            this.openDialog();\n        }\n    }\n\n    constructor(\n        public dialogRef: MatDialog,\n        public elementRef: ElementRef,\n        public content: ContentService\n    ) {}\n\n    private get dialogConfig() {\n        const { DIALOG_WIDTH: width } = FolderEditDirective;\n        const { folder } = this;\n\n        return {\n            data: {\n                folder,\n                editTitle: this.title\n            },\n            width: `${width}px`\n        };\n    }\n\n    private openDialog(): void {\n        const { dialogRef, dialogConfig, content } = this;\n        const dialogInstance = dialogRef.open(FolderDialogComponent, dialogConfig);\n\n        dialogInstance.componentInstance.error.subscribe((error) => {\n            this.error.emit(error);\n        });\n\n        dialogInstance.componentInstance.success.subscribe((node: Node) => {\n            this.success.emit(node);\n        });\n\n        dialogInstance.afterClosed().subscribe((node: Node) => {\n            if (node) {\n                content.folderEdit.next(node);\n            }\n        });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\n\nimport { FolderCreateDirective } from './folder-create.directive';\nimport { FolderEditDirective } from './folder-edit.directive';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule\n    ],\n    declarations: [\n        FolderCreateDirective,\n        FolderEditDirective\n    ],\n    exports: [\n        FolderCreateDirective,\n        FolderEditDirective\n    ]\n})\nexport class FolderDirectiveModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { CardViewDateItemModel, CardViewTextItemModel, FileSizePipe } from '@alfresco/adf-core';\n@Injectable({\n    providedIn: 'root'\n})\nexport class BasicPropertiesService {\n\n    constructor(private fileSizePipe: FileSizePipe) {\n    }\n\n    getProperties(node: Node) {\n\n        const sizeInBytes = node.content ? node.content.sizeInBytes : '',\n            mimeTypeName = node.content ? node.content.mimeTypeName : '',\n            author = node.properties ? node.properties['cm:author'] : '',\n            description = node.properties ? node.properties['cm:description'] : '',\n            title = node.properties ? node.properties['cm:title'] : '';\n\n        return [\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.NAME',\n                value: node.name,\n                key: 'properties.cm:name',\n                editable: true\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.TITLE',\n                value: title,\n                key: 'properties.cm:title',\n                editable: true\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.CREATOR',\n                value: node.createdByUser.displayName,\n                key: 'createdByUser.displayName',\n                editable: false\n            }),\n            new CardViewDateItemModel({\n                label: 'CORE.METADATA.BASIC.CREATED_DATE',\n                value: node.createdAt,\n                key: 'createdAt',\n                editable: false,\n                format: 'mediumDate'\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.SIZE',\n                value: sizeInBytes,\n                key: 'content.sizeInBytes',\n                pipes: [{ pipe: this.fileSizePipe }],\n                editable: false\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.MODIFIER',\n                value: node.modifiedByUser.displayName,\n                key: 'modifiedByUser.displayName',\n                editable: false\n            }),\n            new CardViewDateItemModel({\n                label: 'CORE.METADATA.BASIC.MODIFIED_DATE',\n                value: node.modifiedAt,\n                key: 'modifiedAt',\n                editable: false,\n                format: 'mediumDate'\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.MIMETYPE',\n                value: mimeTypeName,\n                key: 'content.mimeTypeName',\n                editable: false\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.AUTHOR',\n                value: author,\n                key: 'properties.cm:author',\n                editable: true\n            }),\n            new CardViewTextItemModel({\n                label: 'CORE.METADATA.BASIC.DESCRIPTION',\n                value: description,\n                key: 'properties.cm:description',\n                multiline: true,\n                editable: true\n            })\n        ];\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport {\n    CardViewItemProperties,\n    CardViewItem,\n    CardViewTextItemModel,\n    CardViewBoolItemModel,\n    CardViewDateItemModel,\n    CardViewSelectItemModel,\n    CardViewDatetimeItemModel,\n    CardViewIntItemModel,\n    CardViewFloatItemModel,\n    LogService,\n    MultiValuePipe,\n    AppConfigService,\n    DecimalNumberPipe\n} from '@alfresco/adf-core';\nimport { Property, CardViewGroup, OrganisedPropertyGroup } from '../interfaces/content-metadata.interfaces';\nimport { of } from 'rxjs';\nimport { Definition, Constraint, Property as PropertyBase } from '@alfresco/js-api';\n\nconst D_TEXT = 'd:text';\nconst D_MLTEXT = 'd:mltext';\nconst D_DATE = 'd:date';\nconst D_DATETIME = 'd:datetime';\nconst D_INT = 'd:int';\nconst D_LONG = 'd:long';\nconst D_FLOAT = 'd:float';\nconst D_DOUBLE = 'd:double';\nconst D_BOOLEAN = 'd:boolean';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class PropertyGroupTranslatorService {\n\n    static readonly RECOGNISED_ECM_TYPES = [D_TEXT, D_MLTEXT, D_DATE, D_DATETIME, D_INT, D_LONG, D_FLOAT, D_DOUBLE, D_BOOLEAN];\n\n    valueSeparator: string;\n\n    constructor(private logService: LogService,\n                private multiValuePipe: MultiValuePipe,\n                private decimalNumberPipe: DecimalNumberPipe,\n                private appConfig: AppConfigService) {\n        this.valueSeparator = this.appConfig.get<string>('content-metadata.multi-value-pipe-separator');\n    }\n\n    public translateToCardViewGroups(propertyGroups: OrganisedPropertyGroup[], propertyValues, definition: Definition): CardViewGroup[] {\n        return propertyGroups.map((propertyGroup) => {\n            const translatedPropertyGroup: any = Object.assign({}, propertyGroup);\n            translatedPropertyGroup.properties = this.translateArray(propertyGroup.properties, propertyValues, definition);\n            return translatedPropertyGroup;\n        });\n    }\n\n    public translateProperty(property: PropertyBase, startValue?: any, allowEditing: boolean = false): CardViewItem {\n        this.checkECMTypeValidity(property.dataType);\n\n        const prefix = 'properties.';\n\n        const propertyDefinition: CardViewItemProperties = {\n            label: property.title || property.id,\n            value: startValue ? startValue : property.defaultValue,\n            key: `${prefix}${property.id}`,\n            default: property.defaultValue,\n            editable: property.isProtected ? false : allowEditing,\n            constraints: property?.constraints\n        };\n\n        return this.transform(propertyDefinition, property.dataType, property.isMultiValued);\n    }\n\n    private translateArray(properties: Property[], propertyValues: any, definition: Definition): CardViewItem[] {\n        return properties.map((property) => {\n            return this.translate(property, propertyValues, this.getPropertyConstraints(property.name, definition));\n        });\n    }\n\n    private translate(property: Property, propertyValues: any, constraints: Constraint[]): CardViewItem {\n        let propertyValue: any;\n        if (propertyValues && !this.isEmpty(propertyValues[property.name])) {\n            propertyValue = propertyValues[property.name];\n        }\n\n        this.checkECMTypeValidity(property.dataType);\n\n        const prefix = 'properties.';\n\n        const propertyDefinition: CardViewItemProperties = {\n            label: property.title || property.name,\n            value: propertyValue,\n            key: `${prefix}${property.name}`,\n            default: property.defaultValue,\n            editable: property.protected ? false : property.editable !== undefined ? property.editable : true,\n            constraints: constraints\n        };\n\n        return this.transform(propertyDefinition, property.dataType, property.multiValued);\n    }\n\n    private transform(propertyDefinition: CardViewItemProperties, dataType: string, isMultiValued: boolean): CardViewItem {\n        let cardViewItemProperty: CardViewItem;\n\n        if (this.isListOfValues(propertyDefinition.constraints)) {\n            const options = propertyDefinition.constraints[0].parameters.allowedValues.map((value) => ({ key: value, label: value }));\n            const properties = Object.assign(propertyDefinition, { options$: of(options) });\n\n            cardViewItemProperty = new CardViewSelectItemModel(properties);\n        } else {\n            switch (dataType) {\n                case D_MLTEXT:\n                    cardViewItemProperty = new CardViewTextItemModel(Object.assign(propertyDefinition, {\n                        multiline: true\n                    }));\n                    break;\n\n                case D_INT:\n                case D_LONG:\n                    cardViewItemProperty = new CardViewIntItemModel(Object.assign(propertyDefinition, {\n                        multivalued: isMultiValued,\n                        pipes: [{ pipe: this.multiValuePipe, params: [this.valueSeparator] }]\n                    }));\n                    break;\n\n                case D_FLOAT:\n                case D_DOUBLE:\n                    cardViewItemProperty = new CardViewFloatItemModel(Object.assign(propertyDefinition, {\n                        multivalued: isMultiValued,\n                        pipes: [\n                            { pipe: this.decimalNumberPipe },\n                            { pipe: this.multiValuePipe, params: [this.valueSeparator] }\n                        ]\n                    }));\n                    break;\n\n                case D_DATE:\n                    cardViewItemProperty = new CardViewDateItemModel(Object.assign(propertyDefinition, {\n                        multivalued: isMultiValued,\n                        pipes: [{ pipe: this.multiValuePipe, params: [this.valueSeparator] }]\n                    }));\n                    break;\n\n                case D_DATETIME:\n                    cardViewItemProperty = new CardViewDatetimeItemModel(Object.assign(propertyDefinition, {\n                        multivalued: isMultiValued,\n                        pipes: [{ pipe: this.multiValuePipe, params: [this.valueSeparator] }]\n                    }));\n                    break;\n\n                case D_BOOLEAN:\n                    cardViewItemProperty = new CardViewBoolItemModel(propertyDefinition);\n                    break;\n\n                case D_TEXT:\n                default:\n                    cardViewItemProperty = new CardViewTextItemModel(Object.assign(propertyDefinition, {\n                        multivalued: isMultiValued,\n                        multiline: isMultiValued,\n                        pipes: [{ pipe: this.multiValuePipe, params: [this.valueSeparator] }]\n                    }));\n            }\n        }\n\n        return cardViewItemProperty;\n    }\n\n    private isListOfValues(constraint: Constraint[]): boolean {\n        return constraint?.[0]?.type === 'LIST';\n    }\n\n    private getPropertyConstraints(propertyName: string, definition: Definition): Constraint[] {\n        return definition?.properties.find((item) => item.id === propertyName)?.constraints ?? [];\n    }\n\n    private checkECMTypeValidity(ecmPropertyType: string) {\n        if (PropertyGroupTranslatorService.RECOGNISED_ECM_TYPES.indexOf(ecmPropertyType) === -1) {\n            this.logService.error(`Unknown type for mapping: ${ecmPropertyType}`);\n        }\n    }\n\n    private isEmpty(value: any): boolean {\n        return value === undefined || value === null || value === '';\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PropertyGroup, Property, PropertyGroupContainer } from '../../interfaces/content-metadata.interfaces';\n\nconst emptyGroup = {\n    properties: {}\n};\n\nfunction convertObjectToArray(object: any): Property[] {\n    return Object.keys(object).map((key) => object[key]);\n}\n\nexport function getGroup(propertyGroups: PropertyGroupContainer, groupName: string): PropertyGroup | undefined {\n    return propertyGroups[groupName];\n}\n\nexport function getProperty(propertyGroups: PropertyGroupContainer, groupName: string, propertyName: string): Property | Property[] | undefined {\n    const groupDefinition = getGroup(propertyGroups, groupName) || emptyGroup;\n    let propertyDefinitions;\n\n    if (propertyName === '*') {\n        propertyDefinitions = convertObjectToArray(groupDefinition.properties);\n    } else {\n        propertyDefinitions = groupDefinition.properties[propertyName];\n    }\n\n    return propertyDefinitions;\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentMetadataConfig, OrganisedPropertyGroup, PropertyGroupContainer, Property } from '../../interfaces/content-metadata.interfaces';\nimport { getGroup, getProperty } from './property-group-reader';\n\nexport class AspectOrientedConfigService implements ContentMetadataConfig {\n\n    constructor(private config: any) { }\n\n    public isGroupAllowed(groupName: string): boolean {\n        if (this.isIncludeAllEnabled()) {\n            return true;\n        }\n        const groupNames = Object.keys(this.config);\n        return groupNames.indexOf(groupName) !== -1;\n    }\n\n    public reorganiseByConfig(propertyGroups: PropertyGroupContainer): OrganisedPropertyGroup[] {\n        const aspects = this.config,\n            aspectNames = Object.keys(aspects);\n\n        return aspectNames\n            .reduce((groupAccumulator, aspectName) => {\n                const newGroup = this.getOrganisedPropertyGroup(propertyGroups, aspectName);\n                return groupAccumulator.concat(newGroup);\n            }, [])\n            .filter((organisedPropertyGroup) => organisedPropertyGroup.properties.length > 0);\n    }\n\n    public appendAllPreset(propertyGroups: PropertyGroupContainer): OrganisedPropertyGroup[] {\n        const groups = Object.keys(propertyGroups)\n            .map((groupName) => {\n                const propertyGroup = propertyGroups[groupName],\n                    properties = propertyGroup.properties;\n\n                if (this.isAspectReadOnly(groupName)) {\n                    Object.keys(properties).map((propertyName) => this.setReadOnlyProperty(properties[propertyName]));\n                }\n\n                return Object.assign({}, propertyGroup, {\n                    properties: Object.keys(properties).map((propertyName) => {\n                        if (this.isPropertyReadOnly(propertyName)) {\n                            this.setReadOnlyProperty(properties[propertyName]);\n                        }\n                        return properties[propertyName];\n                    })\n                });\n            });\n\n        return groups;\n    }\n\n    private setReadOnlyProperty(property: Property) {\n        property.editable = false;\n    }\n\n    private isPropertyReadOnly(propertyName: string): boolean {\n        const readOnlyAspects = this.config.readOnlyProperties;\n\n        if (Array.isArray(readOnlyAspects)) {\n            return readOnlyAspects.includes(propertyName);\n        } else {\n            return readOnlyAspects === propertyName;\n        }\n    }\n\n    private isAspectReadOnly(propertyGroupName: string): boolean {\n        const readOnlyAspects = this.config.readOnlyAspects;\n\n        if (Array.isArray(readOnlyAspects)) {\n            return readOnlyAspects.includes(propertyGroupName);\n        } else {\n            return readOnlyAspects === propertyGroupName;\n        }\n\n    }\n\n    public filterExcludedPreset(propertyGroups: OrganisedPropertyGroup[]): OrganisedPropertyGroup[] {\n        if (this.config.exclude) {\n            return propertyGroups.filter((preset) => {\n                return !this.config.exclude.includes(preset.name);\n            });\n        }\n        return propertyGroups;\n    }\n\n    public isIncludeAllEnabled() {\n        return this.config.includeAll;\n    }\n\n    private getOrganisedPropertyGroup(propertyGroups, aspectName) {\n        const group = getGroup(propertyGroups, aspectName);\n        let newGroup = [];\n\n        if (group) {\n            const aspectProperties = this.config[aspectName];\n            let properties;\n\n            if (aspectProperties === '*') {\n                properties = getProperty(propertyGroups, aspectName, aspectProperties);\n            } else {\n                properties = (<string[]> aspectProperties)\n                    .map((propertyName) => getProperty(propertyGroups, aspectName, propertyName))\n                    .filter((props) => props !== undefined);\n            }\n\n            newGroup = [{ title: group.title, properties }];\n        }\n\n        return newGroup;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ContentMetadataConfig, OrganisedPropertyGroup,\n    PropertyGroupContainer\n} from '../../interfaces/content-metadata.interfaces';\n\nexport class IndifferentConfigService implements ContentMetadataConfig {\n\n    isGroupAllowed(): boolean {\n        return true;\n    }\n\n    reorganiseByConfig(propertyGroups: PropertyGroupContainer): OrganisedPropertyGroup[] {\n        return Object.keys(propertyGroups)\n            .map((groupName) => {\n                const propertyGroup = propertyGroups[groupName],\n                    properties = propertyGroup.properties;\n\n                return Object.assign({}, propertyGroup, {\n                    properties: Object.keys(properties).map((propertyName) => properties[propertyName])\n                });\n            });\n    }\n\n    filterExcludedPreset(propertyGroups: OrganisedPropertyGroup[]): OrganisedPropertyGroup[] {\n        return propertyGroups;\n    }\n\n    appendAllPreset(): OrganisedPropertyGroup[] {\n        return[];\n    }\n\n    isIncludeAllEnabled(): boolean {\n        return true;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    ContentMetadataConfig,\n    LayoutOrientedConfigItem,\n    OrganisedPropertyGroup,\n    PropertyGroupContainer,\n    Property\n} from '../../interfaces/content-metadata.interfaces';\nimport { getProperty } from './property-group-reader';\n\nexport class LayoutOrientedConfigService implements ContentMetadataConfig {\n\n    constructor(private config: any) { }\n\n    public isGroupAllowed(groupName: string): boolean {\n        if (this.isIncludeAllEnabled()) {\n            return true;\n        }\n        return this.getMatchingGroups(groupName).length > 0;\n    }\n\n    public reorganiseByConfig(propertyGroups: PropertyGroupContainer): OrganisedPropertyGroup[] {\n        const layoutBlocks = this.config.filter((itemsGroup) => itemsGroup.items);\n\n        const organisedPropertyGroup = layoutBlocks.map((layoutBlock) => {\n            const flattenedItems = this.flattenItems(layoutBlock.items),\n                properties = flattenedItems.reduce((props, explodedItem) => {\n                    const isProperty = typeof explodedItem.property  === 'object';\n                    const propertyName = isProperty ? explodedItem.property.name : explodedItem.property;\n                    let  property = getProperty(propertyGroups, explodedItem.groupName, propertyName) || [];\n                    if (isProperty) { property = this.setPropertyTitle(property, explodedItem.property); }\n                    property = this.setEditableProperty(property, explodedItem);\n                    return props.concat(property);\n                }, []);\n\n            return {\n                title: layoutBlock.title,\n                properties\n            };\n        });\n\n        return organisedPropertyGroup;\n    }\n\n    public appendAllPreset(propertyGroups: PropertyGroupContainer): OrganisedPropertyGroup[] {\n        return Object.keys(propertyGroups)\n            .map((groupName) => {\n                const propertyGroup = propertyGroups[groupName],\n                    properties = propertyGroup.properties;\n\n                return Object.assign({}, propertyGroup, {\n                    properties: Object.keys(properties).map((propertyName) => properties[propertyName])\n                });\n            });\n    }\n\n    public filterExcludedPreset(propertyGroups: OrganisedPropertyGroup[]): OrganisedPropertyGroup[] {\n        let excludedConfig = this.config\n            .map((config) => config.exclude)\n            .find((exclude) => exclude !== undefined);\n\n        if (excludedConfig === undefined) {\n            excludedConfig = [];\n        } else if (typeof excludedConfig === 'string') {\n            excludedConfig = [excludedConfig];\n        }\n\n        return propertyGroups.filter((props) => {\n            return !excludedConfig.includes(props.name);\n        });\n    }\n\n    public isIncludeAllEnabled() {\n        const includeAllProperty = this.config\n            .map((config) => config.includeAll)\n            .find((includeAll) => includeAll !== undefined);\n\n        return includeAllProperty !== undefined ? includeAllProperty : false;\n    }\n\n    private setEditableProperty(propertyGroup: Property | Property[], itemConfig): Property | Property[] {\n        if (Array.isArray(propertyGroup)) {\n            propertyGroup.map((property) => property.editable = itemConfig.editable !== undefined ? itemConfig.editable : true);\n        } else {\n            propertyGroup.editable = itemConfig.editable !== undefined ? itemConfig.editable : true;\n        }\n\n        return propertyGroup;\n    }\n\n    private setPropertyTitle(item: Property | Property[], property: Property): Property | Property[] {\n        if (!Array.isArray(item)) {\n            return { ...item, ...(item.name === property.name && !!property.title) && { title: property.title } };\n        }\n        return item;\n    }\n\n    private flattenItems(items) {\n        return items.reduce((accumulator, item) => {\n            const properties = Array.isArray(item.properties) ? item.properties : [item.properties];\n            const flattenedProperties = properties.map((property) => {\n                return {\n                    groupName: item.aspect || item.type,\n                    property,\n                    editable: item.editable\n                };\n            });\n\n            return accumulator.concat(flattenedProperties);\n        }, []);\n    }\n\n    private getMatchingGroups(groupName: string): LayoutOrientedConfigItem[] {\n        return this.config\n            .map((layoutBlock) => layoutBlock.items)\n            .reduce((accumulator, items) => accumulator.concat(items), [])\n            .filter((item) => item.aspect === groupName || item.type === groupName);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AppConfigService, LogService } from '@alfresco/adf-core';\nimport { AspectOrientedConfigService } from './aspect-oriented-config.service';\nimport { IndifferentConfigService } from './indifferent-config.service';\nimport { LayoutOrientedConfigService } from './layout-oriented-config.service';\nimport {\n    PresetConfig,\n    ContentMetadataConfig,\n    AspectOrientedConfig,\n    LayoutOrientedConfig\n} from '../../interfaces/content-metadata.interfaces';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ContentMetadataConfigFactory {\n\n    static readonly INDIFFERENT_PRESET = '*';\n    static readonly DEFAULT_PRESET_NAME = 'default';\n\n    constructor(private appConfigService: AppConfigService, private logService: LogService) {}\n\n    public get(presetName: string = 'default'): ContentMetadataConfig {\n        let presetConfig: PresetConfig;\n        try {\n            presetConfig = this.appConfigService.config['content-metadata'].presets[presetName];\n        } catch {\n            if (presetName !== ContentMetadataConfigFactory.DEFAULT_PRESET_NAME) {\n                this.logService.error(`No content-metadata preset for: ${presetName}`);\n            }\n            presetConfig = ContentMetadataConfigFactory.INDIFFERENT_PRESET;\n        }\n\n        return this.createConfig(presetConfig);\n    }\n\n    public createConfig(presetConfig: PresetConfig): ContentMetadataConfig {\n        let config: ContentMetadataConfig;\n\n        if (this.isLayoutOrientedPreset(presetConfig)) {\n            config = new LayoutOrientedConfigService(<LayoutOrientedConfig> presetConfig);\n        } else if (this.isAspectOrientedPreset(presetConfig)) {\n            config = new AspectOrientedConfigService(<AspectOrientedConfig> presetConfig);\n        } else {\n            config = new IndifferentConfigService();\n        }\n\n        Object.freeze(config);\n        return config;\n    }\n\n    private isAspectOrientedPreset(presetConfig: PresetConfig): boolean {\n        return this.isObject(presetConfig);\n    }\n\n    private isLayoutOrientedPreset(presetConfig: PresetConfig): boolean {\n        return Array.isArray(presetConfig);\n    }\n\n    private isObject(x: any): boolean {\n        return x != null && typeof x === 'object';\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { Observable, defer, forkJoin } from 'rxjs';\nimport { PropertyGroup, PropertyGroupContainer } from '../interfaces/content-metadata.interfaces';\nimport { map } from 'rxjs/operators';\nimport { ClassesApi } from '@alfresco/js-api';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class PropertyDescriptorsService {\n\n    private _classesApi;\n    get classesApi(): ClassesApi {\n        this._classesApi = this._classesApi ?? new ClassesApi(this.alfrescoApiService.getInstance());\n        return this._classesApi;\n    }\n\n    constructor(private alfrescoApiService: AlfrescoApiService) {\n    }\n\n    load(groupNames: string[]): Observable<PropertyGroupContainer> {\n        const groupFetchStreams = groupNames\n            .map((groupName) => groupName.replace(':', '_'))\n            .map((groupName) => defer(() => this.classesApi.getClass(groupName)));\n\n        return forkJoin(groupFetchStreams).pipe(\n            map(this.convertToObject)\n        );\n    }\n\n    private convertToObject(propertyGroupsArray: PropertyGroup[]): PropertyGroupContainer {\n        return propertyGroupsArray.reduce((propertyGroups, propertyGroup) => {\n            return Object.assign({}, propertyGroups, {\n                [propertyGroup.name]: propertyGroup\n            });\n        }, {});\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TypeEntry, TypePaging, TypesApi } from '@alfresco/js-api';\nimport { Injectable } from '@angular/core';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { from, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\n@Injectable({\n    providedIn: 'root'\n})\nexport class ContentTypeService {\n\n    _typesApi: TypesApi;\n    get typesApi(): TypesApi {\n        this._typesApi = this._typesApi ?? new TypesApi(this.alfrescoApiService.getInstance());\n        return this._typesApi;\n    }\n\n    constructor(private alfrescoApiService: AlfrescoApiService) {\n    }\n\n    getContentTypeByPrefix(prefixedType: string): Observable<TypeEntry> {\n        return from(this.typesApi.getType(prefixedType));\n    }\n\n    getContentTypeChildren(nodeType: string): Observable<TypeEntry[]> {\n        const where = `(parentId in ('${nodeType}') and not namespaceUri matches('http://www.alfresco.*'))`;\n        const opts: any = {\n            where,\n            include: ['properties']\n        };\n        return from(this.typesApi.listTypes(opts)).pipe(\n            map((result: TypePaging) => result.list.entries)\n        );\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { TypeEntry } from '@alfresco/js-api';\nimport { Component, Inject, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { ContentTypeDialogComponentData } from './content-type-metadata.interface';\nimport { ContentTypeService } from './content-type.service';\n\n@Component({\n    selector: 'adf-content-type-dialog',\n    templateUrl: './content-type-dialog.component.html',\n    styleUrls: ['./content-type-dialog.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class ContentTypeDialogComponent implements OnInit {\n\n    title: string;\n    description: string;\n    nodeType: string;\n    confirmMessage: string;\n\n    currentContentType: TypeEntry;\n    typeProperties: any[] = [];\n\n    propertyColumns: string[] = ['name', 'title', 'dataType'];\n\n    constructor(private dialog: MatDialogRef<ContentTypeDialogComponent>,\n                @Inject(MAT_DIALOG_DATA) public data: ContentTypeDialogComponentData,\n                private contentTypeService: ContentTypeService) {\n        this.title = data.title;\n        this.description = data.description;\n        this.confirmMessage = data.confirmMessage;\n        this.nodeType = data.nodeType;\n\n        this.contentTypeService.getContentTypeByPrefix(this.nodeType).subscribe((contentTypeEntry) => {\n            this.currentContentType = contentTypeEntry;\n            this.typeProperties = this.currentContentType.entry.properties.filter((property) => property.id.startsWith(this.currentContentType.entry.model.namespacePrefix));\n        });\n    }\n\n    ngOnInit() {\n        this.dialog.backdropClick().subscribe(() => {\n            this.close();\n        });\n    }\n\n    close() {\n        this.data.select.complete();\n    }\n\n    onCancel() {\n        this.close();\n    }\n\n    onApply() {\n        this.data.select.next(true);\n        this.close();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { CardViewItem, CardViewSelectItemModel, CardViewSelectItemOption, CardViewTextItemModel, VersionCompatibilityService } from '@alfresco/adf-core';\nimport { Observable, of, Subject, zip } from 'rxjs';\nimport { distinctUntilChanged, map } from 'rxjs/operators';\nimport { ContentTypeDialogComponent } from '../../content-type/content-type-dialog.component';\nimport { ContentTypeDialogComponentData } from '../../content-type/content-type-metadata.interface';\nimport { ContentTypeService } from '../../content-type/content-type.service';\nimport { Node, Property, TypeEntry } from '@alfresco/js-api';\nimport { PropertyGroupTranslatorService } from './property-groups-translator.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class ContentTypePropertiesService {\n\n    constructor(private contentTypeService: ContentTypeService,\n                private dialog: MatDialog,\n                private versionCompatibilityService: VersionCompatibilityService,\n                private propertyGroupTranslatorService: PropertyGroupTranslatorService) {\n    }\n\n    getContentTypeCardItem(node: Node): Observable<CardViewItem[]> {\n        if (this.versionCompatibilityService.isVersionSupported('7')) {\n            return this.contentTypeService.getContentTypeByPrefix(node.nodeType).\n                pipe(\n                    map((contentType) => {\n                        const contentTypesOptions$ = this.getContentTypesAsSelectOption(contentType);\n                        const contentTypeCard = this.buildContentTypeSelectCardModel(contentType.entry.id, contentTypesOptions$);\n                        const filteredProperties =  this.getContentTypeSpecificProperties(contentType);\n                        const propertiesCard = this.buildCardItemsFromPropertyList(filteredProperties, node.properties);\n                        return [contentTypeCard, ...propertiesCard];\n                    }));\n        } else {\n            return of([this.buildContentTypeTextCardModel(node.nodeType)]);\n        }\n    }\n\n    buildCardItemsFromPropertyList(properties: Property[], currentProperties: any): CardViewItem[] {\n        return properties.map((property) => {\n            const propertyValue = currentProperties ? currentProperties[property.id] : null;\n            return this.buildCardItemFromProperty(property, propertyValue);\n        });\n    }\n\n    private buildCardItemFromProperty(property: Property, propertyValue: any): CardViewItem {\n        return this.propertyGroupTranslatorService.translateProperty(property, propertyValue, true);\n    }\n\n    private getContentTypeSpecificProperties(contentType: TypeEntry): Property[] {\n        return contentType.entry.properties.filter((property) => property.id.startsWith(contentType.entry.model.namespacePrefix));\n    }\n\n    private buildContentTypeTextCardModel(currentValue: string): CardViewTextItemModel {\n        const contentTypeCard = new CardViewTextItemModel({\n            label: 'CORE.METADATA.BASIC.CONTENT_TYPE',\n            value: currentValue,\n            key: 'nodeType',\n            editable: false\n        });\n\n        return contentTypeCard;\n    }\n\n    private buildContentTypeSelectCardModel(currentValue: string, options$: Observable<CardViewSelectItemOption<string>[]>): CardViewSelectItemModel<string> {\n        const contentTypeCard = new CardViewSelectItemModel({\n            label: 'CORE.METADATA.BASIC.CONTENT_TYPE',\n            value: currentValue,\n            key: 'nodeType',\n            editable: true,\n            options$: options$,\n            displayNoneOption: false\n        });\n\n        return contentTypeCard;\n    }\n\n    private getContentTypesAsSelectOption(currentType: TypeEntry): Observable<CardViewSelectItemOption<string>[]> {\n        const childrenTypes$ = this.contentTypeService.getContentTypeChildren(currentType.entry.id);\n        return zip(childrenTypes$, of(currentType)).pipe(\n            distinctUntilChanged(),\n            map(([contentTypesEntries, currentContentType]) => {\n                const updatedTypes = this.appendCurrentType(currentContentType, contentTypesEntries);\n                return updatedTypes.map((contentType) => <CardViewSelectItemOption<string>> { key: contentType.entry.id, label: contentType.entry.title ?? contentType.entry.id });\n            }));\n    }\n\n    private appendCurrentType(currentType: TypeEntry, contentTypesEntries: TypeEntry[]): TypeEntry[] {\n        const resultTypes = [...contentTypesEntries];\n        const currentTypePresent = contentTypesEntries.find((type) => type.entry.id === currentType.entry.id);\n        if (!currentTypePresent) {\n            resultTypes.push(currentType);\n        }\n        return resultTypes;\n    }\n\n    openContentTypeDialogConfirm(nodeType): Observable<boolean> {\n        const select = new Subject<boolean>();\n        select.subscribe({\n            complete: this.close.bind(this)\n        });\n\n        const data: ContentTypeDialogComponentData = {\n            title: 'CORE.METADATA.CONTENT_TYPE.DIALOG.TITLE',\n            description: 'CORE.METADATA.CONTENT_TYPE.DIALOG.DESCRIPTION',\n            confirmMessage: 'CORE.METADATA.CONTENT_TYPE.DIALOG.CONFIRM',\n            select: select,\n            nodeType\n        };\n\n        this.openDialog(data, 'adf-content-type-dialog', '600px');\n        return select;\n    }\n\n    close() {\n        this.dialog.closeAll();\n    }\n\n    private openDialog(data: ContentTypeDialogComponentData, panelClass: string, width: string) {\n        this.dialog.open(ContentTypeDialogComponent, {\n            data,\n            panelClass,\n            width,\n            disableClose: true\n        });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { BasicPropertiesService } from './basic-properties.service';\nimport { Observable, of, iif, Subject } from 'rxjs';\nimport { PropertyGroupTranslatorService } from './property-groups-translator.service';\nimport { CardViewItem } from '@alfresco/adf-core';\nimport { CardViewGroup, OrganisedPropertyGroup, PresetConfig } from '../interfaces/content-metadata.interfaces';\nimport { ContentMetadataConfigFactory } from './config/content-metadata-config.factory';\nimport { PropertyDescriptorsService } from './property-descriptors.service';\nimport { map, switchMap } from 'rxjs/operators';\nimport { ContentTypePropertiesService } from './content-type-property.service';\n@Injectable({\n    providedIn: 'root'\n})\nexport class ContentMetadataService {\n\n    error = new Subject<{ statusCode: number, message: string }>();\n\n    constructor(private basicPropertiesService: BasicPropertiesService,\n                private contentMetadataConfigFactory: ContentMetadataConfigFactory,\n                private propertyGroupTranslatorService: PropertyGroupTranslatorService,\n                private propertyDescriptorsService: PropertyDescriptorsService,\n                private contentTypePropertyService: ContentTypePropertiesService) {\n    }\n\n    getBasicProperties(node: Node): Observable<CardViewItem[]> {\n        return of(this.basicPropertiesService.getProperties(node));\n    }\n\n    getContentTypeProperty(node: Node): Observable<CardViewItem[]> {\n        return this.contentTypePropertyService.getContentTypeCardItem(node);\n    }\n\n    openConfirmDialog(changedProperties): Observable<any> {\n        return this.contentTypePropertyService.openContentTypeDialogConfirm(changedProperties.nodeType);\n    }\n\n    getGroupedProperties(node: Node, preset: string | PresetConfig = 'default'): Observable<CardViewGroup[]> {\n        let groupedProperties = of([]);\n\n        if (node.aspectNames) {\n            let contentMetadataConfig;\n            if (typeof preset === 'string') {\n                contentMetadataConfig = this.contentMetadataConfigFactory.get(preset);\n            } else {\n                contentMetadataConfig = this.contentMetadataConfigFactory.createConfig(preset);\n            }\n\n            const groupNames = node.aspectNames\n                .concat(node.nodeType)\n                .filter((groupName) => contentMetadataConfig.isGroupAllowed(groupName));\n\n            if (groupNames.length > 0) {\n                groupedProperties = this.propertyDescriptorsService.load(groupNames).pipe(\n                    switchMap((groups) =>\n                        iif(\n                            () => contentMetadataConfig.isIncludeAllEnabled(),\n                            of(contentMetadataConfig.appendAllPreset(groups).concat(contentMetadataConfig.reorganiseByConfig(groups))),\n                            of(contentMetadataConfig.reorganiseByConfig(groups))\n                        )),\n                    map((groups) => contentMetadataConfig.filterExcludedPreset(groups)),\n                    map((groups) => this.filterEmptyPreset(groups)),\n                    map((groups) => this.setTitleToNameIfNotSet(groups)),\n                    map((groups) => this.propertyGroupTranslatorService.translateToCardViewGroups(groups, node.properties, node.definition))\n                );\n            }\n        }\n\n        return groupedProperties;\n    }\n\n    setTitleToNameIfNotSet(propertyGroups: OrganisedPropertyGroup[]): OrganisedPropertyGroup[] {\n        propertyGroups.map((propertyGroup) => {\n            propertyGroup.title = propertyGroup.title || propertyGroup.name;\n        });\n        return propertyGroups;\n    }\n\n    filterEmptyPreset(propertyGroups: OrganisedPropertyGroup[]): OrganisedPropertyGroup[]  {\n        return propertyGroups.filter((props) => props.properties.length);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges, ViewEncapsulation } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { Observable, Subject, of, zip } from 'rxjs';\nimport {\n    CardViewItem,\n    NodesApiService,\n    LogService,\n    CardViewUpdateService,\n    AlfrescoApiService,\n    TranslationService,\n    AppConfigService,\n    CardViewBaseItemModel,\n    UpdateNotification\n} from '@alfresco/adf-core';\nimport { ContentMetadataService } from '../../services/content-metadata.service';\nimport { CardViewGroup, PresetConfig } from '../../interfaces/content-metadata.interfaces';\nimport { takeUntil, debounceTime, catchError, map } from 'rxjs/operators';\n\n@Component({\n    selector: 'adf-content-metadata',\n    templateUrl: './content-metadata.component.html',\n    styleUrls: ['./content-metadata.component.scss'],\n    host: { 'class': 'adf-content-metadata' },\n    encapsulation: ViewEncapsulation.None\n})\nexport class ContentMetadataComponent implements OnChanges, OnInit, OnDestroy {\n\n    static DEFAULT_SEPARATOR = ', ';\n\n    protected onDestroy$ = new Subject<boolean>();\n\n    /** (required) The node entity to fetch metadata about */\n    @Input()\n    node: Node;\n\n    /** Toggles whether the edit button should be shown */\n    @Input()\n    editable: boolean = false;\n\n    /** Toggles whether to display empty values in the card view */\n    @Input()\n    displayEmpty: boolean = false;\n\n    /** Toggles between expanded (ie, full information) and collapsed\n     * (ie, reduced information) in the display\n     */\n    @Input()\n    expanded: boolean = false;\n\n    /** The multi parameter of the underlying material expansion panel, set to true to allow multi accordion to be expanded at the same time */\n    @Input()\n    multi = false;\n\n    /** Name or configuration of the metadata preset, which defines aspects and their properties */\n    @Input()\n    preset: string | PresetConfig;\n\n    /** Toggles whether the metadata properties should be shown */\n    @Input()\n    displayDefaultProperties: boolean = true;\n\n    /** (optional) shows the given aspect in the expanded  card */\n    @Input()\n    displayAspect: string = null;\n\n    /** Toggles whether or not to enable copy to clipboard action. */\n    @Input()\n    copyToClipboardAction: boolean = true;\n\n    /** Toggles whether or not to enable chips for multivalued properties. */\n    @Input()\n    useChipsForMultiValueProperty: boolean = true;\n\n    multiValueSeparator: string;\n    basicProperties$: Observable<CardViewItem[]>;\n    groupedProperties$: Observable<CardViewGroup[]>;\n\n    changedProperties = {};\n    hasMetadataChanged = false;\n    private targetProperty: CardViewBaseItemModel;\n\n    constructor(\n        private contentMetadataService: ContentMetadataService,\n        private cardViewUpdateService: CardViewUpdateService,\n        private nodesApiService: NodesApiService,\n        private logService: LogService,\n        private alfrescoApiService: AlfrescoApiService,\n        private translationService: TranslationService,\n        private appConfig: AppConfigService\n    ) {\n        this.copyToClipboardAction = this.appConfig.get<boolean>('content-metadata.copy-to-clipboard-action');\n        this.multiValueSeparator = this.appConfig.get<string>('content-metadata.multi-value-pipe-separator') || ContentMetadataComponent.DEFAULT_SEPARATOR;\n        this.useChipsForMultiValueProperty = this.appConfig.get<boolean>('content-metadata.multi-value-chips');\n    }\n\n    ngOnInit() {\n        this.cardViewUpdateService.itemUpdated$\n            .pipe(\n                debounceTime(500),\n                takeUntil(this.onDestroy$))\n            .subscribe(\n                (updatedNode: UpdateNotification) => {\n                    this.hasMetadataChanged = true;\n                    this.targetProperty = updatedNode.target;\n                    this.updateChanges(updatedNode.changed);\n                }\n            );\n\n        this.cardViewUpdateService.updatedAspect$.pipe(\n            debounceTime(500),\n            takeUntil(this.onDestroy$))\n            .subscribe((node) => this.loadProperties(node));\n\n        this.loadProperties(this.node);\n    }\n\n    protected handleUpdateError(error: Error) {\n        this.logService.error(error);\n\n        let statusCode = 0;\n\n        try {\n            statusCode = JSON.parse(error.message).error.statusCode;\n        } catch {\n        }\n\n        let message = `METADATA.ERRORS.${statusCode}`;\n\n        if (this.translationService.instant(message) === message) {\n            message = 'METADATA.ERRORS.GENERIC';\n        }\n\n        this.contentMetadataService.error.next({\n            statusCode,\n            message\n        });\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (changes.node && !changes.node.firstChange) {\n            this.loadProperties(changes.node.currentValue);\n        }\n    }\n\n    private loadProperties(node: Node) {\n        if (node) {\n            this.basicProperties$ = this.getProperties(node);\n            this.groupedProperties$ = this.contentMetadataService.getGroupedProperties(node, this.preset);\n        }\n    }\n\n    private getProperties(node: Node) {\n        const properties$ = this.contentMetadataService.getBasicProperties(node);\n        const contentTypeProperty$ = this.contentMetadataService.getContentTypeProperty(node);\n        return zip(properties$, contentTypeProperty$)\n            .pipe(map(([properties, contentTypeProperty]) => {\n                const filteredProperties = contentTypeProperty.filter((property) => properties.findIndex((baseProperty) => baseProperty.key === property.key) === -1);\n                return [...properties, ...filteredProperties];\n            }));\n    }\n\n    updateChanges(updatedNodeChanges) {\n        Object.keys(updatedNodeChanges).map((propertyGroup: string) => {\n            if (typeof updatedNodeChanges[propertyGroup] === 'object') {\n                this.changedProperties[propertyGroup] = {\n                    ...this.changedProperties[propertyGroup],\n                    ...updatedNodeChanges[propertyGroup]\n                };\n            } else {\n                this.changedProperties[propertyGroup] = updatedNodeChanges[propertyGroup];\n            }\n        });\n    }\n\n    saveChanges() {\n        if (this.hasContentTypeChanged(this.changedProperties)) {\n            this.contentMetadataService.openConfirmDialog(this.changedProperties).subscribe(() => {\n                this.updateNode();\n            });\n        } else {\n            this.updateNode();\n        }\n    }\n\n    private updateNode() {\n        this.nodesApiService.updateNode(this.node.id, this.changedProperties).pipe(\n            catchError((err) => {\n                this.cardViewUpdateService.updateElement(this.targetProperty);\n                this.handleUpdateError(err);\n                return of(null);\n            }))\n            .subscribe((updatedNode) => {\n                if (updatedNode) {\n                    if (this.hasContentTypeChanged(this.changedProperties)) {\n                        this.cardViewUpdateService.updateNodeAspect(this.node);\n                    }\n                    this.revertChanges();\n                    Object.assign(this.node, updatedNode);\n                    this.alfrescoApiService.nodeUpdated.next(this.node);\n                }\n            });\n    }\n\n    private hasContentTypeChanged(changedProperties): boolean {\n        return !!changedProperties?.nodeType;\n    }\n\n    revertChanges() {\n        this.changedProperties = {};\n        this.hasMetadataChanged = false;\n    }\n\n    cancelChanges() {\n        this.revertChanges();\n        this.loadProperties(this.node);\n    }\n\n    showGroup(group: CardViewGroup): boolean {\n        const properties = group.properties.filter((property) => {\n            return !this.isEmpty(property.displayValue);\n        });\n\n        return properties.length > 0;\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    public canExpandTheCard(group: CardViewGroup): boolean {\n        return group.title === this.displayAspect;\n    }\n\n    public canExpandProperties(): boolean {\n        return !this.expanded || this.displayAspect === 'Properties';\n    }\n\n    keyDown(event: KeyboardEvent) {\n        if (event.keyCode === 37 || event.keyCode === 39) { // ArrowLeft && ArrowRight\n            event.stopPropagation();\n        }\n    }\n\n    private isEmpty(value: any): boolean {\n        return value === undefined || value === null || value === '';\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, OnInit, ViewEncapsulation } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { AspectListDialogComponentData } from './aspect-list-dialog-data.interface';\n@Component({\n    selector: 'adf-aspect-list-dialog',\n    templateUrl: './aspect-list-dialog.component.html',\n    styleUrls: ['./aspect-list-dialog.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class AspectListDialogComponent implements OnInit {\n\n    title: string;\n    description: string;\n    currentNodeId: string;\n    overTableMessage: string;\n\n    currentAspectSelection: string[] = [];\n\n    constructor(private dialog: MatDialogRef<AspectListDialogComponent>,\n                @Inject(MAT_DIALOG_DATA) public data: AspectListDialogComponentData) {\n        this.title = data.title;\n        this.description = data.description;\n        this.overTableMessage = data.overTableMessage;\n        this.currentNodeId = data.nodeId;\n    }\n\n    ngOnInit() {\n        this.dialog.backdropClick().subscribe(() => {\n            this.close();\n        });\n        this.dialog.keydownEvents().subscribe(event => {\n            // Esc\n            if (event.keyCode === 27) {\n                event.preventDefault();\n                event.stopImmediatePropagation();\n                this.close();\n            }\n        });\n    }\n\n    onValueChanged(aspectList: string[]) {\n       this.currentAspectSelection = aspectList;\n    }\n\n    close() {\n        this.data.select.complete();\n    }\n\n    onCancel() {\n        this.close();\n    }\n\n    onApply() {\n        this.data.select.next(this.currentAspectSelection);\n        this.close();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { AlfrescoApiService, AppConfigService, LogService } from '@alfresco/adf-core';\nimport { from, Observable, of, Subject, zip } from 'rxjs';\nimport { AspectListDialogComponentData } from './aspect-list-dialog-data.interface';\nimport { AspectListDialogComponent } from './aspect-list-dialog.component';\nimport { catchError, map } from 'rxjs/operators';\nimport { AspectEntry, AspectPaging, AspectsApi } from '@alfresco/js-api';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class AspectListService {\n\n    _aspectsApi: AspectsApi;\n    get aspectsApi(): AspectsApi {\n        this._aspectsApi = this._aspectsApi ?? new AspectsApi(this.alfrescoApiService.getInstance());\n        return this._aspectsApi;\n    }\n\n    constructor(private alfrescoApiService: AlfrescoApiService,\n                private appConfigService: AppConfigService,\n                private dialog: MatDialog,\n                private logService: LogService) {\n    }\n\n    getAspects(): Observable<AspectEntry[]> {\n        const visibleAspectList = this.getVisibleAspects();\n        const standardAspects$ = this.getStandardAspects(visibleAspectList);\n        const customAspects$ = this.getCustomAspects();\n        return zip(standardAspects$, customAspects$).pipe(\n            map(([standardAspectList, customAspectList]) => [...standardAspectList, ...customAspectList])\n        );\n    }\n\n    getStandardAspects(whiteList: string[]): Observable<AspectEntry[]> {\n        const where = `(modelId in ('cm:contentmodel', 'emailserver:emailserverModel', 'smf:smartFolder', 'app:applicationmodel' ))`;\n        const opts: any = {\n            where,\n            include: ['properties']\n        };\n        return from(this.aspectsApi.listAspects(opts))\n            .pipe(\n                map((result: AspectPaging) => this.filterAspectByConfig(whiteList, result?.list?.entries)),\n                catchError((error) => {\n                    this.logService.error(error);\n                    return of([]);\n                })\n            );\n    }\n\n    getCustomAspects(): Observable<AspectEntry[]> {\n        const where = `(not namespaceUri matches('http://www.alfresco.*'))`;\n        const opts: any = {\n            where,\n            include: ['properties']\n        };\n        return from(this.aspectsApi.listAspects(opts))\n            .pipe(\n                map((result: AspectPaging) => result?.list?.entries),\n                catchError((error) => {\n                    this.logService.error(error);\n                    return of([]);\n                })\n            );\n    }\n\n    private filterAspectByConfig(visibleAspectList: string[], aspectEntries: AspectEntry[]): AspectEntry[] {\n        let result = aspectEntries ? aspectEntries : [];\n        if (visibleAspectList?.length > 0 && aspectEntries) {\n            result = aspectEntries.filter((value) => {\n                return visibleAspectList.includes(value?.entry?.id);\n            });\n        }\n        return result;\n    }\n\n    getVisibleAspects(): string[] {\n        let visibleAspectList: string[] = [];\n        const aspectVisibleConfig = this.appConfigService.get('aspect-visible');\n        if (aspectVisibleConfig) {\n            for (const aspectGroup of Object.keys(aspectVisibleConfig)) {\n                visibleAspectList = visibleAspectList.concat(aspectVisibleConfig[aspectGroup]);\n            }\n        }\n        return visibleAspectList;\n    }\n\n    openAspectListDialog(nodeId?: string): Observable<string[]> {\n        const select = new Subject<string[]>();\n        select.subscribe({\n            complete: this.close.bind(this)\n        });\n\n        const data: AspectListDialogComponentData = {\n            title: 'ADF-ASPECT-LIST.DIALOG.TITLE',\n            description: 'ADF-ASPECT-LIST.DIALOG.DESCRIPTION',\n            overTableMessage: 'ADF-ASPECT-LIST.DIALOG.OVER-TABLE-MESSAGE',\n            select,\n            nodeId\n        };\n\n        this.openDialog(data, 'adf-aspect-list-dialog', '750px');\n        return select;\n    }\n\n    private openDialog(data: AspectListDialogComponentData, panelClass: string, width: string) {\n        this.dialog.open(AspectListDialogComponent, {\n            data,\n            panelClass,\n            width,\n            disableClose: true\n        });\n    }\n\n    close() {\n        this.dialog.closeAll();\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { AlfrescoApiService, CardViewUpdateService, NodesApiService } from '@alfresco/adf-core';\nimport { AspectListService } from './aspect-list.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class NodeAspectService {\n\n    constructor(private alfrescoApiService: AlfrescoApiService,\n                private nodesApiService: NodesApiService,\n                private aspectListService: AspectListService,\n                private cardViewUpdateService: CardViewUpdateService) {\n    }\n\n    updateNodeAspects(nodeId: string) {\n        this.aspectListService.openAspectListDialog(nodeId).subscribe((aspectList) => {\n            this.nodesApiService.updateNode(nodeId, { aspectNames: [...aspectList] }).subscribe((updatedNode) => {\n                this.alfrescoApiService.nodeUpdated.next(updatedNode);\n                this.cardViewUpdateService.updateNodeAspect(updatedNode);\n            });\n        });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnChanges, SimpleChanges, ViewEncapsulation } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { ContentService, AllowableOperationsEnum, VersionCompatibilityService } from '@alfresco/adf-core';\nimport { NodeAspectService } from '../../../aspect-list/node-aspect.service';\nimport { PresetConfig } from '../../interfaces/content-metadata.interfaces';\n@Component({\n    selector: 'adf-content-metadata-card',\n    templateUrl: './content-metadata-card.component.html',\n    styleUrls: ['./content-metadata-card.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { 'class': 'adf-content-metadata-card' }\n})\nexport class ContentMetadataCardComponent implements OnChanges {\n\n    /** (required) The node entity to fetch metadata about */\n    @Input()\n    node: Node;\n\n    /** (optional) This flag displays/hides empty metadata\n     * fields.\n     */\n    @Input()\n    displayEmpty: boolean = false;\n\n    /** (optional) This flag displays desired aspect when open for the first time\n     * fields.\n     */\n    @Input()\n    displayAspect: string = null;\n\n    /** (required) Name or configuration of the metadata preset, which defines aspects\n     * and their properties.\n     */\n    @Input()\n    preset: string | PresetConfig;\n\n    /** (optional) This flag sets the metadata in read only mode\n     * preventing changes.\n     */\n    @Input()\n    readOnly = false;\n\n    /** (optional) This flag allows the component to display more\n     * than one accordion at a time.\n     */\n    @Input()\n    multi = false;\n\n    private _displayDefaultProperties: boolean = true;\n\n    /** (optional) This flag displays/hides the metadata\n     * properties.\n     */\n    @Input()\n    set displayDefaultProperties(value: boolean) {\n        this._displayDefaultProperties = value;\n        this.onDisplayDefaultPropertiesChange();\n    }\n\n    get displayDefaultProperties(): boolean {\n        return this._displayDefaultProperties;\n    }\n\n    editable: boolean = false;\n\n    expanded: boolean;\n\n    editAspectSupported = false;\n\n    constructor(private contentService: ContentService, private nodeAspectService: NodeAspectService, private versionCompatibilityService: VersionCompatibilityService) {\n        this.editAspectSupported = this.versionCompatibilityService.isVersionSupported('7');\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes.displayAspect && changes.displayAspect.currentValue) {\n            this.expanded = true;\n        }\n    }\n\n    onDisplayDefaultPropertiesChange(): void {\n        this.expanded = !this._displayDefaultProperties;\n    }\n\n    toggleEdit(): void {\n        this.editable = !this.editable;\n    }\n\n    toggleExpanded(): void {\n        this.expanded = !this.expanded;\n    }\n\n    hasAllowableOperations() {\n        return this.contentService.hasAllowableOperations(this.node, AllowableOperationsEnum.UPDATE);\n    }\n\n    openAspectDialog() {\n        this.nodeAspectService.updateNodeAspects(this.node.id);\n    }\n\n    isEditAspectSupported(): boolean {\n        return !this.readOnly && this.hasAllowableOperations() && this.editAspectSupported;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { FlexLayoutModule } from '@angular/flex-layout';\nimport { NgModule } from '@angular/core';\nimport { MaterialModule } from '../material.module';\nimport { CoreModule } from '@alfresco/adf-core';\nimport { ContentMetadataComponent } from './components/content-metadata/content-metadata.component';\nimport { ContentMetadataCardComponent } from './components/content-metadata-card/content-metadata-card.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        FlexLayoutModule,\n        CoreModule\n    ],\n    exports: [\n        ContentMetadataComponent,\n        ContentMetadataCardComponent\n    ],\n    declarations: [\n        ContentMetadataComponent,\n        ContentMetadataCardComponent\n    ]\n})\nexport class ContentMetadataModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PermissionElement } from '@alfresco/js-api';\n\nexport class PermissionDisplayModel implements PermissionElement {\n\n    authorityId?: string;\n    name?: string;\n    accessStatus?: PermissionElement.AccessStatusEnum;\n    isInherited: boolean = false;\n    icon: string;\n    readonly?: boolean;\n\n    constructor(obj?: any) {\n        if (obj) {\n            this.authorityId = obj.authorityId;\n            this.name = obj.name;\n            this.accessStatus = obj.accessStatus;\n            this.isInherited = obj.isInherited !== null && obj.isInherited !== undefined ? obj.isInherited : false;\n            this.icon = obj.icon ? obj.icon : 'vpn_key';\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    AlfrescoApiService,\n    NodesApiService,\n    SearchService,\n    TranslationService,\n    EcmUserModel\n} from '@alfresco/adf-core';\nimport {\n    Group,\n    GroupMemberEntry,\n    GroupMemberPaging, GroupsApi,\n    Node,\n    PathElement,\n    PermissionElement,\n    QueryBody\n} from '@alfresco/js-api';\nimport { Injectable } from '@angular/core';\nimport { forkJoin, from, Observable, of, throwError } from 'rxjs';\nimport { catchError, map, switchMap } from 'rxjs/operators';\nimport { PermissionDisplayModel } from '../models/permission.model';\nimport { RoleModel } from '../models/role.model';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class NodePermissionService {\n\n    _groupsApi: GroupsApi;\n    get groupsApi(): GroupsApi {\n        this._groupsApi = this._groupsApi ?? new GroupsApi(this.apiService.getInstance());\n        return this._groupsApi;\n    }\n\n    constructor(private apiService: AlfrescoApiService,\n                private searchApiService: SearchService,\n                private nodeService: NodesApiService,\n                private translation: TranslationService) {\n    }\n\n    /**\n     * Gets a list of roles for the current node.\n     * @param node The target node\n     * @returns Array of strings representing the roles\n     */\n    getNodeRoles(node: Node): Observable<string[]> {\n        const retrieveSiteQueryBody: QueryBody = this.buildRetrieveSiteQueryBody(node.path.elements);\n        return this.searchApiService.searchByQueryBody(retrieveSiteQueryBody)\n            .pipe(\n                switchMap((siteNodeList: any) => {\n                    if (siteNodeList.list.entries.length > 0) {\n                        const siteName = siteNodeList.list.entries[0].entry.name;\n                        return this.getGroupMembersBySiteName(siteName);\n                    } else {\n                        return of(node.permissions?.settable);\n                    }\n                })\n            );\n    }\n\n    getNodePermissions(node: Node): PermissionDisplayModel[] {\n        const result: PermissionDisplayModel[] = [];\n\n        if (node?.permissions?.locallySet) {\n            node.permissions.locallySet.map((permissionElement) => {\n                result.push(new PermissionDisplayModel(permissionElement));\n            });\n        }\n\n        if (node?.permissions?.inherited) {\n            node.permissions.inherited.map((permissionElement) => {\n                const permissionInherited = new PermissionDisplayModel(permissionElement);\n                permissionInherited.isInherited = true;\n                result.push(permissionInherited);\n            });\n        }\n        return result;\n    }\n\n    /**\n     * Updates the permission role for a node.\n     * @param node Target node\n     * @param updatedPermissionRole Permission role to update or add\n     * @returns Node with updated permission\n     */\n    updatePermissionRole(node: Node, updatedPermissionRole: PermissionElement): Observable<Node> {\n        const permissionBody = { permissions: { locallySet: [] } };\n        const index = node.permissions.locallySet.map((permission) => permission.authorityId).indexOf(updatedPermissionRole.authorityId);\n        permissionBody.permissions.locallySet = permissionBody.permissions.locallySet.concat(node.permissions.locallySet);\n        if (index !== -1) {\n            permissionBody.permissions.locallySet[index] = updatedPermissionRole;\n        } else {\n            permissionBody.permissions.locallySet.push(updatedPermissionRole);\n        }\n        return this.nodeService.updateNode(node.id, permissionBody);\n    }\n\n    /**\n     * Update permissions for a node.\n     * @param nodeId ID of the target node\n     * @param permissionList New permission settings\n     * @returns Node with updated permissions\n     */\n    updateNodePermissions(nodeId: string, permissionList: PermissionElement[]): Observable<Node> {\n        return this.nodeService.getNode(nodeId).pipe(\n            switchMap((node) => this.updateLocallySetPermissions(node, permissionList))\n        );\n    }\n\n    /**\n     * Updates the locally set permissions for a node.\n     * @param node ID of the target node\n     * @param permissions Permission settings\n     * @returns Node with updated permissions\n     */\n    updateLocallySetPermissions(node: Node, permissions: PermissionElement[]): Observable<Node> {\n        const permissionBody = { permissions: { locallySet: [] } };\n        const permissionList = permissions;\n        const duplicatedPermissions = this.getDuplicatedPermissions(node.permissions.locallySet, permissionList);\n        if (duplicatedPermissions.length > 0) {\n            const list = duplicatedPermissions.map((permission) => 'authority -> ' + permission.authorityId + ' / role -> ' + permission.name).join(', ');\n            const duplicatePermissionMessage: string = this.translation.instant('PERMISSION_MANAGER.ERROR.DUPLICATE-PERMISSION', { list });\n            return throwError(duplicatePermissionMessage);\n        }\n        permissionBody.permissions.locallySet = node.permissions.locallySet ? node.permissions.locallySet.concat(permissionList) : permissionList;\n        return this.nodeService.updateNode(node.id, permissionBody);\n    }\n\n    private getDuplicatedPermissions(nodeLocallySet: PermissionElement[], permissionListAdded: PermissionElement[]): PermissionElement[] {\n        const duplicatePermissions: PermissionElement[] = [];\n        if (nodeLocallySet) {\n            permissionListAdded.forEach((permission: PermissionElement) => {\n                const duplicate = nodeLocallySet.find((localPermission) => this.isEqualPermission(localPermission, permission));\n                if (duplicate) {\n                    duplicatePermissions.push(duplicate);\n                }\n            });\n        }\n        return duplicatePermissions;\n    }\n\n    private isEqualPermission(oldPermission: PermissionElement, newPermission: PermissionElement): boolean {\n        return oldPermission.accessStatus === newPermission.accessStatus &&\n            oldPermission.authorityId === newPermission.authorityId &&\n            oldPermission.name === newPermission.name;\n    }\n\n    /**\n     * Removes a permission setting from a node.\n     * @param node ID of the target node\n     * @param permissionToRemove Permission setting to remove\n     * @returns Node with modified permissions\n     */\n    removePermission(node: Node, permissionToRemove: PermissionElement): Observable<Node> {\n        const permissionBody = { permissions: { locallySet: [] } };\n        const index = node.permissions.locallySet.map((permission) => permission.authorityId).indexOf(permissionToRemove.authorityId);\n\n        if (index !== -1) {\n            node.permissions.locallySet.splice(index, 1);\n            permissionBody.permissions.locallySet = node.permissions.locallySet;\n            return this.nodeService.updateNode(node.id, permissionBody);\n        } else {\n            return of(node);\n        }\n    }\n\n    private getGroupMembersBySiteName(siteName: string): Observable<string[]> {\n        const groupName = 'GROUP_site_' + siteName;\n        return this.getGroupMemberByGroupName(groupName)\n            .pipe(\n                map((groupMemberPaging: GroupMemberPaging) => {\n                    const displayResult: string[] = [];\n                    groupMemberPaging.list.entries.forEach((member: GroupMemberEntry) => {\n                        displayResult.push(this.formattedRoleName(member.entry.displayName, 'site_' + siteName));\n                    });\n                    return displayResult;\n                })\n            );\n    }\n\n    /**\n     * Gets all members related to a group name.\n     * @param groupName Name of group to look for members\n     * @param opts Extra options supported by JS-API\n     * @returns List of members\n     */\n    getGroupMemberByGroupName(groupName: string, opts?: any): Observable<GroupMemberPaging> {\n        return from(this.groupsApi.listGroupMemberships(groupName, opts));\n    }\n\n    private formattedRoleName(displayName, siteName): string {\n        return displayName.replace(siteName + '_', '');\n    }\n\n    private buildRetrieveSiteQueryBody(nodePath: PathElement[]): QueryBody {\n        const pathNames = nodePath.map((node: PathElement) => 'name: \"' + node.name + '\"');\n        const builtPathNames = pathNames.join(' OR ');\n\n        return {\n            'query': {\n                'query': builtPathNames\n            },\n            'paging': {\n                'maxItems': 100,\n                'skipCount': 0\n            },\n            'include': ['aspectNames', 'properties'],\n            'filterQueries': [\n                {\n                    'query':\n                        \"TYPE:'st:site'\"\n                }\n            ]\n        };\n    }\n\n    getLocalPermissions(node: Node): PermissionDisplayModel[] {\n        const result: PermissionDisplayModel[] = [];\n\n        if (node?.permissions?.locallySet) {\n            node.permissions.locallySet.forEach((permissionElement) => {\n                result.push(new PermissionDisplayModel(permissionElement));\n            });\n        }\n\n        return result;\n    }\n\n    getInheritedPermission(node: Node): PermissionDisplayModel[] {\n        const result: PermissionDisplayModel[] = [];\n\n        if (node?.permissions?.inherited) {\n            node.permissions.inherited.forEach((permissionElement) => {\n                const permissionInherited = new PermissionDisplayModel(permissionElement);\n                permissionInherited.isInherited = true;\n                result.push(permissionInherited);\n            });\n        }\n        return result;\n    }\n\n    /**\n     * Removes permissions setting from a node.\n     * @param node target node with permission\n     * @param permissions Permissions to remove\n     * @returns Node with modified permissions\n     */\n    removePermissions(node: Node, permissions: PermissionElement[]): Observable<Node> {\n        const permissionBody = { permissions: { locallySet: [] } };\n\n        permissions.forEach((permission) => {\n            const index = node.permissions.locallySet.findIndex((locallySet) => locallySet.authorityId === permission.authorityId);\n            if (index !== -1) {\n                node.permissions.locallySet.splice(index, 1);\n            }\n        });\n        permissionBody.permissions.locallySet = node.permissions.locallySet;\n        return this.nodeService.updateNode(node.id, permissionBody);\n    }\n\n    /**\n     * updates permissions setting from a node.\n     * @param node target node with permission\n     * @param permissions Permissions to update\n     * @returns Node with modified permissions\n     */\n    updatePermissions(node: Node, permissions: PermissionElement[]): Observable<Node> {\n        const permissionBody = { permissions: { locallySet: [] } };\n        permissionBody.permissions.locallySet = permissions;\n        return this.nodeService.updateNode(node.id, permissionBody);\n    }\n\n    /**\n     * Gets all node detail for nodeId along with settable permissions.\n     * @param nodeId Id of the node\n     * @returns node and it's associated roles { node: Node; roles: RoleModel[] }\n     */\n    getNodeWithRoles(nodeId: string): Observable<{ node: Node; roles: RoleModel[] }> {\n        return this.nodeService.getNode(nodeId).pipe(\n            switchMap(node => {\n                return forkJoin({\n                    node: of(node),\n                    roles: this.getNodeRoles(node)\n                        .pipe(\n                            catchError(() => of(node.permissions?.settable)),\n                            map(_roles => _roles.map(role => ({ role, label: role }))\n                            )\n                        )\n                });\n            })\n        );\n    }\n\n    transformNodeToUserPerson(node: Node): { person: EcmUserModel, group: Group } {\n        let person = null, group = null;\n        if (node.nodeType === 'cm:person') {\n            const firstName = node.properties['cm:firstName'];\n            const lastName = node.properties['cm:lastName'];\n            const email = node.properties['cm:email'];\n            const id = node.properties['cm:userName'];\n            person = new EcmUserModel({ id, firstName, lastName, email });\n        }\n\n        if (node.nodeType === 'cm:authorityContainer') {\n            const displayName = node.properties['cm:authorityDisplayName'] || node.properties['cm:authorityName'];\n            const id = node.properties['cm:authorityName'];\n            group = new Group({ displayName, id });\n        }\n        return { person, group };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Group, Node, NodeEntry, PermissionElement } from '@alfresco/js-api';\nimport { PermissionDisplayModel } from './permission.model';\nimport { RoleModel } from './role.model';\nimport { EcmUserModel } from '@alfresco/adf-core';\n\nexport interface NodePermissionsModel {\n    node: Node;\n    roles: RoleModel[];\n    inheritedPermissions: PermissionDisplayModel[];\n    localPermissions: PermissionDisplayModel[];\n}\n\nexport class MemberModel {\n    id: string;\n    role: string;\n    accessStatus: PermissionElement.AccessStatusEnum | string;\n    entry: {\n        person?: EcmUserModel;\n        group?: Group;\n    };\n    readonly: boolean = false;\n\n    constructor(input?) {\n        if (input) {\n            Object.assign(this, input);\n        }\n    }\n\n    static parseFromSearchResult({ entry }: NodeEntry): MemberModel {\n        const result = new MemberModel();\n\n        if (entry.nodeType === 'cm:person') {\n            const person = new EcmUserModel({\n                firstName: entry.properties['cm:firstName'],\n                lastName: entry.properties['cm:lastName'],\n                email: entry.properties['cm:email'],\n                id: entry.properties['cm:userName']\n            });\n\n            result.id = person.id;\n            result.entry = { person };\n            result.accessStatus = 'ALLOWED';\n\n            return result;\n        }\n\n        if (entry.nodeType === 'cm:authorityContainer') {\n            const group = new Group({\n                id: entry.properties['cm:authorityName'],\n                displayName: entry.properties['cm:authorityDisplayName'] || entry.properties['cm:authorityName']\n            });\n\n            result.id = group.id;\n            result.entry = { group };\n            result.accessStatus = 'ALLOWED';\n\n            return result;\n        }\n        return null;\n    }\n\n    toPermissionElement(): PermissionElement {\n        return {\n            authorityId: this.id,\n            name: this.role,\n            accessStatus: this.accessStatus\n        };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Inject, ViewEncapsulation } from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { NodeEntry, PermissionElement } from '@alfresco/js-api';\nimport { AddPermissionDialogData } from './add-permission-dialog-data.interface';\nimport { MemberModel } from '../../models/member.model';\n\n@Component({\n    selector: 'adf-add-permission-dialog',\n    templateUrl: './add-permission-dialog.component.html',\n    styleUrls: ['./add-permission-dialog.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class AddPermissionDialogComponent {\n    isSearchActive = true;\n    selectedMembers: MemberModel[] = [];\n\n    private existingMembers: PermissionElement[] = [];\n    currentSelection: NodeEntry[] = [];\n\n    constructor(@Inject(MAT_DIALOG_DATA) public data: AddPermissionDialogData,\n                private dialogRef: MatDialogRef<AddPermissionDialogComponent>) {\n        this.existingMembers = this.data.node.permissions.locallySet || [];\n    }\n\n    onSelect(items: NodeEntry[]) {\n        this.currentSelection = items;\n    }\n\n    onAddClicked() {\n        const selection = this.selectedMembers.filter(member => !member.readonly).map(member => member.toPermissionElement());\n        this.data.confirm.next(selection);\n        this.data.confirm.complete();\n    }\n\n    onSearchAddClicked() {\n        const newMembers = this.currentSelection.map(item => MemberModel.parseFromSearchResult(item))\n            .filter(({id}) => !this.selectedMembers.find((member) => member.id === id));\n        this.selectedMembers = this.selectedMembers.concat(newMembers);\n\n        this.selectedMembers.forEach((member) => {\n            const existingMember = this.existingMembers.find(({authorityId}) => authorityId === member.id);\n            if (!!existingMember) {\n                member.role = existingMember.name;\n                member.accessStatus = existingMember.accessStatus;\n                member.readonly = true; // make role non editable\n            }\n        });\n        this.disableSearch();\n    }\n\n    canCloseDialog() {\n        if (!!this.selectedMembers.length) {\n            this.disableSearch();\n        } else {\n            this.dialogRef.close();\n        }\n    }\n\n    enableSearch() {\n        this.isSearchActive = true;\n    }\n\n    disableSearch() {\n        this.isSearchActive = false;\n    }\n\n    onBulkUpdate(role: string) {\n        this.selectedMembers.filter(member => !member.readonly)\n            .forEach(member => (member.role = role));\n    }\n\n    onMemberDelete({ id }: MemberModel) {\n        const index = this.selectedMembers.findIndex((member) => member.id === id);\n        this.selectedMembers.splice(index, 1);\n        if (this.selectedMembers.length === 0) {\n            this.enableSearch();\n            this.currentSelection = [];\n        }\n    }\n\n    onMemberUpdate(role: string, member: MemberModel) {\n        const _member = this.selectedMembers.find(({ id }) => id === member.id);\n        _member.role = role;\n    }\n\n    isValid(): boolean {\n        return this.selectedMembers.filter(({readonly}) => !readonly).length && this.selectedMembers.every(({role}) => !!role);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AllowableOperationsEnum, ContentService } from '@alfresco/adf-core';\nimport { Node, PermissionElement } from '@alfresco/js-api';\nimport { MatDialog } from '@angular/material/dialog';\nimport { Injectable } from '@angular/core';\nimport { Observable, Subject, throwError } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\nimport { NodePermissionService } from './node-permission.service';\nimport { AddPermissionDialogComponent } from '../components/add-permission/add-permission-dialog.component';\nimport { AddPermissionDialogData } from '../components/add-permission/add-permission-dialog-data.interface';\nimport { RoleModel } from '../models/role.model';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class NodePermissionDialogService {\n\n    constructor(private dialog: MatDialog,\n                private nodePermissionService: NodePermissionService,\n                private contentService: ContentService) {\n    }\n\n    /**\n     * Opens a dialog to add permissions to a node.\n     * @param node target node\n     * @param roles settable roles for the node\n     * @param title Dialog title\n     * @returns Node with updated permissions\n     */\n    openAddPermissionDialog(node: Node, roles: RoleModel[], title?: string): Observable<PermissionElement[]> {\n        if (this.contentService.hasAllowableOperations(node, AllowableOperationsEnum.UPDATEPERMISSIONS)) {\n            const confirm = new Subject<PermissionElement[]>();\n\n            confirm.subscribe({\n                complete: this.close.bind(this)\n            });\n\n            const data: AddPermissionDialogData = {\n                node: node,\n                title: title,\n                confirm: confirm,\n                roles\n            };\n\n            this.openDialog(data, 'adf-add-permission-dialog', '800px');\n            return confirm;\n        } else {\n            const errors = new Error(JSON.stringify({ error: { statusCode: 403 } }));\n            errors.message = 'PERMISSION_MANAGER.ERROR.NOT-ALLOWED';\n            return throwError(errors);\n        }\n    }\n\n    private openDialog(data: any, currentPanelClass: string, chosenWidth: string) {\n        this.dialog.open(AddPermissionDialogComponent, { data, panelClass: currentPanelClass, width: chosenWidth, restoreFocus: true });\n    }\n\n    /**\n     * Closes the currently-open dialog.\n     */\n    close() {\n        this.dialog.closeAll();\n    }\n\n    /**\n     * Opens a dialog to update permissions for a node.\n     * @param nodeId ID of the target node\n     * @param title Dialog title\n     * @returns Node with updated permissions\n     */\n    updateNodePermissionByDialog(nodeId?: string, title?: string): Observable<Node> {\n        return this.nodePermissionService.getNodeWithRoles(nodeId)\n            .pipe(\n                switchMap(({node, roles}) => {\n                    return this.openAddPermissionDialog(node, roles, title)\n                        .pipe(\n                            switchMap((selection) => {\n                                return this.nodePermissionService.updateNodePermissions(nodeId, selection);\n                            })\n                        );\n                })\n            );\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AllowableOperationsEnum, ContentService, NodesApiService, NotificationService } from '@alfresco/adf-core';\nimport { Node, PermissionElement } from '@alfresco/js-api';\nimport { EventEmitter, Injectable } from '@angular/core';\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\nimport { BehaviorSubject, forkJoin, Observable, of, Subject } from 'rxjs';\nimport { finalize, map, switchMap } from 'rxjs/operators';\nimport { RoleModel } from '../../models/role.model';\nimport { PermissionDisplayModel } from '../../models/permission.model';\nimport { NodePermissionsModel } from '../../models/member.model';\nimport { NodePermissionService } from '../../services/node-permission.service';\nimport { NodePermissionDialogService } from '../../services/node-permission-dialog.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PermissionListService {\n    updated = new EventEmitter<PermissionDisplayModel>();\n    errored = new EventEmitter<PermissionDisplayModel>();\n\n    loading$: BehaviorSubject<boolean> = new BehaviorSubject(true);\n    error$: Subject<boolean> = new Subject();\n    nodeWithRoles$: Subject<{ node: Node, roles: RoleModel[] }> = new Subject();\n    data$: Observable<NodePermissionsModel> = this.nodeWithRoles$.pipe(\n        map(({ node, roles}) => {\n            const nodeLocalPermissions = this.nodePermissionService.getLocalPermissions(node);\n            const localPermissions = this.updateReadOnlyPermission(node, nodeLocalPermissions);\n            return {\n                node,\n                roles,\n                localPermissions,\n                inheritedPermissions: this.nodePermissionService.getInheritedPermission(node)\n            };\n        })\n    );\n\n    private node: Node;\n    private roles: RoleModel[];\n    private SITE_MANAGER_ROLE = 'SiteManager';\n\n    constructor(\n        private nodeService: NodesApiService,\n        private nodePermissionService: NodePermissionService,\n        private nodePermissionDialogService: NodePermissionDialogService,\n        private contentService: ContentService,\n        private notificationService: NotificationService\n    ) {}\n\n    fetchPermission(nodeId: string) {\n        this.loading$.next(true);\n        this.nodePermissionService.getNodeWithRoles(nodeId)\n            .pipe(finalize(() => this.loading$.next(false)))\n            .subscribe(\n                ({ node, roles }) => {\n                    this.node = node;\n                    this.roles = roles;\n                    this.nodeWithRoles$.next({ node, roles });\n                },\n                () => this.error$.next(true)\n            );\n    }\n\n    toggleInherited(change: MatSlideToggleChange) {\n        if (this.contentService.hasAllowableOperations(this.node, AllowableOperationsEnum.UPDATEPERMISSIONS)) {\n            let updateLocalPermission$ = of(null);\n            const nodeBody = {\n                permissions: {\n                    isInheritanceEnabled: !this.node.permissions.isInheritanceEnabled\n                }\n            };\n\n            const authorityId = this.getManagerAuthority(this.node);\n            if (authorityId) {\n                const permissions = [\n                    ...(this.node.permissions.locallySet || []),\n                    { authorityId, name: this.SITE_MANAGER_ROLE, accessStatus: 'ALLOWED' }\n                ];\n                updateLocalPermission$ = this.nodePermissionService.updatePermissions(this.node, permissions);\n            }\n\n            updateLocalPermission$.pipe(switchMap(() => this.nodeService.updateNode(this.node.id, nodeBody, {include: ['permissions']})))\n                .subscribe(\n                    (nodeUpdated: Node) => {\n                        const message = nodeUpdated.permissions.isInheritanceEnabled ? 'PERMISSION_MANAGER.MESSAGE.INHERIT-ENABLE-SUCCESS' : 'PERMISSION_MANAGER.MESSAGE.INHERIT-DISABLE-SUCCESS';\n                        this.notificationService.showInfo(message);\n                        nodeUpdated.permissions.inherited = nodeUpdated.permissions?.inherited ?? [];\n                        this.reloadNode(nodeUpdated);\n                    },\n                    () => {\n                        change.source.checked = this.node.permissions.isInheritanceEnabled;\n                        this.notificationService.showWarning('PERMISSION_MANAGER.MESSAGE.TOGGLE-PERMISSION-FAILED');\n                    }\n                );\n        } else {\n            change.source.checked = this.node.permissions.isInheritanceEnabled;\n            this.notificationService.showError('PERMISSION_MANAGER.ERROR.NOT-ALLOWED');\n        }\n    }\n\n    updateNodePermissionByDialog() {\n        this.nodePermissionDialogService\n            .openAddPermissionDialog(this.node, this.roles, 'PERMISSION_MANAGER.ADD-PERMISSION.TITLE')\n            .pipe(\n                switchMap(selection => {\n                    const total = selection.length;\n                    const group = selection.filter(({authorityId}) => this.isGroup(authorityId)).length;\n                    return forkJoin({\n                        user: of(total - group),\n                        group: of(group),\n                        node: this.nodePermissionService.updateNodePermissions(this.node.id, selection)\n                    });\n                })\n            )\n            .subscribe(({ user,  group, node}) => {\n                    this.notificationService.showInfo( 'PERMISSION_MANAGER.MESSAGE.PERMISSION-ADD-SUCCESS', null, { user, group });\n                    this.reloadNode(node);\n                },\n                () => {\n                    this.notificationService.showError( 'PERMISSION_MANAGER.MESSAGE.PERMISSION-ADD-FAIL');\n                    this.reloadNode();\n                }\n            );\n    }\n\n    deletePermissions(permissions: PermissionElement[]) {\n        this.nodePermissionService.removePermissions(this.node, permissions)\n            .subscribe((node) => {\n                    const total = permissions.length;\n                    const group = permissions.filter(({authorityId}) => this.isGroup(authorityId)).length;\n                    this.notificationService.showInfo('PERMISSION_MANAGER.MESSAGE.PERMISSION-BULK-DELETE-SUCCESS', null, {user: total - group, group});\n                    this.reloadNode(node);\n                },\n                () => {\n                    this.notificationService.showError('PERMISSION_MANAGER.MESSAGE.PERMISSION-DELETE-FAIL');\n                    this.reloadNode();\n                }\n            );\n    }\n\n    updateRole(role: string, permission: PermissionDisplayModel) {\n        const updatedPermissionRole = this.buildUpdatedPermission(role, permission);\n        this.nodePermissionService.updatePermissionRole(this.node, updatedPermissionRole)\n            .subscribe((node) => {\n                this.notificationService.showInfo('PERMISSION_MANAGER.MESSAGE.PERMISSION-UPDATE-SUCCESS');\n                this.reloadNode(node);\n                this.updated.emit(permission);\n                },\n                () => {\n                    this.notificationService.showError('PERMISSION_MANAGER.MESSAGE.PERMISSION-UPDATE-FAIL');\n                    this.reloadNode();\n                    this.errored.emit(permission);\n                }\n            );\n    }\n\n    bulkRoleUpdate(role: string) {\n        const permissions = [...this.node.permissions.locallySet].map((permission) => this.buildUpdatedPermission(role, permission));\n        this.nodePermissionService.updatePermissions(this.node, permissions)\n            .subscribe((node) => {\n                    const total = permissions.length;\n                    const group = permissions.filter(({authorityId}) => this.isGroup(authorityId)).length;\n                    this.notificationService.showInfo('PERMISSION_MANAGER.MESSAGE.PERMISSION-BULK-UPDATE-SUCCESS', null, {user: total - group, group});\n                    this.reloadNode(node);\n                },\n                () => {\n                    this.notificationService.showError('PERMISSION_MANAGER.MESSAGE.PERMISSION-UPDATE-FAIL');\n                    this.reloadNode();\n                }\n            );\n    }\n\n    deletePermission(permission: PermissionDisplayModel) {\n        const cloneNode = { ...this.node, permissions: { ...this.node.permissions, locallySet: [ ...this.node.permissions.locallySet ] } };\n        this.nodePermissionService\n            .removePermission(cloneNode, permission)\n            .subscribe((node) => {\n                    this.notificationService.showInfo('PERMISSION_MANAGER.MESSAGE.PERMISSION-DELETE-SUCCESS');\n                    if (!node.permissions.locallySet) {\n                       node.permissions.locallySet = [];\n                    }\n                    this.reloadNode(node);\n                },\n                () => {\n                    this.notificationService.showError('PERMISSION_MANAGER.MESSAGE.PERMISSION-DELETE-FAIL');\n                    this.reloadNode();\n                }\n            );\n    }\n\n    private buildUpdatedPermission(role: string, permission: PermissionElement): PermissionElement {\n        return {\n            accessStatus: permission.accessStatus,\n            name: this.canUpdateThePermission(this.node, permission) ? role :  permission.name,\n            authorityId: permission.authorityId\n        };\n    }\n\n    private reloadNode(node?: Node) {\n        if (node != null) {\n            Object.assign(this.node.permissions, node.permissions);\n        }\n        this.nodeWithRoles$.next({ node: this.node, roles: this.roles });\n    }\n\n    getManagerAuthority(node: Node): string {\n        const sitePath = node.path.elements.find((path) => path.nodeType === 'st:site');\n        let hasLocalManagerPermission = false, authorityId: string;\n        if (sitePath) {\n            authorityId = `GROUP_site_${sitePath.name}_${this.SITE_MANAGER_ROLE}`;\n            hasLocalManagerPermission = !!node.permissions.locallySet?.find((permission) => permission.authorityId === authorityId && permission.name === this.SITE_MANAGER_ROLE);\n        }\n\n        if (!hasLocalManagerPermission && authorityId) {\n            return authorityId;\n        }\n        return null;\n    }\n\n    updateReadOnlyPermission(node: Node, permissions: PermissionDisplayModel[]): PermissionDisplayModel[] {\n        permissions.forEach((permission) => {\n            if (!this.canUpdateThePermission(node, permission)) {\n                permission.readonly = true;\n            }\n        });\n        return permissions;\n    }\n\n    canUpdateThePermission(node: Node, permission: PermissionElement): boolean {\n        const sitePath = node.path.elements.find((path) => path.nodeType === 'st:site');\n        if (!node.permissions.isInheritanceEnabled && sitePath) {\n           const authorityId = `GROUP_site_${sitePath.name}_${this.SITE_MANAGER_ROLE}`;\n           return !(permission.authorityId === authorityId && permission.name === this.SITE_MANAGER_ROLE);\n        }\n        return true;\n    }\n\n    private isGroup(authorityId) {\n        return authorityId.startsWith('GROUP_') || authorityId.startsWith('ROLE_');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ObjectDataRow } from '@alfresco/adf-core';\nimport { PermissionElement } from '@alfresco/js-api';\nimport { Component, EventEmitter, Input, Output, ViewEncapsulation } from '@angular/core';\nimport { PermissionDisplayModel } from '../../models/permission.model';\nimport { PermissionListService } from './permission-list.service';\n\n@Component({\n    selector: 'adf-permission-list',\n    templateUrl: './permission-list.component.html',\n    styleUrls: ['./permission-list.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\nexport class PermissionListComponent {\n    /** ID of the node whose permissions you want to show. */\n    @Input()\n    nodeId: string;\n\n    /** Emitted when the permission is updated. */\n    @Output()\n    update: EventEmitter<PermissionElement>;\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error: EventEmitter<any>;\n\n    selectedPermissions: PermissionDisplayModel[] = [];\n\n    constructor(public readonly permissionList: PermissionListService) {\n        this.error = this.permissionList.errored;\n        this.update = this.permissionList.updated;\n    }\n\n    ngOnInit(): void {\n        this.permissionList.fetchPermission(this.nodeId);\n    }\n\n    openAddPermissionDialog() {\n        this.permissionList.updateNodePermissionByDialog();\n    }\n\n    onSelect(selections: ObjectDataRow[]) {\n        this.selectedPermissions = selections.map((selection) => selection['obj']).filter((permission) => !permission.readonly);\n    }\n\n    deleteSelection() {\n        this.permissionList.deletePermissions(this.selectedPermissions);\n        this.selectedPermissions = [];\n    }\n\n    updatePermission({role, permission}) {\n        this.permissionList.updateRole(role, permission);\n    }\n\n    deletePermission(permission: PermissionDisplayModel) {\n        this.selectedPermissions = [];\n        this.permissionList.deletePermission(permission);\n    }\n\n    updateAllPermission(role: string) {\n        this.permissionList.bulkRoleUpdate(role);\n        this.selectedPermissions = [];\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* tslint:disable:no-input-rename  */\nimport { Directive, Input, Output, EventEmitter } from '@angular/core';\nimport { NodesApiService, ContentService, AllowableOperationsEnum } from '@alfresco/adf-core';\nimport { Node } from '@alfresco/js-api';\n\n@Directive({\n    selector: 'button[adf-inherit-permission], mat-button-toggle[adf-inherit-permission]',\n    host: {\n        'role': 'button',\n        '(click)': 'onInheritPermissionClicked()'\n    }\n})\nexport class InheritPermissionDirective {\n\n    /** ID of the node to add/remove inherited permissions. */\n    @Input()\n    nodeId: string;\n\n    /** Emitted when the node is updated. */\n    @Output()\n    updated: EventEmitter<Node> = new EventEmitter<Node>();\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter<any>();\n\n    constructor(private nodeService: NodesApiService,\n                private contentService: ContentService) {\n    }\n\n    onInheritPermissionClicked() {\n        this.nodeService.getNode(this.nodeId).subscribe((node: Node) => {\n            if (this.contentService.hasAllowableOperations(node, AllowableOperationsEnum.UPDATEPERMISSIONS)) {\n                const nodeBody = { permissions: { isInheritanceEnabled: !node?.permissions?.isInheritanceEnabled ?? false} };\n                this.nodeService.updateNode(this.nodeId, nodeBody, { include: ['permissions'] }).subscribe((nodeUpdated: Node) => {\n                    this.updated.emit(nodeUpdated);\n                }, (error) => this.error.emit(error));\n            } else {\n                this.error.emit('PERMISSION_MANAGER.ERROR.NOT-ALLOWED');\n            }\n        });\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { QueryBody } from '@alfresco/js-api';\nimport { SearchConfigurationInterface } from '@alfresco/adf-core';\nimport { Injectable, Optional, Inject, InjectionToken } from '@angular/core';\n\nexport const SEARCH_QUERY_TOKEN = new InjectionToken<QueryProvider>('Alfresco Search Query Token');\nexport interface QueryProvider {\n    query: string;\n}\n\n@Injectable()\nexport class SearchPermissionConfigurationService implements SearchConfigurationInterface {\n\n    constructor(\n        @Optional()\n        @Inject(SEARCH_QUERY_TOKEN)\n        private queryProvider: QueryProvider) {\n    }\n\n    public generateQueryBody(searchTerm: string, maxResults: number, skipCount: number): QueryBody {\n        const defaultQueryBody: QueryBody = {\n            query: {\n                query: this.getQuery(searchTerm)\n            },\n            include: ['properties', 'aspectNames'],\n            paging: {\n                maxItems: maxResults,\n                skipCount: skipCount\n            },\n            filterQueries: [\n                /*tslint:disable-next-line */\n                { query: \"TYPE:'cm:authority'\" }]\n        };\n\n        return defaultQueryBody;\n    }\n\n    private getQuery(searchTerm: string) {\n        let query: string;\n        if (this.queryProvider && this.queryProvider.query) {\n            query = this.queryProvider.query.replace(\n                new RegExp(/\\${([^}]+)}/g), searchTerm);\n        } else {\n            query = `(email:*${searchTerm}* OR firstName:*${searchTerm}* OR lastName:*${searchTerm}* OR displayName:*${searchTerm}* OR authorityName:*${searchTerm}* OR authorityDisplayName:*${searchTerm}*) AND ANAME:(\\\"0/APP.DEFAULT\\\")`;\n        }\n        return query;\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SearchConfigurationService, SearchService } from '@alfresco/adf-core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { Component, EventEmitter, Output, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { debounceTime } from 'rxjs/operators';\nimport { SearchPermissionConfigurationService } from './search-config-permission.service';\nimport { SearchComponent } from '../../../search/components/search.component';\nimport { MatSelectionList } from '@angular/material/list';\n\n@Component({\n    selector: 'adf-add-permission-panel',\n    templateUrl: './add-permission-panel.component.html',\n    styleUrls: ['./add-permission-panel.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    providers: [\n        { provide: SearchConfigurationService, useClass: SearchPermissionConfigurationService },\n        SearchService\n    ]\n})\nexport class AddPermissionPanelComponent {\n\n    @ViewChild('search', { static: true })\n    search: SearchComponent;\n\n    @ViewChild(MatSelectionList, { static: false })\n    matSelectionList: MatSelectionList;\n\n    /** Emitted when a permission list item is selected. */\n    @Output()\n    select: EventEmitter<NodeEntry[]> = new EventEmitter();\n\n    searchInput: FormControl = new FormControl();\n    searchedWord = '';\n    debounceSearch: number = 200;\n\n    selectedItems: NodeEntry[] = [];\n\n    EVERYONE: NodeEntry = new NodeEntry({ entry: { nodeType: 'cm:authorityContainer', properties: {'cm:authorityName': 'GROUP_EVERYONE'}}});\n\n    constructor() {\n        this.searchInput.valueChanges\n        .pipe(\n            debounceTime(this.debounceSearch)\n        )\n        .subscribe((searchValue) => {\n            const selectionOptions = this.matSelectionList.selectedOptions.selected.map(option => option.value);\n            this.selectedItems.push(...selectionOptions);\n            this.matSelectionList.deselectAll();\n            this.searchedWord = searchValue;\n            if (!searchValue) {\n                this.search.resetResults();\n            }\n        });\n    }\n\n    onSelectionChange() {\n        const currentSelection = this.matSelectionList.selectedOptions.selected.map(option => option.value);\n        const uniqueSelection = [ ...currentSelection, ...this.selectedItems ]\n            .reduce((uniquesElements, currentElement) => {\n            const isExist = uniquesElements.find(uniqueElement => uniqueElement.entry.id === currentElement.entry.id);\n            if (!isExist) {\n                uniquesElements.push(currentElement);\n            }\n            return uniquesElements;\n            }, []);\n        this.select.emit(uniqueSelection);\n    }\n\n    clearSearch() {\n        this.searchedWord = '';\n        this.selectedItems.splice(0, this.selectedItems.length);\n        this.search.resetResults();\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AllowableOperationsEnum, ContentService } from '@alfresco/adf-core';\nimport { Node, NodeEntry, PermissionElement } from '@alfresco/js-api';\nimport { Component, EventEmitter, Input, OnInit, Output, ViewEncapsulation } from '@angular/core';\nimport { NodePermissionService } from '../../services/node-permission.service';\nimport { RoleModel } from '../../models/role.model';\n\n@Component({\n    selector: 'adf-add-permission',\n    templateUrl: './add-permission.component.html',\n    styleUrls: ['./add-permission.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\n/*\n * @deprecated in 4.4.0, use adf-add-permission-panel instead.\n */\nexport class AddPermissionComponent implements OnInit {\n\n    /** ID of the target node. */\n    @Input()\n    nodeId: string;\n\n    /** Emitted when the node is updated successfully. */\n    @Output()\n    success: EventEmitter<Node> = new EventEmitter();\n\n    /** Emitted when an error occurs during the update. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter();\n\n    selectedItems: NodeEntry[] = [];\n    currentNode: Node;\n    currentNodeRoles: RoleModel[];\n\n    constructor(private nodePermissionService: NodePermissionService,\n                private contentService: ContentService) { }\n\n    ngOnInit(): void {\n        this.nodePermissionService.getNodeWithRoles(this.nodeId).subscribe(({node, roles }) => {\n            this.currentNode = node;\n            this.currentNodeRoles = roles;\n        });\n    }\n\n    onSelect(selection: NodeEntry[]) {\n        this.selectedItems = selection;\n    }\n\n    isAddEnabled(): boolean {\n        return this.contentService.hasAllowableOperations(this.currentNode, AllowableOperationsEnum.UPDATEPERMISSIONS) &&\n                this.selectedItems.length !== 0;\n    }\n\n    applySelection() {\n        if (this.contentService.hasAllowableOperations(this.currentNode, AllowableOperationsEnum.UPDATEPERMISSIONS)) {\n            const permissions = this.transformNodeToPermissionElement(this.selectedItems, this.currentNodeRoles[0].role);\n            this.nodePermissionService.updateNodePermissions(this.nodeId, permissions)\n                .subscribe((node) => {\n                        this.success.emit(node);\n                    },\n                    (error) => {\n                        this.error.emit(error);\n                    });\n        }\n    }\n\n    private transformNodeToPermissionElement(nodes: NodeEntry[], role: string): PermissionElement[] {\n        return nodes.map((node) => {\n            return {\n                'authorityId': node.entry.properties['cm:authorityName'] ?? node.entry.properties['cm:userName'],\n                'name': role,\n                'accessStatus': 'ALLOWED'\n            };\n        });\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { User } from '@alfresco/adf-core';\nimport { NodeEntry } from '@alfresco/js-api';\nimport { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { NodePermissionService } from '../../services/node-permission.service';\n\n@Component({\n    selector: 'adf-user-icon-column',\n    template: `\n        <div class=\"adf-cell-value\" [attr.id]=\"group ? 'group-icon' : 'person-icon'\"  *ngIf=\"!isSelected\">\n            <ng-container *ngIf=\"displayText$ | async as user\">\n                <mat-icon *ngIf=\"group\" class=\"adf-group-icon\">people_alt_outline</mat-icon>\n                <div *ngIf=\"!group\" [outerHTML]=\"user | usernameInitials: 'adf-people-initial'\"></div>\n            </ng-container>\n        </div>\n        <div class=\"adf-cell-value\" *ngIf=\"isSelected\">\n            <mat-icon class=\"adf-people-select-icon adf-datatable-selected\" svgIcon=\"selected\"></mat-icon>\n        </div>\n    `,\n    styleUrls: ['./user-icon-column.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-user-icon-column adf-datatable-content-cell' }\n})\nexport class UserIconColumnComponent implements OnInit {\n    @Input()\n    context: any;\n\n    @Input()\n    node: NodeEntry;\n\n    @Input()\n    selected: boolean = false;\n\n    displayText$ = new BehaviorSubject<User>(null);\n    group = false;\n\n    get isSelected(): boolean {\n        return this.context?.row?.isSelected || this.selected;\n    }\n\n    constructor(private nodePermissionService: NodePermissionService) {}\n\n    ngOnInit() {\n        if (this.context) {\n            const { person, group, authorityId } = this.context.row.obj?.entry ?? this.context.row.obj;\n            this.group = this.isGroup(group, authorityId);\n            this.displayText$.next(person || group || { displayName: authorityId });\n        }\n\n        if (this.node) {\n            const { person, group } = this.nodePermissionService.transformNodeToUserPerson(this.node.entry);\n            this.group = this.isGroup(group, null);\n            this.displayText$.next(person || group);\n        }\n    }\n\n    private isGroup(group, authorityId): boolean {\n        return !!group || authorityId?.startsWith('GROUP_') || authorityId?.startsWith('ROLE_');\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, Input, OnInit, ViewEncapsulation } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { Group, NodeEntry } from '@alfresco/js-api';\nimport { NodePermissionService } from '../../services/node-permission.service';\nimport { EcmUserModel } from '@alfresco/adf-core';\n\n@Component({\n    selector: 'adf-user-name-column',\n    template: `\n        <div class=\"adf-ellipsis-cell\" [attr.data-automation-id]=\"displayText$ | async\">\n            <span class=\"adf-user-name-column\" title=\"{{ displayText$ | async }}\"> {{ displayText$ | async }}</span>\n            <br/>\n            <span class=\"adf-user-email-column\" title=\"{{ subTitleText$ | async }}\" *ngIf=\"subTitleText$ | async\">\n                {{ subTitleText$ | async }}\n            </span>\n        </div>\n    `,\n    styleUrls: ['./user-name-column.component.scss'],\n    encapsulation: ViewEncapsulation.None,\n    host: { class: 'adf-user-name-column adf-datatable-content-cell adf-expand-cell-5 adf-ellipsis-cell' }\n})\nexport class UserNameColumnComponent implements OnInit {\n    @Input()\n    context: any;\n\n    @Input()\n    node: NodeEntry;\n\n    displayText$ = new BehaviorSubject<string>('');\n    subTitleText$ = new BehaviorSubject<string>('');\n\n    constructor(private nodePermissionService: NodePermissionService) {}\n\n    ngOnInit() {\n        if (this.context != null) {\n            const { person, group, authorityId } = this.context.row.obj?.entry ?? this.context.row.obj;\n            const permissionGroup = authorityId ? { displayName: authorityId } as  Group : null;\n            this.updatePerson(person);\n            this.updateGroup(group || permissionGroup);\n        }\n\n        if (this.node) {\n            const { person, group } = this.nodePermissionService.transformNodeToUserPerson(this.node.entry);\n            this.updatePerson(person);\n            this.updateGroup(group);\n        }\n    }\n\n    private updatePerson(person: EcmUserModel) {\n        if (person) {\n            this.displayText$.next(`${person.firstName ?? ''} ${person.lastName ?? ''}`);\n            this.subTitleText$.next(person.email ?? '');\n        }\n   }\n\n    private updateGroup(group: Group) {\n        if (group) {\n            this.displayText$.next(group.displayName);\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { RoleModel } from '../../models/role.model';\n\n@Component({\n  selector: 'adf-user-role-column',\n  template: `\n      <mat-form-field floatLabel=\"never\" class=\"adf-role-selector-field\" *ngIf=\"!readonly\">\n          <mat-select\n              (click)=\"$event.stopPropagation()\"\n              [placeholder]=\"placeholder | translate\"\n              [value]=\"value\"\n              (selectionChange)=\"onRoleChanged($event.value)\">\n              <mat-option *ngFor=\"let role of roles\" [value]=\"role.role\">\n                  {{ role.label | adfLocalizedRole }}\n              </mat-option>\n          </mat-select>\n      </mat-form-field>\n\n      <span class=\"adf-datatable-cell-value adf-readonly-role\" [title]=\"value | adfLocalizedRole\" *ngIf=\"readonly\">\n          {{value | adfLocalizedRole}}\n      </span>\n  `,\n    host: { class: 'adf-user-role-column adf-datatable-content-cell adf-expand-cell-4' },\n    styles: [\n        `.adf-role-selector-field {\n            width: 100%;\n            .mat-form-field {\n                width: 100%;\n                max-width: 200px;\n            }\n        }\n        .adf-readonly-role {\n            padding-left: 0 !important;\n        }\n        `\n    ]\n})\nexport class UserRoleColumnComponent {\n\n    @Input()\n    roles: RoleModel[];\n\n    @Input()\n    value: string;\n\n    @Input()\n    readonly = false;\n\n    @Input()\n    placeholder: string = 'PERMISSION_MANAGER.LABELS.SELECT-ROLE';\n\n    @Output()\n    roleChanged: EventEmitter<string> = new EventEmitter<string>();\n\n    onRoleChanged(newRole: string) {\n        this.value = newRole;\n        this.roleChanged.emit(newRole);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node } from '@alfresco/js-api';\nimport { Component, Input, OnInit } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\n\n@Component({\n    selector: 'adf-node-path-column',\n    template: `\n        <span class=\"adf-user-name-column adf-datatable-cell-value\"  title=\"{{ displayText$ | async }}\">\n            {{ displayText$ | async }}\n        </span>\n    `,\n    host: { class: 'adf-node-path-column adf-datatable-content-cell' }\n})\nexport class NodePathColumnComponent implements OnInit {\n    @Input()\n    node: Node;\n\n    displayText$ = new BehaviorSubject<string>('');\n\n    ngOnInit() {\n        this.updateValue();\n    }\n\n    protected updateValue() {\n        this.displayText$.next(this.node.path.name);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnChanges, Output, ViewEncapsulation } from '@angular/core';\nimport { Node } from '@alfresco/js-api';\nimport { PermissionDisplayModel } from '../../models/permission.model';\nimport { RoleModel } from '../../models/role.model';\n\n@Component({\n  selector: 'adf-permission-container',\n  templateUrl: './permission-container.component.html',\n  styleUrls: ['./permission-container.component.scss'],\n  encapsulation: ViewEncapsulation.None\n})\nexport class PermissionContainerComponent implements OnChanges {\n\n    @Input()\n    node: Node;\n\n    @Input()\n    permissions: PermissionDisplayModel[] = [];\n\n    @Input()\n    roles!: RoleModel[];\n\n    @Input()\n    isReadOnly = false;\n\n    @Input()\n    showLocation = false;\n\n    @Input()\n    selectionMode = 'multiple'; // none|single|multiple\n\n    /** Emitted when the permission is updated. */\n    @Output()\n    update = new EventEmitter<{role: string, permission: PermissionDisplayModel}>();\n\n    @Output()\n    updateAll = new EventEmitter<string>();\n\n    /** Emitted when the permission is updated. */\n    @Output()\n    delete = new EventEmitter<PermissionDisplayModel>();\n\n    /** Emitted when an error occurs. */\n    @Output()\n    error = new EventEmitter<any>();\n\n    bulkSelectionRole: string;\n\n    ngOnChanges(): void {\n        this.bulkSelectionRole = '';\n    }\n\n    updateRole(role: string, permission: PermissionDisplayModel) {\n        this.update.emit({ role, permission });\n    }\n\n    bulkRoleUpdate(role: string) {\n        this.updateAll.emit(role);\n    }\n\n    removePermission(event: MouseEvent, permissionRow: PermissionDisplayModel) {\n        event.stopPropagation();\n        this.delete.emit(permissionRow);\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AfterViewInit, Directive, ElementRef, Input, OnDestroy, OnInit, TemplateRef, ViewContainerRef } from '@angular/core';\nimport { ConnectionPositionPair, Overlay, OverlayRef } from '@angular/cdk/overlay';\nimport { TemplatePortal } from '@angular/cdk/portal';\nimport { takeUntil } from 'rxjs/operators';\nimport { Subject } from 'rxjs';\n\n@Directive({\n    selector: '[adf-pop-over]',\n    exportAs: 'adfPopOver'\n\n})\nexport class PopOverDirective implements OnInit, OnDestroy, AfterViewInit {\n    get open(): boolean {\n        return this._open;\n    }\n\n    @Input('adf-pop-over') popOver!: TemplateRef<object>;\n    @Input() target!: HTMLElement;\n    @Input() panelClass = 'adf-permission-pop-over';\n\n    private _open = false;\n    private destroy$ = new Subject();\n    private overlayRef!: OverlayRef;\n\n    constructor(\n        private element: ElementRef,\n        private overlay: Overlay,\n        private vcr: ViewContainerRef\n    ) { }\n\n    ngOnInit(): void {\n        this.createOverlay();\n    }\n\n    ngAfterViewInit(): void {\n        this.element.nativeElement.addEventListener('click', () => this.attachOverlay());\n    }\n\n    ngOnDestroy(): void {\n        this.detachOverlay();\n        this.destroy$.next();\n        this.destroy$.complete();\n    }\n\n    private createOverlay(): void {\n        const scrollStrategy = this.overlay.scrollStrategies.reposition();\n        const positionStrategy = this.overlay\n            .position()\n            .flexibleConnectedTo(this.target)\n            .withPositions([\n                new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'start', overlayY: 'top' }),\n                new ConnectionPositionPair({ originX: 'start', originY: 'top' }, { overlayX: 'start', overlayY: 'bottom' })\n            ])\n            .withPush(false);\n\n        this.overlayRef = this.overlay.create({\n            positionStrategy,\n            scrollStrategy,\n            hasBackdrop: true,\n            backdropClass: 'cdk-overlay-transparent-backdrop',\n            panelClass: this.panelClass\n        });\n\n        this.overlayRef\n            .backdropClick()\n            .pipe(takeUntil(this.destroy$))\n            .subscribe(() => {\n                this._open = false;\n                this.detachOverlay();\n            });\n    }\n\n    private attachOverlay(): void {\n        if (!this.overlayRef.hasAttached()) {\n            const periodSelectorPortal = new TemplatePortal(this.popOver, this.vcr);\n\n            this.overlayRef.attach(periodSelectorPortal);\n            this._open = true;\n        }\n    }\n\n    private detachOverlay(): void {\n        if (this.overlayRef.hasAttached()) {\n            this.overlayRef.detach();\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CoreModule, PipeModule } from '@alfresco/adf-core';\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { MaterialModule } from '../material.module';\nimport { PermissionListComponent } from './components/permission-list/permission-list.component';\nimport { AddPermissionComponent } from './components/add-permission/add-permission.component';\nimport { AddPermissionDialogComponent } from './components/add-permission/add-permission-dialog.component';\nimport { InheritPermissionDirective } from './components/inherited-button.directive';\nimport { AddPermissionPanelComponent } from './components/add-permission/add-permission-panel.component';\nimport { SearchModule } from '../search/search.module';\nimport { UserNameColumnComponent } from './components/user-name-column/user-name-column.component';\nimport { UserIconColumnComponent } from './components/user-icon-column/user-icon-column.component';\nimport { UserRoleColumnComponent } from './components/user-role-column/user-role-column.component';\nimport { NodePathColumnComponent } from './components/node-path-column/node-path-column.component';\nimport { PopOverDirective } from './components/pop-over.directive';\nimport { PermissionContainerComponent } from './components/permission-container/permission-container.component';\n\n@NgModule({\n    imports: [\n        CoreModule,\n        CommonModule,\n        FormsModule,\n        ReactiveFormsModule,\n        MaterialModule,\n        SearchModule,\n        PipeModule\n    ],\n    declarations: [\n        PermissionListComponent,\n        AddPermissionPanelComponent,\n        InheritPermissionDirective,\n        AddPermissionComponent,\n        AddPermissionDialogComponent,\n        UserNameColumnComponent,\n        UserIconColumnComponent,\n        UserRoleColumnComponent,\n        PopOverDirective,\n        NodePathColumnComponent,\n        PermissionContainerComponent\n    ],\n    exports: [\n        PermissionListComponent,\n        AddPermissionPanelComponent,\n        InheritPermissionDirective,\n        AddPermissionComponent,\n        AddPermissionDialogComponent,\n        UserNameColumnComponent,\n        UserIconColumnComponent,\n        UserRoleColumnComponent,\n        PopOverDirective,\n        NodePathColumnComponent\n    ]\n})\nexport class PermissionManagerModule {}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n    Component,\n    Inject,\n    OnInit,\n    ViewEncapsulation,\n    ViewChild,\n    OnDestroy\n} from '@angular/core';\nimport { MAT_DIALOG_DATA, MatDialogRef, MatDialog } from '@angular/material/dialog';\nimport { MatSlideToggleChange } from '@angular/material/slide-toggle';\nimport { FormGroup, FormControl, AbstractControl } from '@angular/forms';\nimport { Observable, Subject } from 'rxjs';\nimport {\n    SharedLinksApiService,\n    NodesApiService,\n    ContentService,\n    RenditionsService,\n    AppConfigService\n} from '@alfresco/adf-core';\nimport { SharedLinkEntry, Node } from '@alfresco/js-api';\nimport { ConfirmDialogComponent } from '../dialogs/confirm.dialog';\nimport moment from 'moment-es6';\nimport { ContentNodeShareSettings } from './content-node-share.settings';\nimport { takeUntil, debounceTime } from 'rxjs/operators';\n\ntype DatePickerType = 'date' | 'time' | 'month' | 'datetime';\n\n@Component({\n    selector: 'adf-share-dialog',\n    templateUrl: './content-node-share.dialog.html',\n    styleUrls: ['./content-node-share.dialog.scss'],\n    host: { class: 'adf-share-dialog' },\n    encapsulation: ViewEncapsulation.None\n})\nexport class ShareDialogComponent implements OnInit, OnDestroy {\n\n    minDate = moment().add(1, 'd');\n    sharedId: string;\n    fileName: string;\n    baseShareUrl: string;\n    isFileShared: boolean = false;\n    isDisabled: boolean = false;\n    form: FormGroup = new FormGroup({\n        sharedUrl: new FormControl(''),\n        time: new FormControl({ value: '', disabled: true })\n    });\n    type: DatePickerType = 'datetime';\n    maxDebounceTime = 500;\n\n    @ViewChild('slideToggleExpirationDate', { static: true })\n    slideToggleExpirationDate;\n\n    @ViewChild('dateTimePickerInput', { static: true })\n    dateTimePickerInput;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(\n        private appConfigService: AppConfigService,\n        private sharedLinksApiService: SharedLinksApiService,\n        private dialogRef: MatDialogRef<ShareDialogComponent>,\n        private dialog: MatDialog,\n        private nodesApiService: NodesApiService,\n        private contentService: ContentService,\n        private renditionService: RenditionsService,\n        @Inject(MAT_DIALOG_DATA) public data: ContentNodeShareSettings\n    ) {}\n\n    ngOnInit() {\n        this.type = this.appConfigService.get<DatePickerType>('sharedLinkDateTimePickerType', 'datetime');\n\n        if (this.data.node && this.data.node.entry) {\n            this.fileName = this.data.node.entry.name;\n            this.baseShareUrl = this.data.baseShareUrl;\n\n            const properties = this.data.node.entry.properties;\n\n            if (!properties || !properties['qshare:sharedId']) {\n                this.createSharedLinks(this.data.node.entry.id);\n            } else {\n                this.sharedId = properties['qshare:sharedId'];\n                this.isFileShared = true;\n                this.updateForm();\n            }\n        }\n\n        this.time.valueChanges\n            .pipe(\n                debounceTime(this.maxDebounceTime),\n                takeUntil(this.onDestroy$)\n            )\n            .subscribe(value => this.onTimeChanged(value));\n    }\n\n    onTimeChanged(date: moment.Moment) {\n        this.updateNode(date).subscribe(\n            () => this.updateEntryExpiryDate(date)\n        );\n    }\n\n    get time(): AbstractControl {\n        return this.form.controls['time'];\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    onSlideShareChange(event: MatSlideToggleChange) {\n        if (event.checked) {\n            this.createSharedLinks(this.data.node.entry.id);\n        } else {\n            this.openConfirmationDialog();\n        }\n    }\n\n    get canUpdate() {\n        const { entry } = this.data.node;\n\n        if (entry && entry.allowableOperations) {\n            return this.contentService.hasAllowableOperations(entry, 'update');\n        }\n\n        return true;\n    }\n\n    onToggleExpirationDate(slideToggle: MatSlideToggleChange) {\n        if (slideToggle.checked) {\n            this.time.enable();\n        } else {\n            this.time.disable();\n            this.time.setValue(null);\n        }\n    }\n\n    onDatetimepickerClosed() {\n        this.dateTimePickerInput.nativeElement.blur();\n\n        if (!this.time.value) {\n            this.slideToggleExpirationDate.checked = false;\n        }\n    }\n\n    private openConfirmationDialog() {\n        this.isFileShared = false;\n\n        this.dialog\n            .open(ConfirmDialogComponent, {\n                data: {\n                    title: 'SHARE.CONFIRMATION.DIALOG-TITLE',\n                    message: 'SHARE.CONFIRMATION.MESSAGE',\n                    yesLabel: 'SHARE.CONFIRMATION.REMOVE',\n                    noLabel: 'SHARE.CONFIRMATION.CANCEL'\n                },\n                minWidth: '250px',\n                closeOnNavigation: true\n            })\n            .beforeClosed()\n            .subscribe((deleteSharedLink) => {\n                if (deleteSharedLink) {\n                    this.deleteSharedLink(this.sharedId);\n                } else {\n                    this.isFileShared = true;\n                }\n            });\n    }\n\n    private createSharedLinks(nodeId: string) {\n        this.isDisabled = true;\n\n        this.sharedLinksApiService.createSharedLinks(nodeId).subscribe(\n            (sharedLink: SharedLinkEntry) => {\n                if (sharedLink.entry) {\n                    this.sharedId = sharedLink.entry.id;\n                    if (this.data.node.entry.properties) {\n                        this.data.node.entry.properties['qshare:sharedId'] = this.sharedId;\n                    } else {\n                        this.data.node.entry.properties = {\n                            'qshare:sharedId': this.sharedId\n                        };\n                    }\n                    this.isDisabled = false;\n                    this.isFileShared = true;\n                    this.renditionService\n                        .generateRenditionForNode(this.data.node.entry.id)\n                        .subscribe(() => {});\n\n                    this.updateForm();\n                }\n            },\n            () => {\n                this.isDisabled = false;\n                this.isFileShared = false;\n            }\n        );\n    }\n\n    deleteSharedLink(sharedId: string) {\n        this.isDisabled = true;\n\n        this.sharedLinksApiService\n            .deleteSharedLink(sharedId)\n            .subscribe((response: any) => {\n                if (response instanceof Error) {\n                    this.isDisabled = false;\n                    this.isFileShared = true;\n                    this.handleError(response);\n                } else {\n                    if (this.data.node.entry.properties) {\n                        this.data.node.entry.properties['qshare:sharedId'] = null;\n                        this.data.node.entry.properties['qshare:expiryDate'] = null;\n                    }\n                    this.dialogRef.close(false);\n                }\n            }\n        );\n    }\n\n    private handleError(error: Error) {\n        let message = 'SHARE.UNSHARE_ERROR';\n        let statusCode = 0;\n\n        try {\n            statusCode = JSON.parse(error.message).error.statusCode;\n        } catch {}\n\n        if (statusCode === 403) {\n            message = 'SHARE.UNSHARE_PERMISSION_ERROR';\n        }\n\n        this.sharedLinksApiService.error.next({\n            statusCode,\n            message\n        });\n    }\n\n    private updateForm() {\n        const { entry } = this.data.node;\n        let expiryDate = null;\n\n        if (entry && entry.properties) {\n            expiryDate = entry.properties['qshare:expiryDate'];\n        }\n\n        this.form.setValue({\n            sharedUrl: `${this.baseShareUrl}${this.sharedId}`,\n            time: expiryDate ? moment(expiryDate).local() : null\n        });\n\n        if (expiryDate) {\n            this.time.enable();\n        } else {\n            this.time.disable();\n        }\n    }\n\n    private updateNode(date: moment.Moment): Observable<Node> {\n        const expiryDate = date\n            ? (this.type === 'date' ? date.endOf('day').utc().format() : date.utc().format())\n            : null;\n\n        return this.nodesApiService.updateNode(this.data.node.entry.id, {\n            properties: {\n                'qshare:expiryDate': expiryDate\n            }\n        });\n    }\n\n    private updateEntryExpiryDate(date: moment.Moment) {\n        const { properties } = this.data.node.entry;\n\n        if (properties) {\n            properties['qshare:expiryDate'] = date\n                ? date.local()\n                : null;\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Directive, Input, HostListener, OnChanges, NgZone, OnDestroy } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\nimport { NodeEntry, NodesApi } from '@alfresco/js-api';\n\nimport { ShareDialogComponent } from './content-node-share.dialog';\nimport { Observable, from, Subject } from 'rxjs';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\nimport { takeUntil } from 'rxjs/operators';\n\n@Directive({\n    selector: '[adf-share]',\n    exportAs: 'adfShare'\n})\nexport class NodeSharedDirective implements OnChanges, OnDestroy {\n\n    isFile: boolean = false;\n    isShared: boolean = false;\n\n    /** Node to share. */\n        // tslint:disable-next-line:no-input-rename\n    @Input('adf-share')\n    node: NodeEntry;\n\n    /** Prefix to add to the generated link. */\n    @Input()\n    baseShareUrl: string;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    _nodesApi: NodesApi;\n    get nodesApi(): NodesApi {\n        this._nodesApi = this._nodesApi ?? new NodesApi(this.alfrescoApiService.getInstance());\n        return this._nodesApi;\n    }\n\n    constructor(\n        private dialog: MatDialog,\n        private zone: NgZone,\n        private alfrescoApiService: AlfrescoApiService) {\n    }\n\n    ngOnDestroy() {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    shareNode(nodeEntry: NodeEntry) {\n        if (nodeEntry && nodeEntry.entry && nodeEntry.entry.isFile) {\n            // shared and favorite\n            const nodeId = nodeEntry.entry['nodeId'] || nodeEntry.entry['guid'];\n\n            if (nodeId) {\n                this.getNodeInfo(nodeId).subscribe((node) => {\n                    this.openShareLinkDialog(node);\n                });\n            } else {\n                this.openShareLinkDialog(nodeEntry);\n            }\n        }\n    }\n\n    private getNodeInfo(nodeId: string): Observable<NodeEntry> {\n        const options = {\n            include: ['allowableOperations']\n        };\n\n        return from(this.nodesApi.getNode(nodeId, options));\n    }\n\n    private openShareLinkDialog(node: NodeEntry) {\n        this.dialog.open(ShareDialogComponent, {\n            width: '600px',\n            panelClass: 'adf-share-link-dialog',\n            data: {\n                node,\n                baseShareUrl: this.baseShareUrl\n            }\n        });\n    }\n\n    ngOnChanges() {\n        this.zone.onStable\n            .pipe(takeUntil(this.onDestroy$))\n            .subscribe(() => {\n                if (this.node && this.node.entry) {\n                    this.isFile = this.node.entry.isFile;\n                    this.isShared = this.node.entry.properties ? this.node.entry.properties['qshare:sharedId'] : false;\n                }\n            });\n    }\n\n    @HostListener('click')\n    onClick() {\n        if (this.node) {\n            this.shareNode(this.node);\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { CoreModule } from '@alfresco/adf-core';\nimport { MaterialModule } from '../material.module';\nimport { ShareDialogComponent } from './content-node-share.dialog';\nimport { NodeSharedDirective } from './content-node-share.directive';\n\n@NgModule({\n    imports: [\n        CoreModule,\n        CommonModule,\n        MaterialModule\n    ],\n    declarations: [\n        ShareDialogComponent,\n        NodeSharedDirective\n    ],\n    exports: [\n        ShareDialogComponent,\n        NodeSharedDirective\n    ]\n})\nexport class ContentNodeShareModule {\n    static forRoot(): ModuleWithProviders<ContentNodeShareModule> {\n        return {\n            ngModule: ContentNodeShareModule\n        };\n    }\n\n    static forChild(): ModuleWithProviders<ContentNodeShareModule> {\n        return {\n            ngModule: ContentNodeShareModule\n        };\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodeEntry } from '@alfresco/js-api';\n\nexport class TreeBaseNode {\n\n    name: string;\n    nodeId: string;\n    level: number;\n    expandable = true;\n    node: NodeEntry;\n\n    constructor(nodeEntry: NodeEntry, level?: number, expandable?: boolean) {\n        this.name = nodeEntry.entry.name;\n        this.nodeId = nodeEntry.entry.id;\n        this.level = level ? level : 0;\n        this.expandable = expandable ? expandable : true;\n        this.node = nodeEntry ? new NodeEntry(nodeEntry) : undefined;\n\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NodesApiService } from '@alfresco/adf-core';\nimport { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { TreeBaseNode } from '../models/tree-view.model';\nimport { NodePaging, NodeEntry } from '@alfresco/js-api';\nimport { map } from 'rxjs/operators';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class TreeViewService {\n\n    constructor(private nodeApi: NodesApiService) {\n    }\n\n    getTreeNodes(nodeId): Observable<TreeBaseNode[]> {\n        return this.nodeApi.getNodeChildren(nodeId)\n            .pipe(\n                map((nodePage: NodePaging) => {\n                    return nodePage.list.entries.filter((node) => node.entry.isFolder ? node : null);\n                }),\n                map((nodes: NodeEntry[]) => nodes.map((node) => new TreeBaseNode(node)))\n            );\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { CollectionViewer, SelectionChange } from '@angular/cdk/collections';\nimport { BehaviorSubject, merge, Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { FlatTreeControl } from '@angular/cdk/tree';\nimport { TreeBaseNode } from '../models/tree-view.model';\nimport { TreeViewService } from '../services/tree-view.service';\n\n@Injectable()\nexport class TreeViewDataSource {\n\n    treeNodes: TreeBaseNode[];\n    dataChange = new BehaviorSubject<TreeBaseNode[]>([]);\n    childrenSubscription = null;\n    changeSubscription = null;\n\n    get data(): TreeBaseNode[] {\n        return this.treeNodes;\n    }\n\n    set data(value: TreeBaseNode[]) {\n        this.treeControl.dataNodes = value;\n        this.dataChange.next(value);\n    }\n\n    constructor(private treeControl: FlatTreeControl<TreeBaseNode>,\n                private treeViewService: TreeViewService) {\n        this.dataChange.subscribe((treeNodes) => this.treeNodes = treeNodes);\n    }\n\n    connect(collectionViewer: CollectionViewer): Observable<TreeBaseNode[]> {\n        this.changeSubscription = this.treeControl.expansionModel.changed.subscribe((change) => {\n            if ((change as SelectionChange<TreeBaseNode>).added &&\n                (change as SelectionChange<TreeBaseNode>).added.length > 0) {\n                this.expandTreeNodes(change as SelectionChange<TreeBaseNode>);\n            } else if ((change as SelectionChange<TreeBaseNode>).removed) {\n                this.reduceTreeNodes(change as SelectionChange<TreeBaseNode>);\n            }\n        });\n        return merge(collectionViewer.viewChange, this.dataChange).pipe(map(() => this.data));\n    }\n\n    disconnect() {\n        if (this.childrenSubscription) {\n            this.childrenSubscription.unsubscribe();\n        }\n        if (this.changeSubscription) {\n            this.changeSubscription.unsubscribe();\n        }\n    }\n\n    private expandTreeNodes(change: SelectionChange<TreeBaseNode>) {\n        change.added.forEach((node) => this.expandNode(node));\n    }\n\n    private reduceTreeNodes(change: SelectionChange<TreeBaseNode>) {\n        change.removed.slice().reverse().forEach((node) => this.toggleNode(node));\n    }\n\n    private expandNode(node: TreeBaseNode) {\n        this.childrenSubscription = this.treeViewService.getTreeNodes(node.nodeId)\n            .subscribe((children) => {\n                const index = this.data.indexOf(node);\n                if (!children || index < 0) {\n                    node.expandable = false;\n                    return;\n                }\n                const nodes = children.map((actualNode) => {\n                    actualNode.level = node.level + 1;\n                    return actualNode;\n                });\n                this.data.splice(index + 1, 0, ...nodes);\n                this.dataChange.next(this.data);\n            });\n    }\n\n    toggleNode(node: TreeBaseNode) {\n        const index = this.data.indexOf(node);\n        let count = 0;\n        for (let i = index + 1; i < this.data.length\n            && this.data[i].level > node.level; i++ , count++) { }\n        this.data.splice(index + 1, count);\n        this.dataChange.next(this.data);\n    }\n\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FlatTreeControl } from '@angular/cdk/tree';\nimport { Component, Input, OnChanges, SimpleChanges, Output, EventEmitter } from '@angular/core';\nimport { TreeBaseNode } from '../models/tree-view.model';\nimport { TreeViewDataSource } from '../data/tree-view-datasource';\nimport { TreeViewService } from '../services/tree-view.service';\nimport { NodeEntry } from '@alfresco/js-api';\n\n@Component({\n    selector: 'adf-tree-view-list',\n    templateUrl: './tree-view.component.html',\n    styleUrls: ['./tree-view.component.scss']\n})\n\nexport class TreeViewComponent implements OnChanges {\n\n    /** Identifier of the node to display. */\n    @Input()\n    nodeId: string;\n\n    /** Emitted when a node in the tree view is clicked. */\n    @Output()\n    nodeClicked: EventEmitter<NodeEntry> = new EventEmitter();\n\n    /** Emitted when an invalid node id is given. */\n    @Output()\n    error: EventEmitter<any> = new EventEmitter();\n\n    treeControl: FlatTreeControl<TreeBaseNode>;\n    dataSource: TreeViewDataSource;\n\n    constructor(private treeViewService: TreeViewService) {\n        this.treeControl = new FlatTreeControl<TreeBaseNode>(this.getLevel, this.isExpandable);\n        this.dataSource = new TreeViewDataSource(this.treeControl, this.treeViewService);\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        if (changes['nodeId'] && changes['nodeId'].currentValue &&\n            changes['nodeId'].currentValue !== changes['nodeId'].previousValue) {\n            this.loadTreeNode();\n        } else {\n            this.dataSource.data = [];\n        }\n    }\n\n    onNodeClicked(node: NodeEntry) {\n        this.nodeClicked.emit(node);\n    }\n\n    getLevel = (node: TreeBaseNode) => node.level;\n\n    isExpandable = (node: TreeBaseNode) => node.expandable;\n\n    hasChild = (_: number, nodeData: TreeBaseNode) => nodeData.expandable;\n\n    private loadTreeNode() {\n        this.treeViewService.getTreeNodes(this.nodeId)\n            .subscribe(\n                (treeNode: TreeBaseNode[]) => {\n                    this.dataSource.data = treeNode;\n                },\n                (error) => this.error.emit(error)\n            );\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { MaterialModule } from '../material.module';\nimport { TreeViewComponent } from './components/tree-view.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MaterialModule,\n        TranslateModule\n    ],\n    declarations: [\n        TreeViewComponent\n    ],\n    exports: [\n        TreeViewComponent\n    ]\n})\nexport class TreeViewModule {\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Injectable } from '@angular/core';\nimport { GroupEntry, GroupsApi } from '@alfresco/js-api';\nimport { AlfrescoApiService } from '@alfresco/adf-core';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class GroupService {\n\n    _groupsApi: GroupsApi;\n    get groupsApi(): GroupsApi {\n        this._groupsApi = this._groupsApi ?? new GroupsApi(this.alfrescoApiService.getInstance());\n        return this._groupsApi;\n    }\n\n    constructor(\n        private alfrescoApiService: AlfrescoApiService\n    ) {\n    }\n\n    async listAllGroupMembershipsForPerson(personId: string, opts?: any, accumulator = []): Promise<GroupEntry[]> {\n        const groupsPaginated = await this.groupsApi.listGroupMembershipsForPerson(personId, opts);\n        accumulator = [...accumulator, ...groupsPaginated.list.entries];\n        if (groupsPaginated.list.pagination.hasMoreItems) {\n            const skip = groupsPaginated.list.pagination.skipCount + groupsPaginated.list.pagination.count;\n            return this.listAllGroupMembershipsForPerson(personId, {\n                maxItems: opts.maxItems,\n                skipCount: skip\n            }, accumulator);\n        } else {\n            return accumulator;\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Component, EventEmitter, Input, OnDestroy, OnInit, Output, ViewEncapsulation } from '@angular/core';\nimport { NodesApiService } from '@alfresco/adf-core';\nimport { Observable, Subject, zip } from 'rxjs';\nimport { concatMap, map, takeUntil, tap } from 'rxjs/operators';\nimport { AspectListService } from './aspect-list.service';\nimport { MatCheckboxChange } from '@angular/material/checkbox';\nimport { AspectEntry } from '@alfresco/js-api';\n@Component({\n    selector: 'adf-aspect-list',\n    templateUrl: './aspect-list.component.html',\n    styleUrls: ['./aspect-list.component.scss'],\n    encapsulation: ViewEncapsulation.None\n})\n\nexport class AspectListComponent implements OnInit, OnDestroy {\n\n    /** Node Id of the node that we want to update */\n    @Input()\n    nodeId: string = '';\n\n    /** Emitted every time the user select a new aspect */\n    @Output()\n    valueChanged: EventEmitter<string[]> = new EventEmitter<string[]>();\n\n    propertyColumns: string[] = ['name', 'title', 'dataType'];\n    aspects$: Observable<AspectEntry[]> = null;\n    nodeAspects: string[] = [];\n    nodeAspectStatus: string[] = [];\n    hasEqualAspect: boolean = true;\n\n    private onDestroy$ = new Subject<boolean>();\n\n    constructor(private aspectListService: AspectListService, private nodeApiService: NodesApiService) {\n    }\n\n    ngOnDestroy(): void {\n        this.onDestroy$.next(true);\n        this.onDestroy$.complete();\n    }\n\n    ngOnInit(): void {\n        if (this.nodeId) {\n            const node$ = this.nodeApiService.getNode(this.nodeId);\n            const customAspect$ = this.aspectListService.getCustomAspects()\n            .pipe(map(\n                (customAspects) => customAspects.flatMap((customAspect) => customAspect.entry.id)\n            ));\n            this.aspects$ = zip(node$, customAspect$).pipe(\n                tap(([node, customAspects]) => {\n                    this.nodeAspects = node.aspectNames.filter((aspect) => this.aspectListService.getVisibleAspects().includes(aspect) || customAspects.includes(aspect));\n                    this.nodeAspectStatus = [ ...this.nodeAspects ];\n                    this.valueChanged.emit(this.nodeAspects);\n                }),\n                concatMap(() => this.aspectListService.getAspects()),\n                takeUntil(this.onDestroy$));\n        } else {\n            this.aspects$ = this.aspectListService.getAspects()\n                .pipe(takeUntil(this.onDestroy$));\n        }\n    }\n\n    onCheckBoxClick(event: Event) {\n        event.stopImmediatePropagation();\n    }\n\n    onChange(change: MatCheckboxChange, prefixedName: string) {\n        if (change.checked) {\n            this.nodeAspects.push(prefixedName);\n        } else {\n            this.nodeAspects.splice(this.nodeAspects.indexOf(prefixedName), 1);\n        }\n        this.updateEqualityOfAspectList();\n        this.valueChanged.emit(this.nodeAspects);\n    }\n\n    reset() {\n        if (this.nodeAspectStatus && this.nodeAspectStatus.length > 0) {\n            this.nodeAspects.splice(0, this.nodeAspects.length, ...this.nodeAspectStatus);\n            this.hasEqualAspect = true;\n            this.valueChanged.emit(this.nodeAspects);\n        } else {\n            this.clear();\n        }\n    }\n\n    clear() {\n        this.nodeAspects = [];\n        this.updateEqualityOfAspectList();\n        this.valueChanged.emit(this.nodeAspects);\n    }\n\n    getId(aspect: any): string {\n        return aspect?.entry?.title ? aspect?.entry?.title : aspect?.entry?.id.replace(':', '-');\n    }\n\n    getTitle(aspect: any): string {\n        return aspect?.entry?.title ? aspect?.entry?.title : aspect?.entry?.id;\n    }\n\n    private updateEqualityOfAspectList() {\n        if (this.nodeAspectStatus.length !== this.nodeAspects.length) {\n            this.hasEqualAspect =  false;\n        } else {\n            this.hasEqualAspect = this.nodeAspects.every((aspect) => this.nodeAspectStatus.includes(aspect));\n        }\n    }\n}\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { AspectListComponent } from './aspect-list.component';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { PipeModule } from '@alfresco/adf-core';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { AspectListDialogComponent } from './aspect-list-dialog.component';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MatTableModule,\n        MatExpansionModule,\n        MatCheckboxModule,\n        PipeModule,\n        TranslateModule,\n        MatDialogModule,\n        MatButtonModule,\n        MatTooltipModule,\n        MatProgressSpinnerModule\n    ],\n    exports: [\n        AspectListComponent,\n        AspectListDialogComponent\n    ],\n    declarations: [\n        AspectListComponent,\n        AspectListDialogComponent\n    ]\n})\nexport class AspectListModule { }\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { MatTableModule } from '@angular/material/table';\nimport { MatExpansionModule } from '@angular/material/expansion';\nimport { MatCheckboxModule } from '@angular/material/checkbox';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatButtonModule } from '@angular/material/button';\nimport { ContentTypeDialogComponent } from './content-type-dialog.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        MatTableModule,\n        MatExpansionModule,\n        MatCheckboxModule,\n        TranslateModule,\n        MatDialogModule,\n        MatButtonModule\n    ],\n    exports: [\n        ContentTypeDialogComponent\n    ],\n    declarations: [\n        ContentTypeDialogComponent\n    ]\n})\nexport class ContentTypeModule { }\n","/*!\n * @license\n * Copyright 2019 Alfresco Software, Ltd.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonModule } from '@angular/common';\nimport { NgModule, ModuleWithProviders } from '@angular/core';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { CoreModule, TRANSLATION_PROVIDER } from '@alfresco/adf-core';\n\nimport { MaterialModule } from './material.module';\n\nimport { SocialModule } from './social/social.module';\nimport { TagModule } from './tag/tag.module';\nimport { WebScriptModule } from './webscript/webscript.module';\nimport { DocumentListModule } from './document-list/document-list.module';\nimport { UploadModule } from './upload/upload.module';\nimport { SearchModule } from './search/search.module';\nimport { SitesDropdownModule } from './site-dropdown/sites-dropdown.module';\nimport { BreadcrumbModule } from './breadcrumb/breadcrumb.module';\nimport { VersionManagerModule } from './version-manager/version-manager.module';\nimport { ContentNodeSelectorModule } from './content-node-selector/content-node-selector.module';\nimport { ContentNodeShareModule } from './content-node-share/content-node-share.module';\nimport { ContentDirectiveModule } from './directives/content-directive.module';\nimport { DialogModule } from './dialogs/dialog.module';\nimport { FolderDirectiveModule } from './folder-directive/folder-directive.module';\nimport { ContentMetadataModule } from './content-metadata/content-metadata.module';\nimport { PermissionManagerModule } from './permission-manager/permission-manager.module';\nimport { TreeViewModule } from './tree-view/tree-view.module';\nimport { ContentTypeModule } from './content-type/content-type.module';\nimport { AspectListModule } from './aspect-list/aspect-list.module';\n\n@NgModule({\n    imports: [\n        CoreModule,\n        SocialModule,\n        TagModule,\n        CommonModule,\n        WebScriptModule,\n        FormsModule,\n        ReactiveFormsModule,\n        DialogModule,\n        SearchModule,\n        DocumentListModule,\n        UploadModule,\n        MaterialModule,\n        SitesDropdownModule,\n        BreadcrumbModule,\n        ContentNodeSelectorModule,\n        ContentNodeShareModule,\n        ContentMetadataModule,\n        FolderDirectiveModule,\n        ContentDirectiveModule,\n        PermissionManagerModule,\n        VersionManagerModule,\n        TreeViewModule,\n        ContentTypeModule,\n        AspectListModule\n    ],\n    providers: [\n        {\n            provide: TRANSLATION_PROVIDER,\n            multi: true,\n            useValue: {\n                name: 'adf-content-services',\n                source: 'assets/adf-content-services'\n            }\n        }\n    ],\n    exports: [\n        SocialModule,\n        TagModule,\n        WebScriptModule,\n        DocumentListModule,\n        UploadModule,\n        SearchModule,\n        SitesDropdownModule,\n        BreadcrumbModule,\n        ContentNodeSelectorModule,\n        ContentNodeShareModule,\n        ContentMetadataModule,\n        DialogModule,\n        FolderDirectiveModule,\n        ContentDirectiveModule,\n        PermissionManagerModule,\n        VersionManagerModule,\n        TreeViewModule,\n        AspectListModule,\n        ContentTypeModule\n    ]\n})\nexport class ContentModule {\n    static forRoot(): ModuleWithProviders<ContentModule> {\n        return {\n            ngModule: ContentModule,\n            providers: [\n                {\n                    provide: TRANSLATION_PROVIDER,\n                    multi: true,\n                    useValue: {\n                        name: 'adf-content-services',\n                        source: 'assets/adf-content-services'\n                    }\n                }\n            ]\n        };\n    }\n\n    static forChild(): ModuleWithProviders<ContentModule> {\n        return {\n            ngModule: ContentModule\n        };\n    }\n}\n"]}