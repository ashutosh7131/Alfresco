import { Injectable, Output, EventEmitter } from '@angular/core';
import { Subject } from 'rxjs';
import { AlfrescoApiService, ContentService, NodeDownloadDirective, DownloadService } from '@alfresco/adf-core';
import { MatDialog } from '@angular/material/dialog';
import { DocumentListService } from './document-list.service';
import { ContentNodeDialogService } from '../../content-node-selector/content-node-dialog.service';
import { NodeAction } from '../models/node-action.enum';
import * as i0 from "@angular/core";
import * as i1 from "../../content-node-selector/content-node-dialog.service";
import * as i2 from "@angular/material/dialog";
import * as i3 from "@alfresco/adf-core";
import * as i4 from "./document-list.service";
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../../content-node-selector/content-node-dialog.service';
import * as ɵngcc2 from '@angular/material/dialog';
import * as ɵngcc3 from '@alfresco/adf-core';
import * as ɵngcc4 from './document-list.service';
export class NodeActionsService {
    constructor(contentDialogService, dialogRef, content, documentListService, apiService, dialog, downloadService) {
        this.contentDialogService = contentDialogService;
        this.dialogRef = dialogRef;
        this.content = content;
        this.documentListService = documentListService;
        this.apiService = apiService;
        this.dialog = dialog;
        this.downloadService = downloadService;
        this.error = new EventEmitter();
    }
    downloadNode(node) {
        new NodeDownloadDirective(this.apiService, this.downloadService, this.dialog)
            .downloadNode(node);
    }
    copyContent(contentEntry, permission) {
        return this.doFileOperation(NodeAction.COPY, 'content', contentEntry, permission);
    }
    copyFolder(contentEntry, permission) {
        return this.doFileOperation(NodeAction.COPY, 'folder', contentEntry, permission);
    }
    moveContent(contentEntry, permission) {
        return this.doFileOperation(NodeAction.MOVE, 'content', contentEntry, permission);
    }
    moveFolder(contentEntry, permission) {
        return this.doFileOperation(NodeAction.MOVE, 'folder', contentEntry, permission);
    }
    doFileOperation(action, type, contentEntry, permission) {
        const observable = new Subject();
        this.contentDialogService
            .openCopyMoveDialog(action, contentEntry, permission)
            .subscribe((selections) => {
            const selection = selections[0];
            this.documentListService[`${action.toLowerCase()}Node`].call(this.documentListService, contentEntry.id, selection.id)
                .subscribe(observable.next.bind(observable, `OPERATION.SUCCESS.${type.toUpperCase()}.${action}`), observable.error.bind(observable));
        }, (error) => {
            observable.error(error);
            return observable;
        });
        return observable;
    }
}
NodeActionsService.ɵfac = function NodeActionsService_Factory(t) { return new (t || NodeActionsService)(ɵngcc0.ɵɵinject(ɵngcc1.ContentNodeDialogService), ɵngcc0.ɵɵinject(ɵngcc2.MatDialog), ɵngcc0.ɵɵinject(ɵngcc3.ContentService), ɵngcc0.ɵɵinject(ɵngcc4.DocumentListService), ɵngcc0.ɵɵinject(ɵngcc3.AlfrescoApiService), ɵngcc0.ɵɵinject(ɵngcc2.MatDialog), ɵngcc0.ɵɵinject(ɵngcc3.DownloadService)); };
NodeActionsService.ɵprov = i0.ɵɵdefineInjectable({ factory: function NodeActionsService_Factory() { return new NodeActionsService(i0.ɵɵinject(i1.ContentNodeDialogService), i0.ɵɵinject(i2.MatDialog), i0.ɵɵinject(i3.ContentService), i0.ɵɵinject(i4.DocumentListService), i0.ɵɵinject(i3.AlfrescoApiService), i0.ɵɵinject(i2.MatDialog), i0.ɵɵinject(i3.DownloadService)); }, token: NodeActionsService, providedIn: "root" });
NodeActionsService.ctorParameters = () => [
    { type: ContentNodeDialogService },
    { type: MatDialog },
    { type: ContentService },
    { type: DocumentListService },
    { type: AlfrescoApiService },
    { type: MatDialog },
    { type: DownloadService }
];
NodeActionsService.propDecorators = {
    error: [{ type: Output }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(NodeActionsService, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: ɵngcc1.ContentNodeDialogService }, { type: ɵngcc2.MatDialog }, { type: ɵngcc3.ContentService }, { type: ɵngcc4.DocumentListService }, { type: ɵngcc3.AlfrescoApiService }, { type: ɵngcc2.MatDialog }, { type: ɵngcc3.DownloadService }]; }, { error: [{
            type: Output
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZS1hY3Rpb25zLnNlcnZpY2UuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2hvbWUvdHJhdmlzL2J1aWxkL0FsZnJlc2NvL2FsZnJlc2NvLW5nMi1jb21wb25lbnRzL2xpYi9jb250ZW50LXNlcnZpY2VzL3NyYy9saWIvZG9jdW1lbnQtbGlzdC9zZXJ2aWNlcy9ub2RlLWFjdGlvbnMuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFpQkEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRWpFLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLGtCQUFrQixFQUFFLGNBQWMsRUFBRSxxQkFBcUIsRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNoSCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFFckQsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0seUJBQXlCLENBQUM7QUFDOUQsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0seURBQXlELENBQUM7QUFDbkcsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQ3hEO0FBRXNCO0FBR0M7QUFHRDtBQUVJOzs7Ozs7QUFMMUIsTUFBTSxPQUFPLGtCQUFrQjtBQUMvQixJQUlJLFlBQW9CLG9CQUE4QyxFQUMvQyxTQUFvQixFQUNwQixPQUF1QixFQUN0QixtQkFBeUMsRUFDekMsVUFBK0IsRUFDL0IsTUFBa0IsRUFDbEIsZUFBaUM7QUFBSSxRQU5yQyx5QkFBb0IsR0FBcEIsb0JBQW9CLENBQTBCO0FBQUMsUUFDaEQsY0FBUyxHQUFULFNBQVMsQ0FBVztBQUFDLFFBQ3JCLFlBQU8sR0FBUCxPQUFPLENBQWdCO0FBQUMsUUFDdkIsd0JBQW1CLEdBQW5CLG1CQUFtQixDQUFzQjtBQUFDLFFB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QkFBbUI7QUFBSSxZQUh2QixrQkFBa0I7QUFBSSxZQUN0QixTQUFTO0FBQUksWUFEOEMsZUFBZTtBQUFHO0FBQUc7QUFDM0Usb0JBWVQsTUFBTTtBQUNWOzs7Ozs7OztvQkFBRTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgSW5qZWN0YWJsZSwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE5vZGUsIE5vZGVFbnRyeSB9IGZyb20gJ0BhbGZyZXNjby9qcy1hcGknO1xuaW1wb3J0IHsgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgQWxmcmVzY29BcGlTZXJ2aWNlLCBDb250ZW50U2VydmljZSwgTm9kZURvd25sb2FkRGlyZWN0aXZlLCBEb3dubG9hZFNlcnZpY2UgfSBmcm9tICdAYWxmcmVzY28vYWRmLWNvcmUnO1xuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZGlhbG9nJztcblxuaW1wb3J0IHsgRG9jdW1lbnRMaXN0U2VydmljZSB9IGZyb20gJy4vZG9jdW1lbnQtbGlzdC5zZXJ2aWNlJztcbmltcG9ydCB7IENvbnRlbnROb2RlRGlhbG9nU2VydmljZSB9IGZyb20gJy4uLy4uL2NvbnRlbnQtbm9kZS1zZWxlY3Rvci9jb250ZW50LW5vZGUtZGlhbG9nLnNlcnZpY2UnO1xuaW1wb3J0IHsgTm9kZUFjdGlvbiB9IGZyb20gJy4uL21vZGVscy9ub2RlLWFjdGlvbi5lbnVtJztcblxuQEluamVjdGFibGUoe1xuICAgIHByb3ZpZGVkSW46ICdyb290J1xufSlcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogZGlyZWN0aXZlLWNsYXNzLXN1ZmZpeFxuZXhwb3J0IGNsYXNzIE5vZGVBY3Rpb25zU2VydmljZSB7XG5cbiAgICBAT3V0cHV0KClcbiAgICBlcnJvciA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBjb250ZW50RGlhbG9nU2VydmljZTogQ29udGVudE5vZGVEaWFsb2dTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHB1YmxpYyBkaWFsb2dSZWY6IE1hdERpYWxvZyxcbiAgICAgICAgICAgICAgICBwdWJsaWMgY29udGVudDogQ29udGVudFNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBkb2N1bWVudExpc3RTZXJ2aWNlPzogRG9jdW1lbnRMaXN0U2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGFwaVNlcnZpY2U/OiBBbGZyZXNjb0FwaVNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBkaWFsb2c/OiBNYXREaWFsb2csXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBkb3dubG9hZFNlcnZpY2U/OiBEb3dubG9hZFNlcnZpY2UpIHt9XG5cbiAgICBkb3dubG9hZE5vZGUobm9kZTogTm9kZUVudHJ5KSB7XG4gICAgICAgIG5ldyBOb2RlRG93bmxvYWREaXJlY3RpdmUodGhpcy5hcGlTZXJ2aWNlLCB0aGlzLmRvd25sb2FkU2VydmljZSwgdGhpcy5kaWFsb2cpXG4gICAgICAgICAgICAuZG93bmxvYWROb2RlKG5vZGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvcHkgY29udGVudCBub2RlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29udGVudEVudHJ5IG5vZGUgdG8gY29weVxuICAgICAqIEBwYXJhbSBwZXJtaXNzaW9uIHBlcm1pc3Npb24gd2hpY2ggaXMgbmVlZGVkIHRvIGFwcGx5IHRoZSBhY3Rpb25cbiAgICAgKi9cbiAgICBjb3B5Q29udGVudChjb250ZW50RW50cnk6IE5vZGUsIHBlcm1pc3Npb24/OiBzdHJpbmcpOiBTdWJqZWN0PHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kb0ZpbGVPcGVyYXRpb24oTm9kZUFjdGlvbi5DT1BZLCAnY29udGVudCcsIGNvbnRlbnRFbnRyeSwgcGVybWlzc2lvbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29weSBmb2xkZXIgbm9kZVxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbnRlbnRFbnRyeSBub2RlIHRvIGNvcHlcbiAgICAgKiBAcGFyYW0gcGVybWlzc2lvbiBwZXJtaXNzaW9uIHdoaWNoIGlzIG5lZWRlZCB0byBhcHBseSB0aGUgYWN0aW9uXG4gICAgICovXG4gICAgY29weUZvbGRlcihjb250ZW50RW50cnk6IE5vZGUsIHBlcm1pc3Npb24/OiBzdHJpbmcpOiBTdWJqZWN0PHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gdGhpcy5kb0ZpbGVPcGVyYXRpb24oTm9kZUFjdGlvbi5DT1BZLCAnZm9sZGVyJywgY29udGVudEVudHJ5LCBwZXJtaXNzaW9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNb3ZlIGNvbnRlbnQgbm9kZVxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbnRlbnRFbnRyeSBub2RlIHRvIG1vdmVcbiAgICAgKiBAcGFyYW0gcGVybWlzc2lvbiBwZXJtaXNzaW9uIHdoaWNoIGlzIG5lZWRlZCB0byBhcHBseSB0aGUgYWN0aW9uXG4gICAgICovXG4gICAgbW92ZUNvbnRlbnQoY29udGVudEVudHJ5OiBOb2RlLCBwZXJtaXNzaW9uPzogc3RyaW5nKTogU3ViamVjdDxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9GaWxlT3BlcmF0aW9uKE5vZGVBY3Rpb24uTU9WRSwgJ2NvbnRlbnQnLCBjb250ZW50RW50cnksIHBlcm1pc3Npb24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE1vdmUgZm9sZGVyIG5vZGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb250ZW50RW50cnkgbm9kZSB0byBtb3ZlXG4gICAgICogQHBhcmFtIHBlcm1pc3Npb24gcGVybWlzc2lvbiB3aGljaCBpcyBuZWVkZWQgdG8gYXBwbHkgdGhlIGFjdGlvblxuICAgICAqL1xuICAgIG1vdmVGb2xkZXIoY29udGVudEVudHJ5OiBOb2RlLCBwZXJtaXNzaW9uPzogc3RyaW5nKTogU3ViamVjdDxzdHJpbmc+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9GaWxlT3BlcmF0aW9uKE5vZGVBY3Rpb24uTU9WRSwgJ2ZvbGRlcicsIGNvbnRlbnRFbnRyeSwgcGVybWlzc2lvbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2VuZXJhbCBtZXRob2QgZm9yIHBlcmZvcm1pbmcgdGhlIGdpdmVuIG9wZXJhdGlvbiAoY29weXxtb3ZlKVxuICAgICAqXG4gICAgICogQHBhcmFtIGFjdGlvbiB0aGUgYWN0aW9uIHRvIHBlcmZvcm0gKGNvcHl8bW92ZSlcbiAgICAgKiBAcGFyYW0gdHlwZSB0eXBlIG9mIHRoZSBjb250ZW50IChjb250ZW50fGZvbGRlcilcbiAgICAgKiBAcGFyYW0gY29udGVudEVudHJ5IHRoZSBjb250ZW50RW50cnkgd2hpY2ggaGFzIHRvIGhhdmUgdGhlIGFjdGlvbiBwZXJmb3JtZWQgb25cbiAgICAgKiBAcGFyYW0gcGVybWlzc2lvbiBwZXJtaXNzaW9uIHdoaWNoIGlzIG5lZWRlZCB0byBhcHBseSB0aGUgYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBkb0ZpbGVPcGVyYXRpb24oYWN0aW9uOiBOb2RlQWN0aW9uLkNPUFkgfCBOb2RlQWN0aW9uLk1PVkUsIHR5cGU6ICdjb250ZW50JyB8ICdmb2xkZXInLCBjb250ZW50RW50cnk6IE5vZGUsIHBlcm1pc3Npb24/OiBzdHJpbmcpOiBTdWJqZWN0PHN0cmluZz4ge1xuICAgICAgICBjb25zdCBvYnNlcnZhYmxlID0gbmV3IFN1YmplY3Q8c3RyaW5nPigpO1xuXG4gICAgICAgIHRoaXMuY29udGVudERpYWxvZ1NlcnZpY2VcbiAgICAgICAgICAgIC5vcGVuQ29weU1vdmVEaWFsb2coYWN0aW9uLCBjb250ZW50RW50cnksIHBlcm1pc3Npb24pXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChzZWxlY3Rpb25zOiBOb2RlW10pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBzZWxlY3Rpb25zWzBdO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRMaXN0U2VydmljZVtgJHthY3Rpb24udG9Mb3dlckNhc2UoKX1Ob2RlYF0uY2FsbCh0aGlzLmRvY3VtZW50TGlzdFNlcnZpY2UsIGNvbnRlbnRFbnRyeS5pZCwgc2VsZWN0aW9uLmlkKVxuICAgICAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLm5leHQuYmluZChvYnNlcnZhYmxlLCBgT1BFUkFUSU9OLlNVQ0NFU1MuJHt0eXBlLnRvVXBwZXJDYXNlKCl9LiR7YWN0aW9ufWApLFxuICAgICAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLmVycm9yLmJpbmQob2JzZXJ2YWJsZSlcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICBvYnNlcnZhYmxlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gb2JzZXJ2YWJsZTtcbiAgICB9XG59XG4iXX0=